var USB4View=USB4View?USB4View:{};USB4View.AdapterNumbersPerDescriptionTextLine=4;USB4View.TunnelBoxBaseHeight=85;USB4View.TunnelBoxBaseWidth=200;USB4View.TunnelBoxDescriptionSeparator=":";USB4View.TunnelEdgeAdapterTextHeight=30;USB4View.TunnelEdgeAdapterTextWidth=60;USB4View.KonvaTunnelBox=(class{constructor(n,t){this._container=t;this.tunnel=n;this._sidebar=null;this.konvaObject=null;this._protocol=this.tunnel.tunnelProtocol();this._boundingRect=new Konva.Rect({width:USB4View.TunnelBoxBaseWidth,height:USB4View.TunnelBoxBaseHeight,stroke:"black",strokeWidth:USB4View.STROKEWIDTH,fill:USB4View.protocolColor(this._protocol)});this._protocolText=new Konva.Text({text:this._protocol,width:this._boundingRect.width(),height:30,fontFamily:"Consolas",fontSize:28,align:"center",verticalAlign:"middle"});this._inText=new Konva.Text({text:this.tunnel.firstAdapter()+" "+(this._protocol==USB4View.DP?USB4View.IN:USB4View.DN),x:USB4View.DefaultPad,width:USB4View.TunnelEdgeAdapterTextWidth,height:USB4View.TunnelEdgeAdapterTextHeight,fontFamily:"Consolas",fontSize:18,align:"left",verticalAlign:"middle"});this._outText=new Konva.Text({text:this.tunnel.lastAdapter()+" "+(this._protocol==USB4View.DP?USB4View.OUT:USB4View.UP),x:this._boundingRect.width()-USB4View.TunnelEdgeAdapterTextWidth-USB4View.DefaultPad,width:USB4View.TunnelEdgeAdapterTextWidth,height:USB4View.TunnelEdgeAdapterTextHeight,fontFamily:"Consolas",fontSize:18,align:"right",verticalAlign:"middle"});this._segmentText=new Konva.Text({text:this._tunnelSegmentDescription(),width:this._boundingRect.width(),height:this._boundingRect.height()-USB4View.TunnelEdgeAdapterTextHeight,y:USB4View.TunnelEdgeAdapterTextHeight,fontFamily:"Consolas",fontSize:18,align:"center",verticalAlign:"middle",wrap:"word"});this._group=new Konva.Group;this._group.add(this._boundingRect,this._protocolText,this._inText,this._outText,this._segmentText);this._group.on("mouseover",()=>{document.body.style.cursor="pointer",this._boundingRect.setAttrs(USB4View.KonvaToggledProperty)});this._group.on("mouseout",()=>{document.body.style.cursor="default",this._boundingRect.setAttrs(USB4View.KonvaUntoggledProperty)});this._group.on("click",()=>{this._drawSidebar()})}setPosition(n,t){this._group.setAttrs({x:n,y:t});this.konvaObject==null&&(this.konvaObject=this._group,this._container.add(this.konvaObject))}isDrawn(){return this.konvaObject!=null&&this.konvaObject.getParent()!=null}remove(){this.konvaObject.remove();this.konvaObject=null}get width(){return this._boundingRect.width()}get height(){return this._boundingRect.height()}static get baseWidth(){return USB4View.TunnelBoxBaseWidth}static get baseHeight(){return USB4View.TunnelBoxBaseHeight}_tunnelSegmentDescription(){let n=this.tunnel.paths.find(n=>!n.isIncoming).segments,t=[];return n.forEach((i,r)=>{let u=i.startAdapter.adapterNumber+USB4View.TunnelBoxDescriptionSeparator+i.endAdapter.adapterNumber,f=(r+1)%USB4View.AdapterNumbersPerDescriptionTextLine==0,e=r==n.length-1;f&&!e&&(u=u+"\n");t.push(u)}),t.join(USB4View.TunnelBoxDescriptionSeparator)}_drawSidebar(){this._sidebar?this._sidebar.destroy():this._sidebar=new USB4View.SidebarTunnel(this.tunnel,USB4View.SidebarDivId);this._sidebar.render()}})