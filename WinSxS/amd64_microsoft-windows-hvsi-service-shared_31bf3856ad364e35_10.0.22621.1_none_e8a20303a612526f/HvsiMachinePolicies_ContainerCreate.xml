<?xml version="1.0" encoding="utf-8"?>
<Settings>
  <Name>HVSI Machine Policies</Name>
  <ID>HvsiMachinePolicies</ID>
  <RunElevated>true</RunElevated>

  <RegistrySettings Machine="true" CompactSettings="true">

    <!--
        Microsoft Edge Machine Group Policy registry entries
    -->
    <Registry>
     <Path Recursive="false">SOFTWARE\Policies\Microsoft\MicrosoftEdge\Main</Path>
     <Name>AllowInPrivate</Name>
     <Name>Cookies</Name>
     <Name>DoNotTrack</Name>
     <Name>AllowPasswordManager</Name>
     <Name>AllowPopups</Name>
     <Name>PreventAccessToAboutFlagsInMicrosoftEdge</Name>
     <Name>HideLocalHostIP</Name>
     <Name>Use FormSuggest</Name>
    </Registry>
    <Registry>
     <Path Recursive="false">SOFTWARE\Policies\Microsoft\MicrosoftEdge\PhishingFilter</Path>
     <Name>EnabledV9</Name>
     <Name>PreventOverrideAppRepUnknown</Name>
     <Name>PreventOverride</Name>
    </Registry>
    <Registry>
     <Path Recursive="false">SOFTWARE\Policies\Microsoft\MicrosoftEdge\Privacy</Path>
     <Name>ClearBrowsingHistoryOnExit</Name>
    </Registry>
    <Registry>
     <Path Recursive="false">SOFTWARE\Policies\Microsoft\MicrosoftEdge\SearchScopes</Path>
     <Name>ShowSearchSuggestionsGlobal</Name>
    </Registry>
    <Registry>
     <Path Recursive="false">SOFTWARE\Policies\Microsoft\MicrosoftEdge\ServiceUI</Path>
     <Name>AllowWebContentOnNewTabPage</Name>
     <Name>ShowOneBox</Name>
    </Registry>
    <Registry>
     <Path Recursive="false">SOFTWARE\Policies\Microsoft\Windows\Windows Search</Path>
     <Name>AllowCortana</Name>
    </Registry>
      
    <!--
        Microsoft Edge MDM Policy Manager registry entries
    -->
    <Registry>
     <Path Recursive="true">SOFTWARE\Microsoft\PolicyManager\default\Browser\AllowInPrivate</Path>
    </Registry>
    <Registry>
     <Path Recursive="true">SOFTWARE\Microsoft\PolicyManager\default\Browser\AllowCookies</Path>
    </Registry>
    <Registry>
     <Path Recursive="true">SOFTWARE\Microsoft\PolicyManager\default\Browser\AllowDoNotTrack</Path>
    </Registry>
    <Registry>
     <Path Recursive="true">SOFTWARE\Microsoft\PolicyManager\default\Browser\AllowPasswordManager</Path>
    </Registry>
    <Registry>
     <Path Recursive="true">SOFTWARE\Microsoft\PolicyManager\default\Browser\AllowPopups</Path>
    </Registry>
    <Registry>
     <Path Recursive="true">SOFTWARE\Microsoft\PolicyManager\default\Browser\AllowSearchSuggestionsinAddressBar</Path>
    </Registry>
    <Registry>
     <Path Recursive="true">SOFTWARE\Microsoft\PolicyManager\default\Browser\AllowSmartScreen</Path>
    </Registry>
    <Registry>
     <Path Recursive="true">SOFTWARE\Microsoft\PolicyManager\default\Browser\AllowAddressBarDropdown</Path>
    </Registry>
    <Registry>
     <Path Recursive="true">SOFTWARE\Microsoft\PolicyManager\default\Browser\AllowAutofill</Path>
    </Registry>
    <Registry>
     <Path Recursive="true">SOFTWARE\Microsoft\PolicyManager\default\Browser\AllowFlash</Path>
    </Registry>
    <Registry>
     <Path Recursive="true">SOFTWARE\Microsoft\PolicyManager\default\Browser\ConfigureAdditionalSearchEngines</Path>
    </Registry>
    <Registry>
     <Path Recursive="true">SOFTWARE\Microsoft\PolicyManager\default\Browser\PreventAccessToAboutFlagsInMicrosoftEdge</Path>
    </Registry>
    <Registry>
     <Path Recursive="true">SOFTWARE\Microsoft\PolicyManager\default\Browser\PreventSmartScreenPromptOverrideForFiles</Path>
    </Registry>
    <Registry>
     <Path Recursive="true">SOFTWARE\Microsoft\PolicyManager\default\Browser\PreventSmartScreenPromptOverride</Path>
    </Registry>
    <Registry>
     <Path Recursive="true">SOFTWARE\Microsoft\PolicyManager\default\Browser\PreventUsingLocalHostIPAddressForWebRTC</Path>
    </Registry>
    <Registry>
     <Path Recursive="true">SOFTWARE\Microsoft\PolicyManager\default\Browser\SetDefaultSearchEngine</Path>
    </Registry>

    <Registry>
     <Path Recursive="false">SOFTWARE\Microsoft\PolicyManager\current\device\Browser</Path>
     <Name>AllowInPrivate</Name>
     <Name>AllowInPrivate_ProviderSet</Name>
     <Name>AllowCookies</Name>
     <Name>AllowCookies_ProviderSet</Name>
     <Name>AllowDoNotTrack</Name>
     <Name>AllowDoNotTrack_ProviderSet</Name>
     <Name>AllowPasswordManager</Name>
     <Name>AllowPasswordManager_ProviderSet</Name>
     <Name>AllowPopups</Name>
     <Name>AllowPopups_ProviderSet</Name>
     <Name>AllowSearchSuggestionsinAddressBar</Name>
     <Name>AllowSearchSuggestionsinAddressBar_ProviderSet</Name>
     <Name>AllowSmartScreen</Name>
     <Name>AllowSmartScreen_ProviderSet</Name>
     <Name>AllowAddressBarDropdown</Name>
     <Name>AllowAddressBarDropdown_ProviderSet</Name>
     <Name>AllowAutofill</Name>
     <Name>AllowAutofill_ProviderSet</Name>
     <Name>AllowFlash</Name>
     <Name>AllowFlash_ProviderSet</Name>
     <Name>ConfigureAdditionalSearchEngines</Name>
     <Name>ConfigureAdditionalSearchEngines_ProviderSet</Name>
     <Name>PreventAccessToAboutFlagsInMicrosoftEdge</Name>
     <Name>PreventAccessToAboutFlagsInMicrosoftEdge_ProviderSet</Name>
     <Name>PreventSmartScreenPromptOverrideForFiles</Name>
     <Name>PreventSmartScreenPromptOverrideForFiles_ProviderSet</Name>
     <Name>PreventSmartScreenPromptOverride</Name>
     <Name>PreventSmartScreenPromptOverride_ProviderSet</Name>
     <Name>PreventUsingLocalHostIPAddressForWebRTC</Name>
     <Name>PreventUsingLocalHostIPAddressForWebRTC_ProviderSet</Name>
     <Name>SetDefaultSearchEngine</Name>
     <Name>SetDefaultSearchEngine_ProviderSet</Name>
    </Registry>

    <!--
        Specific IME settings
    -->
    <Registry>
     <Path Recursive="true">System\CurrentControlSet\Services\i8042prt\Parameters</Path>
    </Registry>
    <Registry>
     <Path Recursive="true">SOFTWARE\Microsoft\CTF</Path>
    </Registry>

    <!--
        Cortana MDM Policy Manager registry entries
    -->
    <Registry>
     <Path Recursive="true">SOFTWARE\Microsoft\PolicyManager\default\Experience\AllowCortana</Path>
    </Registry>
    
    <Registry>
     <Path Recursive="false">SOFTWARE\Microsoft\PolicyManager\current\device\Experience</Path>
     <Name>AllowCortana</Name>
     <Name>AllowCortana_ProviderSet</Name>
    </Registry>
      
    <Registry>
     <Path Recursive="true">System\CurrentControlSet\Control\MUI\UILanguages</Path>
    </Registry>
    
    <!--
        HVSI MDM Policy Manager registry entries
    -->
    <Registry>
     <Path Recursive="true">SOFTWARE\Microsoft\PolicyManager\default\AppHVSI\AuditApplicationGuard</Path>
    </Registry>

    <Registry>
     <Path Recursive="false">SOFTWARE\Microsoft\PolicyManager\current\device\AppHVSI</Path>
     <Name>AuditApplicationGuard</Name>
     <Name>AuditApplicationGuard_ProviderSet</Name>
    </Registry>

    <!--
        HVSI Machine Group Policy registry entries
    -->
    <Registry>
     <Path Recursive="false">SOFTWARE\Policies\Microsoft\AppHVSI</Path>
     <Name>AuditApplicationGuard</Name>
    </Registry>

    <!--
        HVSI Machine reg key controls UIlock in wdag office.
    -->
    <Registry>
     <Path Recursive="false">SOFTWARE\Microsoft\Hvsi\Office</Path>
     <Name>DisableUILock</Name>
    </Registry>

    <!--
        HVSI Machine reg key to enable licensing vdev .
    -->
    <Registry>
        <Path Recursive="false">SOFTWARE\Microsoft\Hvsi</Path>
        <Name>DisableLicensingVdevForWDAG</Name>
    </Registry>

  </RegistrySettings>
  
  <Execute>
   <Path>%windir%\system32\HvsiMachinePolicies.dll</Path>
  </Execute>
</Settings>
