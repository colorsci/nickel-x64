<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v3" manifestVersion="1.0" copyright="Copyright (c) Microsoft Corporation. All Rights Reserved.">
  <firewallRule Action="Allow" Active="FALSE" Binary="%SystemRoot%\system32\snmptrap.exe" Desc="@firewallapi.dll,-50328" Dir="In" LPort="162" Name="@firewallapi.dll,-50327" Profile="Private, Public" Protocol="17" RA4="LocalSubnet" RA6="LocalSubnet" Svc="SNMPTRAP" group="@firewallapi.dll,-50323" internalName="SNMPTRAP-In-UDP" />
  <firewallRule Action="Allow" Active="FALSE" Binary="%SystemRoot%\system32\snmptrap.exe" Desc="@firewallapi.dll,-50328" Dir="In" LPort="162" Name="@firewallapi.dll,-50327" Profile="Domain" Protocol="17" Svc="SNMPTRAP" group="@firewallapi.dll,-50323" internalName="SNMPTRAP-In-UDP-NoScope" />
  <assemblyIdentity name="Microsoft-Windows-SNMP-Trap-Service" version="10.0.22621.1" processorArchitecture="amd64" language="neutral" buildType="release" publicKeyToken="31bf3856ad364e35" versionScope="nonSxS" />
  <dependency discoverable="no" resourceType="Resources">
    <dependentAssembly dependencyType="prerequisite">
      <assemblyIdentity name="Microsoft-Windows-SNMP-Trap-Service.Resources" version="10.0.22621.1" processorArchitecture="amd64" language="*" buildType="release" publicKeyToken="31bf3856ad364e35" />
    </dependentAssembly>
  </dependency>
  <file name="snmptrap.exe" destinationPath="$(runtime.system32)\" sourceName="snmptrap.exe" importPath="$(build.nttree)\" sourcePath=".\">
    <securityDescriptor name="WRP_FILE_DEFAULT_SDDL" />
    <asmv2:hash xmlns:asmv2="urn:schemas-microsoft-com:asm.v2" xmlns:dsig="http://www.w3.org/2000/09/xmldsig#">
      <dsig:Transforms>
        <dsig:Transform Algorithm="urn:schemas-microsoft-com:HashTransforms.Identity" />
      </dsig:Transforms>
      <dsig:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha256" />
      <dsig:DigestValue>dWWpYqqLbm5l0boZVJIvU+Mov1DTxSYt/uIz28Tb8o4=</dsig:DigestValue>
    </asmv2:hash>
  </file>
  <registryKeys>
    <registryKey keyName="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\System\SNMPTRAP">
      <registryValue name="EventMessageFile" valueType="REG_EXPAND_SZ" value="%SystemRoot%\System32\snmptrap.exe" />
      <registryValue name="TypesSupported" valueType="REG_DWORD" value="0x00000007" />
    </registryKey>
    <registryKey keyName="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\RestrictedServices\Static\System">
      <registryValue name="SNMPTRAP-1" valueType="REG_SZ" value="V2.0|Action=Allow|Dir=In|Protocol=17|App=%SystemRoot%\system32\snmptrap.exe|Svc=SNMPTRAP|Name=Allow inbound UDP traffic to SNMPTRAP service|" />
      <registryValue name="SNMPTRAP-2" valueType="REG_SZ" value="V2.0|Action=Block|Dir=In|App=%SystemRoot%\system32\snmptrap.exe|Svc=SNMPTRAP|Name=Block any other traffic to SNMPTRAP service|" />
      <registryValue name="SNMPTRAP-3" valueType="REG_SZ" value="V2.0|Action=Block|Dir=Out|App=%SystemRoot%\system32\snmptrap.exe|Svc=SNMPTRAP|Name=Block any other traffic from SNMPTRAP service|" />
    </registryKey>
    <registryKey keyName="HKEY_LOCAL_MACHINE\System\CurrentControlset\Services\SNMPTrap">
      <overridable name="Start" scope="Microsoft" type="REG_DWORD" />
    </registryKey>
  </registryKeys>
  <memberships>
    <categoryMembership>
      <id name="Microsoft.Windows.Categories.Services" version="10.0.22621.1" publicKeyToken="31bf3856ad364e35" typeName="Service" />
      <categoryInstance subcategory="SNMPTRAP">
        <serviceData name="SNMPTRAP" displayName="@firewallapi.dll,-50323" errorControl="normal" start="demand" type="win32OwnProcess" description="@firewallapi.dll,-50324" imagePath="%SystemRoot%\System32\snmptrap.exe" objectName="NT AUTHORITY\LocalService" requiredPrivileges="SeChangeNotifyPrivilege" sidType="unrestricted">
          <failureActions resetPeriod="4294967295">
            <actions>
              <action delay="60000" type="restartService" />
              <action delay="60000" type="restartService" />
              <action delay="0" type="none" />
            </actions>
          </failureActions>
        </serviceData>
      </categoryInstance>
    </categoryMembership>
  </memberships>
  <localization>
    <resources culture="en-US">
      <stringTable>
        <string id="description1" value="Receives trap messages generated by local or remote Simple Network Management Protocol (SNMP) agents and forwards the messages to SNMP management programs running on this computer. If this service is stopped, SNMP-based programs on this computer will not receive SNMP trap messages. If this service is disabled, any services that explicitly depend on it will fail to start." />
        <string id="description" value="The trap service is a component that allows SNMP management applications to receive trap messages sent by SNMP agents. The service receives incoming trap messages from the network and forwards them through the WinSNMP API (wsnmp32.dll) to the appropriate management system." />
        <string id="displayName" value="SNMP TRAP" />
        <string id="displayName1" value="SNMP Trap" />
      </stringTable>
    </resources>
  </localization>
  <trustInfo>
    <security>
      <accessControl>
        <securityDescriptorDefinitions>
          <securityDescriptorDefinition name="WRP_FILE_DEFAULT_SDDL" sddl="O:S-1-5-80-956008885-3418522649-1831038044-1853292631-2271478464G:S-1-5-80-956008885-3418522649-1831038044-1853292631-2271478464D:P(A;;FA;;;S-1-5-80-956008885-3418522649-1831038044-1853292631-2271478464)(A;;GRGX;;;BA)(A;;GRGX;;;SY)(A;;GRGX;;;BU)(A;;GRGX;;;S-1-15-2-1)(A;;GRGX;;;S-1-15-2-2)S:(AU;FASA;0x000D0116;;;WD)" operationHint="replace" description="Default SDDL for Windows Resource Protected file" />
        </securityDescriptorDefinitions>
      </accessControl>
    </security>
  </trustInfo>
</assembly>