var __spreadArrays,__assign,WSB;(function(n){function u(){if(!n.isMiniSerpEnabled())return 0;var t=7;return n.config.allowAnswersToAutoOpenMiniSerp||(t&=-2),n.config.allowDNavToAutoOpenMiniSerp||(t&=-3),n.config.allowWebToAutoOpenMiniSerp||(t&=-5),t}var t=function(){function t(){}return t.QuickAccess=n.config.newQuickAccess?"::{F874310E-B6B7-47DC-BC84-B9E6B38F5903}":"::{679F85CB-0220-4080-B29B-5540CC05AAB6}",t.ThisPC="::{20D04FE0-3AEA-1069-A2D8-08002B30309D}",t.ControlPanel="::{26EE0668-A00A-44D7-9371-BEB064C98683}",t}(),i=[t.QuickAccess,t.ThisPC],r=function(){function r(){this.refreshEntrypointApp()}return r.prototype.refreshEntrypointApp=function(){this.EntryPointApp=SearchAppWrapper.CortanaApp.hostingEnvironment==3?1:n.config.forceSettingsAppExperience?3:0},r.prototype.clearDefaults=function(){this.QfMode=0;this.PreviewPaneAvailable=!1;this.MiniSERPMode=0;this.AlwaysWide=!1;this.SearchBoxOnTop=!0;this.AllowKeyboardNavCycling=!0;this.AllowKeyboardNavOffCanvas=!1;this.ScopesAvailable=!1;this.FlatListWithoutGroups=!1;this.MaxSuggestionsWhenFlatList=0;this.SearchHomeAvailable=undefined;this.FirstSuggestionSelectedByDefault=!0;this.AllowProtocolSyntheticSuggestions=!0;this.PanelCanResize=!1},r.prototype.getAlwaysWideAndPrevewPaneAvailable=function(){var u=SearchAppWrapper.CortanaApp.textScaleFactor>1.25,t;try{t=SearchAppWrapper.CortanaApp.isWideSearch}catch(e){}var i=t!==!1&&!!n.Host.getFeatureDWORD("WideAtStartupDelta").featureValue,r=(i||n.config.alwaysWideBeforeRS5)&&!u,f=r||n.PreviewPane&&!i&&t!==!1;return[r,f]},r.prototype.OnAppVisible=function(){var r;this.clearDefaults();this.refreshEntrypointApp();n.isFileExplorerCurrentPathThisPcOrQuickAccess=!1;switch(this.EntryPointApp){case 1:r=n.safeExecute(function(){return SearchAppWrapper.CortanaApp.fileExplorerSuggestionPage.currentLocation},"fileExplorerSuggestionPage.currentLocation");r&&!r.startsWith("::")?this.QfMode=5:n.config.wsbInControlPanel&&r&&r.startsWith(t.ControlPanel)?this.QfMode=9:n.contains(i,r)?(n.isFileExplorerCurrentPathThisPcOrQuickAccess=!0,this.QfMode=5):this.QfMode=999999;this.AllowKeyboardNavOffCanvas=!0;this.FlatListWithoutGroups=!0;this.MaxSuggestionsWhenFlatList=10;this.FirstSuggestionSelectedByDefault=!1;this.AllowProtocolSyntheticSuggestions=!1;this.PanelCanResize=!0;break;case 3:this.QfMode=7;this.FlatListWithoutGroups=!0;this.MaxSuggestionsWhenFlatList=10;this.AllowProtocolSyntheticSuggestions=!1;break;case 0:default:var e=this.getAlwaysWideAndPrevewPaneAvailable(),f=e[0],o=e[1];this.QfMode=f?1:o?0:4;this.PreviewPaneAvailable=f||o;this.MiniSERPMode=this.PreviewPaneAvailable?u():0;this.AlwaysWide=f;this.ScopesAvailable=f?n.config.scopesOrderBeginAlwaysWide.length>0:n.config.scopesOrderBegin.length>0;this.SearchBoxOnTop=!1;this.SearchHomeAvailable=n.config.searchHomeSupported}},r}();n.RuntimeConfiguration=r})(WSB||(WSB={})),function(n){var t;(function(n){var t,i,r,u,f,e;(function(n){n.User="SRCHHPGUSR"})(t=n.CookieNames||(n.CookieNames={})),function(n){n.AutoSuggest="AS"}(i=n.CrumbNames||(n.CrumbNames={})),function(n){n.CursorPosition="cp";n.ConversationId="cvid";n.SuggestionCount="sc";n.PartialQuery="pq";n.SuggestionPosition="sp";n.SuggestionType="qs";n.PreviewPaneSuggestionType="qsc";n.SkipValue="sk";n.PreviewPaneSkipValue="skc";n.Ghosting="ghc";n.Css="css";n.Count="count";n.DataSet="ds";n.SessionId="sid";n.TimeStamp="qt";n.Query="q";n.ImpressionGuid="ig";n.QFQuery="qry";n.BaseQuery="bq";n.FormCode="form";n.HashedMuid="nclid";n.RequestElToken="elvr";n.ElTokenValue="elv";n.AppId="appid";n.History="history";n.NoHistory="nohs";n.ApiTextDecoration="textdecorations";n.ClientId="clientid";n.Market="mkt";n.Scope="scope";n.CountryCode="cc";n.HomeGeographicRegion="hgr";n.SetLang="setlang";n.ZeroInputSerp="zis";n.Host="host";n.CortanaVersion="version";n.QfMode="qfm"}(r=n.QueryParams||(n.QueryParams={})),function(n){n.ImpressionGuid="X-MSEdge-IG"}(u=n.Headers||(n.Headers={})),function(n){n.HitHighlighting="h";n.PopularNow="p";n.Local="l";n.Answers="a"}(f=n.Options||(n.Options={})),function(n){n.Id="id";n.Query="query";n.Url="url";n.Navigation="nav";n.Type="stype";n.Autocomplete="hc";n.InstData="h";n.AriaLabel="aria-label"}(e=n.SuggestionAttributes||(n.SuggestionAttributes={}))})(t=n.Service||(n.Service={}))}(WSB||(WSB={})),function(n){function ri(t,i){if(i){var r=nt.exec(t);return r&&n.TopLevelDomains[r[1].toLowerCase()]==1}return nt.test(t)}function ui(n){return ni.test(n)}function fi(t){for(var i,u=t.substr(1).split("%").map(function(n){return parseInt(n,16)}),r=0;r<u.length;++r)if((i=[u[r],u[r+1]||0,u[r+2]||0,u[r+3]||0],i[0]>=240&&++r&&i[3]<128)||i[0]>=224&&++r&&i[2]<128||i[0]>=192&&++r&&i[1]<128||i[0]<192&&i[0]>=128||i[0]<32||n.contains(it,i[0]))return!1;return!0}function ei(n){return n.replace(/%25/g,"%2525").replace(/%([^0-9a-fA-F])/g,"%25$1").replace(/%([^0-9a-fA-F])/g,"%25$1").replace(/%(.[^0-9a-fA-F])/g,"%25$1").replace(/%(.[^0-9a-fA-F])/g,"%25$1").replace(/%(.)?$/g,"%25$1").match(/[^%]+|(?:%..)*/g).map(function(n){return n.startsWith("%")&&!fi(n)?n.replace(/%/g,"%25"):n}).join("")}function h(t){var i=t;return t.includes("%")&&(t=n.safeExecute(function(){return ei(t)},"sanitizeUrlEncodings",i,i)),n.safeExecute(function(){return decodeURI(t)},"safeDecodeURI",i,i)}function r(n,t){var r,u,i;if(!n)return null;if(n=n.trim(),n.includes("%")&&c(n))if(n.includes("?")){var e=/([^?]*)(.*)/.exec(n),f=e[1],o=e[2];f=h(f);n=f+o}else n=h(n);return(r=kt.exec(n),!r)?null:(u=r[0].length,t&&u<n.length)?null:(i={length:u,type:0,protocol:r[1]||"",auth:r[2]||"",hostname:r[3]||"",port:r[4]||"",path:r[5]||"",parameters:r[6]||"",unparsedSegment:n.substr(u)},i.auth&&!i.auth.includes(":")&&!i.protocol&&!i.port&&!i.path&&!i.parameters)?null:i.protocol||i.path&&i.path.endsWith("/")?i:dt.test(i.hostname)||ri(i.hostname,t)||w.test(i.hostname)||k.test(i.hostname)?i:(i.type=i.path&&!ui(i.path)?1:2,i)}function rt(n,t){var r=new RegExp("[?&]{1}"+t+"=([^&]+)([\\/\\\\][^?#]*)?([?#].*)?","i"),i=n.match(r);return i?i[1]:null}function ci(n){return si.some(function(t){return n.startsWith(t)})||oi.test(n)||n.toLocaleLowerCase().includes(hi)}function li(n,t,i){var e=0,o=0,s=0,u;(t.startsWith("read:")||t.startsWith("ftp:"))&&(t=t.replace(f,""));u=r(t,!0);u&&u.type==0&&(e=ai(i,u),o=vi(i,t,u),s=yi(i,u));n.protocolMatchLength=e;n.domainMatchLength=o;n.pathMatchLength=s}function ai(n,t){var i=f.exec(n),r=i?i[1]:n.trim();return t.protocol.startsWith(r)?r.length:0}function vi(t,i,r){var u,f,o,e,s;return w.test(r.hostname)||k.test(r.hostname)?r.hostname.startsWith(t)||i.startsWith(t)?t.length:0:(u=r.hostname.split("."),u.length==1?f=HitHighlightingParser.addMarkers(u[0],t):(u=u.length>2&&n.SecondLevelDomains[u[u.length-2]]?u.splice(0,u.length-2):u.splice(0,u.length-1),o=u.join("."),f=HitHighlightingParser.addMarkers(o,t)),e=f.indexOf(HitHighlightingParser.startMarker),e==-1)?0:t.includes(".")?(t.endsWith("/")&&(t=t.substr(0,t.length-1)),r.hostname.includes(t)?t.length:0):(s=f.indexOf(HitHighlightingParser.endMarker),s-e-1)}function yi(n,t){var i,r,u;return t.path?(i=HitHighlightingParser.addMarkers(t.path,n),r=i.indexOf(HitHighlightingParser.startMarker),r==-1)?0:(u=i.indexOf(HitHighlightingParser.endMarker),u-r-1):0}function pi(n){return n=ft(n,!1),gt.test(n)}function ut(n){return f.test(n)}function wi(n){return a.test(n)}function c(n){return wt.test(n)}function bi(n){return ut(n)&&!c(n)}function ki(n){var t;return t=typeof n=="string"?n:l(n,!0),t=gi(t),t.trim().replace(/^ht+p(s)?[:;]+[\\\/]*|^\/*/ig,function(n,t){return t?"https://":"http://"})}function ft(n,t){return t?n.includes("/")||(n=n.replace(/\\/g,"/")):n.startsWith("//")||n.includes("\\")||(n=n.replace(/\//g,"\\")),n}function di(n){return n=ft(n,!0).replace(/\/+/g,"/"),(n.startsWith("/")?"file:/":"file:///")+n}function gi(n){if(!n||!n.includes("\\"))return n;var i=n.includes("?")?n.indexOf("?"):n.length,r=n.includes("#")?n.indexOf("#"):n.length,t=Math.min(i,r),u=n.substring(0,t),f=n.substr(t);return u.replace(/\\/g,"/")+f}function l(n,t){var i=n.protocol?n.protocol:"";return i+=!t&&n.auth?n.auth:"",i+=n.hostname,i+=n.port?n.port:"",i+=n.path?n.path:"",i+=n.parameters?n.parameters:"",i+(n.unparsedSegment?n.unparsedSegment:"")}function i(n,t){var i=n,u,f,e;return t&1&&(u=et.exec(i),u&&(i=u[1])),t&2&&(u=ot.exec(i),u&&(i=u[1])),t&4&&(u=st.exec(i),u&&(i=u[1])),t&8&&(u=a.exec(i),u&&(i=u[1])),t&16&&(u=nr.exec(i),u&&(i=u[1])),t&32&&(f=r(i,!1),f&&(f.protocol=f.protocol.toLocaleLowerCase(),f.hostname=f.hostname.toLocaleLowerCase(),e=l(f),i=i.replace(/^(\s*)(?:[^\s]*)(\s*)$/g,"$1"+e+"$2"))),t&64&&(i=h(i)),i}function tr(n){return a.test(n)}function e(n){return ot.test(n)?1:et.test(n)?2:st.test(n)?3:0}function ir(n,t,r){var f,u,o,s,e;return t?t=="/"?n:(f=i(t,7),f!=t)?n:(u=i(n,r?7:6),!u)?n:(o=t.toLowerCase(),"https".startsWith(o)&&!u.startsWith(t))?n:(s=i(f,8),s!=f)?u:(e=i(u,8),!e)?u:"www".startsWith(o)&&!e.startsWith(t)?u:e:i(n,r?15:14)||n}function rr(n,t){var i=e(t);switch(e(n)){case 1:return i!=2;case 2:return i!=1;case 3:case 0:return!0}}function ur(t,r,u){if(i(r,127)!=i(u,127))return!1;var f=e(t.originalQuery);return n.contains([1,2],f)&&!rr(r,u)?!1:!0}function ct(n){var t=r(n,!0),i;return t?(i=v(t),i?t.path.toLocaleLowerCase():null):null}function v(n){var t=n.hostname.split(".");return n.hostname&&t.length>1?t[t.length-1]=="com"&&ht.some(function(n){return t[t.length-2]==n}):!0}function fr(t){if(t=="/?form=EDGSTP&pc=MESP"||t=="/?form=EDGSTP&pc=MESPB")return!0;var i=ct(t);return!!i&&n.contains(n.WebSearchPaths,i)}function er(n){var t=r(n.replace(/^ftp:/g,"http:"),!0);return(t?t.hostname:null)||""}function or(t){var r=t.queryToFetch.toLocaleLowerCase(),f,u;return r?(f=["/","ht","htt","http","https","ww","www"],u=i(r,15),!u||n.contains(f,r)||u!=r&&"www".startsWith(i(r,7))):!1}function sr(n){var t,i;return pt.test(n)||f.test(n)?!0:(t=n.replace(ti,"/"),ii.test(t)?t=t.replace(tt,"."):t.includes(".")&&(t=t.replace(tt,"")),i=r(t,!0),i&&i.type==0)}function hr(t,i,r,u,f){var o,e;if(!t||!i||!r)return"";o=encodeURIComponent(i);e={triggeringMode:"Explicit",intent:r};u&&(e.entityId=u);var h=JSON.stringify(e),c=encodeURIComponent(h),s=n.formatString(t.bfbSearchUrl,[o,c,f]);return _G&&_G.IG?s+"&cvid="+encodeURIComponent(_G.IG):s}function cr(t,i,r){var u=n.formatString(t.bfbSearchUrl,[i,"",r]);return _G&&_G.IG?u+"&cvid="+encodeURIComponent(_G.IG):u}function lr(n){return n.replace(/[;,/?:@&=+$ ]/g,function(n){return"%"+n.charCodeAt(0).toString(16)})}function ar(n,t,i){return v(r(n,!0))?at(lt(n,i),t):n}function lt(n,t){return o(n,"setlang",t)}function at(n,t){return o(n,"cc",t)}function o(n,t,i){var u=vr(n),f=u.params,e=u.anchor,r=f,s=rt(f,t);return s==null?r=n.indexOf("?")>=0?r.concat("&"+t+"="+i):r.concat("?"+t+"="+i):(r=r.replace(new RegExp(t+"="+s,"i"),""),r=o(r,t,i)),e.length>0&&(r=r.concat("#",e)),r=r.replace("?&","?"),r.replace("&&","&")}function vr(n){var t=n.split("#");return t.length==2?{params:t[0],anchor:t[1]}:{params:t[0],anchor:""}}var u="\\-\\s\\[\\]\\/\\\\!@#$%^&*()+={}:;~`\"'|<,>.。?",vt="(?:[^"+u+"]-*)*[^"+u+"](?:-*[^"+u+"])*",y="(?:[^"+u+"]-*)*[^"+u+"0-9](?:-*[^"+u+"])*",yt="(?:(?:"+vt+"[.。])*"+y+")[.。]?",p="(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])",s="(?:(?:"+p+"\\.){3}"+p+")",w=new RegExp("^"+s+"$"),t="(?:[0-9a-fA-F]{1,4})",b="(?::(?:(?::"+t+"){1,7}|:)|(?:"+t+":){1,7}:|(?:"+t+":){7}"+t+"|(?:"+t+":){1,6}(?::"+t+"){1}|(?:"+t+":){1,5}(?::"+t+"){2}|(?:"+t+":){1,4}(?::"+t+"){3}|(?:"+t+":){1,3}(?::"+t+"){4}|(?:"+t+":){1,2}(?::"+t+"){5}|(?:"+t+":){1,1}(?::"+t+"){6}|fe80:(?::"+t+"){0,4}%[0-9]+|::ffff:"+s+"|)",k=new RegExp("^\\["+b+"\\]$","i"),d="ht+ps?[:;]+[\\\\/]*",pt=new RegExp(d,"i"),g=d+"|/+",wt=new RegExp("^("+g+")","i"),bt=yt+"|"+s+"|\\["+b+"\\]",kt=new RegExp("^("+g+")?([^/@#?]*@)?("+bt+")(:(?:6553[0-5]|655[0-2][0-9]|65[0-4][0-9]{2}|6[0-4][0-9]{3}|[1-5][0-9]{1,4}|[1-9][0-9]{0,3}))?([\\/\\\\][^?#]*)?([?#].*)?","i"),dt=/^localhost[.。]?$/,nt=new RegExp("[.。]("+y+")[.。]?$","i"),gt=/((^[\\]{2}).+)|(^[a-z]:\\.*)/i,f=/^([a-z0-9\-]+):/i,ni=/\s/,tt=/\s+/g,ti=/\s+\/(?!\/)/g,ii=/([^\/]|^)\/(?!\/)/,it,ht;n.WebSearchPaths=["/search","/entityexplore"];it=[33,39,40,41,42,91,93];n.tryParseUrl=r;n.getQueryStringParam=rt;var oi=/file:\/\/\/[^:\/]+:\/[^\/]+\/[^\/]+\/AppData\//i,si=["ms-appx:","ms-appx-web:","ms-browser-extension:",],hi="microsoft.microsoftedge_8wekyb3d8bbwe";n.isJunkUrl=ci;n.computeUrlMatchLengths=li;n.isUncOrLocalPath=pi;n.startsWithProtocol=ut;n.startsWithWww=wi;n.isHttpProtocol=c;n.isNonHttpProtocol=bi;n.cleanAndFixUrlProtocol=ki;n.cleanAndFixUncOrLocalPath=di;n.parsedUrlToString=l;var et=/^ht+ps:\/*(.*)/i,ot=/^ht+p:\/*(.*)/i,st=/^\/{2,}(.*)/,a=/^www\.(.*)/i,nr=/^(.*[^:\/])\/+$/;n.normalizeUrl=i;n.hasWww=tr;n.getProtocol=e;n.prettyPrintUrl=ir;n.isDuplicateUrl=ur;ht=["bing","staging-bing-int","working-bing-int","bing-int","bing-exp","binginternal"];n.tryGetBingPathLC=ct;n.isBingHost=v;n.isBingSearchUrl=fr;n.getDomain=er;n.isEmptyUrlPrefix=or;n.queryLooksLikeUrl=sr;n.buildBfbSearchUrl=hr;n.buildMsbWorkSearchUrl=cr;n.encodeURIComponentForWindowsProtocol=lr;n.setBingUrlLanguageAndRegion=ar;n.setUrlLang=lt;n.setUrlCC=at;n.setUrlParameter=o}(WSB||(WSB={})),function(n){var t,i;(function(n){function t(t,i,r,u,f,e){var o={T:n.QFPERFPING_EVENT_NAME,ST:r,CVID:u,OFFSETS:i,STATE:f,V:n.QFPERFPING_VERSION,RFC:e};return{ImpressionGuid:t,EventType:n.CLIENTINST_EVENT_TYPE,Data:o}}n.CLIENTINST_EVENT_TYPE="ClientInst";n.QFPERFPING_EVENT_NAME="QFPerfPing";n.CLICK_EVENT_TYPE="Click";n.QFPERFPING_VERSION="2";n.QFPERFPING_INVALID_MEASURE=-2;n.INVALID_SEQUENCE_NUMBER=-2;n.KVALUE_SUGGESTIONS_START=1e3;n.KVALUE_SUFFIX_START=1;n.KVALUE_NON_SUGGESTIONS_START=100;n.KVALUE_DSB_CONTENT=500;n.KVALUE_DSB_MSB_CONTENT=800;n.DEFAULT_APP_NAMESPACE="SmartSearch";n.DEFAULT_SERVICE_NAME="AutoSuggest";n.createPerfPingEvent=t})(t=n.InstrumentationCommon||(n.InstrumentationCommon={}));i=function(){function n(n,t,i){this._kValue=n;this._qsCode=t;this._handOffType=i;this._properties={}}return n.createInstrumentedItem=function(t,i){return new n(n.generateKValue(t),i)},n.createInstrumentedItemHandOffOverride=function(t,i,r){return new n(n.generateKValue(t),i,r)},n.createInstrumentedItemKvalueOverride=function(t,i,r){return new n(t,i,r)},n.createInstrumentedItemForReformulation=function(t,i){return new n(n.generateKValue(t),i,998)},n.createInstrumentedItemNoHandOff=function(t,i){return new n(n.generateKValue(t),i,999)},n.getNonSuggestionInstrumentedItem=function(t,i,r){if(!i[t])throw new Error(t+" not found in kvalues map");return new n(i[t],t,r)},n.prototype.getKValue=function(){return this._kValue},n.prototype.getAppNS=function(){return n.AppNS},n.prototype.getLayoutKValue=function(){return this._kValue+"."+n.Suffix},n.prototype.getHValue=function(){return"ID="+n.AppNS+","+this.getLayoutKValue()},n.prototype.getHandoffType=function(){return this._handOffType},n.prototype.getQsCode=function(){return this._qsCode},n.prototype.setProperty=function(n,t){this._properties[n]=t},n.prototype.getProperties=function(){return Object.keys(this._properties).length>0?this._properties:undefined},n.resetKValues=function(n){delete this._keystrokesKValues[n]},n.generateKValue=function(n){var r=n,i=this._keystrokesKValues[r];return i>0||(i=t.KVALUE_SUGGESTIONS_START),this._keystrokesKValues[r]=++i,i},n.AppNS=t.DEFAULT_APP_NAMESPACE,n.Suffix=t.KVALUE_SUFFIX_START,n._keystrokesKValues={},n}();n.InstrumentedItem=i}(WSB||(WSB={}));__spreadArrays=this&&this.__spreadArrays||function(){for(var i=0,n=0,r=arguments.length;n<r;n++)i+=arguments[n].length;for(var u=Array(i),f=0,n=0;n<r;n++)for(var e=arguments[n],t=0,o=e.length;t<o;t++,f++)u[f]=e[t];return u},function(n){function vt(){return matchMedia("screen and (-ms-high-contrast)").matches}function yt(){return(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.isOffline)?!1:navigator.onLine}function c(n){return n?n.replace(ot,"$1").replace(st,"$1 "):n}function pt(n){return n?n.replace(/[-{}]/g,"").toLowerCase():null}function wt(n){return!n||Object.keys(n).length===0}function bt(n){return n.canFail}function l(n,t,i,r){var u,e;n&&(n=n.slice(0,t)+f+n.slice(t,n.length));u=i(n);u&&(e=u.indexOf(f),t=e!=-1?e:t,u=u.replace(f,""));r(u,t)}function kt(n){if(!n)return SharedLogHelper.LogError("getInputType",null,new Error("event object is missing")),0;switch(n.pointerType){case"mouse":return 2;case"touch":return 3;case"pen":return 4;default:return 1}}function a(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];i.forEach(function(t){return delete n.enabledDataSources[t]})}function v(i,r){if(!i||!r)return!1;var u=!n.config.bingFetchEnabledRegions||n.config.bingFetchEnabledRegions.length==0||t(n.config.bingFetchEnabledRegions,i.toLowerCase()),f=r.split("-")[0],e=!n.config.bingFetchEnabledLang||n.config.bingFetchEnabledLang.length==0||t(n.config.bingFetchEnabledLang,f.toLowerCase());return u&&e}function dt(i,r){if(!i||!r)return!1;var u=!n.config.miniSerpEnabledRegions||n.config.miniSerpEnabledRegions.length==0||t(n.config.miniSerpEnabledRegions,i.toLowerCase()),f=r.split("-")[0],e=!n.config.miniSerpEnabledLang||n.config.miniSerpEnabledLang.length==0||t(n.config.miniSerpEnabledLang,f.toLowerCase());return u&&e}function gt(t,i,r){var u=t.queryToFetch&&t.queryToFetch.length<n.config.minQueryLengthForWebProvider||!v(i,r);return u&&a(t,"Web"),u}function y(t){if(t){t=n.normalizeUrl(t,15);for(var i=1;i<t.length-1;++i)if(ct.includes(t[i]))return!0}return!1}function ni(t,i,r){var u,f;return r||(r=0),l(t,i,function(n){return c(n)},function(n,t){u=n;f=t}),u&&(n.config&&n.config.doNotRemoveSpaceAfterIn&&u.toLocaleLowerCase().endsWith(" in ")||(u=u.trim()),f=Math.min(f,u.length)),{originalQuery:t,originalCursorPosition:i,queryToFetch:u,cursorPosition:f,enabledDataSources:{},equals:function(n){return(u?u.toLowerCase():u)==(n.queryToFetch?n.queryToFetch.toLowerCase():n.queryToFetch)&&r==n.topHitRestriction},isMultiWord:y(u),getCacheKey:function(){return u},topHitRestriction:r}}function p(i,r){return r&&!r.enabledDataSources[i]?!1:t(n.config.enabledDataSources,i)}function w(i,r,u,f){var e=f.enabledDataSources[i];return e?e.suggestionIsEnabled&&!e.suggestionIsEnabled(r,u)?!1:t(n.config.enabledDataSources,i):!1}function t(n,t){return n.indexOf(t)!=-1}function ti(n,t){var i=n.indexOf(t);return i!=-1?(n.splice(i,1),!0):!1}function ii(n,t){var i=n.findIndex(t);return i!=-1?n.splice(i,1)[0]:null}function ri(n,t,i){if(t<100)for(var r=n.length-1;n.length>t&&r>=0;--r)i(n[r])&&n.splice(r,1)}function ui(n,i){return n.filter(function(n){return!t(i,n)})}function fi(n,t){if(n.length!=t.length)return!1;for(var i=0;i<n.length;++i)if(n[i]!=t[i])return!1;return!0}function ei(n,t){if(n===t)return!0;if(!n||!t||Object.keys(n).length!=Object.keys(t).length)return!1;for(var i in n)if(n[i]!=t[i])return!1;return!0}function b(){return n.getCurrentDate().getTime()}function r(n){var t=Math.abs(Math.floor(n));return(t<10?"0":"")+t}function oi(){var t=n.getCurrentDate(),i=-t.getTimezoneOffset(),u=i>=0?"+":"-";return t.getFullYear()+"-"+r(t.getMonth()+1)+"-"+r(t.getDate())+"T"+r(t.getHours())+":"+r(t.getMinutes())+":"+r(t.getSeconds())+"."+r(t.getMilliseconds())+u+r(i/60)+":"+r(i%60)}function si(n,t){return n?n.replace(ht,function(n,i){return t[i]}):n}function hi(n){var t=n?n.number:null,i=n?n.name:null;return t==-2147023673||i=="Canceled"}function u(n,t,i,r,u,f){try{return n()}catch(e){return f||SharedLogHelper.LogError(t,r,e),u&&u(e),i}}function o(n,t,i,r,f,e){return sb_st(function(){return u(n,i,null,r,f,e)},t)}function ci(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];u(function(){return sj_evt.fire.apply(sj_evt,__spreadArrays([n],i))},n)}function li(n,t){o(t,1,n)}function s(n,t){var i=[],r=!0,u=function(){for(var u=[],n=0;n<arguments.length;n++)u[n]=arguments[n];r?i.push(u):t.apply(null,u)};n(u);r=!1;i.forEach(function(n){return t.apply(null,n)})}function ai(n,t,i){e=n&&it()!="ms-appx-web:";k=e&&v(t,i);d=e&&dt(t,i)}function vi(){return e}function yi(){return k}function pi(){return d}function ki(n){return t(wi,n)}function di(n){return t(tt,n)}function gi(n){return t(g,n)}function nr(n){return t(nt,n)}function tr(n){return t(bi,n)}function ir(n,t){return n==121&&t||n==93}function rr(n,t){return n==8||n==46||n==88&&t.ctrlKey}function it(){return _w.location.protocol}function ur(){return _w.location.host}function fr(){return _w.location.pathname}function er(){var n=_d.activeElement;return!n||n.id.endsWith("sb_form_q")?_d.body:n}function rt(t){return t&&+t!=n.WindowsApiDefaultDate&&t.getTime&&!isNaN(t.getTime())&&t.getFullYear()!=1600}function ut(t){if(!rt(t))return null;var i=t.getTime(),r=b();return Math.abs(r-i)/n.DayToMs}function or(n){var t=ut(n);return t!==null&&t>14}function sr(n){return n==="i"?13:n==="v"?14:0}function hr(n){return encodeURIComponent(n).replace(/[!'()*]/g,escape).replace(/%20/g,"+")}var f=String.fromCharCode(57346),ot=new RegExp("^\\s*("+f+")?\\s*"),st=new RegExp("\\s*("+f+")?\\s+","g"),ht=/{([0-9]+)}/g,ct=" -_/\\",lt=-2147215328,at=-2147023673,h,ft,i,et;n.DayToMs=864e5;n.HourToMs=36e5;n.MinuteToMs=6e4;n.DebugSourceName="WindowsSearchBox";SharedLogHelper.RegisterErrorFilter(function(n){var t=n?n.number:null,i=n?n.name:null;return t===at||t===lt||i==="Canceled"});n.isHighContrastEnabled=vt;n.isBrowserOnline=yt;n.cleanQuery=c;n.cleanGuid=pt;n.isEmpty=wt;n.canIconFail=bt;n.mantainCursorPositionIn=l;n.getInputType=kt;n.disableDataSources=a;n.disableWebDataSourceIfNeeded=gt;n.isMultiWord=y;n.baseParseQuery=ni;n.isDataSourceEnabled=p;n.isSuggestionTypeEnabled=w;n.contains=t;n.tryRemove=ti;n.removeFirstWhere=ii;n.trimList=ri;n.except=ui;n.sequenceEqual=fi;n.objEquals=ei;n.log=function(){};n.getCurrentDate=function(){return new Date};n.getCurrentTime=b;n.getDateWithTimezone=oi;n.fetchWrapper=function(n,t,i){return i()};n.formatString=si;n.isCancellation=hi;n.safeExecute=u;n.safeSetTimeout=o;n.safeFireEvent=ci;n.invokeAsynchronously=li;n.ensureCallbackIsAsync=s;var e=!0,k=!0,d=!0;n.refreshBingEnabledCache=ai;n.isBingEnabled=vi;n.isWebProviderEnabled=yi;n.isMiniSerpEnabled=pi;var wi=[3,16,17,18,19,20,144,145,],g=[38,203,211,],nt=[40,204,212,],tt=g.concat(nt),bi=tt.concat(37,39,36,35);n.isFunctionalKey=ki;n.isUpOrDownKey=di;n.isUpKey=gi;n.isDownKey=nr;n.isMovingCursorKey=tr;n.isContextMenuKey=ir;n.isDeletionKey=rr;n.getWindowProtocol=it;n.getWindowHost=ur;n.getWindowPath=fr;n.getCurrentActiveElement=er;n.WindowsApiDefaultDate=-116444736e5;n.isValidDate=rt;n.getTimeDiffInDays=ut;n.olderThan2Weeks=or;n.verticalToHandoffType=sr;h=function(){function n(){this._cancellations={};this._lastId=0}return n.prototype.register=function(n,t,i){var r=++this._lastId;return this._cancellations[r]={action:n,skipOnDismissAndLaunch:t,where:i},r},n.prototype.unregister=function(n){delete this._cancellations[n]},n.prototype.cancelAll=function(n){var t=function(t){var r=i._cancellations[t];r.skipOnDismissAndLaunch&&n||u(function(){return r.action()},r.where)},i=this;for(var r in this._cancellations)t(r);this._cancellations={}},n}();n.CancellationManager=h;ft=function(){function n(){}return n.prototype.getItem=function(n){var t;try{return((t=_w.localStorage)===null||t===void 0?void 0:t.getItem(n))||null}catch(i){return SharedLogHelper.LogError("localStorage",i,new Error("getItem")),null}},n.prototype.setItem=function(n,t){var i;try{(i=_w.localStorage)===null||i===void 0?void 0:i.setItem(n,t)}catch(r){SharedLogHelper.LogError("localStorage",r,new Error("setItem"))}},n.prototype.removeItem=function(n){var t;try{return(t=_w.localStorage)===null||t===void 0?void 0:t.removeItem(n)}catch(i){SharedLogHelper.LogError("localStorage",i,new Error("removeItem"))}},n.prototype.clear=function(){var n;try{return(n=_w.localStorage)===null||n===void 0?void 0:n.clear()}catch(t){SharedLogHelper.LogError("localStorage",t,new Error("clear"))}},n.prototype.getLength=function(){var n;try{return((n=_w.localStorage)===null||n===void 0?void 0:n.length)||0}catch(t){return SharedLogHelper.LogError("localStorage",t,new Error("length")),0}},n.prototype.key=function(n){var t;try{return((t=_w.localStorage)===null||t===void 0?void 0:t.key(n))||null}catch(i){return SharedLogHelper.LogError("localStorage",i,new Error("key")),null}},n}();n.LightweightStorage=ft;i=function(){function n(){}return n.resetSequenceNumber=function(){this._sequenceNumber=0},n.getSequenceNumber=function(){return this._sequenceNumber},n.incrementSequenceNumber=function(){this._sequenceNumber++},n._sequenceNumber=0,n}();n.SequenceNumberManager=i;et=function(){function t(t,i,r,u,f){var e=this;this._suggestionsParsers=t;this._rootViewModel=i;this._suggestionsRenderingManager=r;this._webProviders=u;this._otherProviders=f;n.config.cancellationEnabled&&(this._cancellationManager=new h);n.Host.bindShown(function(){e._lastQuery=null;e._currentQuery=null;e._isPaneDismissed=!1});n.Host.bindDismissed(function(){e.clearFetchTimer();e.finishPreviousQuery(!0);e.finalizeKeystroke(!0);e._isPaneDismissed=!0;e._rootViewModel.onDismiss()});n.Host.bindQueryChangedOrInitialized(function(t,i){return e.onQueryChanged(t,n.config.d,i)});n.Host.bindOnSubmit(function(n,t,i){return e.onSubmit(n,t,i)});n.Host.initializeEvents();sj_be(_d.body,"dragstart",function(n){return n.preventDefault(),n.stopPropagation(),!1});sj_b.addEventListener("click",function(n){n.shiftKey&&sj_pd(n)})}return t.prototype.clearFetchTimer=function(){this._fetchTimer&&(sb_ct(this._fetchTimer),this._fetchTimer=null)},t.prototype.finishPreviousQuery=function(n){this.cancelPreviousQuery(n);this._suggestionsRenderingManager.resetTimers()},t.prototype.finalizeKeystroke=function(t){var r=i.getSequenceNumber();r>0&&n.InstrumentationHelper.finalizeKeystrokeLog(r);t||i.incrementSequenceNumber()},t.prototype.onQueryChanged=function(n,t,r){var u=this;if(this._currentQuery=n,!r&&this._lastQuery&&this._lastQuery.equals(this._currentQuery))this._rootViewModel.onQueryChanged(this._currentQuery,i.getSequenceNumber());else this.clearFetchTimer(),this._completedDataSources={},(this._lastQuery||r)&&this.cancelPreviousQuery(!1),this.logQueryChange(r,!1),t<=0||this._currentQuery.isSearchHomeZI?this.fetchForQueryChange(r):this._fetchTimer=o(function(){u._fetchTimer=null;u.fetchForQueryChange(r)},t,"fetchTimer"),this._lastQuery=this._currentQuery},t.prototype.logQueryChange=function(t,r){var f=t?this._currentQuery:n.Host.getQuery(),u;f.equals(this._currentQuery)&&((this._lastQuery||t)&&this.finishPreviousQuery(r),this.finalizeKeystroke(!1),u=i.getSequenceNumber(),n.InstrumentationHelper.instrumentQueryChangedRequest(u,this._currentQuery))},t.prototype.onSubmit=function(t,r,u){this._fetchTimer&&(this._currentQuery||(this._currentQuery=n.Host.getQuery()),this.logQueryChange(!1,!0),this.fetchForQueryChange(!1));this._rootViewModel.submit(t,r,i.getSequenceNumber(),u,this._isPaneDismissed)},t.prototype.cancelPreviousQuery=function(n){this._cancellationManager&&this._cancellationManager.cancelAll(n)},t.prototype.fetchForQueryChange=function(t){var u=this,f,r,o,h;if(this.clearFetchTimer(),f=t?this._currentQuery:n.Host.getQuery(),f.equals(this._currentQuery)){if(r=i.getSequenceNumber(),o=!n.config.enabledDataSources.some(function(n){return p(n,u._currentQuery)}),o)this._rootViewModel.onQueryChanged(this._currentQuery,r);if(h=!1,this._suggestionsRenderingManager.initiateSequenceNumber(r,this._currentQuery,function(){return h=!0}),!o){var e=function(){return!u._isPaneDismissed&&(n.config.d>0?f.equals(u._currentQuery):r==i.getSequenceNumber())&&!h},c=(new Date).getTime(),l=function(n,t,i,o,s,h){return u.onResponseReceived(f,r,n,t,i,e,o,s,c,h)},a=function(t){n.InstrumentationHelper.instrumentFetchesBegin(r);n.config.enabledDataSources.forEach(function(t){n!==undefined&&n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().beginMark(t+".Fetch")});n.fetchWrapper(f,e,function(){u._webProviders.forEach(function(i){u.fetchWeb(f,i,r,t,e);n.config.enableFetchStartLogging&&n.InstrumentationHelper.instrumentFetchProviderBegin(r,i.getName().replace("DataProvider",""))});u._otherProviders.forEach(function(i){u.fetch(f,i,r,t,e);n.config.enableFetchStartLogging&&n.InstrumentationHelper.instrumentFetchProviderBegin(r,i.getName().replace("DataProvider",""))})});n.InstrumentationHelper.instrumentFetchesEnd(r);u._rootViewModel.onQueryChanged(u._currentQuery,r)};s(a,l)}}},t.prototype.fetchWeb=function(t,i,r,f,e){var c=this,s=n.Service.QueryParams,o=n.Host.getCustomUrlParameters(t),h;n.Host.shouldRequestEltoken()&&(o[s.RequestElToken]="1");o[s.CursorPosition]=t.cursorPosition.toString();o[s.ConversationId]=n.Host.getConversationId();o[s.ImpressionGuid]=n.InstrumentationHelper.getImpressionGuid(r);h=n.Host.getCustomHeaders(t);u(function(){return i.fetch(t,f,r,c._cancellationManager,e,o,h)},"fetch "+i.getName())},t.prototype.fetch=function(n,t,i,r,f){var e=this;u(function(){return t.fetch(n,r,i,e._cancellationManager,f)},"fetch "+t.getName())},t.prototype.onResponseReceived=function(t,i,r,u,f,e,o,h,c,l){var a=this,v,y;if(e()){if(this._completedDataSources[r]){n.config.forceUseNifQF&&r=="Web"||SharedLogHelper.LogError("onResponseReceived",r,new Error("Data source already completed"));return}n!==undefined&&n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().endMark(r+".Fetch");this._completedDataSources[r]=!l;n.InstrumentationHelper.instrumentResponseReceived(i,r,f,o,h,l);v=function(r,u,o){if(n.InstrumentationHelper.instrumentDataSourceParsed(i,r),e())a.onSuggestionsParsed(t,i,r,f,u,o,l)};y=function(n){var f=a._suggestionsParsers[r];f?f.parse(t,i,r,u,e,n,a._cancellationManager):(SharedLogHelper.LogError("onResponseReceived",r,new Error("No parser for data source")),n(r,[],null))};s(y,v)}},t.prototype.onSuggestionsParsed=function(t,i,r,u,f,e,o){f=f.filter(function(n){return w(r,n.type,n.handoffType,t)});n.InstrumentationHelper.instrumentDataSource(i,r,f,e);this._rootViewModel.onSuggestionsParsed(t,i,r,u,f,e);this._suggestionsRenderingManager.queueSuggestions(i,r,f,e,o)},t}();n.Core=et;n.encodeQueryParameter=hr}(WSB||(WSB={})),function(n){function bt(t){return n.contains(vt,t)}function kt(t){return n.contains(yt,t)}function dt(t){return n.contains(nt,t)}function gt(t){return n.contains(pt,t)}function ni(t){return n.contains(wt,t)}function o(t){return{dataSource:"ODC",requirements:[1,2],conditionalRequirements:function(){var t=n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType();return n.isCloudSearchEnabledMsaCache&&(t==2||t==4)},suggestionIsEnabled:t?function(n){return n==t}:undefined}}function tt(){return n.isDataSourceEnabled("SSUE",null)}function it(t){var r=n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType(),i=!n.config.userProfileButtonEnabled||r==t;switch(t){case 2:return i&&n.isSubstrateOutlookAccountConnected;case 1:return i&&n.isSubstrateO365AccountConnected;case 4:return i&&n.isSubstrateO365AccountConnected&&n.isSubstrateOutlookAccountConnected;default:return!1}}function ti(t){var i=SearchAppWrapper.CortanaApp.authenticationManager.getAllSearchWebAccountsAsync,r=n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType();return i?!0:r==t}function ii(){return{dataSource:"ANA",groupType:t.SearchSuggestions,requirements:[1],conditionalRequirements:function(){return n.isAnaheimDataEnabled(!1)},suggestionIsEnabled:function(t){return t=="ANAH"||n.config.topHitMuse&&t=="ANATH"}}}function r(n,t,i,r){return s(n,undefined,t,i,r)}function s(t,i,r,u,f){return{dataSource:t,groupType:i,requirements:[1],conditionalRequirements:function(t){return(r==1?n.isCloudSearchEnabledAadCache:n.isCloudSearchEnabledMsaCache)&&(!f||f())&&(u||t&&t.queryToFetch&&t.queryToFetch.length>=n.config.minLengthFor3SonL1)&&ti(r)&&it(r)}}}function ri(){return n.config.use3sRecMeetingRelatedEntities&&(n.isMsftAccountConnected||n.config.cloudDocsZiWw)}function rt(){return n.isDocSourceEnabledInQws("SREE")}function l(t,i){return{dataSource:"MSBC",requirements:[1,2],conditionalRequirements:function(r){var u=n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType();return n.isCloudSearchEnabledAadCache&&(!i||typeof n.isMsbFileReady=="function"&&n.isMsbFileReady())&&(t||r&&r.queryToFetch&&r.queryToFetch.length>=n.config.msbClientQfMinQueryLength)&&(u==1||u==4||n.config.msbMockToken)&&typeof n.isTenantMsbEnabled=="function"&&n.isTenantMsbEnabled()}}}function v(t){return{dataSource:"MSBS",requirements:[1,2],conditionalRequirements:function(i){var r=n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType();return n.isCloudSearchEnabledAadCache&&(t||i&&i.queryToFetch&&i.queryToFetch.length>=n.config.msbServerQfMinQueryLength)&&(r==1||r==4)&&typeof n.isTenantMsbEnabled=="function"&&n.isTenantMsbEnabled()}}}function a(){var t=n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType();return!n.isCloudSearchEnabledAadCache&&!n.isCloudSearchEnabledMsaCache||t==3||t==0||!tt()?!1:!it(t)}function ui(){var t=n.isDocSourceEnabledInQws("SSUE"),i=n.config.enableSsueOnZeroInput&&(n.isMsftAccountConnected||n.config.cloudDocsZiWw);return t||i&&!rt()}function y(){var t=n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType();return t==2||t==4}function ut(t){return t.isSearchHomeZI&&(n.isDataSourceEnabled("SSUE",t)||n.isDataSourceEnabled("SREE",t))}function fi(t,i){return i.siteTitle&&(t.isSearchHomeZI||n.config.nicerCloudFiles&&(n.isMsftAccountConnected||n.config.cloudDocsZiWw))}function ei(){n.ScopeConfig[i.All].getEmptyZIMessages=function(){return f(i.All,"EmptyAllMessage",n.isBingEnabled()?"EmptyAllSubMessage":"EmptyAllSubMessageNoWeb",p(!0))};n.RuntimeConfig.SearchHomeAvailable==1?(n.ScopeConfig[i.All].icon=n.getSearchSuggestionIcon(),n.ScopeConfig[i.All].enabledDataSourcesForZeroInput=[{dataSource:"TOPP",groupType:t.TopApps,suggestionGroupToggler:c(t.TopApps),conditionalRequirements:function(t){return n.shouldShowZIDataSource(t)&&!(n.cohortProfileManager===null||n.cohortProfileManager===void 0?void 0:n.cohortProfileManager.isWWEVisibleSinglePane())&&!(typeof n.shouldHideTopApp=="function"&&n.shouldHideTopApp()&&n.isMsbEnterprise()&&!n.config.msbQwsDynamicDisableEnabled&&n.isQwsSuccessRateThresholdMet())}},{dataSource:"WWE",groupType:t.WelcomeExperience,conditionalRequirements:function(){if(n.cohortProfileManager!==null&&n.cohortProfileManager!==void 0)return n.cohortProfileManager.isWWEVisible()}},{dataSource:"DFLS",groupType:t.CuratedSuggestions,suggestionGroupToggler:c(t.CuratedSuggestions),conditionalRequirements:function(t){return n.shouldShowStaticSearchHome(t)||n.shouldShowDSBLayout(t)}},{dataSource:"CUSE",groupType:t.CuratedSettings,suggestionGroupToggler:c(t.CuratedSettings),conditionalRequirements:function(t){return n.shouldShowStaticSearchHome(t)&&n.config.undocked&&n.RuntimeConfig.AlwaysWide}},{dataSource:"QSCH",groupType:t.QuickSearch,suggestionGroupToggler:c(t.QuickSearch),conditionalRequirements:function(t){return n.canShowQuickSearch(e,t)}},{dataSource:"MSBC",groupType:t.QuickWorkSearch,conditionalRequirements:function(){return n.canShowQuickWorkSearch(e)}},{dataSource:"MSNN",groupType:t.MSNNews,suggestionGroupToggler:c(t.MSNNews),conditionalRequirements:function(){return n.config.msnNewsSearch&&n.shouldEnableMSNNewsSearches(n.getCurrentLanguage())&&n.canShowMSNNewsTab(e)}},{dataSource:"MRU",groupType:t.MRUHistory,conditionalRequirements:function(){return n.enableMRUSearchHome()}},{dataSource:"MPP",groupType:t.MRUHistory,conditionalRequirements:function(){return n.enableMRUSearchHome()}},{dataSource:"MST",groupType:t.MRUHistory,conditionalRequirements:function(){return n.enableMRUSearchHome()}},{dataSource:"MFF",suggestionIsEnabled:function(){return!0},groupType:t.MRUHistory,conditionalRequirements:function(){return n.enableMRUSearchHome()}},{dataSource:"MRS",groupType:t.MRUHistory,requirements:[1,2],conditionalRequirements:function(){return n.enableMRUSearchHome()},suggestionIsEnabled:function(n,t){return t==0}},{dataSource:"ANA",groupType:t.AnaheimDataList,requirements:[1],conditionalRequirements:function(){return n.isAnaheimDataEnabled(!0)},suggestionIsEnabled:function(n){return n=="QSSG"||n=="ANAT"||n=="ANAH"}},s("SSUE",t.RecommendedDocs,1,!0,function(){return ui()}),s("SREE",t.RecommendedDocs,1,!0,function(){return ri()||rt()}),{dataSource:"Web",groupType:t.SearchSuggestions,conditionalRequirements:function(){return n.config.forceUseNifSH}}],n.ScopeConfig[i.All].staticGroupOrderForZeroInput=n.shouldShowStaticSearchHome(n.Host.getQuery())?function(){return[t.MRUHistory,t.CuratedSuggestions,t.CuratedSettings,t.TopApps,t.QuickWorkSearchTopList,t.QuickWorkSearch,t.RecommendedDocs,t.QuickSearch,t.Upsell,t.PromoBanner,]}:n.shouldShowDSBLayout(n.Host.getQuery())?function(){return[t.MRUHistory,t.CuratedSuggestions,t.TopApps,t.QuickWorkSearchTopList,t.QuickWorkSearch,t.RecommendedDocs,t.Upsell,t.PromoBanner,]}:n.shouldEnableAnaheimResetDefault()?function(){return[t.Upsell,t.PromoBanner,t.TopApps,t.AnaheimDataTile,t.MRUHistory,t.AnaheimDataList,t.WelcomeExperience,t.MSNNews,t.QuickWorkSearchTopList,t.QuickWorkSearch,t.RecommendedDocs,t.QuickSearch,t.VisualSearch,]}:function(){return[t.TopApps,t.AnaheimDataTile,t.MRUHistory,t.AnaheimDataList,t.WelcomeExperience,t.MSNNews,t.QuickWorkSearchTopList,t.QuickWorkSearch,t.RecommendedDocs,t.QuickSearch,t.Upsell,t.PromoBanner,t.VisualSearch,]}):n.ScopeConfig[i.All].enabledDataSourcesForZeroInput=[]}function ft(){n.ScopeConfig={};n.ScopeConfig[i.All_FileExplorer]={icon:null,prefixesLocString:null,enabledDataSources:[{dataSource:"FEH"},{dataSource:"IFF"},{dataSource:"MDOC",conditionalRequirements:function(){return n.config.useL2ProvidersInFileExplorer}},{dataSource:"MPHO",conditionalRequirements:function(){return n.config.useL2ProvidersInFileExplorer}},{dataSource:"MVID",conditionalRequirements:function(){return n.config.useL2ProvidersInFileExplorer}},{dataSource:"ODC",requirements:[1,2],conditionalRequirements:function(){return n.config.cloudSearchInFileExplorer&&(n.isFileExplorerCurrentPathThisPcOrQuickAccess||!!SearchAppWrapper.CortanaApp.fileExplorerSuggestionPage.currentSyncRootAccount)}},{dataSource:"SSUE",requirements:[1,2],conditionalRequirements:function(){return n.config.cloudSearchInFileExplorer&&(n.isFileExplorerCurrentPathThisPcOrQuickAccess||!!SearchAppWrapper.CortanaApp.fileExplorerSuggestionPage.currentSyncRootAccount)}},{dataSource:"SSEE",requirements:[1,2],conditionalRequirements:function(){return n.config.cloudSearchInFileExplorer&&(n.isFileExplorerCurrentPathThisPcOrQuickAccess||!!SearchAppWrapper.CortanaApp.fileExplorerSuggestionPage.currentSyncRootAccount)}},],enabledDataSourcesForZeroInput:[{dataSource:"FEH"},],getEmptyZIMessages:null};n.ScopeConfig[i.All_SettingsApp]={icon:null,prefixesLocString:null,enabledDataSources:[{dataSource:"ST"},{dataSource:"MST"},],enabledDataSourcesForZeroInput:[],getEmptyZIMessages:null};n.ScopeConfig[i.All_ControlPanel]={icon:{content:"&#xE713",type:2},prefixesLocString:"ScopeSettings",enabledDataSources:[{dataSource:"Web",suggestionIsEnabled:function(){return!1},requirements:[1,2]},{dataSource:"MRU",suggestionIsEnabled:function(){return!1}},{dataSource:"MST"},{dataSource:"ST"},{dataSource:"QS",requirements:[1,2]}],enabledDataSourcesForZeroInput:[{dataSource:"MRU",suggestionIsEnabled:function(){return!1}},{dataSource:"MST"},],getEmptyZIMessages:null};n.ScopeConfig[i.All]={icon:{content:"&#xE782",type:2,needsAccentColor:!0},prefixesLocString:"ScopeAll",enabledDataSources:[{dataSource:"PP"},{dataSource:"ST"},{dataSource:"FL",conditionalRequirements:function(t){var i;return!n.config.providerConditionAggressive||((i=t===null||t===void 0?void 0:t.queryToFetch)===null||i===void 0?void 0:i.length)>n.config.minQueryLengthForAllScopeProviders}},{dataSource:"LM",conditionalRequirements:function(t){var i;return!n.config.providerConditionAggressive||((i=t===null||t===void 0?void 0:t.queryToFetch)===null||i===void 0?void 0:i.length)>n.config.minQueryLengthForAllScopeProviders}},{dataSource:"IFF",conditionalRequirements:function(t){var i;return!n.config.providerConditionAggressive||((i=t===null||t===void 0?void 0:t.queryToFetch)===null||i===void 0?void 0:i.length)>n.config.minQueryLengthForAllScopeProviders+1}},{dataSource:"LDIC",conditionalRequirements:function(t){var i;return!n.config.providerConditionAggressive||((i=t===null||t===void 0?void 0:t.queryToFetch)===null||i===void 0?void 0:i.length)>n.config.minQueryLengthForAllScopeProviders}},{dataSource:"CG"},{dataSource:"MRU"},{dataSource:"MPP"},{dataSource:"MST"},{dataSource:"MFF",conditionalRequirements:function(t){var i;return!n.config.providerConditionAggressive||((i=t===null||t===void 0?void 0:t.queryToFetch)===null||i===void 0?void 0:i.length)>n.config.minQueryLengthForAllScopeProviders}},{dataSource:"MRS",requirements:[1,2],conditionalRequirements:function(t){var i;return y()&&((i=t===null||t===void 0?void 0:t.queryToFetch)===null||i===void 0?void 0:i.length)>n.config.minQueryLengthForAllScopeProviders+(n.config.providerConditionAggressive?1:0)}},{dataSource:"Web",requirements:[1,2],conditionalRequirements:function(t){var i;return((i=t===null||t===void 0?void 0:t.queryToFetch)===null||i===void 0?void 0:i.length)>n.config.minQueryLengthForAllScopeProviders}},{dataSource:"OSTMA",requirements:[1,2],conditionalRequirements:function(t){var i;return((i=t===null||t===void 0?void 0:t.queryToFetch)===null||i===void 0?void 0:i.length)>n.config.minQueryLengthForAllScopeProviders+(n.config.providerConditionAggressive?1:0)}},{dataSource:"QS",requirements:[1,2],conditionalRequirements:function(t){var i;return((i=t===null||t===void 0?void 0:t.queryToFetch)===null||i===void 0?void 0:i.length)>n.config.minQueryLengthForAllScopeProviders+(n.config.providerConditionAggressive?1:0)}},ii(),r("SSUE",1,!1,function(){return!(typeof n.is3sFileDisabled=="function"&&n.is3sFileDisabled())}),l(!1),v(!1)],enabledDataSourcesForZeroInput:[],webSyntheticEnabled:function(t){return t.queryToFetch&&n.isBingEnabled()},getEmptyZIMessages:null,showUpsellOnSuggestionsList:n.config.accountVerificationInAllScope||n.config.msbAccountVerificationInSearchHome?function(){return a()}:undefined};n.ScopeConfig[i.Apps]={icon:{content:n.config.useCobaltCSS?"&#xECAA":"&#xEB3B",type:2},prefixesLocString:"ScopeApps",enabledDataSources:[{dataSource:"Web",suggestionIsEnabled:function(){return!1},requirements:[1,2]},{dataSource:"MRU",suggestionIsEnabled:function(){return!1}},{dataSource:"MPP"},{dataSource:"PP",suggestionIsEnabled:function(n){return n=="PP"}},{dataSource:"OSTMA",requirements:[1,2]},{dataSource:"IBA"},],enabledDataSourcesForZeroInput:[{dataSource:"MRU",suggestionIsEnabled:function(){return!1}},{dataSource:"TOPP",conditionalRequirements:function(n){return n.isSearchHomeZI}},{dataSource:"MPP"},n.contains(n.config.enabledDataSources,"LRA")?{dataSource:"LRA"}:{dataSource:"PP",suggestionIsEnabled:function(n){return n=="PP"}}],staticGroupOrderForZeroInput:function(n){return n.isSearchHomeZI?[t.TopApps,t.Apps]:undefined},getEmptyZIMessages:function(){return f(i.Apps,"EmptyScopeMessageNew","EmptyScopeSubMessageLong","EmptyScopeSearchLocation_PC")}};n.ScopeConfig[i.Settings]={icon:{content:"&#xE713",type:2},prefixesLocString:"ScopeSettings",enabledDataSources:[{dataSource:"Web",suggestionIsEnabled:function(){return!1},requirements:[1,2]},{dataSource:"MRU",suggestionIsEnabled:function(){return!1}},{dataSource:"MST"},{dataSource:"ST"},{dataSource:"QS",requirements:[1,2]}],enabledDataSourcesForZeroInput:[{dataSource:"MRU",suggestionIsEnabled:function(){return!1}},{dataSource:"MST"},],getEmptyZIMessages:function(){return u(i.Settings,!1)}};n.ScopeConfig[i.Photos]={icon:{content:"&#xEB9F",type:2},prefixesLocString:"ScopePhotos",enabledDataSources:[{dataSource:"MRU",suggestionIsEnabled:function(){return!1}},{dataSource:"MFF",suggestionIsEnabled:function(n){return n=="LI"}},{dataSource:"MPHO",suggestionIsEnabled:function(n){return n=="LI"}},o("LI"),],enabledDataSourcesForZeroInput:[{dataSource:"MRU",suggestionIsEnabled:function(){return!1}},{dataSource:"MFF",suggestionIsEnabled:function(n){return n=="LI"}},],getEmptyZIMessages:function(){return u(i.Photos,!0)}};n.ScopeConfig[i.Videos]={icon:{content:"&#xE714",type:1},prefixesLocString:"ScopeVideos",enabledDataSources:[{dataSource:"MRU",suggestionIsEnabled:function(){return!1}},{dataSource:"MFF",suggestionIsEnabled:function(n){return n=="LV"}},{dataSource:"MVID",suggestionIsEnabled:function(n){return n=="LV"}},o("LV"),],enabledDataSourcesForZeroInput:[{dataSource:"MRU",suggestionIsEnabled:function(){return!1}},{dataSource:"MFF",suggestionIsEnabled:function(n){return n=="LV"}},],getEmptyZIMessages:function(){return u(i.Videos,!0)}};n.ScopeConfig[i.Music]={icon:{content:n.config.useCobaltCSS?"&#xE90B":"&#xE8D6",type:2},prefixesLocString:"ScopeMusic",enabledDataSources:[{dataSource:"MRU",suggestionIsEnabled:function(){return!1}},{dataSource:"MFF",suggestionIsEnabled:function(n){return n=="MU"}},{dataSource:"MMUS",suggestionIsEnabled:function(n){return n=="MU"}},o("MU"),],enabledDataSourcesForZeroInput:[{dataSource:"MRU",suggestionIsEnabled:function(){return!1}},{dataSource:"MFF",suggestionIsEnabled:function(n){return n=="MU"}},],getEmptyZIMessages:function(){return u(i.Music,!1)}};n.ScopeConfig[i.Documents]={icon:{content:n.config.useCobaltCSS?"&#xE8A5":"&#xE7C3",type:2},prefixesLocString:"ScopeDocuments",enabledDataSources:[{dataSource:"MRU",suggestionIsEnabled:function(){return!1}},{dataSource:"MFF",suggestionIsEnabled:function(n){return n=="FL"}},{dataSource:"MDOC",suggestionIsEnabled:function(n){return n=="FL"}},{dataSource:"MPHO",suggestionIsEnabled:function(n){return n=="FL"},conditionalRequirements:function(n){return!n||!n.taskFrame}},{dataSource:"MVID",suggestionIsEnabled:function(n){return n=="FL"},conditionalRequirements:function(n){return!n||!n.taskFrame}},{dataSource:"MPVD",suggestionIsEnabled:function(n){return n=="FL"},conditionalRequirements:function(t){return n.config.mergeQueries&&(!t||!t.taskFrame)}},o("FL"),{dataSource:"PP",suggestionIsEnabled:function(n){return n=="LDOC"}},r("SSUE",1,!0,function(){return!(typeof n.is3sFileDisabled=="function"&&n.is3sFileDisabled())}),r("SSEE",1,!0,function(){return!(typeof n.is3sFileDisabled=="function"&&n.is3sFileDisabled())}),l(!0,!0)],enabledDataSourcesForZeroInput:[{dataSource:"MRU",suggestionIsEnabled:function(){return!1}},{dataSource:"MFF",suggestionIsEnabled:function(n){return n=="FL"}},s("SSUE",t.RecommendedDocs,1,!0,function(){return n.config.enableSsueOnZeroInput&&n.config.cloudDocsOnZiL2&&(n.isMsftAccountConnected||n.config.cloudDocsZiWw)}),s("SREE",t.RecommendedDocs,1,!0,function(){return n.config.cloudDocsOnZiL2&&(n.isMsftAccountConnected||n.config.cloudDocsZiWw)}),],showUpsellOnSuggestionsList:function(){return a()},getEmptyZIMessages:function(){return f(i.Documents,"EmptyScopeMessageNew","EmptyScopeSubMessageLong",p(!1))}};n.ScopeConfig[i.Folders]={icon:{content:"&#xE8B7",type:2},prefixesLocString:"ScopeFolders",enabledDataSources:[{dataSource:"MRU",suggestionIsEnabled:function(){return!1}},{dataSource:"MFF",suggestionIsEnabled:function(n){return n=="FD"}},{dataSource:"MFOL",suggestionIsEnabled:function(n){return n=="FD"}},{dataSource:"LDIC"},o("FD"),],enabledDataSourcesForZeroInput:[{dataSource:"MRU",suggestionIsEnabled:function(){return!1}},{dataSource:"MFF",suggestionIsEnabled:function(n){return n=="FD"}},],getEmptyZIMessages:function(){return u(i.Folders,!1)}};n.ScopeConfig[i.Web]={icon:n.config.useCobaltCSS?{content:"&#xF6FA",type:2}:{content:"&#xE774",type:1},prefixesLocString:"ScopeWeb",enabledDataSources:[{dataSource:"MRU",suggestionIsEnabled:function(n,t){return t==1}},{dataSource:"Web",suggestionIsEnabled:function(t,i){return n.contains([0,13,14,10,5,1],i)},requirements:[1,2]},{dataSource:"PP",suggestionIsEnabled:function(n,t){return t==1}},{dataSource:"MSNN",suggestionIsEnabled:function(n,t){return t==1},requirements:[1,2],conditionalRequirements:function(n){return(n===null||n===void 0?void 0:n.fromSearchHome)&&(n===null||n===void 0?void 0:n.queryToFetch)=="Good news - MSN"}},{dataSource:"ANA",suggestionIsEnabled:function(n,t){return t==1&&(n=="ANAH"||n=="ANATH")},requirements:[1,2],conditionalRequirements:function(){return n.config.topHitMuse}},l(!0),v(!0)],enabledDataSourcesForZeroInput:[{dataSource:"MRU",suggestionIsEnabled:function(n,t){return t==1}},{dataSource:"Web",requirements:[1,2],conditionalRequirements:function(){return y()}},],webSyntheticEnabled:function(t){return t.queryToFetch&&n.isBingEnabled()},getEmptyZIMessages:function(){return f(i.Web,"EmptyWebMessage","EmptyWebSubMessage")}};n.ScopeConfig[i.PathCompletion]={icon:{content:"&#xE782",type:2,needsAccentColor:!0},scopeNameLocString:n.config.pathCompletionReplacesAll?"PathCompletionScopeName":null,prefixesLocString:null,enabledDataSources:[{dataSource:"PT"},{dataSource:"CG"},],enabledDataSourcesForZeroInput:[],getEmptyZIMessages:null};n.ScopeConfig[i.Emails]={icon:{content:"&#xE715",type:2},prefixesLocString:"ScopeEmails",enabledDataSources:[r("SSEE",1,!0),r("SSEC",2,!0),],enabledDataSourcesForZeroInput:[],showUpsellOnSuggestionsList:function(){return a()},getEmptyZIMessages:function(){return u(i.Emails,!1)}};n.ScopeConfig[i.People]={icon:{content:"&#xE716",type:2},prefixesLocString:"ScopePeople",enabledDataSources:[r("SSUE",1,!0,function(){return!(typeof n.isTenantMsbEnabled=="function"&&n.isTenantMsbEnabled())}),r("SSUC",2,!0),l(!0),v(!0)],enabledDataSourcesForZeroInput:[r("SSUE",1,!0,function(){return!(typeof n.isTenantMsbEnabled=="function"&&n.isTenantMsbEnabled())}),r("SSUC",2,!0),],showUpsellOnSuggestionsList:function(){return a()},getEmptyZIMessages:function(){return u(i.People,!1)}};n.ScopeConfig[i.Work]={icon:{content:"&#xE821",type:2},prefixesLocString:"ScopeWork",enabledDataSources:[],enabledDataSourcesForZeroInput:[],getEmptyZIMessages:function(){return f(i.Work,"EmptyWorkMessage","EmptyWorkSubMessage")}};n.ScopeConfig[i.EdgeUrls]={icon:{content:"&#xE81F",type:2},prefixesLocString:null,prefixes:["Edge","url","lucky"],enabledDataSources:[{dataSource:"ANA",suggestionIsEnabled:function(n,t){return t==1&&(n=="ANAH"||n=="ANATH")},requirements:[1,2],conditionalRequirements:function(){return n.config.topHitMuse}}],enabledDataSourcesForZeroInput:[{dataSource:"ANA",suggestionIsEnabled:function(n,t){return t==1&&(n=="ANAH"||n=="ANATH")},requirements:[1,2],conditionalRequirements:function(){return n.config.topHitMuse}}],getEmptyZIMessages:function(){return u(i.EdgeUrls,!0)}};for(var e in n.ScopeConfig)n.ScopeConfig[e].enabledDataSources=n.ScopeConfig[e].enabledDataSources.filter(function(t){return n.contains(n.config.enabledDataSources,t.dataSource)}),n.ScopeConfig[e].enabledDataSourcesForZeroInput=n.ScopeConfig[e].enabledDataSourcesForZeroInput.filter(function(t){return n.contains(n.config.enabledDataSources,t.dataSource)})}function oi(){h=null}function p(t){var u=n.Host.getConnectedAccountInfo(0),f=n.Host.getConnectedAccountInfo(1),i=!!(u||f),r=t&&n.isBingEnabled();return i&&r?"EmptyScopeSearchLocation_PCCloudAndWeb":i?"EmptyScopeSearchLocation_PCAndCloud":r?"EmptyScopeSearchLocation_PCAndWeb":"EmptyScopeSearchLocation_PC"}function u(n,t){return f(n,"EmptyScopeMessageNew","EmptyScopeSubMessageShort",p(t))}function f(t,i,r,u){var f=et(n.ScopeConfig[t]).toLocaleLowerCase(),e=u?n.Host.getLocString(u):"",o=n.Host.getLocString(i,f,e),s=n.Host.getLocString(r,f,e);return[o,s]}function si(){var u=function(n){return HitHighlightingParser.removeDiacritics(n.toLocaleLowerCase().trim())},t,r;if(h={},n.RuntimeConfig.ScopesAvailable){t=function(t){var f=parseInt(t),r=n.ScopeConfig[f],e,o;f!=i.All&&w(f,r)&&(!r.prefixes&&r.prefixesLocString&&(e=n.Host.getLocString(r.prefixesLocString),o=n.Host.getEnUsLocString(r.prefixesLocString),r.prefixes=ot(e,o)),r.prefixes&&r.prefixes.forEach(function(n){return h[u(n)]=f}))};for(r in n.ScopeConfig)t(r)}}function et(t){if(t.scopeNameLocString)return n.Host.getLocString(t.scopeNameLocString);if(t.prefixes)return t.prefixes[0].trim();if(t.prefixesLocString){var i=ot(n.Host.getLocString(t.prefixesLocString));return i[0].trim()}return""}function ot(n,t){var i=n;return t&&(i+=","+t),i.search(g)>-1&&(i=i.replace(g,",")),i.split(",")}function w(t,r){var u,o,f,e,s;if(!n.contains(n.config.enabledScopes,i[t])||t==i.Web&&!n.isBingEnabled())return!1;if(t===i.Work)return typeof n.isMsbWorkScopeApplicable=="function"&&n.isMsbWorkScopeApplicable();if(r.showUpsellOnSuggestionsList&&r.showUpsellOnSuggestionsList())return!0;for(u=n.config.enabledDataSources.filter(function(n){return n!="MRU"}),n.isBingEnabled()&&t!=i.Web&&(u=u.filter(function(n){return n!="Web"})),o=function(n){ct(n,null)||(u=u.filter(function(t){return t!=n.dataSource}))},f=0,e=r.enabledDataSources;f<e.length;f++)s=e[f],o(s);return r.enabledDataSources.some(function(t){return n.contains(u,t.dataSource)})?!0:!1}function st(t){switch(n.RuntimeConfig.QfMode){case 5:return n.ScopeConfig[i.All_FileExplorer];case 7:return n.ScopeConfig[i.All_SettingsApp];case 9:return n.ScopeConfig[i.All_ControlPanel];default:return n.ScopeConfig[k(t)]}}function hi(t,r,u,f,e){var h,c,p,l,a,v,s,y;e||(e={});var w=e.topHitRestriction,b=e.forceGroupOnTop,d=e.fromSearchHome,g=e.fromSuggestionType,nt=e.inorganic,tt=e.serpURLParams,o=n.baseParseQuery(t,r,w);if(o.fullPartialQuery=o.queryToFetch,o.scope=i.All,o.forceGroupOnTop=b,o.fromSuggestionType=g,o.fromSearchHome=d,o.inorganic=nt,o.serpURLParams=tt,ai(o,f))o.taskFrame=f,o.isFormulatedQuery=!0,h=n.ScopeConfig[k(o)];else{for(o.fullPartialQuery&&(ci(o),u&&o.scope!=u.scope&&(o.isFormulatedQuery=!0)),o.isSearchHomeZI=!o.queryToFetch&&(n.RuntimeConfig.SearchHomeAvailable==1||n.RuntimeConfig.SearchHomeAvailable==2&&o.scope!=i.All),(o.scope==i.All||o.scope==i.Web)&&(c=n.tryParseUrl(o.queryToFetch,!0),c&&c.type==0?(o.isProtocol=!0,o.fixedUrl=n.cleanAndFixUrlProtocol(c)):ht.test(o.queryToFetch)&&(o.isProtocol=!0,o.fixedUrl=n.cleanAndFixUrlProtocol(o.queryToFetch))),h=st(o),p=o.queryToFetch?h.enabledDataSources:h.enabledDataSourcesForZeroInput,o.availableDataSources={},l=0,a=p;l<a.length;l++)s=a[l],n.contains(n.config.enabledDataSources,s.dataSource)&&(o.availableDataSources[s.dataSource]=s);o.enabledDataSources={};for(v in o.availableDataSources)s=o.availableDataSources[v],s.suggestionGroupToggler&&s.suggestionGroupToggler.isHidden()||(o.enabledDataSources[v]=s);y=o.queryToFetch?h.staticGroupOrder:h.staticGroupOrderForZeroInput;y&&(o.staticGroupOrder=y(o))}return li(o,h),o.showProgressBar=n.isL2(o)&&n.config.dataSourcesWithProgressBar.some(function(n){return!!o.enabledDataSources[n]}),o.equals=function(n){return(o.queryToFetch?o.queryToFetch.toLowerCase():o.queryToFetch)==(n.queryToFetch?n.queryToFetch.toLowerCase():n.queryToFetch)&&n.scope==o.scope&&(n.taskFrame?n.taskFrame.raw:"")==(o.taskFrame?o.taskFrame.raw:"")&&n.topHitRestriction==o.topHitRestriction},o.getCacheKey=function(){return o.cursorPosition+o.queryToFetch.toLocaleLowerCase()+o.scope+n.regionCache},o}function ci(t){var f,s,e,r,o;if(n.RuntimeConfig.ScopesAvailable){if(f=n.isDataSourceEnabled("PT",null),s=f&&b.test(t.fullPartialQuery),s){t.canBePathCompletion=!0;t.scope=i.PathCompletion;return}if(e=HitHighlightingParser.removeDiacritics(t.originalQuery),r=e.match(/^(([^:：]+)[:：]\s*)(.*)/)||n.config.forwardSlashScopes&&e.match(/(\/(\w+)\s*)(.*)/),r){var c=r[1],u=r[2],l=r[3];(u=u.toLocaleLowerCase(),o=u.trim(),n.contains(Object.keys(h),o))&&(t.queryToFetch=l,t.cursorPosition=Math.max(0,t.originalCursorPosition-c.length),n.mantainCursorPositionIn(t.queryToFetch,t.cursorPosition,n.cleanQuery,function(n,i){t.queryToFetch=n;t.cursorPosition=i}),t.scope=h[o],t.scopePrefix=u,t.isMultiWord=n.isMultiWord(t.queryToFetch),t.canBePathCompletion=f&&b.test(t.queryToFetch))}}}function ct(t,i){for(var f,r=0,u=t.requirements||[];r<u.length;r++){f=u[r];switch(f){case 1:if(n.config.disableOfflineRequest&&!n.isBrowserOnline())return!1;break;case 2:if(!n.isBingEnabled())return!1}}return t.conditionalRequirements&&!t.conditionalRequirements(i)?!1:!0}function li(t,r){var h=n.RuntimeConfig.QfMode==5&&t.fullPartialQuery.search(":")>=0,s,u,f,e,o;if(h){t.enabledDataSources={};return}for(n.disableWebDataSourceIfNeeded(t,n.Host.getRegion(),n.Host.getLanguage()),s=t.queryToFetch?r.enabledDataSources:r.enabledDataSourcesForZeroInput,u=0,f=s;u<f.length;u++)e=f[u],ct(e,t)||n.disableDataSources(t,e.dataSource);t.queryToFetch||(o=SearchAppWrapper.CortanaApp.queryFormulationView.searchHistory,o&&o.isDeviceHistoryEnabled||n.disableDataSources(t,"PP","LRA","FL","LM","IFF"));n.TweakSearch&&n.TweakSearch.disableDataSourcesBasedOnTweakSearch(t);n.config.searchServiceDisabled&&n.disableDataSources(t,"IFF","IBA");ut(t)&&(n.config.cloudDocsOnTheLeft&&t.scope==i.All?n.disableDataSources(t,"MRU","MPP","MST","MFF"):n.config.msbQwsDynamicDisableEnabled&&n.isMsbEnterprise()&&typeof n.enableQwsRecDocs=="function"&&n.enableQwsRecDocs()||n.disableDataSources(t,"QSCH"))}function ai(t,i){var r,s,e,u,o,f;if(i&&(r=i.scope,s=n.ScopeConfig[i.scope],w(r,n.ScopeConfig[r])&&(e=n.ScopeConfig[r].enabledDataSources.filter(function(n){return wi(n.dataSource,i)}),e.length>0))){for(u=0,o=e;u<o.length;u++)f=o[u],n.contains(n.config.enabledDataSources,f.dataSource)&&(t.enabledDataSources[f.dataSource]=f);return s}return null}function vi(t){var r=n.safeExecute(function(){return JSON.parse(t)},"parseTaskFrame"),u;return r&&(u=yi(r),u!=i.All)?{raw:t,parsed:r,scope:u}:null}function yi(n){switch(n.Uri){case lt:var r=n,t=r.FileType;if(t&&t.Value){if(t.Value=="Picture")return i.Photos;if(t.Value=="Video")return i.Videos}return i.Documents;case at:return i.Emails}return i.All}function k(n){return n?n.taskFrame?n.taskFrame.scope:n.scope:undefined}function pi(n){var e,t,o,s,h,u,c,r,f,l;if(n.taskFrame&&(e=n.taskFrame.parsed,e))if(n.taskFrame.scope==i.Emails){if(t=e,o=t.Subject,o&&o.Value)return o.Value;if(r=t.Body,r&&r.Value)return r.Value;if(s=t.From&&t.From.length>0?t.From[0]:null,s&&s.Value)return s.Value;if(h=t.To&&t.To.length>0?t.To[0]:null,h&&h.Value)return h.Value}else{if(u=e,c=u.Title,c&&c.Value)return c.Value;if(r=u.Body,r&&r.Value)return r.Value;if(f=u.People,f&&f[0]&&f[0].Value)return f[0].Value;if(l=u.Place,l&&l.Value)return l.Value}return n.queryToFetch}function wi(n,t){if(t.scope==i.Emails)return n=="SSEC"||n=="SSEE";var u=t.parsed,r=u.FileSource?u.FileSource.Value:null;switch(n){case"MPVD":case"MDOC":case"MPHO":case"MVID":return r!="onedrive"&&r!="sharepoint";case"SSEE":return r!="thispc"&&r!="onedrive";default:return!1}}function bi(n){e=n}function c(t){var i=""+t,r=function(){var n=e.getItem(d)||"";return n.split(",")},u=function(n){var t=n.join(",");e.setItem(d,t)};return{isHidden:n.config.enableSearchHomeCustomization?function(){return n.safeExecute(function(){return r().some(function(n){return n==i})},"GroupToggler.isHidden")}:function(){return!1},toggle:function(t){n.safeExecute(function(){var n=r(),f;t&&n.every(function(n){return n!=i})?(n.push(i),u(n)):t||(f=n.findIndex(function(n){return n==i}),f>-1&&(n.splice(f,1),u(n)))},"GroupToggler.toggle")}}}var i,t,h,ht,b,lt,at,e,d;(function(n){n[n.All=0]="All";n[n.Apps=1]="Apps";n[n.Settings=2]="Settings";n[n.Photos=3]="Photos";n[n.Videos=4]="Videos";n[n.Music=5]="Music";n[n.Documents=6]="Documents";n[n.Folders=7]="Folders";n[n.Web=8]="Web";n[n.PathCompletion=9]="PathCompletion";n[n.Emails=10]="Emails";n[n.People=11]="People";n[n.Work=12]="Work";n[n.All_FileExplorer=1e3]="All_FileExplorer";n[n.All_Lockscreen=1001]="All_Lockscreen";n[n.All_SettingsApp=1002]="All_SettingsApp";n[n.All_ControlPanel=1003]="All_ControlPanel";n[n.EdgeUrls=1004]="EdgeUrls"})(i=n.Scope||(n.Scope={})),function(n){n[n.Apps=0]="Apps";n[n.Settings=1]="Settings";n[n.Cortana=2]="Cortana";n[n.Command=3]="Command";n[n.Photos=4]="Photos";n[n.Videos=5]="Videos";n[n.Music=6]="Music";n[n.Documents=7]="Documents";n[n.Folders=8]="Folders";n[n.Emails=9]="Emails";n[n.Store=10]="Store";n[n.SearchSuggestions=11]="SearchSuggestions";n[n.PathCompletion=12]="PathCompletion";n[n._PowerBi=13]="_PowerBi";n[n.JumpListTasks=14]="JumpListTasks";n[n.JumpListPinned=15]="JumpListPinned";n[n.JumpListRecent=16]="JumpListRecent";n[n.JumpListFrequent=17]="JumpListFrequent";n[n.JumpListCustom=18]="JumpListCustom";n[n._JumpListActivityFeed=19]="_JumpListActivityFeed";n[n.People=20]="People";n[n._EdgeHistory=21]="_EdgeHistory";n[n.LocalPlaces=22]="LocalPlaces";n[n.Bookmarks=25]="Bookmarks";n[n.Related=26]="Related";n[n.Websites=27]="Websites";n[n.Contact=28]="Contact";n[n.JumpListSynthetic=29]="JumpListSynthetic";n[n.JumpListActions=30]="JumpListActions";n[n._StartMenu=31]="_StartMenu";n[n.LocalSearchHistory=32]="LocalSearchHistory";n[n.JumpListSettingsFaq=33]="JumpListSettingsFaq";n[n.JumpListSettingsRelatedSettings=34]="JumpListSettingsRelatedSettings";n[n.ActivityFeedSuggestions=35]="ActivityFeedSuggestions";n[n.TopApps=36]="TopApps";n[n.QuickSearch=37]="QuickSearch";n[n._LockscreenQuickSearch=38]="_LockscreenQuickSearch";n[n.WelcomeExperience=39]="WelcomeExperience";n[n.Upsell=40]="Upsell";n[n.MSNNews=42]="MSNNews";n[n.MRUHistory=43]="MRUHistory";n[n.PromoBanner=44]="PromoBanner";n[n.VisualSearch=45]="VisualSearch";n[n._BingDailyImage=46]="_BingDailyImage";n[n._MeetingPrep=48]="_MeetingPrep";n[n.AnaheimDataList=49]="AnaheimDataList";n[n.RecommendedDocs=50]="RecommendedDocs";n[n.QuickWorkSearch=51]="QuickWorkSearch";n[n.QuickWorkSearchTopList=52]="QuickWorkSearchTopList";n[n.CuratedSuggestions=53]="CuratedSuggestions";n[n.RelatedMsbDocuments=54]="RelatedMsbDocuments";n[n.AnaheimDataTile=55]="AnaheimDataTile";n[n.AnaheimDataTopHit=56]="AnaheimDataTopHit";n[n.DSBGroup=57]="DSBGroup";n[n.CuratedSettings=58]="CuratedSettings";n[n.ThreeFingerTap=59]="ThreeFingerTap";n[n.GroupHeader=104]="GroupHeader"}(t=n.GroupType||(n.GroupType={}));var g=/،/g,vt=["PP","QP","IBA","TOPL"],yt=["ST","QS","SSTS"],nt=["LI","LV","MU"],pt=["FL","LDOC","FD","MFIL"].concat(nt),wt=[i.Documents,i.Folders,i.Photos,i.Videos,i.Music];n.isApp=bt;n.isSetting=kt;n.isMedia=dt;n.isFileOrFolder=gt;n.isFileOrFolderScope=ni;n.substrateProvidersEnabled=tt;n.searchHistoryAllowed=y;n.isRecommendedDocsGroupEnabled=ut;n.nicerCloudFilesEnabled=fi;n.setZeroInputDataSourcesForL1=ei;n.populateScopeConfig=ft;ft();n.cleanScopePrefixes=oi;n.initScopePrefixes=si;n.getScopeDisplayName=et;n.isScopeEnabled=w;n.getScopeConfig=st;ht=/^ht+ps?[;:]+|^www[.。]|^\/+/;b=/^[a-z]:\\|^%[^%]+%\\|^\\/i;n.parseQuery=hi;n.parseTaskFrame=vi;lt="action://FindMyStuff/FindDocument";at="action://FindMyStuff/FindMessage";n.getEffectiveScope=k;n.getEffectiveQuery=pi;d="HiddenSuggestionGroups";n.initQueryParser=bi}(WSB||(WSB={}));__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},function(n){function tr(n,t){return n.type==t.type&&n.source==t.source}function ir(t){if(n.config.useCobaltCSS)switch(t){case"WNSGPH":return"WSBEDG";case"WMSRPM":return"WMSMAN";case"WMSRPA":return"WMSAUT";case"WSBREW":return"WSREWF";case"WSBBST":return"WSBSTK";case"SBIWSB":return"WSVISS";case"BFBWSL":return"MSBWSL";case"BFBWPP":return"MSBWPP";case"BFBWMS":return"MSBWMS";case"MDSB10":return"MDSB11";case"WSBWS0":return"WSBWS1";case"WSHBSH":return"WSHBSH";default:return t}return t}function ur(n){switch(n){case"PP":return"Apps";case"ST":return"Settings";case"FL":return"Files";case"LM":return"Media";default:return null}}function fr(n){switch(n){case"FL":case"LM":case"IFF":case"MFF":case"PT":case"CG":case"MPVD":case"MDOC":case"MFOL":case"MPHO":case"MVID":case"MMUS":case"FEH":case"LDIC":return!0;case"OSTMA":case"QS":case"PP":case"LRA":case"ST":case"MPP":case"MST":case"IBA":case"THST":case"TOPP":case"QSCH":case"DFLS":case"CUSE":case"WWE":case"MSNN":return!1}throw new Error("New local data source "+n+" needs to be explicity classified as potentially containing PII or not");}function st(n){var t=w(n);return n.deviceItem&&n.handoffType==2?t+"\t"+n.deviceItem.id:t+"\t"+n.query}function hr(n,t){return n.msbDomain!=null&&n.msbDomain===t.msbDomain&&n.msbId!=null&&n.msbId===t.msbId}function cr(t,i){return t.isSearchHomeZI&&g()&&nr(t)&&i.staticGroupType===n.GroupType.RecommendedDocs&&typeof n.enableQwsRecDocs=="function"&&n.enableQwsRecDocs()&&et()}function ht(t,i){return t.targetPathLC&&n.isApp(t.type)&&n.isApp(i.type)&&t.targetPathLC.includes("\\installer\\")&&t.targetPathLC.endsWith(".ico")&&t.text==i.text}function ct(n,t){return n.handoffType==5&&n.actionUri=="ms-cortana://navigate/Settings"&&t.deviceItem&&t.deviceItem.id=="CortanaSettings"}function lt(n){var t=f(n);return t?t.packageFamilyName:null}function at(t,i){var u,f;return i?(u=r(n.FOLDERID_SkyDrive),u?u+="\\":u="\\onedrive\\",f=t.indexOf(u),f>=0&&(t=t.substr(f+u.length))):t.startsWith("onedrive:\\")&&(t=t.substr(10)),t}function vt(t,i,u){var e,o,h,f,s;return i?(e=r(n.FOLDERID_Profile)+"\\onedrive - ",o=t.indexOf(e),o>=0&&(h=t.indexOf("\\",o+e.length),t=t.substr(h+1))):(f=n.AccessTokenManager.getWindowsIdentity(),f&&t.startsWith("onedrive for business:\\")&&u&&(s=f.indexOf("@"),s!=-1&&u.toLocaleLowerCase().indexOf("personal/"+f.substr(0,s))>0&&(t=t.substr(23)))),t}function yt(t,i,u){var e,o="",s,h,f,c;return u?(s=r(n.FOLDERID_Profile)+"\\"+n.SubstrateTenantName.toLocaleLowerCase()+"\\",h=i.indexOf(s),h>=0&&(f=h+s.length,c=i.indexOf(" - ",f),o=i.substr(f,c-f).toLocaleLowerCase(),i=i.substr(c+3))):i.startsWith("sharepoint:\\")&&(i=i.substr(12),o=(e=t.siteTitle)===null||e===void 0?void 0:e.toLocaleLowerCase()),[i,o]}function lr(i,r,u){var s,h,e,o,g,nt,tt,it,k,c,l,w,b;if((r.type=="TOPL"||r.type=="DFLS")&&i.isSearchHomeZI||cr(i,r))return t.NotDuplicate;if(hr(r,u)||n.contains([5,4],r.handoffType)&&n.contains([5,4],u.handoffType)&&r.actionUri==u.actionUri&&r.query.toLocaleLowerCase()==u.query.toLocaleLowerCase()||r.handoffType==10&&u.handoffType==10&&r.type==u.type&&!r.htmlContent&&!u.htmlContent&&r.query.toLocaleLowerCase()==u.query.toLocaleLowerCase()||r.type!="PWL"&&r.handoffType==1&&u.handoffType==1&&n.isDuplicateUrl(i,r.url,u.url)||(s=f(r),h=f(u),e=s?s.filePath:r.path,e&&(e=e.toLocaleLowerCase()),o=h?h.filePath:u.path,o&&(o=o.toLocaleLowerCase()),g=lt(r),nt=lt(u),g&&nt&&g.toLocaleLowerCase()==nt.toLocaleLowerCase()))return t.NoMetadata;if(tt=p(r),it=p(u),tt&&h||it&&s){var rt=e||o,a=tt||it,ut=a.encodedPath;return rt&&ut&&rt==ut.toLocaleLowerCase()?(k=s||h,!a.launchArguments||(k.launchArguments||"").toLocaleLowerCase()==a.launchArguments.toLocaleLowerCase()||!k.launchArguments&&a.launchArguments&&k.displayName.toLocaleLowerCase().startsWith(a.displayName.toLocaleLowerCase())?t.NoMetadata:t.NotDuplicate):t.NotDuplicate}if(r.deviceItem&&u.deviceItem){if(c=r.deviceItem.id||"",l=u.deviceItem.id||"",n.isSetting(r.type)&&n.isSetting(u.type)&&(c=r.deviceItem.displayName,l=u.deviceItem.displayName),c.toLocaleLowerCase()==l.toLocaleLowerCase())return e&&!s&&o&&!h?t.MergeMetadata:t.NoMetadata;if(s){if(n.isSetting(u.type)&&v[c]==l)return t.NoMetadata}else if(n.isSetting(r.type)&&(h&&v[l]==c||n.isSetting(u.type)&&(y[c]==l||y[l]==c)))return t.NoMetadata}if(ht(r,u)||ht(u,r))return t.NoMetadata;if(e&&o){if(e==o)return t.MergeMetadata;if(!s&&!h)if(r.handoffType==u.handoffType){if(r.handoffType==8&&r.url==u.url)return t.MergeMetadata}else{if(e=at(e,r.handoffType!=7),o=at(o,u.handoffType!=7),e==o)return t.MergeMetadata;var ft=r.type==="MFIL"||u.type==="MFIL",et=r.handoffType!=8&&r.handoffType!=17,ot=u.handoffType!=8&&u.handoffType!=17;if(e=vt(e,et,r.url),o=vt(o,ot,u.url),e==o)return ft?t.NoMetadata:t.MergeMetadata;if(n.SubstrateTenantName){var st=yt(r,e,et),pt=st[0],kt=st[1],wt=yt(u,o,ot),bt=wt[0],dt=wt[1];if(kt==dt&&(bt.endsWith(pt)||pt.endsWith(bt)))return ft?t.NoMetadata:t.MergeMetadata}}if(w=r.targetPathLC,b=u.targetPathLC,s&&u.type=="IBA"&&(e=d(e)),h&&r.type=="IBA"&&(o=d(o)),(w&&b&&w==b||w&&w==o||b&&e==b||e==o)&&(!s||!h||(s.launchArguments||"").toLocaleLowerCase()==(h.launchArguments||"").toLocaleLowerCase()))return t.NoMetadata}return ct(r,u)||ct(u,r)?t.NoMetadata:r.type==="PPL"&&u.type==="PPL"&&r.uniqueName&&u.uniqueName&&r.uniqueName.toLocaleLowerCase()===u.uniqueName.toLocaleLowerCase()?t.NoMetadata:r.type==="OLE"&&u.type==="OLE"&&r.internetMessageId===u.internetMessageId?t.NoMetadata:r.type==="BKS"&&u.type==="BKS"&&r.url&&u.url&&r.url===u.url?t.NoMetadata:t.NotDuplicate}function ar(n){switch(n){case"MFF":case"FL":case"LM":case"IFF":case"MPVD":case"MDOC":case"MPHO":case"MVID":case"MMUS":case"MFOL":return!0;default:return!1}}function vr(t,i){if(!n.IndexerQueryGenerator)return!1;if(n.RuntimeConfig.QfMode==5)return!0;switch(t){case"IBA":case"MPVD":case"MDOC":case"MPHO":case"MVID":case"MMUS":case"MFOL":return!0;case"IFF":return gt(i)||!n.config.minLengthForIBAonL1||i.queryToFetch.length>=n.config.minLengthForIBAonL1;default:return!1}}function yr(t,i,r,u){var o,f,e;if(r!="Exchange"){var s,h=decodeURI(t.url),c=i.toLocaleLowerCase(),l=h.toLocaleLowerCase().indexOf(c);l!=-1?(o=h.substr(0,l-1),c.endsWith(".one")&&(o=o.substr(0,o.lastIndexOf("/"))),s=encodeURI(o)):s=t.url;f=h.split("/").slice(3);r==null?e="":r=="OneDriveBusiness"?(e="OneDrive for Business:\\",f.length>2&&f[0].toLocaleLowerCase()=="personal"&&f[2].toLocaleLowerCase()=="documents"&&(f=f.slice(3))):e="SharePoint:\\";c.endsWith(".one")&&f.splice(f.length-2,1);t.path=e+f.join("\\");u&&(r=="OneDriveBusiness"?e=n.Host.getLocString("OneDriveTitle",t.siteTitle):(e=t.siteTitle,f.length>1&&f[0].toLocaleLowerCase()=="teams"&&(f=f.slice(2))),t.prettyPrintedPath=e+" > "+f.join(" > "));s&&(t.locationUrl=s)}}function pr(n){return n.kind=="Modern Setting"}function f(t){return n.isApp(t.type)?t.deviceItem:null}function wr(n){return!!n.suggestions}function br(t){return n.config.useCobaltCSS&&(a(t)||u(t))}function kr(n){return n.deviceItem}function p(n){return n.type=="CG"?n.deviceItem:null}function dr(t){return n.isApp(t.type)||n.isSetting(t.type)||n.isFileOrFolder(t.type)&&!fi(t.type)}function w(t){if(typeof t.staticGroupType=="number")return t.staticGroupType;switch(t.type){case"TOPL":return n.GroupType.TopApps}if(n.isApp(t.type))return n.GroupType.Apps;if(b(t))return t.groupType;if(n.isSetting(t.type))return n.GroupType.Settings;switch(t.type){case"CG":return n.GroupType.Command;case"PT":return n.GroupType.PathCompletion;case"LI":return n.GroupType.Photos;case"LV":return n.GroupType.Videos;case"MU":return n.GroupType.Music;case"JL":case"FL":case"LDOC":case"SDFE":case"MFIL":return n.GroupType.Documents;case"FD":return n.GroupType.Folders;case"OLE":case"OWA":return n.GroupType.Emails;case"PPL":case"MPPL":case"MGRP":return n.GroupType.People;case"BKS":case"MBKS":case"MQNA":case"MBLD":return n.GroupType.Bookmarks;case"ELA":return n.GroupType.LocalPlaces;case"NEWS":return n.GroupType.MSNNews;case"ANAF":case"ANAH":case"ANAT":case"ANAR":return n.GroupType.SearchSuggestions;case"ANATH":return n.GroupType.AnaheimDataTopHit;case"FEH":return n.GroupType.LocalSearchHistory;case"SNSC":case"SNSP":case"SNST":return n.GroupType.VisualSearch;case"RSSG":case"QSSG":return n.GroupType.QuickSearch;default:switch(t.handoffType){case 3:return n.GroupType.Store;case 5:case 4:return n.GroupType.Cortana;case 10:return t.htmlContent?n.GroupType.SearchSuggestions:n.GroupType.Cortana;case 0:case 13:case 14:case 21:return n.GroupType.SearchSuggestions;case 1:return n.GroupType.Websites}throw new Error("Unexpected handoff type: "+t.handoffType);}}function gr(n){return!n.isAnswer&&(n.handoffType==0||n.handoffType==11||n.handoffType==21)&&n.type!="QSSG"}function pt(t){switch(t){case n.GroupType.JumpListTasks:case n.GroupType.JumpListPinned:case n.GroupType.JumpListRecent:case n.GroupType.JumpListFrequent:case n.GroupType.JumpListCustom:return!0;default:return!1}}function nu(t){var i=t.type;return pt(i)||i==n.GroupType.Related||i==n.GroupType.Contact||i==n.GroupType.RelatedMsbDocuments}function b(n){return!!n.isChild||!!n.parent}function tu(n){return n.type=="JL"}function wt(t){switch(t){case n.GroupType.Apps:case n.GroupType.Store:return n.Scope.Apps;case n.GroupType.Settings:return n.Scope.Settings;case n.GroupType.Documents:return n.Scope.Documents;case n.GroupType.Folders:return n.Scope.Folders;case n.GroupType.Photos:return n.Scope.Photos;case n.GroupType.Videos:return n.Scope.Videos;case n.GroupType.Music:return n.Scope.Music;case n.GroupType.LocalPlaces:case n.GroupType.SearchSuggestions:case n.GroupType.Websites:case n.GroupType.Bookmarks:return n.Scope.Web;case n.GroupType.Emails:return n.Scope.Emails;case n.GroupType.People:return n.Scope.People;case n.GroupType.AnaheimDataTopHit:if(n.config.topHitMuse)return n.Scope.EdgeUrls}return n.Scope.All}function iu(t){switch(t){case 0:case 7:case 8:return 32;case 1:return 16;case 2:return n.IconSize_GridLayout_Scaled;case 3:return 24;case 4:return 64;case 5:return 200}}function ru(n,t,i){if(n&&n.type==0&&ti(t)){var u=function(t){n.ratio=t.height==t.width?1:t.height>t.width?3:2;i()},r=new Image;r.src=n.content;r.onload=function(){return u({height:r.height,width:r.width})}}else i()}function e(){var t=n.uiLanguageCache.toLocaleLowerCase();return bt[t]||t}function kt(n,t,i,r,u,f,e,o,s,h,c,l,a,v){var y={text:t,getIcon:i,icon:r,type:u,query:f,ciMatchedQuery:null,id:c,click:l,handoffType:o,instItem:e,isAnswer:!1,htmlContent:null,classNames:[],selected:!1,featureStore:undefined,sequenceNumber:s,getMruData:function(){return null},template:0,mayContainPII:h,features:[],previewPaneType:undefined,reactKey:v};return y.previewPaneType=pu(n,y,a),y}function uu(n,t,i,r,u,f,e,o,s){n.subItems==null&&(n.subItems=[]);var c=n.id,h={id:t,sequenceNumber:n.sequenceNumber,selected:!1,text:i,itemView:r,props:u,onSelected:o,click:s,disabled:e,instItem:f,suggestionId:c};return n.subItems.push(h),h}function fu(t,i,r,u,f,e,o,s){var h=n.InstrumentationHelper.getInstrumentedSyntheticSuggestion(i,r),l,c;return h?h:(l=t.scope,h=kt(t,null,null,u,r,null,n.InstrumentedItem.getNonSuggestionInstrumentedItem(r,ot.KValues),f,i,!1,r),h.notAResult=!0,h.primaryMetadata=e,o&&(h.additionalInfoText=" - "+h.primaryMetadata),c=function(n){var t;h.query=n.queryToFetch;h.text=HitHighlightingParser.addMarkers(n.queryToFetch);h.narratorText=dt(h);h.click=function(){return s(h,n)};h.reactKey=r+n.queryToFetch+((t=h.primaryMetadata)!==null&&t!==void 0?t:"")},c(t),h.updateFromQuery=function(n){return!n.isProtocol&&n.scope==l&&n.queryToFetch?(c(n),!0):!1},h.getMruData=function(){return ft(h)},n.InstrumentationHelper.instrumentSyntheticSuggestion(i,h),h)}function dt(n,t){var i,r,u;return n.htmlContent?null:(i=[n.text],r=n.dateShort,r&&i.push(r),t?i.push(t):(n.primaryMetadata&&(i.push(n.primaryMetadata),u=n.department,u&&i.push(u)),n.template==1&&n.secondaryMetadata&&i.push(n.secondaryMetadata)),HitHighlightingParser.removeMarkers(i.join(", ")))}function gt(t){return t.scope!=n.Scope.All||!!t.taskFrame}function ni(t){return typeof t=="string"?t=="LI"||t=="LV":t==n.GroupType.Photos||t==n.GroupType.Videos}function ti(n){return ni(n)||ui(n)}function eu(t){return!n.config.disableMediaGridLayout&&!n.RuntimeConfig.AlwaysWide&&ni(t)}function ou(t,i){var f,u,e,r;if(!t||!n.RuntimeConfig.ScopesAvailable)return null;if(i.scope==n.Scope.All){if(f=[],t.ISUPN&&t.ISUPG)if(u=t.ISUPN.split("\t"),e=t.ISUPG.split("\t"),u.length==e.length)for(r=0;r<u.length;r++)f.push(e[r]+"\t"+u[r]);else SharedLogHelper.LogError("parseWebSuppressionSignals",null,new Error("parsedNames.length != parsedGroups.length"));return{fullySuppressedGroups:t.FSUP?t.FSUP.split("\t"):null,partiallySuppressedGroups:t.PSUP?t.PSUP.split("\t"):null,suppressedSuggestions:f}}return null}function su(t){return o||(o=_d.createElement("span")),n.safeExecute(function(){return o.innerHTML=t,o.innerText},t,"decodeHtml")}function hu(n,t){return{matchType:n,matchedText:t}}function i(n){return n.replace(ii,"\\$&")}function cu(t,r){if(r){var e=n.config.disableSyntaxHighlight?t.toLocaleLowerCase().includes(r.toLocaleLowerCase()):t.includes(HitHighlightingParser.startMarker),s=e?t:HitHighlightingParser.addMarkers(t,r),o=HitHighlightingParser.split(s).find(function(n){return n.highlighted});if(o){var f=e?HitHighlightingParser.removeMarkers(t):t,h=n.config.disableSyntaxHighlight?new RegExp("((?:\\\\[^\\\\]+)?\\\\[^\\\\]+)?\\\\("+i(r)+"|"+i(r.toLocaleLowerCase())+").*","i"):new RegExp("((?:\\\\[^\\\\]+)?\\\\[^\\\\]+)?\\\\"+i(o.text)+".*","i"),u=h.exec(f);if(u&&u[0])return{matchType:k.Location,matchedText:f.startsWith(u[0])?f:String.fromCharCode(8230)+u[0]}}}return null}function lu(t,r){if(r){var f=n.config.disableSyntaxHighlight?t.toLocaleLowerCase().includes(r.toLocaleLowerCase()):t.includes(HitHighlightingParser.startMarker),h=f?t:HitHighlightingParser.addMarkers(t,r),e=HitHighlightingParser.split(h).find(function(n){return n.highlighted});if(e){var o=f?HitHighlightingParser.removeMarkers(t):t,s=void 0,c=n.config.disableSyntaxHighlight?new RegExp("(?:\\S+\\s){0,3}\\b("+i(r)+"|"+i(r.toLocaleLowerCase())+")\\S*(?:\\s\\S+){0,5}","i"):new RegExp("(?:\\S+\\s){0,3}\\b"+i(e.text)+"\\S*(?:\\s\\S+){0,5}","i"),u=c.exec(o);return u&&u[0]&&(s={matchType:k.Content,matchedText:u[0]}),[o,s]}}return[null,null]}function au(t,i){return!t||!i?!1:n.config.disableSyntaxHighlight?HitHighlightingParser.addMarkers(t,i).toLocaleLowerCase().includes(i.toLocaleLowerCase()):HitHighlightingParser.addMarkers(t,i).includes(HitHighlightingParser.startMarker)}function vu(t){return t==n.Scope.Emails}function yu(n){if(b(n))return!1;switch(n.handoffType){case 0:case 13:case 14:case 21:case 5:case 10:case 4:return n.type!="QSSG";case 3:return n.type=="STS";case 2:return n.type=="SDFE";case 8:case 12:return n.type=="OWA";default:return!1}}function pu(t,i,r){var u=undefined,f;if(!n.RuntimeConfig.PreviewPaneAvailable||t.isSearchHomeZI)return u;if(f=function(){if(i.handoffType==1)return n.RuntimeConfig.AlwaysWide?2:u;return n.isBingEnabled()&&n.contains([0,13,14],i.handoffType)&&!i.htmlContent?1:u},r)return f();switch(w(i)){case n.GroupType.Store:return n.RuntimeConfig.AlwaysWide&&i.type!="STS"?2:u;case n.GroupType.Apps:case n.GroupType.Cortana:case n.GroupType.Command:case n.GroupType.Folders:case n.GroupType.Music:case n.GroupType.PathCompletion:case n.GroupType.Emails:case n.GroupType.Photos:case n.GroupType.Settings:case n.GroupType.Videos:return n.RuntimeConfig.AlwaysWide?2:u;case n.GroupType.Documents:return i.handoffType===17?3:n.RuntimeConfig.AlwaysWide?2:u;case n.GroupType.People:return i.handoffType==0?1:i.handoffType==1?u:i.handoffType==17?3:n.RuntimeConfig.AlwaysWide?2:u;case n.GroupType.Bookmarks:return i.handoffType==17?3:f();case n.GroupType.Websites:return n.isBingEnabled()&&i.type!="LURL"?1:u;case n.GroupType.MSNNews:return 4;case n.GroupType.AnaheimDataTopHit:return n.config.topHitMuse?2:f();default:return f()}}function wu(t,i,r){var u=r.previewPaneType;if(!u)return!1;var f=i.previewPaneType,e=u==1&&f==1,o=!0;return n.config.msbVerticalWorkScopeEnabled&&r.handoffType===21&&(o=i.msbVerticalHash===r.msbVerticalHash),i.query.toLocaleLowerCase()==r.query.toLocaleLowerCase()&&(!e&&u==f||e&&i.handoffType==r.handoffType)&&o}function bu(n){return n==null}function ku(t,i){return t==n.GroupType.Documents&&n.isSubstrateO365AccountConnected||n.isFileOrFolderScope(wt(t))&&n.isDataSourceEnabled("ODC",i)}function du(t){switch(t){case 2:return"OneDrive";case 3:return n.Host.getLocString("OneDriveForBusiness");case 4:return"SharePoint";case 1:return n.Host.getLocString("ThisPC");case 5:return n.Host.getLocString("MsbPeopleGroups");case 6:return n.Host.getLocString("MsbPeopleContacts")}return null}function gu(n){if(ei())switch(n){case 37:return 39;case 39:return 37}return n}function nf(){return{content:"&#xE721",type:2}}function tf(t){return n.Host.getLocString(t?typeof n.getIsMsbEduTenantEnabled=="function"&&n.getIsMsbEduTenantEnabled()?"SeeSchoolAndWebResults":"SeeWorkAndWebResults":"SeeWebResults")}function rf(t){return n.isDataSourceEnabled("MSBC",t)||n.isDataSourceEnabled("MSBS",t)}function ui(n){return n=="PPL"||n=="MPPL"||n=="MGRP"}function fi(n){return n=="MFIL"}function uf(){var t=n.config.msbSuggestionTophitRule;switch(t){case 1:return sr;case 2:return or;case 0:default:return er}}function ff(n){return n=="MPPL"||n=="MGRP"||n=="MBKS"||n=="MQNA"||n=="MFIL"||n=="MBLD"||n=="MBV"}function ef(n,t){var i="b_hide";n&&(t?n.classList.remove(i):n.classList.add(i))}function ei(){return ThresholdUtilities.isRightToLeftLanguage(n.uiLanguageCache)}function of(){s={}}function r(t){var i=s[t],r;return typeof i=="undefined"&&(r=SearchAppWrapper.CortanaApp.queryFormulationView.deviceSearch,r.getFolderPathFromKnownFolderIdGuid?(i=n.safeExecute(function(){return r.getFolderPathFromKnownFolderIdGuid(t)},"getPathFromFolderID","",t),i=i.toLocaleLowerCase()):i="",s[t]=i),i}function sf(){h={}}function d(n){var t,i;return n.startsWith("{")?(t=h[n],t||(i=n.match(oi),t=i?r(i[1])+i[2]:n,h[n]=t),t):n}function hf(n){return n.startsWith("file:")&&(n=n.slice(5)),n.replace(/\//g,"\\")}function cf(t){return n.config.enforceOriginalOrderForTypes[t.type]||n.config.enforceOriginalOrderForTypes[t.type+"|"+t.handoffType]}function lf(t){return t==1?"https://substrate.office.com":n.config.useCobaltCSS?"https://substrate.office.com/M365.Access":"https://substrate.office.com/SubstrateSearch-Internal.ReadWrite"}function af(n){return n==1?"/cortana":"service::cortana.bing.com::mbi_ssl"}function vf(t){return n.TweakSearch&&n.TweakSearch.isTweakSearchEnabled()?n.config[t]:undefined}function yf(){return n.config.skipSelectedScope&&n.RuntimeConfig.AlwaysWide}function si(t){return n.RuntimeConfig.PreviewPaneAvailable&&n.RuntimeConfig.QfMode!=0&&l(t)&&n.canShowUpsell&&!(SearchAppWrapper.CortanaApp.height<=550)}function hi(t){return(n.config.supportedQuickAnswersMarkets[t]||n.config.quickAnswerIcon||n.config.quickAnswerWeb)&&n.RuntimeConfig.PreviewPaneAvailable&&n.RuntimeConfig.QfMode!=0&&n.isBingEnabled()&&n.isBrowserOnline()&&SearchAppWrapper.CortanaApp.textScaleFactor<1.25}function ci(t){return n.RuntimeConfig.PreviewPaneAvailable&&n.RuntimeConfig.QfMode===1&&n.config.msnNewsSearch&&n.config.supportedMSNSearchMarkets[t.toLowerCase()]&&n.isBingEnabled()&&n.isBrowserOnline()&&vi()}function pf(t){return n.config.shGAWDx&&t.toLowerCase()==="en-us"&&n.RuntimeConfig.PreviewPaneAvailable&&n.RuntimeConfig.QfMode===1&&n.isBingEnabled()&&n.isBrowserOnline()}function wf(){var t;return n.config.anaheimResetDefaultTop&&!n.config.anaheimResetDefaultDisabledLang[(t=e())===null||t===void 0?void 0:t.substring(0,2)]}function bf(){var i,t;return n.config.enableSnipSearchV2?(i="CN",!n.revIpRegionCache||n.revIpRegionCache==i||n.regionCache==i)?!1:n.isBingEnabled()?(t=n.Host.getQuery(),si(t))?!1:a(t)||u(t)?!1:n.Host.isBitmapInClipboardSupported():!1:!1}function kf(n,t){return li(n,t)&&!c(!0)}function li(t,i){var r=e();return(n.isMiniSerpEnabled()||n.config.quickSearchToMsnMarkets[r])&&di(i)&&(n.config.msbQwsDynamicDisableEnabled||!nt(t))&&ai(t)&&!n.isDataSourceEnabled("CUSE",i)}function g(){return typeof n.shouldForceEnterpriseAccount=="function"&&n.shouldForceEnterpriseAccount()}function nt(t){return typeof n.enableQws=="function"&&n.enableQws()&&g()&&et()&&n.isMiniSerpEnabled()&&(typeof n.getIsMsbClientQfTokenReady=="function"&&n.getIsMsbClientQfTokenReady()||typeof n.getQuickWorkSearchCache=="function"&&n.getQuickWorkSearchCache()!=null)&&ai(t)}function ai(t){var i=e();return!(ci(i)&&pi(t)||(n.cohortProfileManager===null||n.cohortProfileManager===void 0?void 0:n.cohortProfileManager.isWWEVisible())||(n.cohortProfileManager===null||n.cohortProfileManager===void 0?void 0:n.cohortProfileManager.isWWEVisibleSinglePane()))}function c(t){var i=n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType();return t?n.config.enableAnaheimDataSH&&!n.config.useCobaltCSS&&!n.config.enableDynamicSearchBox&&i!=1:n.config.enableAnaheimDataQF&&!n.config.useCobaltCSS}function df(t){return tt(t)&&(n.config.enableAnaheimDataHS&&n.AnaheimDataParser.getANAHCount()!=0||n.config.enableAnaheimDataTSList&&n.AnaheimDataParser.getANATCount()!=0)&&t.getItem("AnaheimDataListDismissed")!="1"}function gf(t){return tt(t)&&n.config.enableAnaheimDataTSTile&&n.AnaheimDataParser.getANATCount()==5&&t.getItem("AnaheimDataTileDismissed")!="1"}function tt(){return c(!0)&&n.config.enableAnaheimDataSHUX&&n.AnaheimDataProvider.getShouldShowAnaheimDataSH()}function ne(){return c(!1)&&n.config.enableAnaheimDataQFUX&&n.config.enableAnaheimDataHS&&n.AnaheimDataProvider.getShouldShowAnaheimDataQF()}function vi(){var t=n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType();return n.config.skipWinVersionCheck||(t==2||t==3)&&[4,27,].indexOf(n.osSKUCache)==-1&&!n.isSubstrateO365AccountConnected}function te(){return hi(n.Host.getLanguage().toLowerCase())||typeof n.enableQws=="function"&&n.enableQws()||n.config.enableAnaheimDataSH||n.config.enableAnaheimDataQF}function pi(t){var i=t.getItem(n.currentTabStorageKey);return i&&i!=yi.News?!1:!0}function ie(){return SearchAppWrapper.CortanaApp.entryPoint=="WNSPTP"&&(n.config.shortcutMessageEnabled||(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.showFlyoutInTests))}function wi(n,t,i){var u,f,r;if(typeof n!="object"||n==null)return n;if(n instanceof Date)return u=new Date,u.setTime(n.getTime()),u;f=Array.isArray(n)?[]:{};for(r in n)(!t||t.indexOf(r)<0)&&(f[r]=i&&i.indexOf(r)>=0?n[r]:wi(n[r],t,i));return f}function it(n,t){var i,u,r;if(n===t||typeof n=="function"&&typeof t=="function")return!0;if(typeof n!="object"||n===null||typeof t!="object"||t===null||(i=Object.keys(n),u=Object.keys(t),i.length!==u.length))return!1;for(r=0;r<i.length;r++)if(!Object.hasOwnProperty.call(t,i[r])||!it(n[i[r]],t[i[r]]))return!1;return!0}function re(t,i,r){return n.config.pureRender?!it(t.props,i)||!it(t.state,r):!0}function ue(){return n.config.mruSearchHome&&!((n.cohortProfileManager===null||n.cohortProfileManager===void 0?void 0:n.cohortProfileManager.isWWEVisible())||n.config.enableSearchHomeCustomization)}function fe(t,i,r,u){return n.Async.safeChainWithGlobalCaching("getIconUrlSuggestion",function(){return ThresholdUtilities.createPromise(function(f){var o=SearchAppWrapper.CortanaApp.createStringMap(),s=SearchAppWrapper.CortanaApp.createStringMap(),e=bi(t,i,r,u);n.Async.safeChain("fetchIconUrl",function(){return SearchAppWrapper.CortanaApp.makeHttpRequestAsync(0,e,o,"",s)},function(t){if(t.statusCode!==200){f(null);return}n.Async.safeChain("readIconResponse",function(){return t.readAsStreamAsync()},f,function(){return f(null)},null,null,1)},function(){return f(null)},null,e,1)})},function(){return t+"_icon"},function(t){return t?n.toIcon(t,"convertResponseToIcon"):{type:0,content:n.getEdgeFallbackIcon()}},null,null,t,1)}function bi(t,i,r,u){i===void 0&&(i=32);r===void 0&&(r=32);u===void 0&&(u=1.5);var f=n.getDomain(t).replace("www.",""),e=n.generateKeyFromDomain(f);return"/th?id=ODF."+e+"&pid=Api&w="+i+"&h="+r+"&dpr="+u}function rt(){var t=!SearchAppWrapper.CortanaApp.isDynamicSearchBoxEnabled||SearchAppWrapper.CortanaApp.isDynamicSearchBoxEnabled();return n.isBingEnabled()&&n.config.enableDynamicSearchBox&&t}function l(t){return t?t.isSearchHomeZI&&t.scope==n.Scope.All:n.RuntimeConfig.SearchHomeAvailable==1}function u(t){return l(t)&&rt()&&ki()&&(n.dsbManager===null||n.dsbManager===void 0?void 0:n.dsbManager.hasContent())}function ki(){return n.config.undocked||(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.showDSBAlways)||SearchAppWrapper.CortanaApp.entryPoint=="WNSDSB"||n.config.showDSBOnGlyphClick&&SearchAppWrapper.CortanaApp.entryPoint=="WNSGLY"||SearchAppWrapper.CortanaApp.entryPoint=="WNSSTB"||SearchAppWrapper.CortanaApp.entryPoint=="WNSPTP"||SearchAppWrapper.CortanaApp.entryPoint=="WNSKBS"||n.config.showDSBOnSearchBoxClick&&SearchAppWrapper.CortanaApp.entryPoint=="WNSBOX"}function ee(){return rt()||n.config.transparentMiniserp}function di(n){return!ut()||a(n)&&!u(n)}function a(n){return l(n)&&!u(n)&&ut()}function ut(){return n.config.enableTwoPanesZI||n.config.msbEnableStaticSH&&nt(new n.LightweightStorage)}function gi(n){return{type:n.type,handoffType:n.handoffType,hc:n.hc,highConfidenceMetaSuggestionScore:n.highConfidenceMetaSuggestionScore,prefetchConfidenceScore:n.prefetchConfidenceScore,suggestionKey:st(n)}}function ft(n){return __assign(__assign({},gi(n)),{query:n.query,textWithoutHH:HitHighlightingParser.removeMarkers(n.text),icon:n.getIcon?null:n.icon})}function oe(n,t){return __assign(__assign({},ft(n)),{title:n.primaryMetadata,url:t})}function se(t){return typeof n.isDocSrcEnabledInQws=="function"&&n.isDocSrcEnabledInQws(t)}function nr(t){return n.config.msbEnableQwsDocsCache&&t.scope!==n.Scope.Documents}function et(){return typeof n.isQwsSuccessRateMet=="function"&&n.isQwsSuccessRateMet()}var ot,rr,v,y,t,bt,o,k,ii,ri,s,h,oi,yi;n.sameGroup=tr;n.mapOSFormCode=ir,function(t){t.KValues=function(){var n={};return n.GPT=108,n.GT=109,n.GW=110,n.SW=114,n.PWL=115,n.STS=116,n.SBI=117,n.SBV=118,n.SDSC=119,n.SDIO=120,n.IMIO=121,n.COFA=122,n.COOA=124,n.SDFE=126,n.OWA=128,n.OMSS=129,n.OMIO=130,n.OMTS=131,n.OMAC=133,n.OMVA=135,n.SSTS=136,n.AFOT=137,n.SNSC=138,n.RWBD=139,n.RWBN=140,n.EUP=142,n.RWBG=145,n.QSCH=146,n.MSNN=147,n.SKU=148,n.SNSP=149,n.SNST=150,n.APPA=152,n.OMZI=153,n.FB=154,n.MSBA=155,n.ANA=156,n.APB=157,n.MMB=158,n.OMB=159,n.CB=161,n.EDUR=162,n.WNSPTP=163,n}();t.HandoffsForNonSuggestions=function(){var n={};return n.GPT=2,n.GT=3,n.GW=0,n.SDSC=2,n.SDIO=2,n.IMIO=2,n.COFA=2,n.COOA=2,n.MSNN=20,n.SNSP=19,n.SNST=19,n.APPA=997,n.OMZI=997,n.FB=997,n.MSBA=2,n.APB=997,n.MMB=997,n.OMB=997,n.CB=997,n.WNSPTP=1,n}();t.HandoffsForDSBScenarios=function(){var n={};return n.ExploreMore=0,n.OnThisDay=0,n.QuoteOfTheDay=0,n.WordOfTheDay=0,n.WholePageTabs=0,n.HeroCardOfTheDay=0,n.RelatedLocal=19,n.RelatedLocal_Hero=0,n.RelatedLocal_CTA=0,n.RelatedShopping_Hero=20,n.RelatedShopping_CTA=20,n.Rewards=0,n.TrendingImages=13,n.TrendingSearch=0,n.TrendingVideos=0,n.PersonalizedRecipes=20,n.RelatedRecipe=0,n.KC_HeroCard=0,n.PersonalizedSports=20,n}();t.GroupsForNonSuggestions=function(){var t={};return t.GPT=n.GroupType.GroupHeader,t.GT=n.GroupType.GroupHeader,t.GW=n.GroupType.GroupHeader,t.SDSC=n.GroupType.Settings,t.SDIO=n.GroupType.Settings,t.IMIO=n.GroupType.Settings,t.COFA=n.GroupType.Settings,t.COOA=n.GroupType.Settings,t.SNSP=n.GroupType.VisualSearch,t.SNST=n.GroupType.VisualSearch,t.MSBA=n.GroupType.Upsell,t}()}(ot=n.SyntheticQSCodesMaps||(n.SyntheticQSCodesMaps={})),function(n){n[n.Open=1]="Open";n[n.RunAs=2]="RunAs";n[n.RunAsUser=3]="RunAsUser";n[n.OpenInBrowser=4]="OpenInBrowser";n[n.OpenFileLocation=5]="OpenFileLocation";n[n.OpenContaining=6]="OpenContaining";n[n.TabletMode_OpenNewWindow=7]="TabletMode_OpenNewWindow";n[n.PinToStartScreen=8]="PinToStartScreen";n[n.StartUnpin=9]="StartUnpin";n[n.TaskbarUnpin=10]="TaskbarUnpin";n[n.StartPin=11]="StartPin";n[n.TaskbarPin=12]="TaskbarPin";n[n.Manage=13]="Manage";n[n.ConnectNetworkDrive=14]="ConnectNetworkDrive";n[n.DisconnectNetworkDrive=15]="DisconnectNetworkDrive";n[n.Uninstall=16]="Uninstall";n[n["Tile.Uninstall"]=17]="Tile.Uninstall";n[n.ItemProperties=18]="ItemProperties";n[n.Settings=19]="Settings";n[n.Review=20]="Review";n[n.Share=21]="Share";n[n.S_Open=1e3]="S_Open";n[n.S_Install=1001]="S_Install";n[n.S_CopyFullPath=1002]="S_CopyFullPath";n[n.S_SendEmail=1003]="S_SendEmail";n[n.S_SendInstantMessage=1004]="S_SendInstantMessage";n[n.S_CopyPersonDetails=1005]="S_CopyPersonDetails";n[n.S_OpenFileLocationInBrowser=1006]="S_OpenFileLocationInBrowser";n[n.S_OpenInOutlookWeb=1007]="S_OpenInOutlookWeb";n[n.S_LaunchOutlookNative=1008]="S_LaunchOutlookNative";n[n.S_OpenInBrowser=1009]="S_OpenInBrowser"}(rr=n.JumplistActionItemType||(n.JumplistActionItemType={}));n.providerFailureLogName=ur;n.localDataSourceMayContainPII=fr;n.getSuggestionKey=st;v={"Microsoft.Windows.ControlPanel":"ControlPanel","Microsoft.AutoGenerated.{923DD477-5846-686B-A659-0FCCD73851A8}":"Classic_{E9C71548-B580-43B2-ACDB-1BA924002754}","{1AC14E77-02E7-4E5D-B744-2EB1AE5198B7}\\dfrgui.exe":"Classic_{7D13A5DB-6081-48BD-8EA3-A9D7FE67A335}","{6D809377-6AF0-444B-8957-A3773F02200E}\\Windows Defender\\MSASCui.exe":"NameSpace_Classic_{D8559EB9-20C0-410E-BEDA-7ED416AECC2A}","{1AC14E77-02E7-4E5D-B744-2EB1AE5198B7}\\cleanmgr.exe":"Classic_{AACA901F-E74F-4894-B074-F55059532853}","Microsoft.AutoGenerated.{BB044BFD-25B7-2FAA-22A8-6371A93E0456}":"Classic_{45FDB5DF-1457-4A41-A824-7AD9C75767BC}","Microsoft.Windows.PCSettings.DefaultApps":"AAA_SettingsPageAppsDefaults"};y={"NameSpace_Classic_{F942C606-0914-47AB-BE56-1321B8035096}":"Classic_{232A1851-808C-4B44-A92A-38E862989CE5",AAA_Proxy_Automatic_Config_Group:"AAA_SettingsPageNetworkProxy",AAA_Settings_DeveloperModeGroup:"AAA_SettingsPageRestoreDeveloperOptions",AAA_SystemSettings_Users_PicturePassword:"AAA_SettingsGroupPicturePassword"},function(n){n[n.NotDuplicate=0]="NotDuplicate";n[n.NoMetadata=1]="NoMetadata";n[n.MergeMetadata=2]="MergeMetadata"}(t||(t={}));var er=[["PPL","MPPL","MGRP"],["MFIL","MBKS","MBLD","MQNA"],["MBV"]],or=[["PPL","MPPL","MGRP","MFIL"],["MBKS","MBLD","MQNA"],["MBV"]],sr=[["PPL","MPPL"],["MFIL","MGRP"],["MBKS","MBLD","MQNA"],["MBV"]];n.isDuplicate=lr;n.MRUDatabaseName="mruWithIndex";n.ANADatabaseName="anaWithIndex";n.isFileOrFolderLocalDataSource=ar;n.supportsShortcuts=vr;n.setDocumentLocationProperties=yr;n.isModernSetting=pr;n.getAppItem=f;n.isGroup=wr;n.isWin11DSB=br;n.getItemWithFileMetadata=kr;n.getCommandLineItem=p;n.isMRUHistoryGroupType=dr;n.getGroupType=w;n.isWebSuggestion=gr;n.isJumpListGroup=pt;n.isTopHitChildGroup=nu;n.isChildSuggestion=b;n.isJumpListSuggestion=tu;n.getScope=wt;n.IconSize_GridLayout=92;n.IconSize_GridLayout_Medium=68;n.IconSize_GridLayout_Scaled=130;n.getImageSizeValue=iu;n.populateImageRatio=ru;bt={"zh-hans-cn":"zh-cn","zh-hans-sg":"zh-cn","zh-hant-hk":"zh-hk","zh-hant-tw":"zh-tw",ko:"ko-kr",ja:"ja-jp",nb:"nb-no"};n.getCurrentLanguage=e;n.createSuggestion=kt;n.addSubItemToSuggestion=uu;n.getSyntheticSuggestion=fu;n.getNarratorText=dt;n.isL2=gt;n.iconIsThumbnail=ti;n.displayedInGridLayout=eu;n.parseWebSuppressionSignals=ou;n.decodeHtml=su,function(n){n[n.Author=1]="Author";n[n.LastModifiedBy=2]="LastModifiedBy";n[n.Content=3]="Content";n[n.Tags=4]="Tags";n[n.Album=5]="Album";n[n.Artist=6]="Artist";n[n.Genre=7]="Genre";n[n.Location=8]="Location"}(k=n.MatchType||(n.MatchType={}));n.createMatch=hu;ii=/[-[\]{}()*+!<=:?.\/\\^$|#\s,]/g;n.escapeRegex=i;n.tryGetLocationMatch=cu;n.tryGetTextContentMatch=lu;n.matchesOnPropertyHH=au;n.uses3lineTemplate=vu;n.hasReverseHighlighting=yu;n.isEquivalentForPreviewPanePurposes=wu;n.isNullOrUndefined=bu;ri=function(){function t(t,i,r){this.verb=t.verb;this.displayName=t.displayName;this.executeSync=t.executeSync?function(){return r(function(){return t.executeSync()})}:function(){return r(function(){n.Async.safeChain("verb.executeAsync",function(){return t.executeAsync()},function(){return n.Host.manuallyDismissApp()},null,null,null)})};this.isDefault=t.isDefault;this.icon=i;this.getIcon=t.getIcon}return t}();n.DeviceItemVerbWrapper=ri;n.shouldSetThisPcGroupSource=ku;n.getGroupSourceDisplayName=du;n.EdgeAppIds=["MSEdge","Microsoft.MicrosoftEdge_8wekyb3d8bbwe!MicrosoftEdge"];n.AnaheimAppIds=["MSEdge"];n.SpartanAppId="Microsoft.MicrosoftEdge_8wekyb3d8bbwe!MicrosoftEdge";n.InternetExplorerId="Microsoft.InternetExplorer.Default";n.getRtlAdjustedKey=gu;n.getSearchSuggestionIcon=nf;n.getWebSuggestionAnnotation=tf;n.msbEnabledForQuery=rf;n.isOnlineSuggestionPersonType=ui;n.isOnlineSuggestionMsbFile=fi;n.getMsbTophitSuggestionTypeOrder=uf;n.isMsbOnlineSuggestionType=ff;n.setVisibility=ef;n.isRtl=ei;n.FOLDERID_Profile="{5E6C858F-0E22-4760-9AFE-EA3317B67173}";n.FOLDERID_SkyDrive="{A52BBA46-E9E1-435f-B3D9-28DAA648C0F6}";n.FOLDERID_System="{1AC14E77-02E7-4E5D-B744-2EB1AE5198B7}";n.FOLDERID_SystemX86="{D65231B0-B2F1-4857-A4CE-A8E7C6EA7D27}";s={};n.clearFolderCaches=of;n.getKnownFolderPathLC=r;h={};n.clearPathExpansionCache=sf;oi=/^\{([a-z0-9-]{36})\}(.*)/i;n.resolveKnownFolderGUIDsInPath=d;n.indexerFilePathToRegularPath=hf;n.enforceOriginalOrder=cf;n.getSubstrateResourceOrScope=lf;n.getBingResourceOrScope=af;n.getTweakedSetting=vf;n.shouldSkipSelectedScope=yf;n.canShowSearchHomeUpsell=si;n.shouldEnableQuickSearches=hi;n.shouldEnableMSNNewsSearches=ci;n.shouldEnableGoodNewsMSN=pf;n.shouldEnableAnaheimResetDefault=wf;n.shouldEnableSnipSearch=bf;n.canShowQuickSearch=kf;n.canShowQuickSearchWithoutANA=li;n.isMsbEnterprise=g;n.canShowQuickWorkSearch=nt;n.isAnaheimDataEnabled=c;n.canShowAnaheimDataSHList=df;n.canShowAnaheimDataSHTile=gf;n.canShowAnaheimDataSH=tt;n.canShowAnaheimDataQF=ne;n.isConsumerWindowsSKU=vi;n.shouldShowTwoColumns=te;n.currentTabStorageKey="currentTab";n.MeetingDismissedEndDateKey="MeetingDismissedStartDate",function(n){n.News="MSNNews";n.QuickSearches="QuickSearches"}(yi=n.MSNNewsTabs||(n.MSNNewsTabs={}));n.canShowMSNNewsTab=pi;n.shouldShowThreeFingerTap=ie;n.deepCopy=wi;n.shouldComponentUpdateOverload=re;n.enableMRUSearchHome=ue;n.getFaviconUrlForRawUrl=fe;n.getThumbnailServerUrl=bi;n.isDynamicSearchContentPossible=rt;n.isZeroInputAllScope=l;n.shouldShowDSBLayout=u;n.isDSBAllowedInEntryPoint=ki;n.shouldShowTransparentMiniserp=ee;n.shouldShowZIDataSource=di;n.shouldShowStaticSearchHome=a;n.isTwoPanesZIEnabled=ut;n.getMruSuggestionData=gi;n.getMruWebSuggestionData=ft;n.getMruUrlSuggestionData=oe;n.isDocSourceEnabledInQws=se;n.isMsbQwsDocsCacheEnabled=nr;n.isQwsSuccessRateThresholdMet=et}(WSB||(WSB={})),function(n){var t,i,r;(function(n){n.checking="checking";n.downloading="downloading";n.error="error";n.noUpdate="noupdate";n.obsolete="obsolete";n.updateReady="updateready"})(t||(t={}));i=[t.checking,t.downloading,t.error,t.noUpdate,t.obsolete,t.updateReady];r=function(){function r(n){n===void 0&&(n=Date.now);this.getNowTimestamp=n;this._appCacheEventIndex=1;this._superFreshEnabled=!1;this._appCache=_w.applicationCache;this.subscribeForEvents()}return r.prototype.instrumentSuperFreshUpdate=function(n){this._appCacheTimeline||(this._appCacheTimeline=this.createAppCacheTimelineObject());this._appCacheTimeline.SuperFreshUpdateData.T=this.getNowTimestamp();this._appCacheTimeline.SuperFreshUpdateData.S=n;this.sendAppCacheEvents()},r.prototype.registerSuperFresh=function(){this._superFreshEnabled=!0},r.prototype.subscribeForEvents=function(){var n=this;i.forEach(function(t,i){return sj_be(n._appCache,t,function(){return n.handleAppCacheEvent(t,i)})})},r.prototype.handleAppCacheEvent=function(n,i){n!=t.checking&&this._appCacheTimeline||(this._appCacheTimeline=this.createAppCacheTimelineObject());this._appCacheTimeline.AppCacheEvents[i]=this.getNowTimestamp();switch(n){case t.obsolete:SharedLogHelper.LogWarning("handleAppCacheEvent",null,"AppCache marked as obsolete and will be deleted");this.sendAppCacheEvents();break;case t.error:case t.noUpdate:this.sendAppCacheEvents();break;case t.updateReady:this._superFreshEnabled||this.sendAppCacheEvents()}},r.prototype.sendAppCacheEvents=function(){var f=_G.ServerIG,t,r,u,i;if(!f){SharedLogHelper.LogError("sendAppCacheEvents","Could not instrument as server IG not known",new Error("Could not instrument app cache event"));return}(t=this._appCacheTimeline,t)&&(r=t.AppCacheEvents,u=[{I:t.EventIndex,E:r,S:t.SuperFreshUpdateData,ABT:n.InstrumentationHelper.getConversationStartTimestamp()}],r[2]&&(u[0].OL=navigator.onLine),i=n.InstrumentationCommon.createPerfPingEvent(f,u,"AppCache",n.Host.getConversationId()),Log2.LogEvent(i.EventType,i.Data,n.InstrumentationCommon.QFPERFPING_EVENT_NAME,null,null,i.ImpressionGuid,null,null),this._appCacheTimeline=this.createAppCacheTimelineObject())},r.prototype.createAppCacheTimelineObject=function(){var n={EventIndex:this._appCacheEventIndex,AppCacheEvents:{},SuperFreshUpdateData:{T:undefined,S:undefined}};return this._appCacheEventIndex++,n},r}();n.AppCacheInstrumentationHelper=r}(WSB||(WSB={})),function(n){var t=["PP","ST","FL","LM"],i=function(){function i(){var n=this;ThresholdUtilities.getCortanaHeaders(function(t){t&&(n._windowsFlights=t["X-BM-WindowsFlights"])})}return i.prototype.logProfilerMarker=function(t,i,r,u,f){f||(f={});n.safeExecute(function(){t==1?SearchAppWrapper.CortanaApp.logMeasure("Bing_QF_"+r,i,"QF",JSON.stringify(f),u):SearchAppWrapper.CortanaApp.logVerboseTrace("Bing_QF_"+r,i,"QF",JSON.stringify(f),u)},"logProfilerMarker")},i.prototype.getEnrichedClientInfo=function(t){var u,l=typeof _G=="object"?_G:{},i={},r,f,c,e,o,s,h;return i.entryPoint=SearchAppWrapper.CortanaApp.entryPoint,i.previousExperience=SearchAppWrapper.CortanaApp.queryFormulationView.previousExperience,i.qfMode=""+n.RuntimeConfig.QfMode,i.isSearchHome=t.isSearchHomeZI?1:undefined,i.isSVCss=n.config.useCobaltCSS?1:undefined,i.region=n.regionCache||undefined,i.lang=n.uiLanguageCache||undefined,i.DC=l.DA||undefined,i.isMobile=SearchAppWrapper.CortanaApp.isMobile?1:0,i.isXbox=navigator.userAgent.toLowerCase().includes("xbox one")?1:0,i.isHololens=navigator.userAgent.toLowerCase().includes("hololens")?1:0,i.windowsColor=n.Host.getWindowsTheme(),i.appColor=n.Host.getAppTheme(),r=n.Host.getFeatureDWORD("WideAtStartupDelta"),r.validFeature&&typeof r.featureValue=="number"&&(i.WideAtStartupDelta=r.featureValue),t.scope!=n.Scope.All&&(i.scope=n.Scope[t.scope]),t.fromSuggestionType&&(i.fromClick={sType:t.fromSuggestionType,searchHome:t.fromSearchHome?1:undefined}),f=SearchAppWrapper.CortanaApp.queryFormulationView.searchHistory,i.deviceHistoryEnabled=f&&f.isDeviceHistoryEnabled?1:0,c=(u=n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType())!==null&&u!==void 0?u:0,i.windowsAccount=c.toString(),n.isMsftAccountConnected&&(i.msftAccountConnected=1),n.isSubstrateO365AccountConnected&&(i.o365Connected=1),n.isSubstrateOutlookAccountConnected&&(i.outlookConnected=1),n.Host.hasFallbackHappened()&&(i.fallback=1),n.Host.isClientLocationAvailable()&&(i.clientLocationAvailable=1),n.Host.isInputPanelVisible()&&(i.isInputPaneVisible=1),n.Host.getWindowsTheme()==2&&(i.darkMode=1),SearchAppWrapper.CortanaApp.colorPrevalenceEnabled&&(i.colorPrevalence=1),SearchAppWrapper.CortanaApp.isSearchBoxInTaskbar&&(i.searchBoxInTaskbar=1),SearchAppWrapper.CortanaApp.taskbarOrientation&&(i.taskbarOrientation=SearchAppWrapper.CortanaApp.taskbarOrientation),n.config.snrVersion&&(i.snrVersion=n.config.snrVersion),n.osSKUCache&&(i.osSKU=n.osSKUCache.toString()),i.ciVersion=n.ConstraintIndex.currentCIVersion,i.defaultBrowser=n.Host.getDefaultBrowser().toString(),e=n.config.enableFuzzyRanking||n.config.enableFuzzyRanking1?n.Host.getFRSuggCount():-1,e>-1&&(i.frSC=e.toString()),o=n.config.enableColdStartRanking||n.config.enableColdStartRanking1?n.Host.getCRCount():-1,o>-1&&(i.crC=o.toString()),s=n.config.enableColdStartRanking||n.config.enableColdStartRanking1?n.Host.getNCRCount():-1,s>-1&&(i.ncrC=s.toString()),h=n.config.enableColdStartRanking||n.config.enableColdStartRanking1?n.Host.getFCRCount():-1,h>-1&&(i.fcrC=h.toString()),this._windowsFlights&&(i.windowsFlights=this._windowsFlights),typeof n.getTenantMsbStatus=="function"&&(i.tenantMsbStatus=n.getTenantMsbStatus()),typeof n.getMsbClientQfState=="function"&&(i.msbClientQfState=n.getMsbClientQfState()),i},i.prototype.getSuggestionsPageName=function(){return"Page.SmartSearch.AS.Suggestions"},i.prototype.getApplicationName=function(){return"SmartSearch"},i.prototype.getRankerModelId=function(){return n.config.mainRankerId},i.prototype.createNonSuggestionDataSourceObject=function(t,i){return{T:"D.Url",K:i.getKValue(),Val:t,Ho:n.SyntheticQSCodesMaps.HandoffsForNonSuggestions[t],Gr:n.SyntheticQSCodesMaps.GroupsForNonSuggestions[t],NR:1,Properties:i.getProperties()}},i.prototype.createDataSourceObject=function(t,i){var f=this,e=t.mayContainPII&&!n.TestHookUrlParameters,o=(i||t.instItem).getKValue(),s=i&&typeof i.getHandoffType()=="number"?i.getHandoffType():t.handoffType,h=i?i.getQsCode():t.type,r={T:"D.Url",K:o,Q:e?undefined:t.query,MQ:t.ciMatchedQuery?t.ciMatchedQuery:undefined,Val:h,Ho:s,Ans:t.isAnswer?1:undefined,Gr:n.getGroupType(t),HC:t.hc?1:undefined,RAF:t.useRaf?1:undefined,HS:t.fromHistory?1:undefined,F:t.features.length>0?t.features.join(","):undefined,AC:t.autoCompleteType?t.autoCompleteType:undefined,HCMS:t.highConfidenceMetaSuggestionScore,HCS:t.highConfidenceSuggestionScore,LM:t.suggestionLogMeta,Uri:t.actionUri,Src:t.source,Sg:t.segments,NR:t.notAResult?1:undefined},u;return t.deviceItem?r.DeviceSignals=n.safeExecute(function(){return f.buildDeviceItemDataSource(e,t)},"buildDeviceItemDataSource"):n.isJumpListSuggestion(t)&&(r.DeviceSignals=n.safeExecute(function(){return f.buildJumpListItemDataSource(t)},"buildJumpListItemDataSource")),n.TestHookUrlParameters&&(u=t,u.path&&(r.path=u.path),u.targetPathLC&&(r.targetPath=u.targetPathLC)),r.RankerSignals=this.buildRankerOutputDataSource(t),r},i.prototype.buildRankerOutputDataSource=function(n){if(!n.rankingScore&&!n.featureStore)return undefined;return{rankingScore:n.rankingScore,featureStore:n.featureStore,mruSuppressionScore:n.mruSuppressionScore,fbcScore:n.fbcScore,previewPaneScore:n.previewPaneScore}},i.prototype.buildJumpListItemDataSource=function(t){var r=t.jumpListItem,i={Rank:r.usagePoints||undefined,LAD:n.isValidDate(r.lastAccessed)?r.lastAccessed.toJSON():undefined};if(n.TestHookUrlParameters)i.path=r.path,i.description=t.tooltip;else if(!i.Rank&&!i.LAD)return undefined;return i},i.prototype.getPathCompletionItem=function(n){return n.type=="PT"?n.deviceItem:null},i.prototype.buildDeviceItemDataSource=function(t,i){var f=i.deviceItem,r={Rank:f.rankScore},u,o,s,e;if(f.propertyHits&&f.propertyHits.length>0&&(r.PHits=f.propertyHits.join(",")),t||(r.Id=f.id,r.DName!=i.query&&(r.DName=f.displayName)),n.TestHookUrlParameters&&(r.kind=f.kind),n.isSetting(i.type))return r.MDN=n.isModernSetting(f)?1:0,r;if(u=n.getAppItem(i),u)return r.LAD=n.isValidDate(u.lastAccessed)?u.lastAccessed.toJSON():undefined,r.AppLnch=u.totalLaunches,r.Args=u.launchArguments?1:0,r.MDN=u.isImmersive?1:0,r.Ext=u.extension,n.TestHookUrlParameters&&(r.CDT=n.isValidDate(u.createdDate)?u.createdDate.toJSON():undefined,r.LMD=n.isValidDate(u.lastModifiedDate)?u.lastModifiedDate.toJSON():undefined,r.launchArguments=u.launchArguments,r.filePath=u.filePath),r;if(o=n.getItemWithFileMetadata(i),o){if(r.Ext=o.extension,n.TestHookUrlParameters&&(r.itemTypeDisplayName=o.itemTypeDisplayName),s=n.getCommandLineItem(i),s)return n.TestHookUrlParameters&&(r.launchArguments=s.launchArguments,r.encodedPath=s.encodedPath),r;this.getPathCompletionItem(i)||(e=i.deviceItem,r.CDT=n.isValidDate(e.createdDate)?e.createdDate.toJSON():undefined,r.LMD=n.isValidDate(e.lastModifiedDate)?e.lastModifiedDate.toJSON():undefined,r.Ext=e.extension?e.extension:"")}return r},i.prototype.logMasterPageImpression=function(t){n.safeExecute(function(){return ThresholdInst.LogPageImpression(t,null,t.enrichedClientInfo)},"logMasterImpressionForClient")},i.prototype.logDataSourceTimeout=function(i,r){var e,u,f,o;if(SearchAppWrapper.CortanaApp.queryFormulationView.logProviderFailure)for(e=function(t){n.isDataSourceEnabled(t,r)&&!n.contains(i,t)&&n.safeExecute(function(){return SearchAppWrapper.CortanaApp.queryFormulationView.logProviderFailure(n.providerFailureLogName(t),"NoReturnForTopHit")},"logProviderFailure")},u=0,f=t;u<f.length;u++)o=f[u],e(o)},i.prototype.onItemClick=function(){SearchAppWrapper.CortanaApp.queryFormulationView.resetConversationIdNextTimeQFIsShown&&SearchAppWrapper.CortanaApp.queryFormulationView.resetConversationIdNextTimeQFIsShown()},i}();n.WSBInstrumentationProvider=i}(WSB||(WSB={})),function(n){var t="/QF_KEYSTROKE_VIRTUAL_URL?",i="autosuggest",r=function(){function r(){}return r.init=function(t,i){r._keystrokesInstrumentationData={};r._instrumentationProvider=t;r._clientTelemetry=i;ClientInstConfig.queueDumpInterval=n.config.logQueueDumpInterval;_w.ClTrCo.SharedClickSuppressed=!0;n.Host.bindShown(function(n){return r._clientShownTimestamp=n});n.Host.bindConversationStart(function(){return r.onConversationStart()});r._conversationTimeline={RawImpressionGuid:"",ImpressionGuid:"",ConversationId:"",AppVisibleStart:n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,AppVisibleFinish:n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,AppShownStart:n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,AppShownFinish:n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE}},r.bindFinalizeKeystroke=function(n){r._finalizeKeystrokeHandlers.push(n)},r.bindKeystrokeTimelineUpdated=function(n){r._keystrokeTimelineUpdatedHandlers.push(n)},r.fireKeystrokeTimelineUpdatedHandlers=function(n){r._keystrokeTimelineUpdatedHandlers.forEach(function(t){return t(n)})},r.getRawImpressionGuid=function(t){var i=r._keystrokesInstrumentationData[t];return i&&i.RawImpressionGuid?i.RawImpressionGuid:(SharedLogHelper.LogError("getRawImpressionGuid","sequenceNumber: "+t+" ConversationID: "+n.Host.getConversationId(),new Error("No instrumentation data/no IG found for sequenceNumber")),"")},r.getImpressionGuid=function(n){var t=r._keystrokesInstrumentationData[n];if(t&&t.ImpressionGuid)return t.ImpressionGuid;throw"getImpressionGuid(): No IG for sequence "+n;},r.updateSuggestionsList=function(n,t){r._clientTelemetry&&r._clientTelemetry.updateSuggestionsList(n,t)},r.instrumentKeyDown=function(n){r._keyDownTimeStamp=n},r.instrumentFetchProviderBegin=function(t,i){t>0&&r.safeInstrumentPerf(t,function(t){n.config.perfInstV2&&(t.DataProvidersStarted[i]=r.getOffsettedNow())},"instrumentFetchProviderBegin",null)},r.instrumentFetchesBegin=function(t){r.safeInstrumentPerf(t,function(t){t.DataSourcesFetchBegin=r.getOffsettedNow();n.config.perfInstV2&&(t.DataProviderFetchStart=r.getOffsettedNow())},"instrumentFetchesBegin",null)},r.instrumentFetchesEnd=function(n){r.safeInstrumentPerf(n,function(n){n.DataSourcesFetchEnd=r.getOffsettedNow()},"instrumentFetchesEnd",null)},r.instrumentDataSourceParsed=function(n,t){r.safeInstrumentPerf(n,function(n){var i=r.getOffsettedNow();typeof n.ResponseParsed[t]!="number"?n.ResponseParsed[t]=i:(n.MultipleResponsesParsed[t]||(n.MultipleResponsesParsed[t]=[n.ResponseParsed[t]]),n.MultipleResponsesParsed[t].push(i))},"instrumentDataSourceParsed",t)},r.instrumentItemClickForPreviewPane=function(n,t,i,u,f,e,o,s,h){if(t.getHandoffType()!=999){var c=r.createBaseCustomGPingPayload(f,e);r.addPreviewPaneDataToGPingPayload(c,o,s,h);r.instrumentItemClickAndGPing(c,n,t,i,u,f)}},r.instrumentItemClickForContextMenu=function(n,t,i,u,f,e,o){if(t.getHandoffType()!=999){var s=r.createBaseCustomGPingPayload(f,e);r.addContextMenuDataToGPingPayload(s,o);r.instrumentItemClickAndGPing(s,n,t,i,u,f)}},r.instrumentItemClick=function(n,t,i,u,f,e){var o=t.getHandoffType(),s;o!=999&&(o==998||o==997?r.instrumentLayoutItemSelect(t,i):(s=r.createBaseCustomGPingPayload(f,e),r.instrumentItemClickAndGPing(s,n,t,i,u,f)))},r.instrumentItemClickAndGPing=function(t,i,u,f,e,o){r.sendCustomGPing(t,u.getHValue(),i);var h=r._keystrokesInstrumentationData[f],s=r._keystrokesInstrumentationData[f];s?(h.RenderingStarted||r.updatePageIG(f),_G.IG!=s.ImpressionGuid&&SharedLogHelper.LogError("instrumentItemClick","IG ("+s.ImpressionGuid+") for sequenceNumber "+f+" does not match the page IG ("+_G.IG+")",new Error("IG for sequence number does not match the currently rendered page's IG (_G.IG)")),r._clientTelemetry&&r._clientTelemetry.logItemClickedMeasure(s.ConversationId,s.RawImpressionGuid,u,o)):SharedLogHelper.LogError("instrumentItemClick","sequenceNumber: "+f+" ConversationID: "+n.Host.getConversationId(),new Error("No instrumentation data found for sequenceNumber"));r.finalizeKeystrokeLog(f,1);e&&e();r._instrumentationProvider.onItemClick();n.config.forceLogFlush?Log2.ForceFlush():Log2.FlushMainQueueDontForce();_w.clickFlushedTime=sb_gt()},r.instrumentLayoutItemSelect=function(n,t){var i={AppNS:n.getAppNS(),K:n.getLayoutKValue()};r.logClientInstEvent("Select","ItemClicked",t,i)},r.instrumentPerfEvent=function(t,i,u){n.config.logClientPerf&&r.safeInstrumentPerf(t,function(n){r._instrumentationProvider.logProfilerMarker(1,0,i,n.RawImpressionGuid,{d:u})},"instrumentPerfEvent")},r.instrumentAggregateFunctionPerf=function(t,i){n.config.logClientPerf&&r._clientTelemetry.logAggregateFunctionPerf(t,i)},r.instrumentDeviceQueryBegin=function(n){r._instrumentationProvider.logProfilerMarker(1,0,"StartDeviceQuery",n,{})},r.createBaseCustomGPingPayload=function(n,t){var i={};switch(n){case 1:i.i="k";i.mk=r.getModifierKeyCodes(t);break;case 3:i.i="t";break;case 4:i.i="p";break;case 5:i.i="n";break;case 6:i.i="b";break;case 0:i.i="x";i.mk=r.getModifierKeyCodes(t);break;default:i.mk=r.getModifierKeyCodes(t)}return i},r.addContextMenuDataToGPingPayload=function(n,t){n.cm=t},r.addPreviewPaneDataToGPingPayload=function(n,t,i,r){t&&(n.pp=t,i&&(n.ppit=i),typeof r=="number"&&(n.rho=r))},r.sendCustomGPing=function(t,i,r){var u=i;n.isEmpty(t)||(u+="&PR="+JSON.stringify(t));n.safeExecute(function(){return _w.si_T(u,null,null,0,r)},"logCustomGPing")},r.getModifierKeyCodes=function(n){if(n){var t=n.altKey?"A":"";if(t+=n.ctrlKey?"C":"",t+=n.shiftKey?"S":"",t)return t}return undefined},r.notifyTopHitPreviewPaneOpenedOrInterrupted=function(t,i){var u=r._keystrokesPerfPingData[t];u&&u.PreviewPanePendingInfo!=null&&(u.PreviewPanePendingInfo.latency=r.getOffsettedNow(),i?u.PreviewPaneOpened=u.PreviewPanePendingInfo:u.PreviewPaneCanceled=u.PreviewPanePendingInfo,u.PreviewPanePendingInfo=null,r.tryInstrumentRenderStopped(t,u));n.config.perfInstV2&&i&&r.safeInstrumentPerf(t,function(n){n.PreviewPaneFinish=r.getOffsettedNow()},"instrumentFetchesEnd",null)},r.previewPaneOpenedOrClosed=function(n,t,i,u,f,e){var s=n?"Select":"Unselect",h=n?"PreviewPaneOpened":"PreviewPaneClosed",o;r.logClientInstEvent(s,h,t,e);n&&r._keystrokesPerfPingData[t]&&r.notifyTopHitPreviewPaneOpenedOrInterrupted(t,!0);n&&r._clientTelemetry&&(o=r._keystrokesInstrumentationData[t],o&&r._clientTelemetry.logPreviewPaneOpenedMeasure(i,u,f))},r.logClientInstEvent=function(n,t,i,u){var e=null,f;i&&(f=r._keystrokesInstrumentationData[i],f&&(e=f.ImpressionGuid));Log2.LogEvent(n,u,t,null,null,e,null,null)},r.safeInstrument=function(n,t,i,u){var f=r._keystrokesInstrumentationData[n];f?t(f):SharedLogHelper.LogError(i,(u?u+" ":"")+" sequenceNumber: "+n,new Error("No instrumentation data found for sequenceNumber"))},r.safeInstrumentPerf=function(t,i,u,f){var e=r._keystrokesPerfPingData[t];e?n.safeExecute(function(){return i(e)},u):SharedLogHelper.LogError(u,(f?f+" ":"")+" sequenceNumber: "+t,new Error("No instrumentation data found for sequenceNumber"))},r.instrumentRenderingStarted=function(n){r.safeInstrument(n,function(t){t.RenderingStarted=!0;r.updatePageIG(n)},"instrumentRenderingStarted")},r.instrumentQueryChangedRequest=function(t,i){var e;delete r._keystrokesInstrumentationData[t-1];n.InstrumentedItem.resetKValues(t);e=r._keystrokesPerfPingData[t];e&&SharedLogHelper.LogError("instrumentQueryChangedRequest","sequenceNumber: "+t,new Error("Duplicate BeginRequest for sequenceNumber"));var f=n.Host.getConversationId(),u=n.Host.getRawImpressionGuid(),o=n.cleanGuid(u),s=n.getCurrentTime(),c={RawImpressionGuid:u,ImpressionGuid:o,ConversationId:f,Query:i,PendingDataSources:{},DataSources:{},RankerExtraInfo:{},DuplicateDS:{},Layout:[],MasterPageImpressionCreated:!1,RenderingStarted:!1,PendingInstrumentedItems:{},PendingSyntheticSuggestions:{},OriginalTimestamp:s},h={RawImpressionGuid:u,ImpressionGuid:o,ConversationId:f,PrefixLength:i.queryToFetch?i.queryToFetch.length:0,SearchHomeRenderEvent:n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,ClientShownEvent:r.getOffsettedNow(r._clientShownTimestamp),RequestBegin:r.getOffsettedNow(s),ResponseReceived:{},MultipleResponsesReceived:{},DataSourcesState:r._searchServiceStatus?{Indexer:r._searchServiceStatus}:undefined,RenderFinished:{},renderGroupFinished:{},AllRenderFinished:0,AllDataSourcesProcessed:!1,PendingIcons:0,PreviewPanePendingInfo:undefined,TopResultRendered:[],ResponseFromCache:{},DataSourcesFetchBegin:0,DataSourcesFetchEnd:0,ResponseParsed:{},PreviewPaneOpened:{},PreviewPaneCanceled:{},PageLoadTime:0,SearchHomeLoadTime:0,FirstRenderTime:0,MultipleResponsesParsed:{},ConversationStart:n.config.perfInstV2?r._conversationStartTimestamp:n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,SequenceStart:n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,DataProviderFetchStart:n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,DataProviderFetchFinish:n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,DataProvidersStarted:{},DataProvidersFinished:{},RendersCompleted:{},RendersColdRank:{},PreviewPaneStart:n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,PreviewPaneFinish:n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,AnaheimDataIndexCount:{}};r._keystrokesInstrumentationData[t]=c;r._keystrokesPerfPingData[t]=h;r._currentRender=0;n.config.perfInstV2&&r._keyDownTimeStamp!=n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE&&(r.safeInstrumentPerf(t,function(n){n.SequenceStart=r._keyDownTimeStamp-r._conversationStartTimestamp},"instrumentKeyDown",null),r._keyDownTimeStamp=n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE);r._clientTelemetry&&r._clientTelemetry.logNewKeystrokeMeasure(f,u,i);r.updatePageIG(t);r.fireKeystrokeTimelineUpdatedHandlers(h);(n.config.enableFuzzyRanking||n.config.enableFuzzyRanking1)&&n.Host.setFRSuggCount(-1);(n.config.enableColdStartRanking||n.config.enableColdStartRanking1)&&(n.Host.setCRCount(-1),n.Host.setNCRCount(-1),n.Host.setFCRCount(-1))},r.setSearchServiceStatus=function(n){r._searchServiceStatus=n},r.instrumentResponseReceived=function(t,i,u,f,e,o){r.safeInstrumentPerf(t,function(t){if(!e){var o=r.getOffsettedNow();typeof t.ResponseReceived[i]!="number"?(t.ResponseReceived[i]=o,n.config.useWhereId&&i=="IFF"):(t.MultipleResponsesReceived[i]||(t.MultipleResponsesReceived[i]=[t.ResponseReceived[i]]),t.MultipleResponsesReceived[i].push(o))}u&&(t.DataSourcesState=t.DataSourcesState||{},t.DataSourcesState[i]=u);f&&(t.ResponseFromCache[i]=f)},"instrumentResponseReceived",i);n.config.perfInstV2&&r.safeInstrumentPerf(t,function(n){o||(n.DataProvidersFinished[i]=r.getOffsettedNow(),n.DataProviderFetchFinish<n.DataProvidersFinished[i]&&(n.DataProviderFetchFinish=n.DataProvidersFinished[i]));u&&(n.DataSourcesState=n.DataSourcesState||{},n.DataSourcesState[i]=u);f&&(n.ResponseFromCache[i]=f)},"instrumentResponseReceived",i)},r.instrumentTopResultRendered=function(t,i,u){r.safeInstrumentPerf(t,function(f){var e=r.getOffsettedNow(),o="T"+i.join(","),s;f.renderGroupFinished[o]?u||(f.renderGroupFinished[o].iconsFinished=e):(f.TopResultRendered.push({V:e,T:i.join(",")}),r._clientTelemetry&&(s=e-f.RequestBegin,r._clientTelemetry.logTopResultsRenderedMeasure(f.RawImpressionGuid,i,s)),f.renderGroupFinished[o]={iconsFinished:e,suggestionsFinished:e});r.tryInstrumentRenderStopped(t,f);n.MockUrlParameters&&n.safeFireEvent("TopResultRendered")},"instrumentTopResultRendered")},r.instrumentRenderedLocalSuggestion=function(n,t){var u=r._keystrokesInstrumentationData[n],f,e,i;if(u){for(f={},e={},i=0;i<t.length;i++)t[i].type=="FV"?f[i]="TBD":t[i].type=="HU"&&(e[i]="TBD");u.FvSug=f;u.HuSug=e}},r.instrumentAggregatorCall=function(t,i){r.safeInstrument(t,function(t){var e={fastRankModelId:r._instrumentationProvider.getRankerModelId()},f,u;for(f in t.RankerExtraInfo)e[f]=t.RankerExtraInfo[f];t.RankerExtraInfo={};u={T:"D.Aggregator",Service:n.InstrumentationCommon.DEFAULT_SERVICE_NAME,Scenario:"Aggregator",AppNS:n.InstrumentationCommon.DEFAULT_APP_NAMESPACE,DS:[],rankerModelIds:e};n.config.counterFactualLoggingOn&&(u.counterFactualDiff=u.counterFactualDiff||i);t.DataSources.aggregator=u},"instrumentAggregatorCall")},r.instrumentDSB=function(){r.safeInstrument(n.SequenceNumberManager.getSequenceNumber(),function(t){var s=n.dsbManager.getInstrumentedProps(),h=[],f,o,i,c;if(s){for(f=0;f<s.length;f++){var r=s[f],u=r===null||r===void 0?void 0:r.instrumentedItem,e=r===null||r===void 0?void 0:r.subItemInstrumentedItems;if(e&&e.length>0)for(o=0;o<e.length;o++)i=e[o],h.push({T:"D.url",Val:i===null||i===void 0?void 0:i.getQsCode(),Ho:i===null||i===void 0?void 0:i.getHandoffType(),Gr:n.GroupType.DSBGroup,K:i===null||i===void 0?void 0:i.getKValue()});h.push({T:"D.url",Val:r===null||r===void 0?void 0:r.scenario,Ho:u===null||u===void 0?void 0:u.getHandoffType(),Gr:n.GroupType.DSBGroup,K:u===null||u===void 0?void 0:u.getKValue()})}c={T:"D.DSB",Service:n.InstrumentationCommon.DEFAULT_SERVICE_NAME,Scenario:"DSB",AppNS:n.InstrumentationCommon.DEFAULT_APP_NAMESPACE,DS:h};t.DataSources.dsb=c}},"instrumentDSB")},r.addDuplicatesDataSource=function(t){var i=Object.keys(t.DuplicateDS).map(function(n){return t.DuplicateDS[n]});i.length>0&&(t.DataSources.duplicates={T:"D.Duplicates",Service:n.InstrumentationCommon.DEFAULT_SERVICE_NAME,Scenario:"Duplicates",AppNS:n.InstrumentationCommon.DEFAULT_APP_NAMESPACE,DS:i})},r.instrumentDuplicate=function(t,i,u){r.safeInstrument(t,function(t){var r=t.DuplicateDS[i.instItem.getHValue()],f;r||(r={T:"D.Duplicate",DS:[{T:"D.DSRef",KRef:i.instItem.getKValue()}]},i.instItem.getAppNS()!=n.InstrumentationCommon.DEFAULT_APP_NAMESPACE&&(r.DS[0].AppNS=i.instItem.getAppNS()),t.DuplicateDS[i.instItem.getHValue()]=r);f={T:"D.DSRef",KRef:u.instItem.getKValue()};u.instItem.getAppNS()!=n.InstrumentationCommon.DEFAULT_APP_NAMESPACE&&(f.AppNS=u.instItem.getAppNS());r.DS.push(f)},"instrumentDuplicate")},r.renderingStopped=function(n){return n.PendingIcons==0&&n.AllDataSourcesProcessed&&n.PreviewPanePendingInfo==null},r.notifyAllDataSourcesProcessed=function(n){r.safeInstrumentPerf(n,function(t){t.AllDataSourcesProcessed=!0;r.tryInstrumentRenderStopped(n,t)},"notifyAllDataSourcesProcessed")},r.notifyIconPending=function(n,t){r.safeInstrumentPerf(n,function(n){n.PendingIcons++},"notifyIconPending",t?"TR":"SUG")},r.notifyIconReadyOrFailed=function(n,t){r.safeInstrumentPerf(n,function(n){n.PendingIcons--},"notifyIconReadyOrFailed",t?"TR":"SUG")},r.notifyPreviewPaneStartRender=function(t){n.config.perfInstV2&&r.safeInstrumentPerf(t,function(n){n.PreviewPaneStart=r.getOffsettedNow()},"previewPaneStart")},r.notifyPreviewPanePending=function(n,t,i){var u=r._keystrokesPerfPingData[n];u&&(u.PreviewPanePendingInfo={previewPaneType:t,suggestionType:i})},r.tryInstrumentRenderStopped=function(t,i){r.renderingStopped(i)&&(r.finalizeKeystrokeLog(t,2),r._instrumentationProvider.logProfilerMarker(1,0,"RenderStopped",r.getRawImpressionGuid(t),{}),r.logMemoryUsageInWSBClient(t,"RenderStoppedMemoryUsage"),n.TestHookUrlParameters&&n.safeFireEvent("RenderStopped"))},r.logMemoryUsageInWSBClient=function(t,i){var u,f,e;SearchAppWrapper.CortanaApp.systemInfo&&(f=SearchAppWrapper.CortanaApp.systemInfo,e="TotalCommitMB:"+f.totalCommitMB+",TotalWorkingSetMB:"+f.totalWorkingSetMB+",SnrVersion:"+n.config.snrVersion+",MsbVersion:"+(typeof BingAtWork=="undefined"?"":(u=BingAtWork.context)===null||u===void 0?void 0:u.midgardVersion),r._instrumentationProvider.logProfilerMarker(1,0,i,r.getRawImpressionGuid(t),e))},r.isLayoutLogged=function(n){return r._keystrokesInstrumentationData[n].MasterPageImpressionCreated},r.finalizeKeystrokeLog=function(t,i){var f,u;(i===void 0&&(i=0),n.config.perfPingAtEndOnly&&i==2)||(r._finalizeKeystrokeHandlers.forEach(function(n){return n(i==0)}),f=r._keystrokesInstrumentationData[t],f&&r.logKeystrokeData(f,t),i!=1&&(u=r._keystrokesPerfPingData[t],u&&(r.logPerfPingEvent(r.createKeystrokePerfPingEvent(t,u)),r._clientTelemetry&&r._clientTelemetry.logDataSourcePerformancesMeasure(u),r.fireKeystrokeTimelineUpdatedHandlers(u))))},r.instrumentZiRendered=function(t,i){i&&(r._instrumentationProvider.logProfilerMarker(1,0,"ZiRendered",r.getRawImpressionGuid(t),{}),r.logMemoryUsageInWSBClient(t,"ZiRenderedMemoryUsage"));n!==undefined&&n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().endMark("RenderZeroInput");r.safeInstrumentPerf(t,function(n){n.SearchHomeRenderEvent=r.getOffsettedNow()},"instrumentSearchHomeRender",null)},r.instrumentRenderFinished=function(t,i,u,f,e){var o,s,h;if(n.config.perfInstV2&&(r===null||r===void 0?void 0:r._currentRender)<0)SharedLogHelper.LogError("instrumentRenderFinished","sequenceNumber: "+t,new Error("Invalid current render for sequence number"));else if(n.config.perfInstV2&&r._keystrokesPerfPingData[t]==undefined)SharedLogHelper.LogError("instrumentRenderFinished","sequenceNumber: "+t+" currentRender: "+r._currentRender,new Error("No keystrokesPerfPingData for sequence number"));else if(e||r._keystrokesPerfPingData[t].FirstRenderTime||(r._keystrokesPerfPingData[t].FirstRenderTime=r.getOffsettedNow()),n.config.perfInstV2){if(r._keystrokesPerfPingData[t].RendersCompleted[r._currentRender]=r.getOffsettedNow(),n.Host.getFCRCount()>-1&&(n.config.enableColdStartRanking||n.config.enableColdStartRanking1)&&(r._keystrokesPerfPingData[t].RendersColdRank[r._currentRender]=n.Host.getFCRCount()),n.isAnaheimDataEnabled(!0)||n.isAnaheimDataEnabled(!1)){if(n.AnaheimDataProvider===null||n.AnaheimDataProvider===void 0?void 0:n.AnaheimDataProvider.getANANumberMap){o=n.AnaheimDataProvider.getANANumberMap();for(s in o)r._keystrokesPerfPingData[t].AnaheimDataIndexCount[s]=o[s]}if(n.AnaheimDataParser===null||n.AnaheimDataParser===void 0?void 0:n.AnaheimDataParser.getANANumberMap){o=n.AnaheimDataParser.getANANumberMap();for(s in o)r._keystrokesPerfPingData[t].AnaheimDataIndexCount[s]=o[s]}}r._currentRender++}r.safeInstrumentPerf(t,function(n){var e=r.getOffsettedNow(),o="S"+i.join(",");n.renderGroupFinished[o]?f||(n.renderGroupFinished[o].iconsFinished=e):(i.forEach(function(t){return n.RenderFinished[t]=e}),n.renderGroupFinished[o]={iconsFinished:e,suggestionsFinished:e});r.tryInstrumentRenderStopped(t,n);r._clientTelemetry&&r._clientTelemetry.logGroupsRenderedMeasure(u)},"instrumentRenderFinished",i.join(","));h=r._keystrokesPerfPingData[t];h&&r.fireKeystrokeTimelineUpdatedHandlers(h)},r.instrumentSyntheticInstrumentedItem=function(n,t,i){var u=r._keystrokesInstrumentationData[n];u?u.PendingInstrumentedItems[t]=i:SharedLogHelper.LogError("instrumentSyntheticInstrumentedItem",t,new Error("keystrokesInstrumentationData not found"))},r.instrumentSyntheticSuggestion=function(n,t){var i=r._keystrokesInstrumentationData[n];i?i.PendingSyntheticSuggestions[t.type]=t:SharedLogHelper.LogError("instrumentSyntheticSuggestion",t.type,new Error("Instrumentation synthetic suggestion after flush"))},r.getInstrumentedSyntheticSuggestion=function(n,t){return r._keystrokesInstrumentationData[n].PendingSyntheticSuggestions[t]},r.instrumentDataSource=function(n,t,i,u){r.safeInstrument(n,function(n){var r,f,e;if(u&&u.rankerExtraInfo)for(r in u.rankerExtraInfo)n.RankerExtraInfo[r]=u.rankerExtraInfo[r];f=i||[];e=n.PendingDataSources[t];n.PendingDataSources[t]=e?e.concat(f):f},"instrumentDataSource",t)},r.processPendingDataSources=function(t){var i,s,u,f,h,e,o,c,l;for(i in t.PendingDataSources)if(s=t.PendingDataSources[i],s.length>0){for(u=[],f=0,h=s;f<h.length;f++)for(e=h[f],u.push(r._instrumentationProvider.createDataSourceObject(e)),o=0,c=e.subInstItems||[];o<c.length;o++)l=c[o],u.push(r._instrumentationProvider.createDataSourceObject(e,l));i=="Web"&&(i="WebAS");u.length>0&&(t.DataSources[i]={T:"D."+i,AppNS:n.InstrumentationCommon.DEFAULT_APP_NAMESPACE,Service:n.InstrumentationCommon.DEFAULT_SERVICE_NAME,Scenario:i,SC:u.length,DS:u})}t.PendingDataSources={}},r.instrumentSnRProviderFetchUrl=function(n,t){r.safeInstrument(n,function(n){n.SnRProviderFetchUrl=t},"instrumentSnRProviderFetchUrl")},r.onConversationStart=function(){if(r._conversationStartTimestamp=n.getCurrentTime(),r._searchServiceStatus=null,r._clientTelemetry){var t=n.Host.getConversationId();r._clientTelemetry.logConversationStartMeasure(t)}r._keystrokesPerfPingData=[];r._currentRender=0},r.getConversationStartTimestamp=function(){return r._conversationStartTimestamp},r.logDataSourceTimeout=function(n,t){r._instrumentationProvider.logDataSourceTimeout(n,t)},r.getPpoFromPpi=function(n){return typeof n.latency=="number"?{L:n.latency,T:n.previewPaneType}:{}},r.createKeystrokePerfPingEvent=function(t,i){var u={I:t,PL:i.PrefixLength,K:i.RequestBegin,F:i.DataSourcesFetchEnd,PPO:r.getPpoFromPpi(i.PreviewPaneOpened),PPC:r.getPpoFromPpi(i.PreviewPaneCanceled),RRT:i.ResponseReceived,RPT:i.ResponseParsed,MRT:i.MultipleResponsesReceived,RFT:i.RenderFinished,TRR:i.TopResultRendered,RS:undefined,PLT:undefined,HLT:undefined,FRT:undefined,IRFT:{},TRIR:[],MPT:i.MultipleResponsesParsed,CS:n.config.perfInstV2?i.ConversationStart:undefined,KS:n.config.perfInstV2?i.SequenceStart:undefined,RB:n.config.perfInstV2?i.RequestBegin:undefined,FS:n.config.perfInstV2?i.DataProviderFetchStart:undefined,FF:n.config.perfInstV2?i.DataProviderFetchFinish:undefined,PST:n.config.perfInstV2&&n.config.enableFetchStartLogging?i.DataProvidersStarted:undefined,PFT:n.config.perfInstV2?i.DataProvidersFinished:undefined,RC:n.config.perfInstV2?i.RendersCompleted:undefined,RCR:n.config.perfInstV2&&(n.config.enableColdStartRanking||n.config.enableColdStartRanking1)?i.RendersColdRank:undefined,PS:n.config.perfInstV2?i.PreviewPaneStart:undefined,PF:n.config.perfInstV2?i.PreviewPaneFinish:undefined,ANA:n.config.perfInstV2&&(n.config.enableAnaheimDataSH||n.config.enableAnaheimDataQF)?i.AnaheimDataIndexCount:undefined},o,h,v,s,c,l,f,e,a;for(e in i.renderGroupFinished)if(o=i.renderGroupFinished[e],o.iconsFinished!=o.suggestionsFinished)if(h=e.substr(1),e.startsWith("T"))u.TRIR.push({T:h,V:o.iconsFinished});else for(v=h.split(","),s=0,c=v;s<c.length;s++)l=c[s],u.IRFT[l]=Math.max(o.iconsFinished,u.IRFT[l]||0);if(r.renderingStopped(i)){f=0;for(e in i.renderGroupFinished)f=Math.max(f,i.renderGroupFinished[e].iconsFinished);i.FirstRenderTime&&(u.FRT=i.FirstRenderTime);f&&(i.AllRenderFinished=f,u.RS=f,f=Math.max(f,i.PreviewPaneOpened.latency||i.PreviewPaneCanceled.latency||0),i.PageLoadTime=f,u.PLT=f);i.SearchHomeRenderEvent!=n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE&&(u.HLT=Math.max(u.PLT-u.K,i.SearchHomeRenderEvent))}else a=r.getOffsettedNow(),u.RS=a,u.PLT=a;return n.InstrumentationCommon.createPerfPingEvent(i.ImpressionGuid,[u],"Keystroke",i.ConversationId,i.DataSourcesState,i.ResponseFromCache)},r.updatePageIG=function(n){_G.IG=r.getImpressionGuid(n)},r.createMasterPageImpression=function(t,u,f,e,o){var c={dataSources:o||[],layoutNodes:[],pageName:t,rawQuery:e?e.queryToFetch:"",isQuery:!1,impressionUrl:r.createVirtualImpressionURL(u,f),appName:r._instrumentationProvider.getApplicationName(),enrichedClientInfo:{FDPartnerEntry:i,nclid:_G.nclid,isOffline:n.isBrowserOnline()?0:1,webRequested:f?1:0}},s=n.safeExecute(function(){return r._instrumentationProvider.getEnrichedClientInfo(e)},"getEnrichedClientInfo"),h;if(s)for(h in s)c.enrichedClientInfo[h]=s[h];return c},r.logKeystrokeData=function(i){var f,e,u;(r.processPendingDataSources(i),n.TestHookUrlParameters&&r.addDuplicatesDataSource(i),f=Object.keys(i.DataSources).map(function(n){return i.DataSources[n]}).concat(r.createNonSuggestionsDataSource(i.PendingInstrumentedItems,i.PendingSyntheticSuggestions)),i.DataSources={},i.PendingSyntheticSuggestions={},i.PendingInstrumentedItems={},f.length==0&&i.MasterPageImpressionCreated)||(i.RenderingStarted&&(e=DsLManager.CreateLayoutNode(_d.body,n.InstrumentationCommon.DEFAULT_APP_NAMESPACE,!1,!0,i.MasterPageImpressionCreated)),i.MasterPageImpressionCreated?Log2.LogEvent("ClientInst",null,null,f,e,i.ImpressionGuid,null,null):(u=r.createMasterPageImpression(r._instrumentationProvider.getSuggestionsPageName(),t,i.SnRProviderFetchUrl?i.SnRProviderFetchUrl.substring(i.SnRProviderFetchUrl.indexOf("?")+1):"",i.Query,f),e&&(u.layoutNodes=e),i.FvSug&&Object.keys(i.FvSug).length>0&&(u.enrichedClientInfo.FvSug=i.FvSug),i.HuSug&&Object.keys(i.HuSug).length>0&&(u.enrichedClientInfo.HuSug=i.HuSug),u.clientTimestamp=i.OriginalTimestamp,r.logMasterPageImpression(i.ImpressionGuid,u),i.MasterPageImpressionCreated=!0))},r.logPerfPingEvent=function(t){Log2.LogEvent(t.EventType,t.Data,n.InstrumentationCommon.QFPERFPING_EVENT_NAME,null,null,t.ImpressionGuid,null,null);n.ClientTestHooks&&n.ClientTestHooks.DebugLogNoConsole("perfPingEvent",[t])},r.logMasterPageImpression=function(t,i){if(i){if(!t){SharedLogHelper.LogError("logMasterPageImpression",null,new Error("Missing impressionGuid"));return}i.impressionGuid=t;r._instrumentationProvider.logMasterPageImpression(i,n.Host.getConversationId());n.ClientTestHooks&&n.ClientTestHooks.DebugLogNoConsole("masterPageImpression",i,t)}},r.instrumentAppVisibleFinish=function(t){var i=n.getCurrentTime();r._conversationTimeline.AppVisibleStart=t;r._conversationTimeline.AppVisibleFinish=i},r.instrumentAppShownFinish=function(t){var i=n.getCurrentTime();r._conversationTimeline.AppShownStart=t;r._conversationTimeline.AppShownFinish=i},r.instrumentConversationTimelineFinish=function(){var t=_G.ServerIG,i,u;if(!t){SharedLogHelper.LogError("instrumentConversationTimelineFinish","Could not instrument as server IG not known",new Error("Could not instrument initilization finish"));return}r._conversationTimeline.RawImpressionGuid=n.Host.getRawImpressionGuid();r._conversationTimeline.ImpressionGuid=n.cleanGuid(r._conversationTimeline.RawImpressionGuid);r._conversationTimeline.ConversationId=n.Host.getConversationId();i={CID:r._conversationTimeline.ConversationId,ASB:r._conversationTimeline.AppShownStart,ASF:r._conversationTimeline.AppShownFinish,AVB:r._conversationTimeline.AppVisibleStart,AVF:r._conversationTimeline.AppVisibleFinish};u=n.InstrumentationCommon.createPerfPingEvent(t,[i],"ConversationTimeline",r._conversationTimeline.ConversationId);r.logPerfPingEvent(u)},r.instrumentInitializationFinish=function(t){var f=_G.ServerIG,i,u;if(!f){SharedLogHelper.LogError("instrumentInitializationFinish","Could not instrument as server IG not known",new Error("Could not instrument initilization finish"));return}if(i=n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,u=_w.performance,u&&u.timing&&(i=u.timing.navigationStart),!(i<=0)){var e=t.getTime()-i,o=n.getCurrentTime()-i,s=[{BLT:e,ILT:o}],h=n.InstrumentationCommon.createPerfPingEvent(f,s,"Load");r.logPerfPingEvent(h)}},r.getOffsettedNow=function(t){return t===void 0&&(t=n.getCurrentTime()),t-r._conversationStartTimestamp},r.createNonSuggestionsDataSource=function(t,i){var u=[],f,e;for(f in t)u.push(r._instrumentationProvider.createNonSuggestionDataSourceObject(f,t[f]));for(f in i)u.push(r._instrumentationProvider.createDataSourceObject(i[f]));return u.length?(e={T:"D.ContentGroup",AppNS:n.InstrumentationCommon.DEFAULT_APP_NAMESPACE,Service:n.InstrumentationCommon.DEFAULT_SERVICE_NAME,Scenario:"NonSuggestions",SC:u.length,DS:u},[e]):[]},r.createVirtualImpressionURL=function(t,i){var r=n.getWindowProtocol()+"//"+n.getWindowHost()+t;return r+=i?i:n.Service.QueryParams.ConversationId+"="+n.encodeQueryParameter(n.Host.getConversationId()),_G.ServerIG&&(r+="&ASInitIG="+n.encodeQueryParameter(_G.ServerIG)),r},r._clientShownTimestamp=n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,r._conversationStartTimestamp=n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,r._currentRender=0,r._keyDownTimeStamp=n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,r._keystrokesPerfPingData={},r._keystrokesInstrumentationData={},r._keystrokeTimelineUpdatedHandlers=[],r._finalizeKeystrokeHandlers=[],r}();n.InstrumentationHelper=r}(WSB||(WSB={})),function(n){var t="&nclid=",i="&ts=",r="&nclidts=",u="&tsms=",f="&elv=",e="&cc=",o="&setlang=",s="&cvid=",h="&qs=",c="&ao=",l="&wsso=",a=function(){function a(t,i){if(t===void 0&&(t=Date.now),i===void 0&&(i=n.getWindowProtocol()+"//"+n.getWindowHost()),this.getNowTimestamp=t,this._baseUrl=i,n.config.overrideHost){var r=n.getWindowHost();r.startsWith("www.")&&(this._baseUrl=n.getWindowProtocol()+"//"+n.config.overrideHost+r.substring(3))}}return a.prototype.getSearchUrl=function(t,i,r,u,e,o,s,h,a,v){var p,y,w,b,k;return u||(r==="MBV"&&e===21?(u="/work/search?q="+n.encodeQueryParameter(i),v&&(u+="&inithash="+v),o=n.mapOSFormCode("WSBWS0")):(p=this.getVerticalFromHandoffType(e),u=(p?"/"+p:"")+"/search?q="+n.encodeQueryParameter(i))),y=this._baseUrl+u,y+=(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.isWindowsTest)?"&form=MONITR&traffictype=wintest":"&form="+n.encodeQueryParameter(o||n.Host.getFormCode()),a&&(y+=c+"1"),y=this.enrichUrlWithSuggestionType(y,h?"P":r),y=this.enrichUrlWithCvid(y),n.config.suppressPqParameter||(y+="&pq="+n.encodeQueryParameter(t)),w=n.Host.getMSNRefIg(),w&&(y+="&refig="+w),y=this.enrichUrlWithMarketInfo(y),y=this.enrichUrlWithDeviceInfo(y),s||(y=this.enrichUrlWithMuidInfo(y),b=n.Host.getElToken(),b&&this._baseUrl.startsWith("https:")&&(y+=f+n.encodeQueryParameter(b)),y=this.enrichUrlWithSafeSearchInfo(y)),k=n.Host.getSafeSearchSetting(),k&&(y+=l+k),y},a.prototype.getImageSearchUrl=function(){var t=this._baseUrl+"/images/detail/upload?FORM="+n.mapOSFormCode("SBIWSB");return(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.isWindowsTest)&&(t+="&isWindowsTest=1&traffictype=Test"),t},a.prototype.getVerticalFromHandoffType=function(n){return n===13?"images":n===14?"videos":n===15?"shop":""},a.prototype.enrichUrlWithDeviceInfo=function(t){n.Host.isEducationEnvironment()&&(t+="&DAF0=1");n.Host.isWindowsS()&&(t+="&DAF1=1");var i=n.Host.getPartnerSearchCode();return i&&(t+="&PC="+i),t},a.prototype.enrichUrlWithMarketInfo=function(t){var i=n.Host.getRegion(),r=n.Host.getLanguage();return i&&(t+=e+i),r&&(t+=o+r),t},a.prototype.enrichUrlWithSafeSearchInfo=function(t){return n.Host.getSafeSearchSetting()=="Strict"?t+"&adlt=strict":t},a.prototype.enrichUrlWithMuidInfo=function(f){var e,o,s;return _G.nclid&&(f+=t+n.encodeQueryParameter(_G.nclid),e=this.getNowTimestamp().toString(),f+=i+n.encodeQueryParameter(e),o=e.substring(0,e.length-3),f+=r+n.encodeQueryParameter(o),s=e.substring(e.length-3),f+=u+n.encodeQueryParameter(s)),f},a.prototype.enrichUrlWithCvid=function(t){return t+(s+n.encodeQueryParameter(n.Host.getConversationId()))},a.prototype.enrichUrlWithSuggestionType=function(t,i){return t+(h+n.encodeQueryParameter(i))},a}();n.NavigationHelper=a}(WSB||(WSB={})),function(n){var t=function(){function t(t){var i=this;this._selectableItemsContainer=t;n.Host.bindKeyDown(function(r,u,f){var e=!1;r==9?e=i.selectFirstItemInNextGroup(u&&u.shiftKey):n.isUpOrDownKey(r)&&(e=i.selectNextItem(n.isUpKey(r)));t.onAfterKeyDown(r,u,f,e)})}return t.prototype.selectFirstItemInNextGroup=function(t){var i=this._selectableItemsContainer.getSelectableItemsByGroup(),u;if(i.length==0)return!1;var f=this._selectableItemsContainer.getSelectedItem(),r=i.findIndex(function(t){return n.contains(t,f)}),e=r<0?-1:i[r].findIndex(function(n){return n==f});return(f&&f.onUnselected&&f.onUnselected(),r<0?u=i[0][0]:t&&e>0?u=i[r][0]:t?r>0&&(u=i[r-1][0]):r+1<i.length&&(u=i[r+1][0]),u)?(this._selectableItemsContainer.select(u,!0),u.onSelected&&u.onSelected(),!0):!1},t.prototype.selectNextItem=function(t){var i=this._selectableItemsContainer.getSelectableItems(),r,u,e,f;return i.length==0?!1:(r=this._selectableItemsContainer.getSelectedItem(),u=r?i.findIndex(function(n){return n.id===r.id}):-1,r&&r.onUnselected&&r.onUnselected(),e=t?u==0:u==i.length-1,e&&n.RuntimeConfig.AllowKeyboardNavOffCanvas)?(this._selectableItemsContainer.select(null,!0),!0):e&&!n.RuntimeConfig.AllowKeyboardNavCycling?!1:(f=t?u<=0?i.length-1:u-1:(u+1)%i.length,this._selectableItemsContainer.select(i[f],!0),i[f]&&i[f].onSelected&&i[f].onSelected(),!0)},t}();n.KeyboardEvtHandler=t}(WSB||(WSB={}));__spreadArrays=this&&this.__spreadArrays||function(){for(var i=0,n=0,r=arguments.length;n<r;n++)i+=arguments[n].length;for(var u=Array(i),f=0,n=0;n<r;n++)for(var e=arguments[n],t=0,o=e.length;t<o;t++,f++)u[f]=e[t];return u},function(n){var t=function(){function t(n,t){this._aggregator=n;this._rootViewModel=t;this._sequenceNumber=-1;this._suggestionsQueue={};this._dataSourcesCompleted={}}return t.prototype.initiateSequenceNumber=function(t,i,r){var u=this,e,o,f,h,s;if(this._sequenceNumber>=t){SharedLogHelper.LogError("initiateSequenceNumber",null,new Error("Unexpected sequence number"));return}for(this.resetStateForNewQuery(t,i),this._highPriorityDataSources=[],this._normalPriorityDataSources=[],this._lowPriorityDataSources=[],e=0,o=n.config.enabledDataSources;e<o.length;e++)f=o[e],h=i.enabledDataSources[f],h&&(n.config.lowPriorityDataSources[f]?this._lowPriorityDataSources.push(f):n.config.highPriorityDataSources[f]?this._highPriorityDataSources.push(f):this._normalPriorityDataSources.push(f));this._HighPriDoneProcessing=this._highPriorityDataSources.length==0;this._highPriorityDataSources.length==0&&this._normalPriorityDataSources.length==0&&this._lowPriorityDataSources.length==0?this.processSuggestions(!1):(s=this.getLatencyTimeout(),s>0&&(this._bufferingTimer=n.safeSetTimeout(function(){u._bufferingTimer=null;u.processSuggestions(!0)},s,"processSuggestionsBuffering"),n.config.dataSourceTimeLimit&&(this._processingTimeoutTimer=n.safeSetTimeout(function(){u._processingTimeoutTimer=null;var t=__spreadArrays(u._highPriorityDataSources.filter(function(t){return!n.contains(u._arrivedDataSources,t)}),u._normalPriorityDataSources.filter(function(t){return!n.contains(u._arrivedDataSources,t)}),u._lowPriorityDataSources.filter(function(t){return!n.contains(u._arrivedDataSources,t)}));SharedLogHelper.LogError("SuggestionsRenderingManager",t.join(","),new Error("Data provider did not complete before the time limit"));u._processingStopped=!0;u._allDataSourcesArrived=!0;u.processSuggestions(!1);r&&r()},n.config.dataSourceTimeLimit,"processSuggestionsTimeout"))))},t.prototype.getLatencyTimeout=function(){return this._partialQuery.queryToFetch?n.config.latencyTimeout:n.config.latencyTimeoutForZeroInput},t.prototype.queueSuggestions=function(t,i,r,u,f){var e;if(t>this._sequenceNumber){SharedLogHelper.LogError("queueSuggestions",null,new Error("Unexpected sequence number"));return}if(!(t<this._sequenceNumber)){if(this._dataSourcesCompleted[i]){SharedLogHelper.LogError("queueSuggestions",i,new Error("Data source already completed"));return}if(!n.contains(this._highPriorityDataSources,i)&&!n.contains(this._normalPriorityDataSources,i)&&!n.contains(this._lowPriorityDataSources,i)){SharedLogHelper.LogError("queueSuggestions",i,new Error("Unexpected data source"));return}this._allDataSourcesArrived||(this._suggestionsQueue[i]&&!this._suggestionsQueue[i].updated?(e=this._suggestionsQueue[i].suggestions).push.apply(e,r):this._suggestionsQueue[i]={suggestions:r,updated:!1},this._dataSourcesCompleted[i]=!f,u&&(this._extraSignalsMap[i]=u),f||this._arrivedDataSources.push(i),this._allDataSourcesArrived=this.haveAllDataSourcesArrived(this._highPriorityDataSources.concat(this._normalPriorityDataSources).concat(this._lowPriorityDataSources)),this._processingStopped||n.InstrumentationHelper.isLayoutLogged(this._sequenceNumber)?this._allDataSourcesArrived&&(this.resetTimers(),n.InstrumentationHelper.notifyAllDataSourcesProcessed(this._sequenceNumber)):this.processSuggestions(!1))}},t.prototype.resetTimers=function(){this._bufferingTimer&&(sb_ct(this._bufferingTimer),this._bufferingTimer=null);this._processingTimeoutTimer&&(sb_ct(this._processingTimeoutTimer),this._processingTimeoutTimer=null)},t.prototype.resetStateForNewQuery=function(t,i){this._arrivedDataSources=[];this._allProcessedDataSources={};this._sequenceNumber=t;this._partialQuery=i;this._suggestionsQueue={};this._dataSourcesCompleted={};this._extraSignalsMap={};this._renderedThisSequenceNumber=!1;this._waitingForMoreResults=!0;this._processingStopped=!1;this._allDataSourcesArrived=n.isEmpty(i.enabledDataSources);this.resetTimers()},t.prototype.getDependencies=function(t){var i=this;return n.Host.dataSourceDependencies(t).filter(function(t){return n.isDataSourceEnabled(t,i._partialQuery)})},t.prototype.haveAllDataSourcesArrived=function(t){var i=this;return n.config.mergeQueries&&this._partialQuery.scope==n.Scope.Documents?t.every(function(n){switch(n){case"MPHO":case"MVID":case"MDOC":return!!i._partialQuery.enabledDataSources.MPHO&&!!i._partialQuery.enabledDataSources.MVID&&!!i._partialQuery.enabledDataSources.MDOC&&!!i._partialQuery.enabledDataSources.MPVD;default:return!!i._suggestionsQueue[n]}}):t.every(function(n){return!!i._suggestionsQueue[n]})&&this.haveCacheBackedDataSourcesArrived(t)},t.prototype.haveCacheBackedDataSourcesArrived=function(t){var u,f,s,h;if(this._partialQuery.isSearchHomeZI&&n.isMsbQwsDocsCacheEnabled(this._partialQuery)){var i="SSUE",r="SREE",c=!!this._partialQuery.enabledDataSources[i]&&n.isDocSourceEnabledInQws(i),l=!!this._partialQuery.enabledDataSources[r]&&n.isDocSourceEnabledInQws(r),e=!1,o=!1;return t.forEach(function(n){n==i?e=!0:(n=r)&&(o=!0)}),u=e&&c,f=o&&l,u||f?(s=u&&this._dataSourcesCompleted[i],h=f&&this._dataSourcesCompleted[r],s||h):!0}return!0},t.prototype.haveAllDataSourcesCompleted=function(t){var i=this;return n.config.mergeQueries&&this._partialQuery.scope==n.Scope.Documents?t.every(function(n){switch(n){case"MPHO":case"MVID":case"MDOC":return!!i._partialQuery.enabledDataSources.MPHO&&!!i._partialQuery.enabledDataSources.MVID&&!!i._partialQuery.enabledDataSources.MDOC&&!!i._partialQuery.enabledDataSources.MPVD;default:return!!i._dataSourcesCompleted[n]}}):t.every(function(n){return!!i._dataSourcesCompleted[n]})},t.prototype.processSuggestions=function(t){var i=this,u=[],o=[],r,y=this.getLatencyTimeout()>0&&this._bufferingTimer==null,s=this.haveAllDataSourcesArrived(this._highPriorityDataSources),h=s||y,p=this.haveAllDataSourcesCompleted(this._normalPriorityDataSources),c=this.haveAllDataSourcesCompleted(this._highPriorityDataSources),l=c&&p,a,v;t&&n.InstrumentationHelper.logDataSourceTimeout(Object.keys(this._suggestionsQueue),this._partialQuery);var f=t&&!this._renderedThisSequenceNumber,w=function(t,e){var s;if(!t.updated&&i.getDependencies(e).every(function(t){return n.contains(i._arrivedDataSources,t)})){if(o.push(e),i._allProcessedDataSources[e]=!0,t.suggestions.length>0&&(s=i.canHaveSuppressions(e)?t.suggestions.filter(function(n){return!i.isSuppressed(e,n)}):t.suggestions,s.length>0)){r||(r=i._renderedThisSequenceNumber?i._rootViewModel.getSuggestions(!0):[]);var h=i.removeDuplicatesAndAssignIds(s,r,u,e),c=h[0],l=h[1];u=u.concat(c);l&&(f=!0)}t.updated=!0}},e=function(n){var u,t,r;for(u in n)t=n[u],r=i._suggestionsQueue[t],r&&w(r,t)};h&&e(this._highPriorityDataSources);this._bufferingTimer&&l&&(sb_ct(this._bufferingTimer),this._bufferingTimer=null);a=h&&!this._HighPriDoneProcessing;v=a||(this.getLatencyTimeout()>0?this._bufferingTimer==null:s);v&&(e(this._normalPriorityDataSources),e(this._lowPriorityDataSources));this._waitingForMoreResults&&l&&(this._waitingForMoreResults=!1,(!this._renderedThisSequenceNumber||this._rootViewModel.mayNeedFlush()||(r||this._rootViewModel.getSuggestions(!0)).length==0)&&(f=!0));this._partialQuery.showProgressBar&&this._allDataSourcesArrived&&(f=!0);(u.length>0||f)&&(r||(r=this._renderedThisSequenceNumber?this._rootViewModel.getSuggestions(!0):[]),this.addSuggestions(r,u,o,f));this._allDataSourcesArrived&&(this.resetTimers(),n.InstrumentationHelper.notifyAllDataSourcesProcessed(this._sequenceNumber),this._rootViewModel.toggleProgressBar(!1));this._HighPriDoneProcessing=c},t.prototype.getAggregatorResult=function(t,i,r){var e=this.waitingForWebProvider(),f=null,u,o;return n.config.counterFactualLoggingOn&&(f=this._aggregator.rank(i,r,this._extraSignalsMap,this._partialQuery,t,this._sequenceNumber,e,!0)),u=this._aggregator.rank(i,r,this._extraSignalsMap,this._partialQuery,t,this._sequenceNumber,e,!1),o=n.config.counterFactualLoggingOn&&(!this.isSuggestionOrderTheSame(u.topResults,f.topResults)||!this.isSuggestionOrderTheSame(u.suggestionsToAdd,f.suggestionsToAdd)),[u,o]},t.prototype.waitingForWebProvider=function(){var t=this;return n.isBrowserOnline()&&["Web"].concat(this.getDependencies("Web")).some(function(i){return n.isDataSourceEnabled(i,t._partialQuery)&&!t._allProcessedDataSources[i]})},t.prototype.isSuggestionOrderTheSame=function(n,t){var r=function(n){return n.query+"\t"+n.type},i;if(n.length!=t.length)return!1;for(i=0;i<n.length;i++)if(r(n[i])!=r(t[i]))return!1;return!0},t.prototype.addSuggestions=function(t,i,r,u){var e=this,o=this._renderedThisSequenceNumber?this._rootViewModel.getCurrentTopResults():[],v=n.safeExecute(function(){return e.getAggregatorResult(o,t,i)},"getAggregatorResults",[null,!1]),f=v[0],p=v[1],s,h,l,c,a,y;for(f||(f={topResults:o,suggestionsToAdd:i,suggestionsToRemove:[],groupOrder:[]}),n.InstrumentationHelper.instrumentAggregatorCall(this._sequenceNumber,p),n.shouldShowDSBLayout(this._partialQuery)&&n.InstrumentationHelper.instrumentDSB(),i=f.suggestionsToAdd,s=f.suggestionsToRemove,h=0,l=f.topResults;h<l.length;h++)c=l[h],n.contains(t,c)&&!n.contains(o,c)&&s.push(c);(u||i.length!=0||s.length!=0||!n.sequenceEqual(o,f.topResults))&&(a=!this._renderedThisSequenceNumber,a&&(this._renderedThisSequenceNumber=!0,n.InstrumentationHelper.instrumentRenderingStarted(this._sequenceNumber)),y=n.safeExecute(function(){return e._rootViewModel.update(a,f.topResults,e._waitingForMoreResults,e._sequenceNumber,i,s,r,f.groupOrder,e._allDataSourcesArrived,e._extraSignalsMap)},"rootViewModel.update",0,null,function(t){n&&n.fallbackToPrepopulatedBundle&&n.fallbackToPrepopulatedBundle(t)}),y==0&&(this._processingStopped=!0,this.resetTimers()))},t.prototype.removeDuplicatesAndAssignIds=function(t,i,r,u){var f=this,c=function(n){var t;n.id||(n.id=n.path?n.path:n.type+n.text+((t=n.additionalInfoText)!==null&&t!==void 0?t:""))},h=!1,s;if(this._aggregator.canHaveDuplicates(u,this._partialQuery)){var o=[],l=function(s){var v=t[s],a=i.findIndex(function(n){return f._aggregator.mergeDuplicates(f._partialQuery,n,v)}),l;if(a>=0)return l=i[a],l.needsRefreshAfterDeduping&&(h=!0),n.InstrumentationHelper.instrumentDuplicate(e._sequenceNumber,l,v),"continue";if(a=r.findIndex(function(n){return f._aggregator.mergeDuplicates(f._partialQuery,n,v)}),a>=0){var l=r[a],y=null,p=n.config.msbReplaceDupLocalFiles&&v.type==="MFIL"&&l.type==="FL";return p&&(y=e.replaceSuggestionInList(r,a,v),l=r[a]),l.needsRefreshAfterDeduping&&(l.needsRefreshAfterDeduping=!1,l.previewPaneNeedsRefreshAfterDeduping=!1),n.InstrumentationHelper.instrumentDuplicate(e._sequenceNumber,l,y!==null&&y!==void 0?y:v),"continue"}if(e._aggregator.canHaveDuplicatesWithinDataSource(u,e._partialQuery)&&(a=o.findIndex(function(n){return f._aggregator.mergeDuplicates(f._partialQuery,n,v)}),a>=0))return l=o[a],l.needsRefreshAfterDeduping&&(l.needsRefreshAfterDeduping=!1,l.previewPaneNeedsRefreshAfterDeduping=!1),n.InstrumentationHelper.instrumentDuplicate(e._sequenceNumber,o[a],v),"continue";c(v);o.push(v)},e=this;for(s=0;s<t.length;++s)l(s);return[o,h]}return t.forEach(function(n){return c(n)}),[t,h]},t.prototype.canHaveSuppressions=function(t){return n.config.suppressDataSources[t]||n.config.dataSourcesWithSuppressedTypes[t]},t.prototype.isSuppressed=function(t,i){return n.config.suppressDataSources[t]||n.config.suppressTypes[i.type]},t.prototype.replaceSuggestionInList=function(n,t,i){var r=n[t];return r?(i.duplicates=r.duplicates,i.needsRefreshAfterDeduping=!0,i.previewPaneNeedsRefreshAfterDeduping=!0,n[t]=i,r):r},t}();n.SuggestionsRenderingManager=t}(WSB||(WSB={})),function(n){function y(n){return n.handoffType==1?n.query:HitHighlightingParser.removeMarkers(n.text)}function f(n){var t,i;if(n.length==0)return 0;for(t=0,i=0;i<n.length;i++)t=(t<<5)-t+n.charCodeAt(i)|0;return t}function t(n,t){var u,i,r;if(!n)return t.length;if(!t)return n.length;for(u=[],i=0;i<=t.length;i++)u[i]=[i];for(r=0;r<=n.length;r++)u[0][r]=r;for(i=1;i<=t.length;i++)for(r=1;r<=n.length;r++)u[i][r]=t.charAt(i-1)==n.charAt(r-1)?u[i-1][r-1]:Math.min(u[i-1][r-1]+1,Math.min(u[i][r-1]+1,u[i-1][r]+1));return u[t.length][n.length]}function p(n,i){return n&&(n=n.toLocaleLowerCase()),i&&(i=i.toLocaleLowerCase()),t(n,i)}function o(n,t,i){var r=0,u;return(t>0||i>0)&&(t>0&&i>0?(i>t&&(u=t,t=i,i=u),r=n/(t-n+i)):r=Number.MAX_VALUE),r}function s(n,t){var r=n.length,e=t.length,a,v,f,o,i;if(r===0&&e===0)return 1;var h=new Array(r),s=new Array(e),u=0,c=0,l=Math.floor(Math.max(r,e)/2)-1;for(i=0;i<r;i++)for(a=Math.max(0,i-l),v=Math.min(e,i+l+1),f=a;f<=v;f++)if(!s[f]&&n[i]==t[f]){h[i]=!0;s[f]=!0;u++;break}if(u===0)return 0;for(o=0,i=0;i<r;i++)if(h[i]){while(!s[o])o++;n[i]!=t[o]&&c++;o++}return(u/r+u/e+(u-c/2)/u)/3}function w(n,t){var i=s(n,t),r,u;return i<1?i:(r=.1,u=h(n,t),i+u*r*(1-i))}function h(n,t){for(var i=0;i<4;i++)if(n[i]!=t[i])return i;return++i}function b(n,t){return!n||!t?0:n.length+1<=t.length&&t[n.length]==" "?1:n.length==t.length?1:0}function k(n){var r=0,i=1,t;if(n&&n.length>1)for(t=1;t<n.length;t++)n.charAt(t)==n.charAt(t-1)?i++:i=1,i>r&&(r=i);else if(n)return 1;return r}function d(n){return n&&n.length>0?n.trim().split(" ").length:0}function g(n){var t=new RegExp("^[0-9a-zA-Z ]+$");return n&&t.test(n)?1:0}function nt(n){return n&&n.length>0&&n.charAt(n.length-1)==" "?1:0}function tt(n){return n&&n.length>0&&(n.includes("http://")||n.includes("https://")||n.includes("."))?1:0}function it(t,i,r,u){var o,e,s,h;t.includes("?")&&(r[117]=1,ot(t)&&(r[127]=1));t.replace("///","").replace("//","").includes("/")&&(r[118]=1);t.includes(".")&&(r[119]=1);o=u.cvid+u.privacyNumber+t;r[120]=f(o);e=t.toLocaleLowerCase();(e.startsWith("www.")||e.startsWith("http://www.")||e.startsWith("https://www."))&&(r[122]=1);e.startsWith("www.")||e.startsWith("http://")?r[123]=1:e.startsWith("https://")?r[124]=1:e.startsWith("ftp://")?r[125]=1:r[126]=1;i&&(s=n.normalizeUrl(e,15),h=n.normalizeUrl(i,15).toLocaleLowerCase(),s.startsWith(h)&&(r[187]=1))}function rt(n,i,r,u,e){if(e){r[128]=t(e,i);r[129]=e.length;var o=u.cvid+u.privacyNumber+e;r[130]=f(o)}}function ut(n,i,r){var e=n.toLocaleLowerCase(),s,u,f,h,c;if(r[140]=n.length,s=e.split(" "),r[144]=s.length,i)for(r[141]=t(n,i),r[142]=Math.min(100,o(r[141],i.length,n.length)),u=i.toLocaleLowerCase(),e.includes(u)&&(r[143]=1),e.startsWith(u)&&(r[188]=1),f=0,h=s;f<h.length;f++)if(c=h[f],c==u){r[145]=1;break}}function ot(n){var t=et.find(function(t){return n.startsWith(t)});return n=t?n.substr(t.length):n,ft.some(function(t){return n.startsWith(t)})}function st(n){var i=0,r,t;if(n)for(r in n)t=n[r],t&&t.prefixLaunchCount&&(i+=t.prefixLaunchCount);return i}function ht(t,i,r,u){if(r){var f=r[t];f&&(i[47]=f.prefixLaunchCount,i[49]=f.lastLaunchTime,i[101]=u,u>0&&(i[100]=f.prefixLaunchCount/u),f.previewPaneLaunchCount&&f.lastPreviewPaneLaunchTime&&(i[301]=f.previewPaneLaunchCount,f.lastPreviewPaneLaunchTime==f.lastLaunchTime&&(i[302]=1),i[303]=n.getCurrentTime()-f.lastPreviewPaneLaunchTime))}}function ct(n,t,i){if(i){var r=i[n];r&&(t[281]=r.probability,t[282]=r.weight)}}function lt(n,t,r,u,f,e){if(t){var s=i(u,r),o=t[s];o&&(f?(n[153]=o.ProbSugClickGivenPref,n[152]=o.ClicksOnSugGivenPref):e?(n[161]=o.Loglikelihood,n[162]=o.ProbSugClickGivenBackground,n[163]=o.ClicksOnSugGivenPref,n[164]=o.ProbSugClickGivenPref,n[165]=o.CCR,n[166]=o.EventCount,n[293]=o.ProbSugClickGivenPrefTime,n[168]=o.CCRTime,n[294]=o.ProbSugClickGivenBackgroundTime,n[295]=o.LoglikelihoodTime):(n[6]=o.Loglikelihood,n[3]=o.ProbSugClickGivenBackground,n[151]=o.ClicksOnSugGivenPref,n[0]=o.ProbSugClickGivenPref,n[94]=o.CCR,n[95]=o.EventCount,n[290]=o.ProbSugClickGivenPrefTime,n[155]=o.CCRTime,n[291]=o.ProbSugClickGivenBackgroundTime,n[292]=o.LoglikelihoodTime))}}function at(n,t,i){if(t){var r=t[i];r&&(n[256]=r.PSGPCR,n[257]=r.PSGCCR,n[258]=r.PSGSTR,n[286]=r.PSGSATCCR,n[287]=r.PSGSATPCR)}}function i(n,t){return(n+"\t"+t).toLocaleLowerCase()}function r(t,i,r){i==11..toString()&&i==0..toString();switch(n.config.athenaKeyType){case 0:return t||SharedLogHelper.LogError("getAthenaGroupKey",null,new Error("Athena key group is empty")),t;case 1:return i||SharedLogHelper.LogError("getAthenaGroupKey",null,new Error("Athena key handoff is empty")),i;case 2:return r||SharedLogHelper.LogError("getAthenaGroupKey",null,new Error("Athena key suggestion type is empty")),i||SharedLogHelper.LogError("getAthenaGroupKey",null,new Error("Athena key handoff is empty")),r+"_"+i;default:return SharedLogHelper.LogError("getAthenaGroupKey",null,new Error("Athena key group type is not set")),""}}function u(t,i,r){switch(n.config.athenaKeyType){case 0:return i==t;case 1:return r==t;case 2:return r==t;default:return!1}}function vt(t){var i={};return t?(n.config.athenaKeyType==2?wt(t,i):(yt(t,i),pt(t,i)),i):i}function yt(t,f){var y=t.Suggestions?t.Suggestions.split("\t"):[],p=t.ProbSugClickGivenPrefs?t.ProbSugClickGivenPrefs.split("\t"):[],w=t.ClicksOnSugGivenPrefs?t.ClicksOnSugGivenPrefs.split("\t"):[],b=t.ProbSugClickGivenBackground?t.ProbSugClickGivenBackground.split("\t"):[],k=t.Loglikelihoods?t.Loglikelihoods.split("\t"):[],a=t.SuggestionGroups?t.SuggestionGroups.split("\t"):[],d=t.ProbSugClickGivenPrefWeeks?t.ProbSugClickGivenPrefWeeks.split("\t"):[],v=t.ProbSugClickGivenPrefWeekends?t.ProbSugClickGivenPrefWeekends.split("\t"):[],g=t.ProbSugClickGivenBackgroundWeeks?t.ProbSugClickGivenBackgroundWeeks.split("\t"):[],it=t.ProbSugClickGivenBackgroundWeekends?t.ProbSugClickGivenBackgroundWeekends.split("\t"):[],nt=t.LoglikelihoodWeeks?t.LoglikelihoodWeeks.split("\t"):[],tt=t.LoglikelihoodWeekends?t.LoglikelihoodWeekends.split("\t"):[],c=n.config.athenaKeyType==0||!t.SuggestionHandOffTypes?[]:t.SuggestionHandOffTypes.split("\t"),s=y.length,l=e(),o;if(u(s,a.length,c.length))for(o=0;o<s;o++){var rt=a&&a.length>o?a[o]:"",ut=c&&c.length>o?c[o]:"",ft=r(rt,ut,""),h=i(y[o],ft);f[h]={SuggestionGroup:+a[o]};b.length==s&&(f[h].ProbSugClickGivenBackground=Number(b[o]));p.length==s&&(f[h].ProbSugClickGivenPref=Number(p[o]));w.length==s&&(f[h].ClicksOnSugGivenPref=Number(w[o]));k.length==s&&(f[h].Loglikelihood=Number(k[o]));n.config.athenaKeyType!=0&&c.length==s&&(f[h].SuggestionHandOffType=Number(c[o]));d.length!=s||l?v.length==s&&l&&(f[h].ProbSugClickGivenPrefTime=Number(v[o])):f[h].ProbSugClickGivenPrefTime=Number(d[o]);g.length!=s||l?v.length==s&&l&&(f[h].ProbSugClickGivenBackgroundTime=Number(it[o])):f[h].ProbSugClickGivenBackgroundTime=Number(g[o]);nt.length!=s||l?tt.length==s&&l&&(f[h].LoglikelihoodTime=Number(tt[o])):f[h].LoglikelihoodTime=Number(nt[o])}else SharedLogHelper.LogError("parseLLSignals",null,new Error("Length doesn't match"))}function pt(t,f){var a=t.CCRSuggestions?t.CCRSuggestions.split("\t"):[],l=t.CCRSuggestionGroups?t.CCRSuggestionGroups.split("\t"):[],v=t.CCRs?t.CCRs.split("\t"):[],y=t.EventCounts?t.EventCounts.split("\t"):[],c=n.config.athenaKeyType==0||!t.CCRSuggestionHandOffTypes?[]:t.CCRSuggestionHandOffTypes.split("\t"),p=t.CCRsWeek?t.CCRsWeek.split("\t"):[],w=t.CCRsWeekend?t.CCRsWeekend.split("\t"):[],s=a.length,b=e(),o;if(u(s,l.length,c.length))for(o=0;o<s;o++){var k=l&&l.length>o?l[o]:"",d=c&&c.length>o?c[o]:"",g=r(k,d,""),h=i(a[o],g);f[h]||(f[h]={SuggestionGroup:Number(l[o])});v.length==s&&(f[h].CCR=Number(v[o]));y.length==s&&(f[h].EventCount=Number(y[o]));n.config.athenaKeyType!=0&&c.length==s&&(f[h].CCRSuggestionHandOffType=Number(c[o]));p.length!=s||b?w.length==s&&b&&(f[h].CCRTime=Number(w[o])):f[h].CCRTime=Number(p[o])}else SharedLogHelper.LogError("parseCCRSignals",null,new Error("Length doesn't match"))}function wt(n,t){var o=n.SugTypes?n.SugTypes.split("\t"):[],s=n.HandOffTypes?n.HandOffTypes.split("\t"):[],h=n.PSGPCRs?n.PSGPCRs.split("\t"):[],c=n.PSGCCRs?n.PSGCCRs.split("\t"):[],l=n.PSGSTRs?n.PSGSTRs.split("\t"):[],a=n.PSGSATCCRs?n.PSGSATCCRs.split("\t"):[],v=n.PSGSATPCRs?n.PSGSATPCRs.split("\t"):[],f=o.length,i;if(u(f,0,s.length))for(i=0;i<f;i++){var y=o[i],p=s[i],e=r("",p,y);t[e]={};h.length==f&&(t[e].PSGPCR=Number(h[i]));c.length==f&&(t[e].PSGCCR=Number(c[i]));l.length==f&&(t[e].PSGSTR=Number(l[i]));a.length==f&&(t[e].PSGSATCCR=Number(a[i]));v.length==f&&(t[e].PSGSATPCR=Number(v[i]))}else SharedLogHelper.LogError("parseGroupEngagementSignals",null,new Error("Length doesn't match"))}function bt(n,t){var r={},f,s,o,i;if(t){var h=0,v=0,u={};for(f=0,s=t;f<s.length;f++){var y=s[f],e=y.key,p=y.value;u[e]={lexicalSimilarity:0,groupClickCounts:{},groupWeight:{}};v+=c(u,e,n);o=a(p);u[e].groupClickCounts=o.groupLaunches;for(i in u[e].groupClickCounts)r[i]||(r[i]={probability:0,weight:0}),r[i].probability+=o.groupHits[i],h+=o.groupHits[i]}l(r,u,v,h)}return r}function kt(n,t){var r={},f,o,i;if(t){var h=0,a=0,u={};for(f=0,o=t;f<o.length;f++){var v=o[f],s=v.key,e=v.value;u[s]={lexicalSimilarity:0,groupClickCounts:{},groupWeight:{}};a+=c(u,s,n);for(i in e)e[i]&&e[i].prefixLaunchCount&&(r[i]||(r[i]={probability:0,weight:0}),u[s].groupClickCounts[i]=e[i].prefixLaunchCount,r[i].probability++,h++)}l(r,u,a,h)}return r}function c(n,t,i){var r=t.length-i.length,u=r/t.length;return n[t].lexicalSimilarity=1-u,n[t].lexicalSimilarity}function l(n,t,i,r){var o=0,s,e,f,u;for(e in t){f=t[e];f.lexicalSimilarity/=i;for(u in f.groupClickCounts)s=f.groupClickCounts[u],f.groupWeight[u]=s*f.lexicalSimilarity,o+=f.groupWeight[u]}for(u in n)n[u].probability/=r;for(e in t){f=t[e];for(u in f.groupClickCounts)n[u]||(n[u]={probability:0,weight:0}),f.groupWeight[u]/=o,n[u].weight+=f.groupWeight[u]}}function a(n){var u=function(n,t,i){return n[t]=n[t]?n[t]+i:i},r={groupLaunches:{},groupHits:{},otherGroupLaunches:0},f,t,i;for(f in n)(t=n[f],t&&t.prefixLaunchCount)&&(i=t.groupType,i||i===0?(u(r.groupLaunches,i,t.prefixLaunchCount),u(r.groupHits,i,1)):r.otherGroupLaunches+=t.prefixLaunchCount);return r}function dt(n,t,i,r){if(r){var f=i(t),u=r[f];u&&(n[266]=u.probability,n[267]=u.weight)}}function e(t){var i=t?t.getDay():n.getCurrentDate().getDay();return i==6||i==0}function gt(n){for(var t in n)n[t]?n[t]=v(Number(n[t])):delete n[t]}function v(n){return Number(n.toFixed(5))}function ni(n,t){n.featureStore||(n.featureStore={});n.featureStore[t]=1}n.getTextForLexicalFeatures=y;n.stringHashCode=f;n.getEditDistance=t;n.getEditDistanceIgnoreCase=p;n.computeEditDistanceRatio=o;n.computeJaroSimilarity=s;n.computeJaroWinklerSimilarity=w;n.computeJaroWinklerPrefixOverLapCount=h;n.isWordBoundary=b;n.countMaxContiguousRepeatedChars=k;n.getNumberOfWords=d;n.containsOnlyDigitsLettersOrSpaces=g;n.endsWithSpace=nt;n.prefixIsLikeUrl=tt;n.computeUrlFeatures=it;n.computeDomainFeatures=rt;n.computeTitleFeatures=ut;var ft=["www.bing.","cn.bing.","www.google.","www.yandex.","www.baidu.","www.yahoo.",],et=["http://","https://",];n.getSumMruLaunches=st;n.setMRUSignal=ht;n.setMRUBackPropSignal=ct;n.setEngagementSignals=lt;n.setSuggestionGroupEngagementSignals=at;n.getEngagementSignalKey=i;n.getAthenaGroupKey=r;n.checkAthenaGroupLength=u;n.parseWebEngagementSignals=vt;n.computeGroupBackpropagatedClicks=bt;n.computeSuggestionBackpropagatedClicks=kt;n.evaluateGroupLaunches=a;n.setMRUGroupBackpropClicks=dt;n.isWeekend=e;n.removeUndefinedAndZeroAndTrimValues=gt;n.trimFeatureStoreValue=v;n.setFlagInFeatureStore=ni}(WSB||(WSB={})),function(n){var t;(function(t){function u(n){return n.isSearchHomeZI}var i=.4,r;t.suggestionRankingModels={};r=function(){function r(){}return r.prototype.rank=function(t,i,r,f,e,o,s,h,c,l){var a,v,y,p;return u(t)?{topResults:[],mruSuppressions:null}:t.scope==n.Scope.PathCompletion?this.rankPathCompletion(i):(a=n.isL2(t)?null:{mruGroupRatios:null,maxGroupCCR:null,maxGroupProbSugClickGivenPref:null,mruGroupBackpropWeights:null,mruGroupBackpropRatios:null},v=i.slice(),this.orderSuggestions(t,i,r,f,o,s,h,c,a,e),this.setMRUHintEnabled(t,i),this.setGroupSuppressionSignals(a,i),y=this.getTopHitCandidates(t,i,l.searchTheWeb,v),p=this.createMulticlassClassifierTopHitSuggestionList(y),{topResults:p,mruSuppressions:a})},r.prototype.isNotChromeIntent=function(n,t){var r="google chrome",i;return t.length==0?!1:(i=t.filter(function(n){return n.query.toLocaleLowerCase()==r&&n.type=="PP"}),i.length>0&&!n.queryToFetch.includes("c")&&!n.queryToFetch.includes("h")&&!n.queryToFetch.includes("r")&&!n.queryToFetch.includes("m"))?!0:!1},r.prototype.setMRUHintEnabled=function(t,i){var f,r,u;if(n.config.enableMRUHint)for(f=t.queryToFetch.toLocaleLowerCase(),r=0;r<i.length;r++)u=i[r].featureStore,u[281]&&u[282]&&(n.config.enableMRUHint!=1&&i[r].text.toLocaleLowerCase().startsWith(f)||(i[r].mruHintEnabled=!0))},r.prototype.rankPathCompletion=function(n){var t=n.find(function(n){return n.type=="CG"})||n[0];return{topResults:t?[t]:[],mruSuppressions:null}},r.prototype.swapHighConfidenceTopHit=function(t){var o={minimum:0,penalty:.1},s={minimum:.08,penalty:.05},h={minimum:.01,penalty:.05},c={minimum:.45,penalty:.9},e=function(n){var t=-5;return(n-t)/(8-t)},r=t[0],f=0,u,i;if(!(t.length<=1)&&!(r.simpleFeatures.mruScore>0)){for(u=0;u<t.length;u++)i=t[u],n.isApp(i.type)?(i.simpleFeatures.topHitScore=e(-.45052*i.simpleFeatures.ciGeoMeanScoreNormalized+.15451*i.simpleFeatures.ciGlobalScore+-.34223*i.simpleFeatures.ciLocalScore+-.18174*i.simpleFeatures.ciMatchScore+3.9928),!n.isApp(r.type)&&i.simpleFeatures.topHitScore>o.minimum&&i.simpleFeatures.topHitScore>r.simpleFeatures.topHitScore+o.penalty&&(r=i,f=u)):n.isSetting(i.type)?(i.simpleFeatures.topHitScore=e(-.42912*i.simpleFeatures.ciGeoMeanScoreNormalized+-.0173*i.simpleFeatures.ciLocalScore+-.1516*i.simpleFeatures.ciMatchScore+.28754),!n.isSetting(r.type)&&i.simpleFeatures.topHitScore>s.minimum&&i.simpleFeatures.topHitScore>r.simpleFeatures.topHitScore+s.penalty&&(r=i,f=u)):n.isFileOrFolder(i.type)?(i.simpleFeatures.topHitScore=e(.99907*i.simpleFeatures.startsWithPrefix+1.1431*i.simpleFeatures.containsPrefix+3.1153*i.simpleFeatures.jaroWinklerScore+-3.9697),r==i&&(i.simpleFeatures.topHitScore=0),!n.isFileOrFolder(r.type)&&i.simpleFeatures.topHitScore>c.minimum&&i.simpleFeatures.topHitScore>r.simpleFeatures.topHitScore+c.penalty&&(r=i,f=u)):n.isWebSuggestion(i)||i.type=="MB"||i.isAnswer?(i.simpleFeatures.topHitScore=e(5.3465*i.simpleFeatures.webConfidence+-5.6972),(!n.isWebSuggestion(r)&&i.simpleFeatures.topHitScore>h.minimum&&i.simpleFeatures.topHitScore>r.simpleFeatures.topHitScore+h.penalty||i.type=="MB"&&n.isWebSuggestion(r))&&(r=i,f=u)):(i.type=="PT"||i.type=="CG")&&(r=i,f=u);f!=0&&(t.unshift(r),t.splice(f+1,1))}},r.prototype.extractSimpleFeatures=function(t){var i=t.featureStore,f=64,r=0,u={mruScore:i[282]||r,sugTypeBucket:10,ciGeoMeanScoreNormalized:Math.floor(i[405]/1e3)||f,ciGlobalScore:i[269]/1e3||f,ciLocalScore:i[270]/1e3||f,ciMatchScore:Math.floor(i[158]/1e3)||0,rank:Math.floor(i[16]/1e3)||128,webScore:this.getSuggestionScoreFromSuggestionLogMeta(t.suggestionLogMeta)||r,webConfidence:i[17]||r,prefixEqualsSuggestion:i[133]||r,startsWithPrefix:i[188]||r,containsPrefix:i[143]||r,jaroWinklerScore:i[421]||r,topHitScore:r};return u.sugTypeBucket=n.isApp(t.type)?0:n.isSetting(t.type)?1:n.isFileOrFolder(t.type)?2:t.type=="MB"?3:n.isWebSuggestion(t)?4:5,t.type=="IBA"&&i[269]<1&&(u.ciGeoMeanScoreNormalized=64),u.ciMatchScore==0&&u.startsWithPrefix==0&&u.sugTypeBucket<=1&&(u.ciMatchScore+=1),u},r.prototype.isColdStartConversation=function(t,i,r){if(i&&i.length>0||r&&r.WebSignalsAvailable||!t.some(function(t){return n.isApp(t.type)||n.isSetting(t.type)}))return n.Host.setFCRCount(0),n.Host.incrementNCRCount(),!1;for(var u=0;u<t.length;u++)if(t[u].featureStore&&t[u].featureStore[269]&&t[u].featureStore[270]&&t[u].featureStore[269]>t[u].featureStore[270])return n.Host.setFCRCount(0),n.Host.incrementNCRCount(),!1;return n.config.enableColdStartRanking1||!n.config.enableColdStartRanking?(n.Host.setFCRCount(1),n.Host.incrementCRCount(),!1):(n.Host.setFCRCount(1),n.Host.incrementCRCount(),!0)},r.prototype.orderSuggestions=function(i,r,u,f,e,o,s,h,c,l){var ut=this,y,w,p,b,nt,tt,k,d,g,v,it,rt,a;if(n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().beginMark("WSBRanking.orderSuggestions"),!n.config.bypassRankerOnNoNewSuggestions||i.hasNewSuggestions){if(y=n.safeExecute(function(){return ut.createFeatureStore(i,r,u,f,e,o,s,c,l)},"createFeatureStore"),y=y||r.map(function(){return{}}),p=h?n.config.counterFactualRankerId:n.config.mainRankerId,p?(w=n.safeExecute(function(){return t.suggestionRankingModels[p]},"getRanker"),w||SharedLogHelper.LogError("getRanker",p,new Error("Model not found"))):SharedLogHelper.LogError("getRanker",p,new Error(h?"CounterFactualRankerId not defined ":"MainRankerId not defined")),n.config.enableSimpleRanker){for(a=0;a<r.length;a++)b=y[a],r[a].featureStore=b,r[a].simpleFeatures=this.extractSimpleFeatures(r[a]);for(n.config.enableMatchQueryDemotions?r.sort(function(n,t){return t.simpleFeatures.mruScore-n.simpleFeatures.mruScore||n.simpleFeatures.sugTypeBucket-t.simpleFeatures.sugTypeBucket||Math.floor(n.simpleFeatures.ciMatchScore/10)-Math.floor(t.simpleFeatures.ciMatchScore/10)||n.simpleFeatures.ciGeoMeanScoreNormalized-t.simpleFeatures.ciGeoMeanScoreNormalized||n.simpleFeatures.rank-t.simpleFeatures.rank||t.simpleFeatures.prefixEqualsSuggestion-n.simpleFeatures.prefixEqualsSuggestion||t.simpleFeatures.startsWithPrefix-n.simpleFeatures.startsWithPrefix||t.simpleFeatures.containsPrefix-n.simpleFeatures.containsPrefix||t.simpleFeatures.jaroWinklerScore-n.simpleFeatures.jaroWinklerScore}):r.sort(function(n,t){return t.simpleFeatures.mruScore-n.simpleFeatures.mruScore||n.simpleFeatures.sugTypeBucket-t.simpleFeatures.sugTypeBucket||n.simpleFeatures.ciGeoMeanScoreNormalized-t.simpleFeatures.ciGeoMeanScoreNormalized||n.simpleFeatures.ciMatchScore-t.simpleFeatures.ciMatchScore||n.simpleFeatures.rank-t.simpleFeatures.rank||t.simpleFeatures.prefixEqualsSuggestion-n.simpleFeatures.prefixEqualsSuggestion||t.simpleFeatures.startsWithPrefix-n.simpleFeatures.startsWithPrefix||t.simpleFeatures.containsPrefix-n.simpleFeatures.containsPrefix||t.simpleFeatures.jaroWinklerScore-n.simpleFeatures.jaroWinklerScore}),a=0;a<r.length;a++)r[a].rankingScore=-a;this.swapHighConfidenceTopHit(r)}else if((n.config.enableColdStartRanking||n.config.enableColdStartRanking1)&&this.isColdStartConversation(r,l,u)){for(a=0;a<r.length;a++)b=y[a],r[a].featureStore=b,r[a].simpleFeatures=this.extractSimpleFeatures(r[a]);for(r.sort(function(n,t){return t.simpleFeatures.prefixEqualsSuggestion-n.simpleFeatures.prefixEqualsSuggestion||t.simpleFeatures.containsPrefix-n.simpleFeatures.containsPrefix||n.simpleFeatures.ciGlobalScore-t.simpleFeatures.ciGlobalScore}),a=0;a<r.length;a++)r[a].rankingScore=-a}else if(w)for(nt=function(t){var i=y[t],u;if(n.config.enableConversationCache&&r[t].skipRerank)return"continue";u=n.safeExecute(function(){return w(i)},"calculateRankingScore");r[t].rankingScore=n.trimFeatureStoreValue(u);r[t].featureStore=i;(n.config.enableFuzzyRanking||n.config.enableFuzzyRanking1)&&(r[t].simpleFeatures=tt.extractSimpleFeatures(r[t]));n.config.enableConversationCache&&(r[t].skipRerank=!0)},tt=this,a=0;a<r.length;a++)nt(a);if(n.config.enableAnaheimRelevance&&(k=[],n.config.enableAnaheimRelevance==1?k=r.filter(function(n){return n.anaheimRankingSignals}):n.config.enableAnaheimRelevance==2&&(k=r.filter(function(t){return n.getGroupType(t)==n.GroupType.SearchSuggestions})),this.getWebRankingWithAnaheimAdapter(k)),d=r.filter(function(n){return n.type=="MB"}),n.config.enableSimpleRanker||r.sort(function(n,t){return t.rankingScore-n.rankingScore}),r.length>1&&(n.config.enableFuzzyRanking||n.config.enableFuzzyRanking1)){for(g=r[0].rankingScore,v=0,a=0;a<r.length;a++)if(n.config.enableFuzzyRanking){if((n.isApp(r[a].type)||n.isSetting(r[a].type))&&r[a].rankingScore<=g-n.config.fuzzyRankingThreshold)break;v+=1}else if(n.config.enableFuzzyRanking1&&r[a].rankingScore+n.config.fuzzyRankingThreshold>=g){if(n.isApp(r[a].type)||n.isSetting(r[a].type))break;v+=1}if(n.Host.setFRSuggCount(v),v>1){for(it=r.slice(0,v).sort(function(n,t){return t.simpleFeatures.prefixEqualsSuggestion-n.simpleFeatures.prefixEqualsSuggestion||t.simpleFeatures.containsPrefix-n.simpleFeatures.containsPrefix||n.simpleFeatures.ciGlobalScore-t.simpleFeatures.ciGlobalScore}),a=0;a<v;a++)r[a]=it[a],r[a].rankingScore=g-n.config.fuzzyRankingThreshold*a/v;r.sort(function(n,t){return t.rankingScore-n.rankingScore})}}if(d.length>1)for(rt=r.map(function(n,t){return n.type=="MB"?t:undefined}).filter(function(n){return typeof n=="number"}),a=0;a<d.length;++a)r[rt[a]]=d[a];n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().endMark("WSBRanking.orderSuggestions")}},r.prototype.getWebRankingWithAnaheimAdapter=function(t){var v=this,i=10,l=-1,o=!1,s=new Array(i),h=function(n){if(n==l&&!o)return o=!0,-400;n=Math.floor(n);n>i-1&&(n=i-1);var t=-(n*100+500)-s[n];return s[n]+=1,t},y=function(n){for(var i,r,t=0,u=n;t<u.length;t++)if(i=u[t],i.suggestionLogMeta&&(r=v.getSuggestionScoreFromSuggestionLogMeta(i.suggestionLogMeta),r))return r;return 64e3},u,a,f,c,e,r;for(t.sort(function(n,t){return t.rankingScore-n.rankingScore}),u=0;u<i;++u)s[u]=0;for(a=y(t),f=0,c=t;f<c.length;f++)e=c[f],r=this.getRankingBucketWithAnaheimAdapter(e,a,i),e.rankingScore=r!=null&&r>=0?!o&&e.anaheimRankingSignals&&r<=n.config.anaheimDataTopHitThreshold?h(l):h(r):h(i)},r.prototype.getRankingBucketWithAnaheimAdapter=function(t,i,r){var f=Math.pow(2,-(i/8e3)+2),u;if(t.anaheimRankingSignals){var e=t.anaheimRankingSignals.dateVisited,o=(n.getCurrentTime()-e.getTime())/864e5,s=t.anaheimRankingSignals.visitCount,h=t.anaheimRankingSignals.urlTypedCount,u=.6*Math.exp(-o/14)+.25*(1-Math.exp(-s/6))+.15*(1-Math.exp(-h/2));return Math.floor(r*(1-u))}return t.suggestionLogMeta&&(u=this.getSuggestionScoreFromSuggestionLogMeta(t.suggestionLogMeta),u)?Math.floor((u-i)/f):null},r.prototype.getSuggestionScoreFromSuggestionLogMeta=function(n){var t=";2152:";return n&&n.indexOf(t)>=0?parseInt(n.substring(n.indexOf(t)+6).split(";")[0].slice(1,-1)):NaN},r.prototype.getTopWebSuggestion=function(t){var f,e,i,o,r,u;if(t.length==0)return null;if(n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().beginMark("WSBRanking.getTopWebSuggestion"),f=t[0],e=64e3,t.length>1)for(i=0,o=t;i<o.length;i++)r=o[i],r.suggestionLogMeta&&(u=this.getSuggestionScoreFromSuggestionLogMeta(r.suggestionLogMeta),!isNaN(u)&&u<e&&(e=u,f=r));return n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().endMark("WSBRanking.getTopWebSuggestion"),f},r.prototype.bypassFallbackForMSB=function(t,i,r){return(n.config.bypassFallbackOnMSBTopHit==2||n.config.bypassFallbackOnMSBTopHit==3)&&i.every(function(t){return n.isWebSuggestion(t)||t.handoffType==17||t.isAnswer})?!0:(n.config.bypassFallbackOnMSBTopHit==1||n.config.bypassFallbackOnMSBTopHit==4)&&!i.some(function(t){return n.isApp(t.type)||n.isSetting(t.type)})&&r.length>0&&n.isMsbOnlineSuggestionType(r[0].type)?!0:n.config.bypassFallbackOnMSBTopHit==4&&!i.some(function(t){return n.isApp(t.type)||n.isSetting(t.type)})&&r.length>1&&(r[0].isAnswer||n.isWebSuggestion(r[0]))&&(n.isMsbOnlineSuggestionType(r[1].type)||r.length>2&&r[0].isAnswer&&r[1].isAnswer&&n.isMsbOnlineSuggestionType(r[2].type))?!0:!1},r.prototype.getTopHitCandidates=function(t,r,u,f){var p=this,e,c,l,v,y,s,a;if(n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().beginMark("WSBRanking.getTopHitCandidates"),e=r.filter(function(n){return p.allowInTopHit(t,n,f)}),this.bypassFallbackForMSB(t,r,e,f)){var w=n.getMsbTophitSuggestionTypeOrder(),h=[],o=[],b=function(t){return o=f.filter(function(i){return t.indexOf(i.type)>-1&&(!n.config.msbCheckAutoOpenSignal||i.autoOpenPreviewPaneWhenOnTopHit)}),o.length>0?"break":void 0};for(c=0,l=w;c<l.length;c++)if(v=l[c],y=b(v),y==="break")break;if(o.length>0&&o[0].autoOpenPreviewPaneWhenOnTopHit&&(n.config.bypassFallbackOnMSBTopHit!=3||n.getTextForLexicalFeatures(o[0]).toLowerCase().startsWith(t.queryToFetch.toLowerCase()))&&h.push(o[0]),n.config.bypassFallbackOnMSBTopHit==4&&(e[0].isAnswer||n.isWebSuggestion(e[0]))&&(e[0].isAnswer||this.getFallbackClassifierScore(e[0])>i)&&h.push(e[0]),h.length>0)return n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().endMark("WSBRanking.getTopHitCandidates"),h}return this.enableFallbackClassifier(t,e,u)?(e=this.getFallbackClassifierSuggestions(e),n.config.enableGGSupp&&this.isNotChromeIntent(t,e))?(n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().endMark("WSBRanking.getTopHitCandidates"),[]):(n.config.demoteWebForApps&&(s=this.getTopAppSuggestion(r),a=s?s.query.toLocaleLowerCase():"",s&&this.allowInTopHit(t,s)&&e.every(function(t){return n.isWebSuggestion(t)})&&(a.startsWith(t.queryToFetch)||a.includes(" "+t.queryToFetch))&&(e=[s])),n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().endMark("WSBRanking.getTopHitCandidates"),e):(n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().endMark("WSBRanking.getTopHitCandidates"),e)},r.prototype.getFallbackClassifierScore=function(i){var r=n.safeExecute(function(){return t.suggestionRankingModels[n.config.fallbackClassifierId]},"getFallbackClassifier"),u=r?n.safeExecute(function(){return r(i.featureStore)},"calculateFallbackClassifierScore"):0;return n.trimFeatureStoreValue(u)},r.prototype.getFallbackClassifierSuggestions=function(r){if(r=r.filter(function(n){return n.type!="SW"}),r.length>0){var f=0,u=r[0];return u.fbcScore=this.getFallbackClassifierScore(u),f=n.config.enableAppsSettingsFbcScoreThreshold?n.isApp(u.type)||n.isSetting(u.type)?n.config.appsSettingsFbcScoreThreshold:n.isWebSuggestion(u)?i:n.config.nonWebFbcScoreThreshold:n.isWebSuggestion(u)?i:n.config.nonWebFbcScoreThreshold,u.fbcScore>=f?r.slice(0,t.topHitIsMultiEntity(r)?2:1):[]}return[]},r.prototype.enableFallbackClassifier=function(t,i,r){if(r&&n.config.fallbackClassifierId&&i.length>0){var u=i[0];return n.getGroupType(u)==n.GroupType.Cortana?!1:u.isAnswer?!1:!0}return!1},r.prototype.getTopAppSuggestion=function(t){for(var u,i=0,r=t;i<r.length;i++)if(u=r[i],n.isApp(u.type))return u;return null},r.prototype.isRecourse=function(t){return t.notAResult&&!n.contains(["SW","PWL","SSTS"],t.type)},r.prototype.allowInTopHit=function(t,i,r){var s=!r||r.length==1,e,f,o,u;if(n.config.demoteTopHitOnNoQueryMatch&&(n.isApp(i.type)||n.isSetting(i.type))&&!i.ciMatchedQuery&&!i.query.toLocaleLowerCase().includes(t.queryToFetch.toLocaleLowerCase()))return!1;if(t.topHitRestriction==1&&i.query.toLocaleLowerCase()!=t.queryToFetch.toLocaleLowerCase()&&(n.contains(i.features,"ForcePrefixOnTop")||i.features.push("ForcePrefixOnTop")),this.isRecourse(i))return s;e=n.getGroupType(i);switch(e){case n.GroupType.Store:return i.hc;case n.GroupType.Command:return i.hc||s;case n.GroupType.LocalPlaces:return!1}if(n.getScope(e)==n.Scope.Emails&&!i.hc)return!1;if(n.enforceOriginalOrder(i)&&r)for(f=0,o=r;f<o.length;f++){if(u=o[f],u==i)break;if(u.type==i.type&&u.handoffType==i.handoffType&&u.sourceForGroup==i.sourceForGroup)return!1}return n.RuntimeConfig.AlwaysWide&&!i.previewPaneType?!1:!0},r.prototype.createMulticlassClassifierTopHitSuggestionList=function(i){for(var r=0,u=0;u<Math.min(i.length,n.config.maxNumberOfTopResults);u++)i[u].rankingScore!==undefined&&i[u].rankingScore>.5&&(r=u);return r==0&&t.topHitIsMultiEntity(i)&&(r=1),n.config.bypassFallbackOnMSBTopHit==4&&i.length>0&&n.isMsbOnlineSuggestionType(i[0].type)&&(r=1),i.slice(0,r+1)},r.prototype.createFeatureStore=function(t,i,r,u,f,e,o,s,h){var st=[],nt=0,ht=0,tt=0,ct=t.queryToFetch.toLocaleLowerCase(),bt=function(t){return n.getGroupType(t)},lt=n.getSumMruLaunches(u),at=0,vt={},it,rt,yt,k,ut,v,y,l,p,d,ft,et,w,g,ot,a,c,b,pt,wt;for(u&&(it=n.evaluateGroupLaunches(u),at=it.otherGroupLaunches,vt=it.groupLaunches),rt=n.computeGroupBackpropagatedClicks(t.queryToFetch,h),yt=n.computeSuggestionBackpropagatedClicks(t.queryToFetch,h),k=0,ut=i;k<ut.length;k++)v=ut[k],v.handoffType==2&&(y=n.getAppItem(v),y&&(ht+=y.totalLaunches,y.totalLaunches>nt&&(nt=y.totalLaunches)),v.deviceItem&&v.deviceItem.rankScore>tt&&(tt=v.deviceItem.rankScore));for(l={},n.isWeekend()&&(l[440]=1),l[441]=this.getLocalHourBucket(new Date),p=ct.split(" "),d=0,ft=p;d<ft.length;d++){if(et=ft[d],et=="install"){l[451]=1;break}if(et=="uninstall"){l[450]=1;break}}for(p&&p.length>0&&(w=p[0],l[452]=w.indexOf("c:")>-1||w.indexOf("d:")>-1||w.indexOf("e:")>-1||w.indexOf("f:")>-1?1:0),g=0,ot=i;g<ot.length;g++)a=ot[g],c=this.getSuggestionFeatureStore(ct,a,f,r,ht,o),c[13]=nt,c[7]=tt,r&&r.WebSignalsAvailable&&(c[93]=1),n.setMRUSignal(n.getSuggestionKey(a),c,u,lt),this.setMRUGroupLaunchRatios(c,a,lt,vt,at,s),n.setMRUBackPropSignal(n.getSuggestionKey(a),c,yt),rt&&n.setMRUGroupBackpropClicks(c,a,bt,rt),b=n.getTextForLexicalFeatures(a),b&&(a.handoffType==1&&(n.computeUrlFeatures(b,t.queryToFetch,c,e),pt=n.getDomain(b),n.computeDomainFeatures(a,t.queryToFetch,c,e,pt,f)),n.isFileOrFolder(a.type)&&(wt=e.cvid+e.privacyNumber+b,c[131]=n.stringHashCode(wt))),l&&(c[440]=l[440],c[441]=l[441],c[451]=l[451],c[450]=l[450],c[452]=l[452]),n.removeUndefinedAndZeroAndTrimValues(c),st.push(c);return st},r.prototype.setGroupSuppressionSignals=function(t,i){var f,e,u;if(t)for(t.maxGroupCCR={},t.maxGroupProbSugClickGivenPref={},t.mruGroupBackpropRatios={},t.mruGroupBackpropWeights={},f=0,e=i;f<e.length;f++)if(u=e[f],u.featureStore){var r=n.getGroupType(u),o=u.featureStore[94]||0,s=u.featureStore[0]||0;t.maxGroupCCR[r]=t.maxGroupCCR[r]?Math.max(t.maxGroupCCR[r],o):o;t.maxGroupProbSugClickGivenPref[r]=t.maxGroupProbSugClickGivenPref[r]?Math.max(t.maxGroupProbSugClickGivenPref[r],s):s;t.mruGroupBackpropRatios[r]=u.featureStore[266];t.mruGroupBackpropWeights[r]=u.featureStore[267];(t.mruGroupBackpropWeights[r]||t.mruGroupBackpropRatios[r])&&(t.backPropDataExists=!0)}},r.prototype.setMRUGroupLaunchRatios=function(t,i,r,u,f,e){var s,o;if(r){e&&(e.mruGroupRatios={});t[186]=f/r;for(s in u){o=u[s]/r;n.getGroupType(i)==Number(s)&&(t[271]=o);e&&(e.mruGroupRatios[s]=o);switch(Number(s)){case n.GroupType.Apps:t[169]=o;break;case n.GroupType.Settings:t[170]=o;break;case n.GroupType.Cortana:t[171]=o;break;case n.GroupType.Command:t[172]=o;break;case n.GroupType.Photos:t[173]=o;break;case n.GroupType.Videos:t[174]=o;break;case n.GroupType.Music:t[175]=o;break;case n.GroupType.Documents:t[176]=o;break;case n.GroupType.Folders:t[177]=o;break;case n.GroupType.Emails:t[178]=o;break;case n.GroupType.Store:t[179]=o;break;case n.GroupType.SearchSuggestions:t[262]=o;t[180]=u[n.GroupType.Websites]?(u[n.GroupType.Websites]+u[s])/r:o;break;case n.GroupType.Websites:t[263]=o;t[180]=u[n.GroupType.SearchSuggestions]?(u[n.GroupType.SearchSuggestions]+u[s])/r:o;break;case n.GroupType.PathCompletion:t[181]=o;break;case n.GroupType.People:t[184]=o;break;case n.GroupType.Bookmarks:t[260]=o;break;case n.GroupType.LocalPlaces:t[261]=o}}}},r.prototype.getRank=function(t){if(t.deviceItem&&typeof t.deviceItem.rankScore!="undefined")return t.deviceItem.rankScore;var i=n.isJumpListSuggestion(t)?t.jumpListItem.usagePoints:undefined;return typeof i!="undefined"?i:undefined},r.prototype.getSuggestionFeatureStore=function(t,i,r,u,f,e){var o={},c,b,l,a,v,y,h,s,k,nt,p,d,tt,w,g;if(this.setTypeSignal(i,o),c=n.getAppItem(i),c?(o[2]=c.totalLaunches,o[92]=c.launchArguments?1:0,f>0&&(o[103]=c.totalLaunches/f),this.addLastAccessDate(c.lastAccessed,o)):this.addLastAccessDate(n.isJumpListSuggestion(i)?i.jumpListItem.lastAccessed:null,o),o[99]=i.confidence,o[150]=i.source,o[283]=i.pinnedToTaskbar?1:undefined,i.hc&&(o[189]=1),o[17]=i.highConfidenceMetaSuggestionScore,b=this.getRank(i),typeof b!="undefined"?o[16]=b:o[4]=1,l=i,l.matchedOnlyOnContent&&(o[259]=1),l.matchedOnlyOnAuthor&&(o[273]=1),l.lastModifiedDate&&(o[268]=n.getTimeDiffInDays(l.lastModifiedDate)),l.extensionLC==".lnk"&&(o[272]=1),o[23]=i.prefetchConfidenceScore,o[264]=u&&u.ProbNextKS!==undefined?u.ProbNextKS:1,o[296]=u&&u.ProbNextKSV2!==undefined?u.ProbNextKSV2:1,this.setThresholdRatios(o,u),this.setRatios(o,u),a=n.getGroupType(i),v=i.query,i.type=="SW"&&(v="SearchTheWeb"),y=n.getAthenaGroupKey(String(a),String(i.handoffType),i.type),n.setEngagementSignals(o,r,y,v,!1,!1),n.setEngagementSignals(o,e,y,v,!1,!0),e&&!r&&n.setEngagementSignals(o,e,y,v,!1,!1),o[10]=t.length,(i.isAnswer||a==n.GroupType.Cortana)&&(o[11]=1),h=n.getTextForLexicalFeatures(i),s=h?h.toLocaleLowerCase():null,h||(o[132]=1),s==t&&(o[133]=1),i.handoffType==2&&(o[8]=1,n.isSetting(i.type)&&(o[64]=1),n.isApp(i.type)&&(o[83]=1)),a==n.GroupType.SearchSuggestions&&(i.type!="SW"&&(o[82]=1),o[25]=1),k=o[132]==1,k?o[137]=t.length:(o[137]=h.length,o[134]=n.getEditDistance(t,s),o[135]=Math.min(100,n.computeEditDistanceRatio(o[134],t.length,h.length)),o[136]=n.isWordBoundary(t,h),o[284]=Math.abs(h.length-t.length)),!k&&s){for(s.indexOf(t)>-1&&(o[143]=1),s.substring(0,t.length)===t&&(o[188]=1),nt=s.split(" "),p=0,d=nt;p<d.length;p++)if(tt=d[p],tt==t){o[145]=1;break}o[420]=n.computeJaroSimilarity(t,s);o[421]=n.computeJaroWinklerSimilarity(t,s)}return o[1]==1&&i.deviceItem&&(w=n.getAppItem(i),w.extension&&(o[400]=w.extension===".exe"?1:0,o[401]=w.extension===".appref-ms"?1:0),s&&(o[402]=s.indexOf("install")>-1?1:0)),o[1]||i.type!="FL"&&i.type!="FD"&&i.type!="ST"||(o[403]=1),(i.type=="QP"||i.type=="QS"||i.type=="SC"||i.type=="OS")&&(o[404]=1),o[8]==1&&(o[27]=o[133]),(i.isAnswer||a==n.GroupType.Cortana)&&(o[55]=o[133]),(i.type=="HS"||i.fromHistory)&&(o[121]=1),o[41]=o[83]==1?o[40]:o[64]==1?o[39]:o[11]==1?o[32]:o[89]==1?o[54]:o[85]==1?o[30]:o[86]==1?o[53]:o[87]==1?o[52]:o[61]==1?o[31]:o[88]==1?o[51]:o[63]==1?o[35]:o[82]==1?o[29]:o[90]==1?o[50]:o[59]==1?o[34]:o[37],(n.isSetting(i.type)||n.isApp(i.type))&&(g=i.ciMetaData,this.computeConstraintIndexFeatures(i.deviceItem,o,g),i.ciMatchedQuery=this.getConstraintIndexMatchedQuery(g),o[269]&&o[270]&&(o[405]=Math.sqrt(o[269]*o[270]))),i.signals&&(o[230]=i.signals.DistanceToEntity,o[231]=i.signals.DistanceToEntityPrecision,o[232]=i.signals.RankingScore),o},r.prototype.addLastAccessDate=function(t,i){var r=n.getTimeDiffInDays(t);r!=null?i[9]=r:i[19]=1},r.prototype.setTypeSignal=function(n,t){switch(n.type){case"LDOC":case"FL":t[61]=1;break;case"LI":t[85]=1;break;case"LV":t[86]=1;break;case"MU":t[87]=1;break;case"FD":t[88]=1;break;case"CG":t[89]=1;break;case"PT":t[90]=1;break;case"PP":case"IBA":t[1]=1;break;case"ML":case"MD":t[21]=1;break;case"SW":t[59]=1}},r.prototype.setRatios=function(n,t){t&&t.AppsRatio!==undefined&&(n[26]=t.AppsRatio,t.SettingsRatio&&(n[5]=t.SettingsRatio),t.StoreRatio&&(n[57]=t.StoreRatio),t.PrefixProbability&&(n[12]=t.PrefixProbability),t.FilesRatio&&(n[24]=t.FilesRatio),t.WebRatio&&(n[18]=t.WebRatio),t.PhotosVideosMusicRatio&&(n[28]=t.PhotosVideosMusicRatio),t.ContactsRatio&&(n[56]=t.ContactsRatio),t.LocalProtocolRatio&&(n[91]=t.LocalProtocolRatio))},r.prototype.setThresholdRatios=function(n,t){t&&t.ThApps!==undefined?(n[40]=t.ThApps,t.ThStore&&(n[35]=t.ThStore),t.ThSetting&&(n[39]=t.ThSetting),t.ThCortAns&&(n[32]=t.ThCortAns),t.ThPrefixCount&&(n[38]=t.ThPrefixCount),t.ThWeb&&(n[29]=t.ThWeb),t.ThSearchTheWeb&&(n[34]=t.ThSearchTheWeb),t.ThOther&&(n[37]=t.ThOther),t.ThFile&&(n[31]=t.ThFile),t.ThFolder&&(n[51]=t.ThFolder),t.ThPath&&(n[50]=t.ThPath),t.ThEmail&&(n[33]=t.ThEmail),t.ThCommAns&&(n[54]=t.ThCommAns),t.ThPhotoAns&&(n[30]=t.ThPhotoAns),t.ThVideoAns&&(n[53]=t.ThVideoAns),t.ThMusicAns&&(n[52]=t.ThMusicAns),t.ThDNav&&(n[147]=t.ThDNav)):n[42]=1},r.prototype.computeConstraintIndexFeatures=function(n,t,i){var u,o,f,e,s,r;if(n&&n.rawIndexResponse){if(!i)return;if(t[157]=i.GrammarScore,t[158]=i.MatchScore,i.Parses&&i.Parses.length>0&&i.Parses[0].Entities&&i.Parses[0].Entities.length>0)for(u=0,o=i.Parses[0].Entities;u<o.length;u++)if(f=o[u],t[159]=f.EntityScore,f.Attributes)for(e=0,s=f.Attributes;e<s.length;e++)r=s[e],r.Name=="gscore"?t[269]=Number(r.Value):r.Name=="lscore"&&(t[270]=Number(r.Value))}},r.prototype.getConstraintIndexMatchedQuery=function(n){return!n||n.MatchScore==0?null:n.Query},r.prototype.getLocalHourBucket=function(n){var t=n.getHours(),i=1;return t>=0&&t<6?i=1:t>=6&&t<12?i=2:t>=12&&t<18?i=3:t>=18&&t<=23&&(i=4),i},r}();t.FastRankRanker=r})(t=n.Ranking||(n.Ranking={}))}(WSB||(WSB={})),function(n){var t=function(){function t(t){var i=this;this._instrumentationProvider=t;n.Host.bindDismissed(function(){return i.flushAggregatedMeasure(!0)});this._keystrokeAggregatedFunctionPerf={}}return t.prototype.onNewKeystroke=function(n,t,i){this.flushAggregatedMeasure();this._aggregatedMeasureFlushed=!1;this._currentLeftPaneSuggestions=null;this._currentRawImpressionGuid=t;this._currentRawClientImpressionGuid=SearchAppWrapper.CortanaApp.impressionId;this._keystrokeAggregatedMeasure={CVID:n};this._keystrokeAggregatedFunctionPerf={};this._currentKeystrokeAggregatedMeasureIsForSearchHome=i},t.prototype.flushAggregatedMeasure=function(t){var f,i,r,e,o,u;if((t||this._currentKeystrokeAggregatedMeasureIsForSearchHome)&&!this._aggregatedMeasureFlushed){if(n.config.logClientPerf){if(f=Object.keys(this._keystrokeAggregatedFunctionPerf),this._keystrokeAggregatedFunctionPerf&&f.length>0){for(i="",r=0,e=f;r<e.length;r++)o=e[r],u=this._keystrokeAggregatedFunctionPerf[o],i+=u.functionName+","+u.numCalls+","+u.totalDuration+";";i=i.substr(0,i.length-1);this._instrumentationProvider.logProfilerMarker(1,0,"KeystrokeAggregatedFuncPerf",this._currentRawClientImpressionGuid,i)}}else this._keystrokeAggregatedMeasure&&Object.keys(this._keystrokeAggregatedMeasure).length>1&&this.logProfilerMarker(1,0,"KeystrokeAggregatedMeasure",this._currentRawImpressionGuid,this._currentRawClientImpressionGuid,this._keystrokeAggregatedMeasure);this._aggregatedMeasureFlushed=!0}},t.prototype.logSingleMeasure=function(n,t,i){this.logProfilerMarker(1,0,n,t,SearchAppWrapper.CortanaApp.impressionId||t,i)},t.prototype.logProfilerMarker=function(n,t,i,r,u,f){f&&u!=r&&(f.ServerIG=r);this._instrumentationProvider.logProfilerMarker(n,t,i,u,f)},t.prototype.logAggregate=function(n,t){this._keystrokeAggregatedMeasure[n]=t},t.prototype.logAggregateFunctionPerf=function(n,t){var i=this._keystrokeAggregatedFunctionPerf[n];this._keystrokeAggregatedFunctionPerf[n]=i?{functionName:i.functionName,numCalls:i.numCalls+1,totalDuration:i.totalDuration+t}:{functionName:n,numCalls:1,totalDuration:t}},t.prototype.getItemLayoutFromSuggestionsList=function(n){var u,e,i,f,r,t;if(this._currentLeftPaneSuggestions){for(u=this._currentLeftPaneSuggestions.topResults,e=this._currentLeftPaneSuggestions.groups,t=0;t<u.length;++t)if(u[t].instItem==n)return{IsInTopResult:!0,GroupType:undefined,PositionInGroup:t};for(i=0,f=e;i<f.length;i++)for(r=f[i],t=0;t<r.suggestions.length;++t)if(r.suggestions[t].instItem==n)return{IsInTopResult:undefined,GroupType:r.typeWithSource.type,PositionInGroup:t}}return undefined},t.prototype.updateSuggestionsList=function(n,t){this._currentLeftPaneSuggestions={topResults:n,groups:t}},t.prototype.logDataSourcePerformancesMeasure=function(n){var t=n.RequestBegin,i=Object.keys(n.ResponseReceived).map(function(i){return{Name:i,ResponseReceivedTime:n.ResponseReceived[i]-t,RenderedTime:n.RenderFinished[i]-t,Status:n.DataSourcesState&&n.DataSourcesState[i]}}),r=n.TopResultRendered.map(function(n){return{Type:n.T,Time:n.V-t}}),u={DataSources:i,TopResultRendered:r};this.logAggregate("DataSourcePerformancesMeasure",u)},t.prototype.logNewKeystrokeMeasure=function(t,i,r){this.onNewKeystroke(t,i,r.isSearchHomeZI);var u={ScopeInQuery:r.scopePrefix,Scope:r.scope,IsSearchHome:r.isSearchHomeZI};u.CIVersion=n.ConstraintIndex.currentCIVersion;this.logAggregate("NewKeystrokeMeasure",u)},t.prototype.logTopResultsRenderedMeasure=function(n,t){this._instrumentationProvider.logProfilerMarker(1,0,"topResultRendered",n,{});var i={SuggestionTypes:t};this.logAggregate("TopResultsRenderedMeasure",i)},t.prototype.logGroupsRenderedMeasure=function(n){var t={GroupTypes:n};this.logAggregate("GroupsRenderedMeasure",t)},t.prototype.logPreviewPaneOpenedMeasure=function(n,t,i){var r={ParentType:n.getQsCode(),PreviewPaneType:t,ParentLayoutInfo:this.getItemLayoutFromSuggestionsList(n),AutoOpened:i||undefined};this.logAggregate("LastPreviewPaneOpened",r)},t.prototype.logConversationStartMeasure=function(n){this.logSingleMeasure("ConversationStartMeasure",n)},t.prototype.logItemClickedMeasure=function(n,t,i,r){var u={CVID:n,ItemType:i.getQsCode(),InputType:r,LayoutInfo:this.getItemLayoutFromSuggestionsList(i)};this.flushAggregatedMeasure(!0);this.logSingleMeasure("ItemClickedMeasure",t,u)},t}();n.WindowsTelemetry=t}(WSB||(WSB={})),function(n){var t=/[+.\\*?\[\]()]/g,i={".":"\\.","+":"\\+","*":"\\*","\\":"\\\\","?":"\\?","[":"\\[","]":"\\]","(":"\\(",")":"\\)"},r=/^(?:https?:\/\/)?(.*)/,u=/^(?:(?:https?:\/\/(?:www\.)?)|(?:www\.))(.*)/,f=/^\s+/,e=function(){function e(){var t=this;n.Host.bindKeyDown(function(i){n.isUpOrDownKey(i)&&t.reset()});n.Host.bindQueryChangedOrInitialized(function(n){t._currentQuery=n;!t._fullAutoCompletedQuery||t._fullAutoCompletedQuery.startsWith(n.originalQuery)||n.originalQuery.startsWith(t._fullAutoCompletedQuery)||t.reset()})}return e.prototype.apply=function(t){var r,o,i;if(t.query!=this._autoCompletedQuery){if(r=this._currentQuery.originalQuery,n.Host.setAutoCompleteQueryText(""),this._currentQuery.originalCursorPosition===r.length){var s=this._currentQuery.scopePrefix?this._currentQuery.scopePrefix.length+1:0,u=r.substr(s).replace(f,"").toLowerCase(),e=t.query.toLowerCase();if(u!==e&&(o=1,i=this.fullAutoCompleteOffset(e,u),i<0&&t.url&&(i=this.infixAutoCompleteOffset(e,u),o=2),i<0&&(i=this.directNavAutoCompleteOffset(e,u)),i>=0)){this.setAutoCompletedQuery(r,t.query,i);t.autoCompleteType=o;return}}this._autoCompletedQuery&&(this.reset(),n.Host.setAutoCompleteQueryText(r))}},e.prototype.reset=function(){this._autoCompletedQuery=null;this._fullAutoCompletedQuery=null},e.prototype.fullAutoCompleteOffset=function(n,t){var i=n.startsWith(t);return i?t.length:-1},e.prototype.infixAutoCompleteOffset=function(n,u){var f=n.search("[ .:,\\\\/+_&-]"+u.replace(t,function(n){return i[n]})),e,o;return f>0&&(e=n.substring(0,f+1).match(r)[1],o=e?e.match(/[ .:,\\/+_&-]+/g).length+1:1,o<3)?f+1+u.length:-1},e.prototype.directNavAutoCompleteOffset=function(n,t){var i=t.match(u),r;return i&&(r=i[1],r.length>0&&n.startsWith(i[1]))?r.length:-1},e.prototype.setAutoCompletedQuery=function(t,i,r){var u=t+i.slice(r);n.Host.setAutoCompleteQueryText(u);this._autoCompletedQuery=i;this._fullAutoCompletedQuery=u},e}();n.WSBAutoComplete=e}(WSB||(WSB={})),function(n){var t;(function(t){function o(n){return{fullySuppressedGroups:n.fullySuppressedGroups?n.fullySuppressedGroups.slice(0):[],partiallySuppressedGroups:n.partiallySuppressedGroups?n.partiallySuppressedGroups.slice(0):[],suppressedSuggestions:n.suppressedSuggestions?n.suppressedSuggestions.slice(0):[]}}function s(n){return n.type=="SW"||n.type=="PWL"}function i(n,t){return!n.suppressed&&n.handoffType==0&&!n.htmlContent&&n.query.toLocaleLowerCase()==t.queryToFetch.toLocaleLowerCase()}function f(n){return n.length>=2&&n[0].type=="MB"&&n[1].type=="MB"}var r,u,e;(function(n){n[n.NotDuplicate=0]="NotDuplicate";n[n.NoMetadata=1]="NoMetadata";n[n.MergeMetadata=2]="MergeMetadata"})(r||(r={}));u={"{1AC14E77-02E7-4E5D-B744-2EB1AE5198B7}\\cmd.exe":{appToPromote:"Microsoft.WindowsTerminal_8wekyb3d8bbwe!App",enabled:n.config.promoteTerminalOverCmd},"Microsoft.Windows.MediaPlayer32":{appToPromote:"Microsoft.ZuneMusic_8wekyb3d8bbwe!Microsoft.ZuneMusic",enabled:n.config.demoteWindowsMediaPlayer}};t.isWebSuggestionForPrefix=i;t.topHitIsMultiEntity=f;e=function(){function t(t,i,r,u,f,e,o,s,h){var c=this;this._navigationHelper=t;this._lightweightStorage=i;this._previousKeystrokeCache=r;this._conversationCache=u;this._ranker=f;this._renderedTopResults=e;this._previewPane=o;this._imageSearchViewModel=s;this._upsellViewModel=h;n.config.enableConversationCache&&this._conversationCache&&n.Host.bindDismissed(function(){c._conversationCache.clean()})}return t.prototype.launchWebSearch=function(t,i,r,u,f){var e=t.queryToFetch;n.Host.launchSearch(e,this._navigationHelper.getSearchUrl(t.fullPartialQuery,e,r,null,u,undefined,undefined,undefined,undefined,f),i)},t.prototype.getProtocol=function(t,i){var u="PWL",r=n.InstrumentationHelper.getInstrumentedSyntheticSuggestion(i,u),f;return r?r:(r=n.createSuggestion(t,null,n.Host.getEdgeIcon,null,u,null,n.InstrumentedItem.getNonSuggestionInstrumentedItem(u,n.SyntheticQSCodesMaps.KValues),1,i,!1,"tp",function(){return n.Host.launchUri(r.url)}),r.notAResult=!0,f=function(t){var i=n.prettyPrintUrl(t.fixedUrl,t.queryToFetch,!0);r.url=t.fixedUrl;r.tooltip=t.fixedUrl;r.query=i;r.text=HitHighlightingParser.addMarkers(i);r.narratorText=n.getNarratorText(r,n.Host.getLocString("DirectNavSuggestion"));r.reactKey=u+t.fixedUrl},f(t),r.updateFromQuery=function(n){return n.isProtocol?(f(n),!0):!1},n.InstrumentationHelper.instrumentSyntheticSuggestion(i,r),r)},t.prototype.getWebSearch=function(t,i,r,u,f,e){var o=this,s=n.contains([13,14],f);return n.getSyntheticSuggestion(t,i,r,u,f,e,s,function(n,t){return o.launchWebSearch(t,n.useRaf,r,f,n.msbVerticalHash)})},t.prototype.getExplorerSearch=function(t,i){var r=n.getSyntheticSuggestion(t,i,"SDFE",{content:"&#xEC50",type:1},2,n.Host.getLocString("SearchInFileExplorer"),!0,function(t,i){return n.Host.launchSearchInFileExplorer(i.queryToFetch)});return n.shouldSetThisPcGroupSource(n.GroupType.Documents,t)&&(r.sourceForGroup=1),r},t.prototype.getOutlookWebAccessSearch=function(t,i){var r=n.AccessTokenManager.getWindowsAccountType()==1;return n.getSyntheticSuggestion(t,i,"OWA",{content:"&#xE715",type:2},r?8:12,n.Host.getLocString("SearchInOutlookWeb"),!0,function(){return n.Host.launchUri(r?"https://outlook.office.com/owa":"https://outlook.live.com/owa")})},t.prototype.getStoreSearch=function(t,i){return n.getSyntheticSuggestion(t,i,"STS",{content:"&#xEA96",type:2},3,n.Host.getLocString("SearchForAppsInTheStore"),!0,function(t,i){return n.Host.launchStoreSearch(i.queryToFetch)})},t.prototype.getRecourse=function(t,i){var r;if(!t.queryToFetch||t.taskFrame)return null;switch(n.getEffectiveScope(t)){case n.Scope.Apps:return n.isBingEnabled()&&((r=SearchAppWrapper.CortanaApp.isStoreAppEnabled)!==null&&r!==void 0?r:!0)?this.getStoreSearch(t,i):null;case n.Scope.Documents:return this.getExplorerSearch(t,i);case n.Scope.Emails:return n.ScopeConfig[n.Scope.Emails].showUpsellOnSuggestionsList()?null:this.getOutlookWebAccessSearch(t,i);case n.Scope.Photos:return n.isBingEnabled()?this.getWebSearch(t,i,"SBI",{content:"&#xEB9F",type:2},13,n.Host.getLocString("SearchForWebImages")):null;case n.Scope.Videos:return n.isBingEnabled()?this.getWebSearch(t,i,"SBV",{content:"&#xE714",type:1},14,n.Host.getLocString("SearchForWebVideos")):null;default:return null}},t.prototype.getSyntheticSuggestions=function(t,i){var s=this,h=n.getScopeConfig(t),a=h.webSyntheticEnabled&&h.webSyntheticEnabled(t),v=a?this.getWebSearch(t,i,"SW",n.getSearchSuggestionIcon(),0,n.getWebSuggestionAnnotation(n.msbEnabledForQuery(t))):null,y=t.isProtocol&&n.RuntimeConfig.AllowProtocolSyntheticSuggestions?this.getProtocol(t,i):null,e=this.getRecourse(t,i),r,u,c,f,o,l;if(e&&(e.rankingScore=-Number.MAX_VALUE),r=[],this._imageSearchViewModel&&t.isSearchHomeZI&&t.scope==n.Scope.All&&r.push(this._imageSearchViewModel.getSnipSearchSyntheticSuggestion(t,i)),this._upsellViewModel&&r.push(this._upsellViewModel.getUpsellSyntheticSuggestion(t,i)),u=[],typeof n.isMsbWorkScopeApplicable=="function"&&n.isMsbWorkScopeApplicable()&&typeof n.msbVerticalManager=="object")for(u=n.msbVerticalManager.getSyntheticSuggestions(t,i),c=function(i){var f,r,u,e;if(i&&(i.click=function(){return s.launchWebSearch(t,i.useRaf,i.type,i.handoffType,i.msbVerticalHash)},n.config.msbVerticalEnableChildSuggestions&&i.childSuggestions!=undefined))for(f=function(n){n.click=function(){return s.launchWebSearch(t,n.useRaf,n.type,n.handoffType,n.msbVerticalHash)}},r=0,u=i.childSuggestions;r<u.length;r++)e=u[r],f(e)},f=0,o=u;f<o.length;f++)l=o[f],c(l);return{protocol:y,searchTheWeb:v,recourse:e,msbVerticals:u,others:r.filter(function(n){return!!n})}},t.prototype.canHaveDuplicates=function(t,i){switch(t){case"Web":case"MRU":case"OSTMA":case"MSBC":case"MSBS":case"QS":case"PP":case"IBA":case"LRA":case"ST":case"FL":case"LM":case"IFF":case"LDIC":case"CG":case"PT":case"MPP":case"MST":case"MFF":case"MRS":case"ODC":case"MPVD":case"MDOC":case"MFOL":case"MPHO":case"MVID":case"MMUS":case"SSUE":case"SSUC":case"ANA":return!0;case"FEH":case"TOPP":case"QSCH":case"DFLS":case"CUSE":case"WWE":case"MSNN":case"SREE":return!1;case"SSEE":return i.scope==n.Scope.Documents||i.scope==n.Scope.Emails||n.RuntimeConfig.QfMode==5;case"SSEC":return i.scope==n.Scope.Emails}throw new Error("New data source "+t+" needs to be explicity classified as needed deduping with other data sources or not");},t.prototype.canHaveDuplicatesWithinDataSource=function(t,i){switch(t){case"MPP":case"MST":case"MRU":case"ST":return!0;case"SSEE":case"SSEC":return i.scope==n.Scope.Emails}return n.supportsShortcuts(t,i)},t.prototype.mergeDuplicates=function(t,i,u){var f=n.isDuplicate(t,i,u);return f?(i.type==="MFIL"||u.type==="MFIL")&&n.config.msbReplaceDupLocalFiles&&u.type==="MFIL"?!0:(f==r.MergeMetadata&&n.enrichMetadataFromDuplicate(t,i,u),i.duplicates=i.duplicates||[],n.contains(i.duplicates,u)||(i.duplicates.push(u),i.needsRefreshAfterDeduping=!0,i.previewPaneNeedsRefreshAfterDeduping=f==r.MergeMetadata),!0):!1},t.prototype.rank=function(t,r,u,f,e,s,h,c){var ti,ct=this,lt,ii=n.isL2(f),et,vt,si,hi,pt,ci,tt,b,it,wt,rt,ut,ot,kt,k,dt,st,v,nt,li,ht,gt,ai,ni,d,vi;ii&&(h=!1);var g=u.Web,at=g?g.rankingSignals:null,yi=g?g.webTopResultRoutingType:1,ft=u.MRU,ri=null,l=null,ui=null;at&&(at.WebSignalsAvailable=!0,ri=g.engagementSignals,l=g.suppressedGroups,(n.config.groupsToNeverFullySuppress||[]).length>0&&l&&(l.fullySuppressedGroups||[]).length>0&&(et=[],vt=[],l.fullySuppressedGroups.forEach(function(t){n.contains(n.config.groupsToNeverFullySuppress,t)?et.push(t):vt.push(t)}),et.length>0&&(l=o(l),l.fullySuppressedGroups=vt,(ti=l.partiallySuppressedGroups).push.apply(ti,et))));this._previousKeystrokeCache&&(ui=this._previousKeystrokeCache.getPreviousEventWebSignalsData(f.queryToFetch));var pi=ft?ft.SuggestionEngagementData:null,wi=ft?ft.LookupCompletions:null,bi={cvid:n.Host.getConversationId(),privacyNumber:n.Host.getPrivacyNumber()},a=this.getSyntheticSuggestions(f,s);if(f.scope!=n.Scope.Web&&n.config.enableSearchTheWebMaxSuggestions){var fi=[n.GroupType.SearchSuggestions,n.GroupType.Websites],ei=["ANAH","ANATH"],yt=t.filter(function(t){return t.type!="SW"&&n.contains(fi,n.getGroupType(t))&&!n.contains(ei,t.type)}),oi=r.filter(function(t){return t.type!="SW"&&n.contains(fi,n.getGroupType(t))&&!n.contains(ei,t.type)}),w=n.config.searchTheWebMaxSuggestionsCount;if(n.config.enableProgressiveSearchTheWebMaxSuggestions)switch(f.queryToFetch.length){case 0:case 1:case 2:case 3:break;case 4:w+=1;break;case 5:w+=2;break;case 6:w+=4;break;case 7:w+=6;break;default:w=25}yt.length>=w?(oi.map(function(n){return n.suppressed=!0}),si=0,yt.forEach(function(n){return n.suppressed=si++>=w})):(hi=1,pt=w-yt.length,pt>0&&oi.filter(function(){return hi++>=pt}).map(function(n){return n.suppressed=!0}))}if(r=r.slice(),l&&(l.fullySuppressedGroups&&l.fullySuppressedGroups.length>0&&(this.removePromotedFSUPGroups(r,l.fullySuppressedGroups),r=r.filter(function(t){return!n.contains(l.fullySuppressedGroups,String(ct.getGroupTypeForSuppressions(t)))})),l.suppressedSuggestions&&l.suppressedSuggestions.length>0&&(r=r.filter(function(t){return!n.contains(l.suppressedSuggestions,n.getSuggestionKey(t))}))),n.config.suppressFileFolders&&f.queryToFetch.length<n.config.maxPrefixLengthForSupp&&f.scope==n.Scope.All&&(ci=[n.GroupType.Documents,n.GroupType.Folders],r=r.filter(function(t){return!n.contains(ci,n.getGroupType(t))})),t.length==0&&(a.others.length>0&&r.unshift.apply(r,a.others),a.protocol&&r.unshift(a.protocol),((lt=a.msbVerticals)===null||lt===void 0?void 0:lt.length)>0&&r.unshift.apply(r,a.msbVerticals)),this.ensureUniqueReactKeys(r),tt=e.length==1&&e[0].childSuggestions&&e[0].childSuggestions.some(function(n){return n.displayed}),b=this.getSuggestionsToRank(tt,t,r,a,s),n.config.bypassRankerOnNoNewSuggestions&&r&&r.length&&(f.hasNewSuggestions=!0),it=[],n.config.enableConversationCache&&this._conversationCache&&!n.isL2(f)&&(this._conversationCache.refreshPartialQuery(f.queryToFetch),it=n.config.enableConversationCacheSearchTheWeb?b.filter(function(n){return ct.shouldCacheSuggestion(n,f)&&n.type=="AS"}):b.filter(function(n){return ct.shouldCacheSuggestion(n,f)&&n.type!="SW"}),it.length>0&&f.queryToFetch.length>0)){wt=!1;t.some(function(n){return n.type=="SW"})&&(wt=!0);t=this._conversationCache.retrieveSuggestionsFromCache(!0);for(rt in t)t[rt].sequenceNumber!=s&&(t[rt].sequenceNumber=s,t[rt].instItem=n.InstrumentedItem.createInstrumentedItem(s,t[rt].type));r=it;b=this.getSuggestionsToRank(tt,t,r,a,s);wt&&a.searchTheWeb&&t.push(a.searchTheWeb)}ut=this._ranker.rank(f,b,at,pi,wi,ri,bi,ui,c,a);this._previousKeystrokeCache&&!h&&this._previousKeystrokeCache.updateSpellerTriggerData(f.queryToFetch,b);t.length==0&&a.recourse&&r.push(a.recourse);var y=this.determineTopResults(e,r,ut,a,f,s,tt),bt=t.filter(function(t){return!n.contains(e,t)}),p=this.determineSuggestionsToAddToGroups(ii,bt,r,e,y,a,f,tt,h);if(!n.RuntimeConfig.FlatListWithoutGroups&&ut.mruSuppressions&&ut.mruSuppressions.backPropDataExists)this.applyMRUSuppressions(ut,e,y,p,f);else if(l&&l.partiallySuppressedGroups&&this.canPartiallySuppressGroups(y,p,f))for(ot=0,kt=p;ot<kt.length;ot++)if(k=kt[ot],!i(k,f)&&(dt=this.getGroupTypeForSuppressions(k),this.canBePartiallySuppressed(k,dt)&&n.contains(l.partiallySuppressedGroups,String(dt))&&!n.contains(e,k))){if(k.sequenceNumber<n.config.minSequenceForPSUP)continue;k.suppressed=!0}if(st=[],this.removeProtocolIfDuplicate(f,a,y,bt,p,st),this.setUseRafFlag(y,p,f,yi),v=this.getGroupOrder(f,p,bt),f.staticGroupOrder){for(nt=[],li=function(n){var t=v.findIndex(function(t){return t.type==n});t>=0&&(nt.push(v[t]),v.splice(t,1))},ht=0,gt=f.staticGroupOrder;ht<gt.length;ht++)ai=gt[ht],li(ai);nt.length>0&&(nt.push.apply(nt,v),v=nt)}else f.forceGroupOnTop&&(ni=f.forceGroupOnTop,d=v.findIndex(function(t){return n.sameGroup(t,ni)}),d>=0&&(v.splice(d,1),v.unshift(ni)),d=v.findIndex(function(t){return n.isTopHitChildGroup(t)}),d>=0&&(vi=v[d],v.splice(d,1),v.unshift(vi)));if(n.RuntimeConfig.FlatListWithoutGroups&&(y=y.concat(p.filter(function(n){return!n.suppressed})),p=[],n.trimList(y,n.RuntimeConfig.MaxSuggestionsWhenFlatList,function(i){return!n.contains(t,i)&&!i.notAResult}),st.length!=0))throw new Error("Can't remove suggestions from groups when there are no groups");return n.config.promoteEdgeOverIE&&this.promoteEdgeOverInternetExplorer(p,y),n.config.transitionIEToEdge&&this.transitionInternetExplorerToEdge(y),n.config.enablePartnerPromotions&&this.promotePartnerSuggestions(p,y,f.queryToFetch),n.config.enableConversationCache&&this._conversationCache&&!n.isL2(f)&&it.length>0&&f.queryToFetch.length>0&&(this._conversationCache.setTopResultCount(y.length),this._conversationCache.setSuggestions(b)),{topResults:y,suggestionsToAdd:p,suggestionsToRemove:st,groupOrder:v}},t.prototype.removePromotedFSUPGroups=function(t,i){var r=function(r){var e=t[t.findIndex(function(n){return n.deviceItem&&n.deviceItem.id==r})],f;e&&(f=u.getGroupTypeForSuppressions(e).toString(),n.contains(i,f)&&n.tryRemove(i,f))},u=this;for(var f in n.config.disableFSUPPartnerAppIds)r(f)},t.prototype.shouldCacheSuggestion=function(t,i){var h=this._conversationCache.isSuggestionCached(t,i),u,f,o,e,s,r;if(h)return this._conversationCache.update(t),!1;for(u=this._conversationCache.retrieveSuggestionsFromCache(!0),f=0,o=u;f<o.length;f++)if(r=o[f],t.query==r.query&&t.handoffType==r.handoffType){if(t.type=="SW"&&r.type!="SW"&&r.handoffType==0)continue;return!1}if(u.length>50)SharedLogHelper.LogError("shouldCacheSuggestion","We should not cache more than 50 suggestions "+i.queryToFetch);else for(e=0,s=u;e<s.length;e++)r=s[e],!n.isDuplicate(i,r,t)&&this._conversationCache.isCached(t)&&SharedLogHelper.LogError("shouldCacheSuggestion","Suggestion found that was not a duplicate of suggestion in cache "+this._conversationCache.createKeyFromSuggestion(t));return!0},t.prototype.transitionInternetExplorerToEdge=function(t){var u,r=(u=n.Host.getQuery().originalQuery)===null||u===void 0?void 0:u.toLowerCase(),i,f;(r==="ie"||(r===null||r===void 0?void 0:r.startsWith("internet e")))&&(i=t.findIndex(function(t){return t.deviceItem&&n.contains(n.AnaheimAppIds,t.deviceItem.id)}),i>=0&&(t[i].primaryMetadata=n.Host.getLocString("EdgeToIEUpsell"),t[i].classNames.twoLineMax||t[i].classNames.push("twoLineMax"),f="&ciaid=actpermedge&source=windowsSearch",t[i].click=n.config.useCobaltCSS?function(){return n.Host.launchUri("https://go.microsoft.com/fwlink/?linkid=2181241"+f)}:function(){return n.Host.launchUri("https://go.microsoft.com/fwlink/?linkid=2181242"+f)}))},t.prototype.promoteEdgeOverInternetExplorer=function(t,i){var r=i.findIndex(function(t){return t.deviceItem&&t.deviceItem.id==n.InternetExplorerId}),u=t.findIndex(function(t){return t.deviceItem&&n.contains(n.AnaheimAppIds,t.deviceItem.id)});r>=0&&u>=0&&(i.unshift(t.splice(u,1)[0]),t.unshift(i.splice(r+1,1)[0]))},t.prototype.promotePartnerSuggestions=function(n,t,i){var r=function(r){if(!u[r].enabled)return"continue";var e=t.findIndex(function(n){return n.deviceItem&&n.deviceItem.id==r}),f=n.findIndex(function(n){return n.deviceItem&&n.deviceItem.id==u[r].appToPromote});e>=0&&f>=0&&n[f].query.toLocaleLowerCase().includes(i)&&(t.unshift(n.splice(f,1)[0]),n.unshift(t.splice(e+1,1)[0]))};for(var f in u)r(f)},t.prototype.applyMRUSuppressions=function(t,r,u,f,e){var h,l,s,o;if(this.canPartiallySuppressGroups(u,f,e)){var c={};for(h=0,l=f;h<l.length;h++)if(s=l[h],!i(s,e)&&(o=n.getGroupType(s),this.canBePartiallySuppressed(s,o))){if(!c[o]){var a=t.mruSuppressions.maxGroupCCR?t.mruSuppressions.maxGroupCCR[o]||0:0,v=t.mruSuppressions.maxGroupProbSugClickGivenPref?t.mruSuppressions.maxGroupProbSugClickGivenPref[o]||0:0,y=t.mruSuppressions.mruGroupRatios?t.mruSuppressions.mruGroupRatios[o]||0:0,p=t.mruSuppressions.mruGroupBackpropRatios?t.mruSuppressions.mruGroupBackpropRatios[o]||0:0,w=t.mruSuppressions.mruGroupBackpropWeights?t.mruSuppressions.mruGroupBackpropWeights[o]||0:0,b=3.34728026*a+3.523466*v+3.72204852*y+.5865976*p+1.37432766*w+-1.75450325,k=1/(1+Math.exp(-b));c[o]=n.trimFeatureStoreValue(k)}s.mruSuppressionScore=c[o];s.mruSuppressionScore<n.config.lRModelCutOff&&(n.contains(r,s)||(s.suppressed=!0))}}},t.prototype.allowedInGroups=function(n){return n.isAnswer?n.allowedInGroups:!0},t.prototype.getGroupTypeForSuppressions=function(t){var i=n.getGroupType(t);return i==n.GroupType.LocalPlaces?n.GroupType.SearchSuggestions:i},t.prototype.canBePartiallySuppressed=function(t,i){return n.getScope(i)!=n.Scope.All},t.prototype.canPartiallySuppressGroups=function(t,i,r){return t.every(function(n){return!n.query.toLocaleLowerCase().includes(r.queryToFetch)})?!1:n.RuntimeConfig.ScopesAvailable?t.every(function(t){return n.getGroupType(t)==n.GroupType.SearchSuggestions})&&i.every(function(t){return n.getGroupType(t)==n.GroupType.SearchSuggestions})?!1:!0:!1},t.prototype.isProtocolDuplicate=function(t,i,r){return t==r?!1:t.type=="MD"?!0:t.handoffType==1&&n.isDuplicateUrl(i,t.url,r.url)},t.prototype.removeProtocolIfDuplicate=function(t,i,r,u,f,e){var h=this,o,s;i.protocol&&(o=function(n){return!n.suppressed&&h.isProtocolDuplicate(n,t,i.protocol)},(r.some(o)||u.some(o)||f.some(o))&&(n.tryRemove(r,i.protocol)?r.length||(s=n.removeFirstWhere(u,o)||n.removeFirstWhere(f,o),r.push(s)):n.tryRemove(f,i.protocol)||n.contains(u,i.protocol)&&(n.config.enableConversationCache||e.push(i.protocol)),i.protocol=null))},t.prototype.getSuggestionsToRank=function(t,i,r,u){t&&(i=i.filter(function(t){return!n.isChildSuggestion(t)}));u.recourse&&(i=i.filter(function(n){return n!=u.recourse}));var f=i.concat(r);return n.config.enableConversationCache&&this._conversationCache?u.searchTheWeb&&!n.contains(f,u.searchTheWeb)&&f.push(u.searchTheWeb):u.searchTheWeb&&!n.contains(i,u.searchTheWeb)&&f.push(u.searchTheWeb),n.config.topHitMuse&&f.forEach(function(n){var t,i,r,u;return n.tooltip="Rank:"+((t=n.rankingScore)===null||t===void 0?void 0:t.toString())+" launch:"+((i=n.anaheimRankingSignals)===null||i===void 0?void 0:i.visitCount)+" DateV:"+((u=(r=n.anaheimRankingSignals)===null||r===void 0?void 0:r.dateVisited)===null||u===void 0?void 0:u.toString())}),f},t.prototype.determineTopResults=function(t,r,u,e,o,h,c){var ot=this,tt,a,k,l,d,v,y,p,it,g,et,nt,rt,ut,w,b;if(c||!o.queryToFetch||n.config.stickyTopResultsV2&&t.length>1&&!n.isL2(o))return t;if(n.config.shGAWDx&&(tt=r.filter(function(n){return n.previewPaneType===4}),tt.length>0))return t.push(tt[0]),t;if(n.config.enableAnaheimDataQFAggressive&&(a=r.filter(function(n){return n.type=="ANAH"}).sort(function(n,t){return t.rankingScore-n.rankingScore}),k=r.filter(function(n){return n.type=="PP"||n.type=="ST"}),a.length>0&&!((k===null||k===void 0?void 0:k.length)>0)))return t.push(a[0]),t;if(o.inorganic&&o.queryToFetch){if(t.length>0)return t;if(e.searchTheWeb.query===o.queryToFetch)return t.push(e.searchTheWeb),t}if(l=u.topResults,d=this._previewPane?this._previewPane.getPreviewedSuggestionToForceTopHit():null,d&&this._ranker.allowInTopHit(o,d)&&(v=function(t){return n.isEquivalentForPreviewPanePurposes(o,d,t)},y=l.findIndex(v),y!=0&&(p=void 0,y>0?(p=l[y],l.splice(y,1)):p=t.find(v)||r.find(v)||(e.searchTheWeb?[e.searchTheWeb]:[]).find(v),p&&l.unshift(p))),e.protocol&&e.searchTheWeb&&this._ranker.allowInTopHit(o,e.protocol)&&n.tryRemove(l,e.searchTheWeb),e.searchTheWeb&&(it=l.indexOf(e.searchTheWeb),it>=0&&l.some(function(n){return n!=e.searchTheWeb&&i(n,o)})&&l.splice(it,1)),l.length==0&&(n.config.stickyTopResultsV2&&t.length>0?l.push.apply(l,t):e.protocol&&this._ranker.allowInTopHit(o,e.protocol)?l.push(e.protocol):e.searchTheWeb&&this._ranker.allowInTopHit(o,e.searchTheWeb)?l.push(e.searchTheWeb):e.recourse&&this._ranker.allowInTopHit(o,e.recourse)&&l.push(e.recourse)),g=n.getEffectiveScope(o)==n.Scope.Emails?n.config.maxNumberOfEmailsInTopResult:Math.max(n.config.maxNumberOfTopResults,f(l)?2:0,t.length),n.config.bypassFallbackOnMSBTopHit==4&&l.length>0&&n.isMsbOnlineSuggestionType(l[0].type)&&(g=2),l.length>g&&(l=l.slice(0,g)),n.config.synthWebNoBestMatch&&l.length==1){var ft=[n.GroupType.SearchSuggestions,n.GroupType.Websites],st=r.filter(function(t){return!n.contains(ft,n.getGroupType(t))}),ht=l.filter(function(t){return!n.contains(ft,n.getGroupType(t))});st.length==0&&ht.length==0&&(l=[])}for(et=function(i){var u=t[i];if(!n.contains(l,u)){if(n.config.enableConversationCache&&l.some(function(t){return n.isDuplicate(o,u,t)}))return"continue";u.useRaf&&(u.useRaf=!1);u!=e.searchTheWeb&&r.unshift(u)}},nt=t.length-1;nt>=0;--nt)et(nt);if(l.length==1&&n.safeExecute(function(){return ot.applyAppOverride(l,r)},"applyDeviceInfoOverride"),l.forEach(function(n){return n.suppressed=!1}),rt=n.isL2(o),n.config.stickyTopResultsV2&&l.length==1&&t.length==1&&!rt&&(ut=l[0],w=t[0],ut==w||s(w)||n.config.msbDisableStickyWeb&&n.isWebSuggestion(w)&&n.isMsbOnlineSuggestionType(ut.type)||l.unshift(w)),n.config.stickyTopResultsV2&&t.length==1&&n.config.enableSuperStickySWTopHit){var ct=l.filter(function(n){return n.handoffType==0}),lt=l.filter(function(n){return n.type=="ANAH"}),a=r.filter(function(n){return n.type=="ANAH"}).sort(function(n,t){return t.rankingScore-n.rankingScore});lt.length==0&&a.length>0?l.push(a[0]):e.searchTheWeb&&ct.length==0&&t[0].rankingScore<1&&this._ranker.allowInTopHit(o,e.searchTheWeb)&&l.push(e.searchTheWeb)}return n.config.enableMRUHint&&l.length>0&&this._previousKeystrokeCache&&(b=this._previousKeystrokeCache.getPreviousTopHit(),b&&b.mruHintEnabled&&b.text==l[0].text&&b.type==l[0].type&&(l[0].mruHintEnabled=!0)),n.config.enableCISpeller&&l.length==1&&this._previousKeystrokeCache&&(l[0].type=="PP"||l[0].type=="ST")&&this._previousKeystrokeCache.setPreviousTopHit(rt?null:l[0]),n.config.enableConversationCache&&l.length==2&&n.isDuplicate(o,l[0],l[1])&&l.splice(1,1),n.config.topHitMuse&&l.forEach(function(n){var t,i,r,u;return n.tooltip="thRank:"+((t=n.rankingScore)===null||t===void 0?void 0:t.toString())+" thlaunch:"+((i=n.anaheimRankingSignals)===null||i===void 0?void 0:i.visitCount)+" thDateV:"+((u=(r=n.anaheimRankingSignals)===null||r===void 0?void 0:r.dateVisited)===null||u===void 0?void 0:u.toString())}),l},t.prototype.applyAppOverride=function(n,t){var r=["Microsoft.Office.WINWORD.EXE","{6D809377-6AF0-444B-8957-A3773F02200E}\\Windows NT\\Accessories\\wordpad.exe"],u=n[0].deviceItem?n[0].deviceItem.id:null,i;u&&u.startsWith(r[1])&&(i=t.findIndex(function(n){return n.deviceItem&&n.deviceItem.id&&n.deviceItem.id.startsWith(r[0])}),i>=0&&n.splice(0,1,t[i]))},t.prototype.setUseRafFlag=function(t,i,r,u){var f,o,e;if(n.isCortanaEnabledCache&&u==2)for(f=0,o=t;f<o.length;f++)e=o[f],e.handoffType!=0||e.isAnswer||(e.useRaf=!0)},t.prototype.determineANASuggestionsToRemove=function(t,i,r){var u=n.canShowAnaheimDataSH(this._lightweightStorage),f=n.canShowAnaheimDataSHTile(this._lightweightStorage),e=n.canShowAnaheimDataSHList(this._lightweightStorage);u&&r.scope==n.Scope.All&&t.forEach(function(t,r){n.config.enableAnaheimDataTSTile&&(f?t.type=="TOPL"&&i.push(r):t.type=="ANAT"&&i.push(r));e?t.type=="QSSG"&&i.push(r):(t.type=="ANAH"||n.config.enableAnaheimDataTSList&&t.type=="ANAT")&&i.push(r)})},t.prototype.determineSuggestionsToAddToGroups=function(t,r,u,f,e,o,s,h,c){var k=this,l=u.filter(function(t){return!n.contains(e,t)}),a,v,p,w,y,b;for(n.config.enableConversationCache&&this._conversationCache&&this._conversationCache.isFirstRender()&&!n.isL2(s)&&(l=l.concat(r.filter(function(t){return!n.contains(e,t)}))),a=[],n.RuntimeConfig.FlatListWithoutGroups||l.forEach(function(t,i){k.allowedInGroups(t)||(n.getScope(n.getGroupType(t))==n.Scope.All?a.push(i):t.suppressed=!0)}),this.determineANASuggestionsToRemove(l,a,s),v=a.length-1;v>=0;--v)l.splice(a[v],1);return o.searchTheWeb&&(p=e.indexOf(o.searchTheWeb),p!=-1&&(w=n.removeFirstWhere(l,function(n){return i(n,s)}),w&&(e[p]=w))),y=l.filter(function(t){return n.contains([n.GroupType.SearchSuggestions,n.GroupType.Websites,n.GroupType.LocalPlaces],n.getGroupType(t))}),b=l.filter(n.enforceOriginalOrder),n.config.enableAnaheimRelevance==2&&(y=l.filter(function(t){return n.contains([n.GroupType.Websites,n.GroupType.LocalPlaces],n.getGroupType(t))})),!h&&this.canRenderChildSuggestions(e,c,s)&&this.addChildSuggestions(t,e[0],l),s.queryToFetch&&l.sort(function(n,t){return t.rankingScore-n.rankingScore}),this.insertDefaultSearchTheWeb(s,o,e,r,l,y),l=this.insertSuggestionsToRightPlace(l,b),l=this.insertSuggestionsToRightPlace(l,y),n.config.topHitMuse&&e.forEach(function(n){var t,i,r,u;return n.tooltip="gaRank:"+((t=n.rankingScore)===null||t===void 0?void 0:t.toString())+" galaunch:"+((i=n.anaheimRankingSignals)===null||i===void 0?void 0:i.visitCount)+" gaDateV:"+((u=(r=n.anaheimRankingSignals)===null||r===void 0?void 0:r.dateVisited)===null||u===void 0?void 0:u.toString())}),l},t.prototype.insertDefaultSearchTheWeb=function(t,r,u,f,e,o){var s,h;r.searchTheWeb&&(t.scope==n.Scope.Web||t.scope==n.Scope.All)&&(s=o.findIndex(function(n){return i(n,t)}),f.some(function(n){return i(n,t)})||u.some(function(n){return i(n,t)})?s!=-1&&(h=o[s],o.splice(s,1),e.splice(e.indexOf(h),1)):s==-1&&(o.unshift(r.searchTheWeb),e.unshift(r.searchTheWeb)))},t.prototype.getGroupOrder=function(t,i,r){var u,o,a,f,v,b,h,y,k,d,g,c,p,s;switch(t.scope){case n.Scope.Web:if(!t.queryToFetch)return[{type:n.GroupType.Websites},{type:n.GroupType.SearchSuggestions}];break;case n.Scope.Apps:return[{type:n.GroupType.Apps},{type:n.GroupType.Store}];case n.Scope.Photos:return[{type:n.GroupType.Photos},{type:n.GroupType.SearchSuggestions}];case n.Scope.Videos:return[{type:n.GroupType.Videos},{type:n.GroupType.SearchSuggestions}]}u=r.concat(i);u.sort(function(n,t){return t.rankingScore-n.rankingScore});var w=[],l=[],e=[],nt=function(t){if(t.suppressed)l.push(t);else if(w.push(t),n.config.enableStaticGroupRanking){var r=n.getGroupType(t),i={type:r,source:t.sourceForGroup};e.some(function(t){return n.sameGroup(t,i)})||e.push(i)}};for(o=0,a=u;o<a.length;o++)s=a[o],nt(s);if(l.length!=0&&(u=w.concat(l)),f=[],n.config.enableStaticGroupRanking&&u.length>0&&n.getGroupType(u[0])!=n.GroupType.SearchSuggestions){for(v=[{type:n.GroupType.Apps},{type:n.GroupType.Settings},{type:n.GroupType.Documents,source:1}],n.config.topHitMuse&&(v=[{type:n.GroupType.Apps},{type:n.GroupType.AnaheimDataTopHit},{type:n.GroupType.Settings},{type:n.GroupType.Documents,source:1}]),b=function(t){e.some(function(i){return n.sameGroup(i,t)})&&f.push(t)},h=0,y=v;h<y.length;h++)k=y[h],b(k);e.some(function(t){return n.sameGroup(t,{type:n.GroupType.SearchSuggestions})})&&f.push({type:n.GroupType.SearchSuggestions})}for(d=function(t){var r=n.getGroupType(t),i=g.getTypeWithSource(r,t);f.some(function(t){return n.sameGroup(t,i)})||(n.config.enableStaticGroupRanking&&n.isTopHitChildGroup(i)?f.unshift(i):f.push(i))},g=this,c=0,p=u;c<p.length;c++)s=p[c],d(s);return f},t.prototype.getTypeWithSource=function(t,i){var r=t==n.GroupType.MRUHistory?undefined:i.sourceForGroup;return{type:t,source:r}},t.prototype.addChildSuggestions=function(t,i,r){var u=this;i.calculateChildSuggestions&&i.calculateChildSuggestions();i.childSuggestions&&i.childSuggestions.length>0&&Object.keys(n.config.topHitChildGroups).forEach(function(n,f){var e=parseInt(n),o=u.getMaxChildSuggestions(t,i,e),s;o>0&&(s=i.childSuggestions.filter(function(n){return n.groupType==e}).slice(0,o),s.forEach(function(n,t){n.rankingScore=1e4-100*f-t;r.push(n)}))})},t.prototype.getMaxChildSuggestions=function(t,i,r){var u;return i.type==="MBV"?t?((u=i.childSuggestions)===null||u===void 0?void 0:u.length)||0:n.config.msbVerticalChildSuggestionsInL1||0:n.contains(n.config.suppressedTopHitChildGroups,r)?0:n.config.topHitChildGroups[r]},t.prototype.canRenderChildSuggestions=function(t,i){var r,u;if(n.RuntimeConfig.FlatListWithoutGroups||t.length!=1)return!1;if(r=t[0],n.RuntimeConfig.AlwaysWide){var f=r.previewPaneType===1,e=r.handoffType===21,o=r.type==="MPPL"&&!!r.calculateChildSuggestions;if(!f&&!e&&!o)return!1}return i?r.handoffType===21?n.config.msbVerticalEnableChildSuggestions:this._renderedTopResults.topResults.length==1?(u=this._renderedTopResults.topResults[0],u.hasChildSuggestionsDisplayed&&u.query==r.query&&n.getGroupType(u)==n.getGroupType(r)):!1:!0},t.prototype.insertSuggestionsToRightPlace=function(t,i){var r,e,u,f;if(i.length==0)return t;for(r=[],e=i[0],u=0;u<t.length;u++)f=t[u],f==e?r=r.concat(i):n.contains(i,f)||r.push(f);return r},t.prototype.ensureUniqueReactKeys=function(n){var r={},t,i,u;if(n)for(t=n.length-1;t>=0;t--)i=n[t],r[i.reactKey]?(u=n.splice(t,1),SharedLogHelper.LogError("ensureUniqueReactKeys","Found two suggestions with the same key: "+u[0].reactKey)):r[i.reactKey]=1},t}();t.Aggregator=e})(t=n.Ranking||(n.Ranking={}))}(WSB||(WSB={}));__spreadArrays=this&&this.__spreadArrays||function(){for(var i=0,n=0,r=arguments.length;n<r;n++)i+=arguments[n].length;for(var u=Array(i),f=0,n=0;n<r;n++)for(var e=arguments[n],t=0,o=e.length;t<o;t++,f++)u[f]=e[t];return u},function(n){function f(t,i){t(n.getCurrentTime(),n.getInputType(i),i)}function i(n,t){var i=parseInt(n.substr(1),16),r=i>>16&255,u=i>>8&255,f=i&255;return"rgba("+r+","+u+","+f+","+t+")"}function r(n,t){var i=parseInt(n.slice(1),16),r=t<0?0:255,u=t<0?t*-1:t,f=i>>16,e=i>>8&255,o=i&255;return"#"+(16777216+(Math.round((r-f)*u)+f)*65536+(Math.round((r-e)*u)+e)*256+(Math.round((r-o)*u)+o)).toString(16).slice(1)}n.invokeClickHandler=f;n.SinglePaneWidth=344;n.PreviewPaneWidth=440;n.DebugWindowWidth=800;n.CobaltPreviewPaneWidth=386;var t,u="aria-selected",e=function(){function f(i){var r=this,e,f;this.lightweightStorage=i;this._performanceWidget=_ge("performanceWidget");this._root=_ge("root");this._windowsTemporaryMessageShown=!1;this._progressBarVisible=!1;this._previewPaneVisible=!1;this._debugWindowVisible=!1;this._suggestionsContainerHeight=0;this._renderingInProgress=!1;this._narratorLaunchHandlers=[];this._viewData={};this._targetElemCache={};e=new MutationObserver(function(n){var t,o,i,f,s,e;if(!r._renderingInProgress){for(t=[],i=0,f=n;i<f.length;i++)s=f[i],e=s.target,o=e.id,t.push(e.getAttribute(u)=="true"?1:0);(t.length==1&&t[0]==0||t.length==2&&t[0]^t[1])&&r._narratorLaunchHandlers.forEach(function(n){return n(o)})}});e.observe(document,{subtree:!0,attributes:!0,attributeFilter:[u]});n.View.getLocString=function(t){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];return n.Host.getLocString.apply(n.Host,__spreadArrays([t],r))};this.addViewData("TestHooksEnabled",n.TestHookUrlParameters);t=SearchAppWrapper.CortanaApp;this._qfContainer=_ge("qfContainer");this._flyout=_ge("flyoutContainer");this._flyoutOverlay=_ge("overlayContainer");n.Host.bindAppVisible(function(){var i=t.width,u=t.height;i&&u?r.setDimensions(i,u):ThresholdUtilities.getCortanaHeaders(function(n){if(n){var t=n["X-BM-DeviceDimensionsLogical"].split("x"),i=t[0],u=t[1];r.setDimensions(parseInt(i),u)}});r._isFileExplorerOrControlPanel=n.RuntimeConfig.QfMode==5||n.RuntimeConfig.QfMode==9;n.RuntimeConfig.PreviewPaneAvailable&&(r.initPreviewPane(),n.setVisibility(r._previewPane,n.RuntimeConfig.AlwaysWide),!n.RuntimeConfig.AlwaysWide&&n.Host.hasFallbackHappened()&&t.resetToDefaultSize());r.initDebugWindow();r.setConditionalCss("wideByDefault",n.RuntimeConfig.AlwaysWide);r.setConditionalCss("settingsApp",n.RuntimeConfig.QfMode==7);r.setConditionalCss("fileExplorer",r._isFileExplorerOrControlPanel);r.setConditionalCss("panelCanResize",n.RuntimeConfig.PanelCanResize);r.setConditionalCss("flatListWithoutGroups",n.RuntimeConfig.FlatListWithoutGroups);r.setConditionalCss("searchBoxOnTop",n.RuntimeConfig.SearchBoxOnTop);r.setConditionalCss("noScopes",!n.RuntimeConfig.ScopesAvailable);r.setConditionalCss("twoColumns",n.shouldShowTwoColumns());r.setConditionalCss("enableAnaheimData",n.isAnaheimDataEnabled(!0)||n.isAnaheimDataEnabled(!1));r.setConditionalCss("cloudDocsOnTheLeft",n.config.cloudDocsOnTheLeft);r.setConditionalCss("snipSearchEnabled",n.shouldEnableSnipSearch());r.setConditionalCss("wweTour",n.config.enableWWETour);r.setConditionalCss("msnNewsAltUX",n.config.msnNewsAlternativeUX);r.setConditionalCss("edgeUpsell",n.shouldEnableAnaheimResetDefault());r.setConditionalCss("threeFingerTap",n.shouldShowThreeFingerTap());r.setQueryBasedCss(null)});n.Host.bindBootstrapDone(function(){n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().beginMark("WSBPage.bindBootstrapDone");var t=_ge("preBootstrapPane");t&&(n.setVisibility(t,!1),t.remove());n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().endMark("WSBPage.bindBootstrapDone")});n.Host.bindShown(function(){n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().beginMark("WSBPage.bindShown");r.applyAccentColor();r.setThemeBasedCss();r.setConditionalCss("snipSearch",t.entryPoint=="WNSSBS"&&n.config.enableSnipSearchV2);n.setVisibility(r._root,!0);n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().endMark("WSBPage.bindShown")});n.Host.bindAppHidden(function(){n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().beginMark("WSBPage.bindAppHidden");r._openPreviewPaneButtonCache=undefined;n.setVisibility(r._previewPane,!1);n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().endMark("WSBPage.bindAppHidden")});n.Host.bindQueryChangedOrInitialized(function(){n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().beginMark("WSBPage.bindQueryChangedOrInitialized");r._isFileExplorerOrControlPanel&&r.updateFENarratorSuggestionCount(null);n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().endMark("WSBPage.bindQueryChangedOrInitialized")});n.Host.bindSearchBoxClick(function(){n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().beginMark("WSBPage.bindSearchBoxClick");n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().endMark("WSBPage.bindSearchBoxClick")});f=function(){n.RuntimeConfig.AlwaysWide||(r._previewPaneVisible=!1,n.setVisibility(r._previewPane,!1));r.setDebugWindowVisibility(!1)};n.Host.bindDismissed(function(){r.resetSuggestionsContainerHeight();f()});!!this._performanceWidget&&n.View.PerformanceWidget&&(n.setVisibility(this._performanceWidget,!0),n.Host.bindShown(function(){r.renderReactView("performanceWidget",n.View.PerformanceWidget,{keystrokeTimeline:null})}),n.InstrumentationHelper.bindKeystrokeTimelineUpdated(function(t){r.renderReactView("performanceWidget",n.View.PerformanceWidget,{keystrokeTimeline:t})}));n.config.alwaysWideBeforeRS5&&t.addEventListener("openanimationcompleted",function(){r.ensureWebViewWidthExpanded()});t.addEventListener("resettingtodefaultsize",function(){f()});sj_be(sj_b,"contextmenu",function(n){for(var t=n.target;t;){if(t.classList.contains("allowcontextmenu"))break;t=t.parentElement}t||sj_pd(n)})}return f.prototype.setConditionalCss=function(n,t){t?this._root.classList.add(n):this._root.classList.remove(n)},f.prototype.setQueryBasedCss=function(t){this.setConditionalCss("zeroInput19H1",t?t.isSearchHomeZI:n.RuntimeConfig.SearchHomeAvailable==1);this.setConditionalCss("twoPanesZI",n.shouldShowStaticSearchHome(t)||n.shouldShowDSBLayout(t));this.setConditionalCss("dsb",n.shouldShowDSBLayout(t));this.setConditionalCss("transparentMiniserp",n.shouldShowTransparentMiniserp());this.setConditionalCss("allScope",t&&t.scope==n.Scope.All)},f.prototype.setThemeBasedCss=function(){if(n.config.isThemeAware){var t=n.Host.getWindowsTheme();this.setConditionalCss("darkTheme",t==2);this.setConditionalCss("lightTheme",t==1)}else n.config.searchHomeSupported&&(this.setConditionalCss("lightTheme",!0),this.setConditionalCss("lightThemeRS5",!0))},f.prototype.initPreviewPane=function(){var i=t.textScaleFactor||1,r=n.config.useCobaltCSS?n.CobaltPreviewPaneWidth/i:n.PreviewPaneWidth/i;this._previewPane||(this._previewPane=_ge("qfPreviewPane"),this._previewPane.classList.remove("transitionOn"));this._previewPane.style.minWidth=r+"px"},f.prototype.initDebugWindow=function(){this._debugWindow||(this._debugWindow=_ge("qfDebugPane"),this._debugWindow&&(this._debugWindow.style.flexBasis=n.DebugWindowWidth+"px"))},f.prototype.setDimensions=function(n){if(!this._previewPaneVisible&&!this._debugWindowVisible){this.onPaneWidthSet(n);this._originalPaneWidth=n}},f.prototype.ensureWebViewWidthExpanded=function(){var i=n.SinglePaneWidth+n.PreviewPaneWidth;n.RuntimeConfig.QfMode==1&&t.width<i&&(t.setPaneWidth(i),this.setDimensions(i,null))},f.prototype.getScrollTop=function(){return this._qfContainer.scrollTop},f.prototype.scrollToTop=function(){this._qfContainer.scrollTop=0;_d.body.scrollTop=0},f.prototype.scrollTo=function(n){var t=_ge(n.id);this.scrollToElement(t,this._qfContainer,this._qfContainer.offsetHeight)},f.prototype.scrollToElement=function(n,t,i){var u=t.scrollTop,r=n.offsetTop-t.offsetTop,f=r+n.offsetHeight;f>u+i?t.scrollTop=f-i:r<u&&(t.scrollTop=r)},f.prototype.getSuggestionsContainerHeight=function(){return this._suggestionsContainerHeight||this.calculateSuggestionsContainerHeight(),this._suggestionsContainerHeight},f.prototype.getSuggestionsContainerWidth=function(){return(n.MockUrlParameters===null||n.MockUrlParameters===void 0?void 0:n.MockUrlParameters.isTest)?t.width:_w.innerWidth},f.prototype.resetSuggestionsContainerHeight=function(){this._suggestionsContainerHeight=0},f.prototype.calculateSuggestionsContainerHeight=function(){var n=_ge("root").clientHeight,t;n<440&&(n=440);t=_ge("temporaryMessage");n-=t.offsetHeight;this._suggestionsContainerHeight=n},f.prototype.getPanelWidthFor=function(t){var i=this._originalPaneWidth;return i+=t&1?n.PreviewPaneWidth:0,i+(t&2?n.DebugWindowWidth:0)},f.prototype.getPanelState=function(){switch(t.width-this._originalPaneWidth){case 0:return 0;case n.PreviewPaneWidth:return 1;case n.DebugWindowWidth:return 2;case n.PreviewPaneWidth+n.DebugWindowWidth:return 3;default:return 0}},f.prototype.openSidePanel=function(n){var i=this.getPanelState(),u,r;if(i==0&&this.setDimensions(t.width,null),!(i&n)){u=i|n;r=this.getPanelWidthFor(u);t.setPaneWidth(r);this.onPaneWidthSet(r)}},f.prototype.closeSidePanel=function(i){var u=this.getPanelState(),f,r;if(u&i){f=u&~i;r=this.getPanelWidthFor(f);r!=this._originalPaneWidth||n.config.alwaysWideBeforeRS5?t.setPaneWidth(r):t.resetToDefaultSize();this.onPaneWidthSet(r)}},f.prototype.onPaneWidthSet=function(t){n.safeFireEvent("CortanaPaneWidthSet",t)},f.prototype.getOpenPreviewPaneButton=function(){if(!n.RuntimeConfig.PreviewPaneAvailable)return null;if(!this._openPreviewPaneButtonCache){var t=n.isRtl(),i=t?"&#xE96F":"&#xE970";this._openPreviewPaneButtonCache={defaultIcon:{content:i,type:2},openedIcon:{content:t?"&#xE72B":"&#xE72A",type:2},clickHandler:this._openPreviewPaneClickHandler}}return this._openPreviewPaneButtonCache},f.prototype.setContextMenuHandler=function(n){this._contextMenuHandler=n},f.prototype.setSuggestionClickHandler=function(n){this._suggestionClickHandler=n},f.prototype.setOpenPreviewPaneClickHandler=function(n){this._openPreviewPaneClickHandler=n},f.prototype.setExpanderClickInstrumentation=function(n){this._expanderClickInstrumentation=n},f.prototype.updateGroupsView=function(t){var f=this,i;if((n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.forceRenderingCrashOnSecondConversation)&&n.Host.getPaneCloseCount())throw new Error("Simulated exception");this.setQueryBasedCss(t.query);this.setConditionalCss("noSuggestions",t.topResults.length==0&&t.groups.length==0);this.setConditionalCss("msnNewsEnabled",n.shouldEnableMSNNewsSearches(n.Host.getLanguage().toLowerCase()));var r=t.query&&t.query.isSearchHomeZI,e=r?null:((i=t.query)===null||i===void 0?void 0:i.scopePrefix)==="work"?null:" - "+n.getWebSuggestionAnnotation(n.msbEnabledForQuery(t.query)),o=n.config.clearMru&&(!t.query||!t.query.queryToFetch)&&t.groups.length>0&&t.groups[0].type!=n.GroupType.QuickSearch,u={groups:t.groups,contextMenuHandler:this._contextMenuHandler,clickHandler:this._suggestionClickHandler,openPreviewPaneButton:this.getOpenPreviewPaneButton(),isSearchHome:r,webSuggestionAnnotation:e,deleteMRUButtonCallback:o?function(){return f.deleteMRUButtonCallback()}:null,notifyIconPending:function(t,i){return n.InstrumentationHelper.notifyIconPending(t,i)},notifyIconReadyOrFailed:function(t,i){return n.InstrumentationHelper.notifyIconReadyOrFailed(t,i)}};this.renderReactView("groups",n.View.WindowsGroups,n.config.reactGroups?n.deepCopy(u,["parent"],["deviceItem"]):u)},f.prototype.deleteMRUButtonCallback=function(){sj_evt.fire("clearMRUButtonClicked");n.Host.refreshCurrentPane()},f.prototype.updateFENarratorSuggestionCount=function(t){var i="";this._isFileExplorerOrControlPanel&&t&&(i=n.Host.getLocString("SuggestionCountNarrator",""+t));this.updateNarratorMessageView(i)},f.prototype.updateTopResultsView=function(t){var i,r;this.setQueryBasedCss(t.query);this.setConditionalCss("noSuggestions",t.topResults.length==0&&t.groups.length==0);this._isFileExplorerOrControlPanel&&(i=t.topResults.length,this.updateFENarratorSuggestionCount(i>0?i:null));r={suggestions:t.topResults,contextMenuHandler:this._contextMenuHandler,clickHandler:this._suggestionClickHandler,openPreviewPaneButton:this.getOpenPreviewPaneButton(),isSearchHome:t.query&&t.query.isSearchHomeZI,notifyIconPending:function(t,i){return n.InstrumentationHelper.notifyIconPending(t,i)},notifyIconReadyOrFailed:function(t,i){return n.InstrumentationHelper.notifyIconReadyOrFailed(t,i)}};this.renderReactView("topResults",n.View.WindowsTopResults,n.config.reactGroups?n.deepCopy(r,["parent"],["deviceItem"]):r)},f.prototype.showTemporaryMessage=function(t,i,r,u){var f=this,e;this._windowsTemporaryMessageShown?(this.hideTemporaryMessage(),n.safeSetTimeout(function(){return f.showTemporaryMessage(t)},100,"showTemporaryMessage")):(e={messageText:t,icon:i!==null&&i!==void 0?i:{content:"&#xE946",type:2},messageClassName:r!==null&&r!==void 0?r:"slideInMessage",clickHandler:function(){f.hideTemporaryMessage();n.Host.setFocusInSearchBox(null,"temporaryMessage")},action:u},this.updateTemporaryMessageView(e),this._windowsTemporaryMessageShown=!0)},f.prototype.hideTemporaryMessage=function(){this._windowsTemporaryMessageShown&&(this.updateTemporaryMessageView(null),this._windowsTemporaryMessageShown=!1)},f.prototype.updateTemporaryMessageView=function(t){this.renderReactView("temporaryMessage",n.View.WindowsMessage,{dataModel:t})},f.prototype.updateDialogBox=function(t){t.isVisible?n.Host.setFocusInWebView("updateDialogBox"):n.Host.setFocusInSearchBox(null,"updateDialogBox: hidden");this.renderReactView("dialogBox",n.View.WindowsDialogBox,{dataModel:t})},f.prototype.updateRewardsFlyout=function(t){this.renderReactView("rewardsFlyoutContainer",n.View.RewardsFlyout,{dataModel:t})},f.prototype.renderAdvancedOptionsMessages=function(t){this.renderReactView("temporaryOption",n.View.AdvancedOptions,n.config.reactGroups?n.deepCopy({advancedOptions:t}):{advancedOptions:t})},f.prototype.updateTopHitHeaderView=function(t){this.renderReactView("topHitHeader",n.View.TopHitHeader,n.config.reactGroups?n.deepCopy({dataModel:t},["parent"]):{dataModel:t})},f.prototype.createFlyout=function(t,i){var r=this;return n.config.enableEducationalFlyout?(this._flyoutController||(this._flyoutController=new n.FlyoutController(this,i),n.Host.bindQueryChangedOrInitialized(function(n){r._flyoutController.onQueryChange(n)})),this._flyoutController.createFlyout(t)):null},f.prototype.renderFlyoutAreaView=function(t){n.shouldShowThreeFingerTap()?t.dismissFlyoutText=n.Host.getLocString("ThreeFingerTapFlyoutButtonDismissMessage"):(t.acknowledgeFlyoutText=n.Host.getLocString("AcknowledgeFlyoutText"),t.nextFlyoutText=n.Host.getLocString("NextFlyoutText"),t.stepCounterText=n.Host.getLocString("FlyoutStepCounterFormat",(t.currentStep+1).toString(),t.nbSteps.toString()),t.dismissFlyoutText=n.Host.getLocString("DismissFlyout"));this._flyoutController.setQuery(n.Host.getQuery());n.RuntimeConfig.QfMode===0||n.RuntimeConfig.QfMode===4?this._flyout.classList.add("flyoutSinglePane"):this._flyout.classList.remove("flyoutSinglePane");this.renderReactView("flyoutContainer",n.View.Flyout,{dataModel:t});this.showFlyoutAreaView();this.renderReactView("overlayContainer",n.View.Overlay,{dataModel:t});t.overlay&&this.showOverlayAreaView()},f.prototype.showFlyoutAreaView=function(){n.setVisibility(this._flyout,!0);this._flyout.style.animation="none";this._flyout.offsetHeight;this._flyout.style.animation=null},f.prototype.hideFlyoutAreaView=function(){n.setVisibility(this._flyout,!1)},f.prototype.showOverlayAreaView=function(){n.setVisibility(this._flyoutOverlay,!0)},f.prototype.hideOverlayAreaView=function(){n.setVisibility(this._flyoutOverlay,!1)},f.prototype.updateBrandingBarView=function(t){typeof n.View.BrandingBar=="undefined"||typeof n.enableCobaltBranding!="function"||n.enableCobaltBranding()||this.renderReactView("msbBrandingBar",n.View.BrandingBar,{dataModel:t,setToAlignRight:!1})},f.prototype.updateScopesHeaderView=function(t){this.renderReactView("scopesHeader",n.View.ScopesHeader,{dataModel:t})},f.prototype.updateNarratorMessageView=function(t){if(t){var i=_ge("narratorMessageContainer");i.setAttribute("aria-label",t)}this.renderReactView("narratorMessageContainer",n.View.NarratorAnnouncement,{message:t})},f.prototype.updatePreviewErrorMessageView=function(t){this.renderReactView("errorPane",n.View.PreviewErrorMessageContainer,{dataModel:t,icon:{content:"&#xF303",type:2}})},f.prototype.updatePreviewContainerView=function(t){this.renderReactView("localPane",n.View.WindowsPreviewContainer,{dataModel:t,expanderClickInstrumentation:this._expanderClickInstrumentation,chevronDownIcon:{content:"&#xE70D",type:2}})},f.prototype.updateGoodNewsPreviewContainerView=function(t){this.renderReactView("goodNewsPane",n.View.GoodNewsPreviewContainer,{dataModel:t})},f.prototype.updateMsbPreviewContainerView=function(n){var t=_ge("b_bfb"),i,r;t!=null&&(i=_w.BingAtWork,i&&i.clearMsbContainer&&i.clearMsbContainer(),t.remove());r=_ge("msbPane");n.suggestion?(t=sj_ce("div","b_bfb"),t.classList.add("fbig"),r.appendChild(t),r.classList.add("localPreviewContainer","msbPreviewContainer")):r.classList.remove("localPreviewContainer","msbPreviewContainer")},f.prototype.updateMenuView=function(t){this.renderReactView("menuContainer",n.View.WindowsMenu,{dataModel:t})},f.prototype.updatePopoverView=function(t){this.renderReactView("popoverContainer",n.View.Popover,{dataModel:t})},f.prototype.updateSnipSearchMessageView=function(t){this.renderReactView("messageContainer",n.View.SnipSearchMessage,{dataModel:t})},f.prototype.setProgressIndicatorVisibility=function(t){this._progressBarVisible!=t&&(this._progressBar||(this._progressBar=_ge("b_progress")),n.setVisibility(this._progressBar,t),this._progressBarVisible=t)},f.prototype.setPreviewPaneVisibility=function(t){this._previewPaneVisible!=t&&(t||this.closeSidePanel(1),n.setVisibility(this._previewPane,t),t&&this.openSidePanel(1),this._previewPaneVisible=t)},f.prototype.toggleDebugWindowVisibility=function(){return this.setDebugWindowVisibility(!this._debugWindowVisible),this._debugWindowVisible},f.prototype.updateOptionsWindowView=function(t){this.renderReactView("optionsContainer",n.View.OptionsWindow,{dataModel:t})},f.prototype.updateDynamicSearchView=function(t){this.renderReactView("dynamic-pane",n.View.DSB.DynamicSearchBox,{dataModel:t})},f.prototype.setDebugWindowVisibility=function(t){n.setVisibility(this._debugWindow,t);n.RuntimeConfig.AlwaysWide?this.setConditionalCss("debugWindowOpen",t):t?this.openSidePanel(2):this.closeSidePanel(2);this._debugWindowVisible=t},f.prototype.applyAccentColor=function(){var u=n.Host.getAccentColor(),o,e,f,t;this._lastAccentColor!=u&&(e="accent-style",f=_ge(e),f||(f=_d.createElement("style"),f.setAttribute("id",e),f.type="text/css",o=!0),t=":root {",t+="--accent0: "+u+";",t+="--accent1: "+i(u,.3)+";",t+="--accent2: "+i(u,.1)+";",t+="--accent3: "+i(u,.4)+";",t+="--accent4: "+i(u,.6)+";",t+="--accent5: "+i(u,.7)+";",t+="--accent6: "+i(u,.15)+";",t+="--accent7: "+r(u,-.35)+";",t+="--accent8: "+r(u,-.2)+";",t+="--accent9: "+r(u,-.1)+";",t+="--accent10: "+i(u,0)+";",t+="--accent11: "+n.Host.getAccentColor(1)+";",t+="--accent12: "+n.Host.getAccentColor(-2)+";",t+="--accent13: "+n.Host.getAccentColor(2)+";",t+="--accent14: "+n.Host.getAccentColor(-1)+";",t+="--accent15: "+i(u,.9)+";",t+="--accent16: "+i(u,.8)+";",t+="--accent17: "+i(n.Host.getAccentColor(1),.9)+";",t+="--accent18: "+i(n.Host.getAccentColor(1),.8)+";",t+="--accent19: "+i(n.Host.getAccentColor(-2),.9)+";",t+="--accent20: "+i(n.Host.getAccentColor(-2),.8)+";",t+="--accent21: "+r(n.Host.getAccentColor(1),.1)+";",t+="--accent22: "+r(n.Host.getAccentColor(-2),.1)+";",t+="--accent23: "+r(n.Host.getAccentColor(1),.2)+";",t+="--accent24: "+r(n.Host.getAccentColor(-2),.2)+";",t+="}",f.innerHTML=t,o&&_d.head.appendChild(f),this._lastAccentColor=u)},f.prototype.adjustHeightAsync=function(){n.safeSetTimeout(function(){return n.Host.adjustHeight()},0,"adjustHeightAsync")},f.prototype.bindOnNarratorLaunch=function(n){this._narratorLaunchHandlers.push(n)},f.prototype.render=function(t){var i=this;this._renderingTimer&&sb_ct(this._renderingTimer);this._renderingInProgress=!0;try{n.View.ViewData=this.getViewData();t()}finally{this._renderingTimer=n.safeSetTimeout(function(){i._renderingTimer=null;i._renderingInProgress=!1},0,"BasePage render")}},f.prototype.renderReactView=function(t,i,r){var e=this,u,f;n!==undefined&&n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().beginMark("React Render - "+t);u=this._targetElemCache[t];u||(this._targetElemCache[t]=u=_ge(t));f=r;f.adjustHeight||(f.adjustHeight=function(){return e.adjustHeightAsync()});this.render(function(){return _w.ReactDOM.render(React.createElement(i,r),u)},t);n!==undefined&&n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().endMark("React Render - "+t)},f.prototype.addViewData=function(n,t){this._viewData[n]=t},f.prototype.getViewData=function(){return this._viewData},f}();n.Page=e}(WSB||(WSB={}));__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)};__spreadArrays=this&&this.__spreadArrays||function(){for(var i=0,n=0,r=arguments.length;n<r;n++)i+=arguments[n].length;for(var u=Array(i),f=0,n=0;n<r;n++)for(var e=arguments[n],t=0,o=e.length;t<o;t++,f++)u[f]=e[t];return u},function(n){var t=54e5,i=function(){function i(){var t=this;if(this._isReloadSuppressed=!1,this._pendingReload=!1,!navigator.serviceWorker){n.log("Service worker is not available");return}n.Host.hasFallbackHappened()&&(this._isReloadSuppressed=!0,this._lastReloadAfterFallback=n.getCurrentTime());navigator.serviceWorker.ready.then(function(n){t._registration=n});n.Host.bindConversationStart(function(){return t.callWhenSWRegistrationReady(function(){return t.onConversationStart()})});n.Host.bindQueryChangedOrInitialized(function(){t.postMessage("sig",{ig:n.Host.getRawImpressionGuid().replace(/[{}-]/g,"")})},!1);n.Host.bindAppHidden(function(){return t.callWhenSWRegistrationReady(function(){return t.onAppHidden()})});sj_be(navigator.serviceWorker,"message",function(n){return t.onMessage(n)})}return i.prototype.callWhenSWRegistrationReady=function(n){var t=this;this._registration?n():navigator.serviceWorker.ready.then(function(i){t._registration=i;n()})},i.prototype.onConversationStart=function(){var n=this;this._isReloadSuppressed=!0;SearchAppWrapper.CortanaApp.getQueryHeadersAsync?SearchAppWrapper.CortanaApp.getQueryHeadersAsync().then(function(t){n.postMessage("sah",{headers:__assign({},t)});n.shouldCheckForUpdate()&&n.sync("cu")}):this.shouldCheckForUpdate()&&this.sync("cu")},i.prototype.onAppHidden=function(){(this._isReloadSuppressed=this._lastReloadAfterFallback&&n.getCurrentTime()-this._lastReloadAfterFallback<t,this._isReloadSuppressed)||(!this._pendingReload&&n.config.reloadAfterConversations&&n.Host.getPaneCloseCount()>=n.config.reloadAfterConversations&&(this._pendingReload=!0),this._pendingReload&&this.reload())},i.prototype.sync=function(n){this._registration.sync?this._registration.sync.register(n):this.postMessage("sy",{tag:n})},i.prototype.shouldCheckForUpdate=function(){return n.isBingEnabled()?(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.disableAppCache)?!1:!0:!1},i.prototype.onUpdateReady=function(){this._isReloadSuppressed?this._pendingReload=!0:this.reload()},i.prototype.reload=function(){n.Host.reloadWebView()},i.prototype.postMessage=function(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];this._registration.active.postMessage(Object.assign.apply(Object,__spreadArrays([{message:n}],i)))},i.prototype.onMessage=function(n){var t=n.data;switch(t.message){case"ua":this.onUpdateReady()}},i}();n.SuperFreshServiceWorker=i}(WSB||(WSB={})),function(n){var t,i;(function(t){function u(t,i,r,u,f,e,o,s){var h,v;o===void 0&&(o=1);var y=Date.now(),a=(new Error).stack,c,l=function(n){n.stack&&(a=n.stack+"\n"+a);n.stack=a;c&&f.unregister(c);switch(o){case 1:SharedLogHelper.LogError(t,e,s||n);break;case 2:SharedLogHelper.LogWarning(t,e,s||n)}u&&u(n)};try{h=i();h?(f&&h.cancel&&(c=f.register(function(){return h.cancel()},!1,t+" cancellation")),v=function(i){var u=Date.now()-y;n.InstrumentationHelper.instrumentAggregateFunctionPerf(t,u);c&&f.unregister(c);r&&n.safeExecute(function(){return r(i)},t+" safeChain() completion")},h.done?h.done(v,l):h.then(v,l)):l(new Error("No promise returned"))}catch(p){l(p)}}function r(t,i,r,u){i.completed=!0;i.result=r;i.pendingCallbacks.forEach(function(t){return n.safeExecute(function(){return t(r)},u)});i.pendingCallbacks=null}function f(){i={}}function e(){var n=[];for(var t in i)i[t].completed||n.push(t);n.forEach(function(n){return delete i[n]})}function o(u,f,e,o,s,h,c,l,a){return a===void 0&&(a=1),function(v,y){var w=e(v),p=i[w],b;p||(p={started:!1,completed:!1,result:null,pendingCallbacks:[]},i[w]=p);p.completed?y(p.result):(p.pendingCallbacks.push(y),p.started||(p.started=!0,b=function(){t.safeChain(u,function(){return f(v)},function(n){h&&!h(n)&&delete i[w];r(w,p,o?o(n):n,u)},function(t){n.isCancellation(t)?r(w,p,null,u):l?(l-=1,b()):r(w,p,s,u)},null,c,a)},b()))}}t.safeChain=u;var i={};t.clearGlobalCache=f;t.clearPendingItemsFromCache=e;t.safeChainWithGlobalCaching=o})(t=n.Async||(n.Async={})),function(n){function t(n,t,i){for(var u,f,e={},r=0,o=n;r<o.length;r++)u=o[r],f=t[u],f&&(e[u]=i(f));return e}function i(n){for(var t in n)if(n[t])return!1;return!0}n.map=t;n.isEmpty=i}(i=n.Map||(n.Map={}))}(WSB||(WSB={})),function(n){var i="show",t=n.config.useCobaltCSS?23:10,r=function(){function r(t,i,r){var u=this;this._page=t;this._showIcons=i;this.adjustHeight=r;this._root=_ge("root");this._menuStack=[];this._menuContainer=_ge("menuContainer");this._itemClickHandler=function(t,i){i.button==0&&(t.subItems?t.isSelectable&&!t.isExpanded&&(u.showSubMenu(t),t.isSticky=!0):t.click&&t.click(n.getCurrentTime(),n.getInputType(i)))};this._itemEnterHandler=function(t){t.isSelectable&&!t.isExpanded&&(t.subItems&&(u._hoverTimer&&sb_ct(u._hoverTimer),u._hoverTimer=n.safeSetTimeout(function(){u._hoverTimer=0;var n=_ge(t.id);t&&!t.isExpanded&&n&&n.matches(":hover")&&u.showSubMenu(t)},500,"menu item mouse enter")),u.stickParent(t))};this._itemLeaveHandler=function(t){t.isExpanded&&!t.isSticky&&n.safeSetTimeout(function(){var n=_ge(t.id);t&&!t.isSticky&&n&&!n.matches(":hover")&&(t.subItems.some(function(n){return n==u._selectedItem})&&u.select(null,!1),u.dismissSubMenu(t))},450,"menu item mouse leave")};sj_be(_d.body,"mouseup",function(n){u._menuContainer.contains(n.target)||u.dismiss()});n.TestHookUrlParameters||sj_be(_w,"blur",function(){return u.dismiss()});sj_evt.bind("ajax.threshold.pageStart",function(){return u.dismiss()});n.Host.bindKeyEscape(function(n){u.isMenuVisible()&&(n.handled=!0,u._menuStack.length>0?u.reselectParentItem():u.dismiss(!0))})}return r.prototype.showSubMenu=function(t){if(!t.isExpanded){this._selectedItem&&this.select(null,!1);var i=_ge(t.id),r=i.querySelector(".contextMenu");t.isExpanded=!0;n.setVisibility(r,!0);this.adjustSubMenuPosition(i,r);this._menuStack.push(t);this._page.updateMenuView(this.getDataModel())}},r.prototype.dismissSubMenu=function(t){var u,f,i,e,r;if(this._selectedItem&&this.select(null,!1),t){if(i=this._menuStack.indexOf(t),i<0)return;for(e=this._menuStack.slice(i),r=0;r<e.length;++r)this.dismissSubMenu()}else t=this._menuStack.pop(),u=_ge(t.id),f=u.querySelector(".contextMenu"),t.isExpanded=!1,t.isSticky=!1,n.setVisibility(f,!1);this._page.updateMenuView(this.getDataModel())},r.prototype.showMenu=function(t,r){var u=this,e,h,f,o,c,s;if(this._menuItems.length){for(n.setVisibility(this._menuContainer,!0),e=this.getDataModel(),this._page.updateMenuView(e),h=function(n){n.getIcon&&n.getIcon(1,function(t){n.icon=t;u._page.updateMenuView(u.getDataModel())})},f=0,o=this._menuItems;f<o.length;f++)c=o[f],h(c);s="renderContextMenu";n.safeSetTimeout(function(){u.adjustPosition(t,r,e.menuType!=0);u._menuContainer.classList.add(i);var f=_qs("#menuContainer > .contextMenu");f.focus();f.scrollTop=0;n.Host.setFocusInWebView(s)},0,s)}},r.prototype.innerShowContextMenu=function(n,t,i,r,u,f){this.dismiss();var e=this.getContextMenuItems(n,r);e&&e.length>0&&(this._menuItems=e,this._onDismiss=u,this._menuType=0,this._inputType=f,t-=this._root.offsetLeft,i-=this._root.offsetTop,this.showMenu(t,i))},r.prototype.showDropdownMenu=function(t,i,r,u,f){if(this.dismiss(),this._parentElement=i,this._inputType=f,t&&t.length>0){this._menuItems=t;this._onDismiss=u;this._menuType=r;var e=i.offsetLeft,o=i.offsetTop+i.offsetHeight+1;n.isRtl()&&(e+=i.offsetWidth);this.showMenu(e,o)}},r.prototype.showContextMenuOnElement=function(n,t,i,r,u){var f=t.getBoundingClientRect(),e,o;this._inputType=r;e=f.left+t.offsetWidth/2;o=f.top+this._page.getScrollTop()+t.offsetHeight/2;this.showContextMenuOnXY(n,e,o,i,this._inputType,u)},r.prototype.showContextMenuOnXY=function(t,i,r,u,f,e){var s=this,o,h;this._parentElement=null;this._inputType=f;e&&(o=t.childSuggestions.filter(function(n){return n.text===e.text}),o&&o.length&&(t=o[0]));h=n.getVerbsAsync("showContextMenu",t,n.config.rawVerbs,!1,function(e){return n.safeSetTimeout(function(){return s.innerShowContextMenu(n.extendVerbs(e,t,s._page),i,r,function(i,r,u,f){n.InstrumentationHelper.instrumentItemClickForContextMenu(r,t.instItem,t.sequenceNumber,t.instrumentPingBack,u,f,i)},u,f)},0,"showContextMenu handler")},function(){return!0});e||h||(this._page.hideTemporaryMessage(),n.Host.setFocusInSearchBox(null,"noContextMenu"))},r.prototype.getSelectableItems=function(){var n,t;return this._menuItems?(n=[],this._menuStack.length>0?(t=this._menuStack[this._menuStack.length-1],n=t.subItems):n=this._menuItems,n.map(function(n){return n.groupItems?n.groupItems:[n]}).reduce(function(n,t){return n.push.apply(n,t),n},[]).filter(function(n){return n.isSelectable})):[]},r.prototype.getSelectableItemsByGroup=function(){return[]},r.prototype.getSelectedItem=function(){return this._selectedItem},r.prototype.getDataModel=function(){return{items:this._menuItems,showIcons:this._showIcons,clickHandler:this._itemClickHandler,menuType:this._menuType,enterHandler:this._itemEnterHandler,leaveHandler:this._itemLeaveHandler,expandIcon:this.getExpandIcon(),inputType:this._inputType}},r.prototype.getExpandIcon=function(){return{content:n.isRtl()?"&#xE76B":"&#xE76C",type:2}},r.prototype.select=function(n){var t;this._selectedItem&&(t=_ge(this._selectedItem.id),t&&t.blur(),this._selectedItem.selected=!1);this._selectedItem=n;this._selectedItem&&(t=_ge(this._selectedItem.id),t&&t.focus(),this._selectedItem.selected=!0);n&&this.stickParent(n);this._page.updateMenuView(this.getDataModel())},r.prototype.stickParent=function(n){var u=this.getParent(n),f,t,r,i;for(u&&(u.isSticky=!0),f=this.getSiblings(n),t=0,r=f;t<r.length;t++)i=r[t],i.isSticky&&(i.isSticky=!1,this._itemLeaveHandler(i,null))},r.prototype.isItemInMenuOrMenuGroup=function(n,t){return t.some(function(t){return t==n||t.groupItems&&t.groupItems.indexOf(n)>=0})},r.prototype.getParent=function(n){for(var r,t=0,i=this._menuStack;t<i.length;t++)if(r=i[t],this.isItemInMenuOrMenuGroup(n,r.subItems))return r;if(this.isItemInMenuOrMenuGroup(n,this._menuItems))return null;throw new Error("Item: '"+n.id+"' was not found");},r.prototype.getSiblings=function(n,t){t===void 0&&(t=!1);var i=this.getParent(n),r=i?i.subItems:this._menuItems;return r.map(function(n){return n.groupItems?n.groupItems:[n]}).reduce(function(n,t){return n.push.apply(n,t),n},[]).filter(function(i){return i.isSelectable&&(t||i!=n)})},r.prototype.selectSubItem=function(n,t){this.showSubMenu(n);this.select(t,!1)},r.prototype.reselectParentItem=function(){var n=this._menuStack[this._menuStack.length-1];this.dismissSubMenu();this.select(n,!1)},r.prototype.onAfterKeyDown=function(t,i,r,u){var f,o,e;if((r||u)&&!n.isUpOrDownKey(t))return!1;if(t=n.getRtlAdjustedKey(t),t==39||t==13){if(f=this._selectedItem,f&&f.subItems&&f.subItems[0]&&(o=f.subItems.filter(function(n){return n.isSelectable})[0],o))return this.selectSubItem(f,o),!0}else if(t==37){if(this._menuStack.length>0)return this.reselectParentItem(),!0}else if(n.isUpOrDownKey(t)&&this._selectedItem)return e=this._menuStack.length==0?_qs(".contextMenu"):_ge(this._menuStack[this._menuStack.length-1].id).querySelector(".contextMenu"),e&&this._page.scrollToElement(_ge(this._selectedItem.id),e,e.offsetHeight),!0;return t==13},r.prototype.isMenuVisible=function(){return!!this._menuItems},r.prototype.dismiss=function(t){if(this._menuItems&&(this._menuItems=null,this._selectedItem&&(this._selectedItem.selected=!1,this._selectedItem=null),this._page.updateMenuView(this.getDataModel()),this._menuContainer.classList.remove(i),this._menuContainer.style.width=null,n.setVisibility(this._menuContainer,!1),n.RuntimeConfig.PanelCanResize&&(this._root.style.minHeight="",this.adjustHeight()),this._menuStack=[]),t&&this._parentElement&&this._parentElement.focus(),this._parentElement=null,this._inputType=null,this._onDismiss){var r=this._onDismiss;this._onDismiss=null;r()}},r.prototype.adjustSubMenuPosition=function(i,r){var h,y,d,o;if(this._menuItems){var f=this._menuContainer,p=f.offsetWidth,w=r.offsetHeight,s=r.offsetWidth,b=0,e=window.getComputedStyle(r).paddingTop;e.endsWith("px")&&(e=e.substr(0,e.length-2),b=+e+1);var l=0,k=_qs("#menuContainer .contextMenu").scrollTop,a=n.isRtl(),v=6;for(h=0,y=this._menuStack;h<y.length;h++)d=y[h],o=_ge(d.id).querySelector(".contextMenu"),v=+o.style.zIndex,l+=o.offsetLeft,k+=o.scrollTop,a=o.offsetLeft<0;++v;var u=f.offsetLeft+l+i.offsetLeft,c=f.offsetTop+i.offsetTop-k-b,g=this._root.offsetWidth-(u+p),nt=u,tt=s<g,it=s<nt;(a||!tt)&&it?u-=s:a&&it||!tt?u=nt>g?t:this._root.offsetWidth-s-t:u+=p-2;c+w>this._root.offsetHeight&&(c=Math.max(this._root.offsetHeight-w,this._root.offsetTop));u-=f.offsetLeft+l;c-=f.offsetTop;r.style.left=u+"px";r.style.top=c+"px";r.style.zIndex=v.toString()}},r.prototype.adjustPosition=function(i,r,u){var e,s;if(this._menuItems){var o=this._menuContainer,f=o.offsetWidth,h=o.offsetHeight;f>this._root.offsetWidth&&(f=this._root.offsetWidth,o.style.width=f+"px");e=i;s=r;n.isRtl()?(e-=f,e<0&&(e=u?t:i)):e+f>this._root.offsetWidth&&(e=u?this._root.offsetWidth-f-t:Math.max(i-f,this._root.offsetLeft));!u&&s+h>this._root.offsetHeight&&(s=Math.max(this._root.offsetHeight-h,this._root.offsetTop));o.style.left=e+"px";o.style.top=s+"px";n.RuntimeConfig.PanelCanResize&&(this._root.style.minHeight=s+h+"px",this.adjustHeight())}},r.prototype.getContextMenuItems=function(t,i){var r=this;return t.map(function(t,u){var f={id:encodeURIComponent(t.verb),text:t.displayName,isSeparator:!t.verb,selected:!1,isDefault:t.isDefault,icon:t.icon,getIcon:t.getIcon,click:undefined,title:undefined,cssClass:undefined,isSelectable:!!t.verb};return f.isSeparator?f.id="Separator"+u:f.click=function(u,f){i(t.verb,u,f,null);t.executeSync?(n.safeExecute(function(){return t.executeSync()},"verb.executeSync",null,t.verb),r.dismiss()):n.Async.safeChain("verb.executeAsync",function(){return t.executeAsync()},function(){return r.dismiss()},null,null,t.verb)},f})},r}();n.MenuFactory=r}(WSB||(WSB={})),function(n){var t="ConnectedAccounts",i=function(){function i(t){this._storage=t;this._accountsCache={};(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.clearSSOCache)&&this.clear();this.init()}return i.prototype.setToken=function(n,t){this.setTokenInfo(t,n);this.writeToLocalStorage()},i.prototype.findAccount=function(n,t){var i=this._accountsCache[n];return i&&!this.isExpired(i.LastUpdated,t,i.ExpireDateTime)?i:null},i.prototype.clear=function(){this._accountsCache={};this.writeToLocalStorage()},i.prototype.init=function(){this._accountsCache={};var i=this._storage.getItem(t);i&&(this._accountsCache=n.safeExecute(function(){return JSON.parse(i)},"parseConnectedAccountString",{}))},i.prototype.writeToLocalStorage=function(){this._storage.setItem(t,JSON.stringify(this._accountsCache))},i.prototype.isExpired=function(t,i,r){var u,e,f;return i===undefined?!1:(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.forceTokenRefresh)?!0:(u=n.getCurrentTime(),r&&u>r)?!0:(e=6e4,f=Math.floor((u-t)/e),f<0||f>=i)},i.prototype.setTokenInfo=function(t,i){var r=this._accountsCache[t],u=n.getCurrentTime();r={Token:i.Token,LastUpdated:u,ExpireDateTime:i.ExpireDateTime,TenantName:i.TenantName,RoutingHint:i.RoutingHint,UserName:i.UserName};this._accountsCache[t]=r},i}();n.TokenStore=i}(WSB||(WSB={})),function(n){var i="SelectedAuthAccountId",t="consumers",r="organizations",f=60,u="72f988bf-86f1-41af-91ab-2d7cd011db47",e=function(){function e(n,t){var i=this;this._storage=n;this._tokenStore=t;this._pendingCallbacks={};this._availableMsaAccounts=[];this._availableAadAccounts=[];this._accessTokenAvailableHandlers=[];this._verifyAccountRequired=[];this._accountTypeChangedHandlers=[];this._selectedAccountChangedHandlers=[];SearchAppWrapper.CortanaApp.addEventListener("experiencelaunched",function(){SearchAppWrapper.CortanaApp.experienceId=="NotebookOffline"&&i._tokenStore.clear()})}return e.getWindowsAccountType=function(){return e._windowsAccountType},e.internalSetWindowsAccountType=function(n){e._windowsAccountType=n},e.getWindowsIdentity=function(){return e._windowsIdentity},e.internalSetWindowsIdentity=function(n){e._windowsIdentity=n},e.prototype.authTypeMatchesWindowsAccountType=function(n){var t=e.getWindowsAccountType();return t==4||(n==0?t==2:t==1)},e.prototype.setWindowsAccountType=function(t){var i=e.getWindowsAccountType();e.internalSetWindowsAccountType(t);this.authTypeMatchesWindowsAccountType(1)&&n.isCloudSearchEnabledAadCache||(n.isMsftAccountConnected=!1);t!=i&&this.fireAccountTypeChanged()},e.prototype.getAllSyncingAccounts=function(n,t,i,r,u){var c=SearchAppWrapper.CortanaApp.fileExplorerSuggestionPage.registeredSyncRootInfo,o=[],l,e,s,h,f;for(l in c)f=c[l],typeof f=="string"&&f.includes("@")&&o.push(f);for(o.length==0&&u([]),e={responses:0,accounts:[]},s=0,h=o;s<h.length;s++)f=h[s],this.getAccountByUserName(n,t,f,i,r,function(n){++e.responses;n&&n.Token&&e.accounts.push(n);e.responses==o.length&&u(e.accounts)})},e.prototype.getAllAvailableAccounts=function(n){return n==0?this.getEnabledMSAAccounts().slice(0):this.getEnabledAADAccounts().slice(0)},e.prototype.getCachedAccountInfo=function(n){if(!this.authTypeMatchesWindowsAccountType(n))return null;switch(n){case 1:return this._cachedAAD;case 0:return this._cachedMSA;default:return null}},e.prototype.getSelectedAccountInfo=function(){var r=this._storage.getItem(i),n,t=this.getEnabledAADAccounts().concat(this.getEnabledMSAAccounts());if(t.length>0){if(r&&(n=t.filter(function(n){return n.accountId==r})[0],n))return this.cacheAccount(n),n;n||(n=t.filter(function(n){return n.isDefaultAccount})[0]);n||(n=t[0]);n&&this.setSelectedAccount(n)}return n},e.prototype.setSelectedAccount=function(n){if(this.cacheAccount(n),e.getWindowsAccountType()!=4){var r=this._storage.getItem(i),u=n.accountProviderAuthority==t?2:1;if(r==n.accountId)return;this.setWindowsAccountType(u);this.connectAccounts([n]);this._storage.setItem(i,n.accountId);this.fireSelectedAccountChanged(n)}this._storage.setItem(i,n.accountId)},e.prototype.isMsaAvailable=function(){return this._availableMsaAccounts.length>0},e.prototype.isAadAvailable=function(){return this._availableAadAccounts.length>0},e.prototype.cacheAccount=function(n){n.accountProviderAuthority==t?this._cachedMSA=n:this._cachedAAD=n},e.prototype.cacheAllAccounts=function(n){var i,u,r;for(this._availableMsaAccounts=[],this._availableAadAccounts=[],i=0,u=n;i<u.length;i++)r=u[i],r.accountProviderAuthority==t?this._availableMsaAccounts.push(r):this._availableAadAccounts.push(r)},e.prototype.getEnabledMSAAccounts=function(){return n.isCloudSearchEnabledMsaCache?this._availableMsaAccounts:[]},e.prototype.getEnabledAADAccounts=function(){return n.isCloudSearchEnabledAadCache?this._availableAadAccounts:[]},e.prototype.getAccountByUserName=function(t,i,r,u,f,e){var o,s=i==0?this._availableMsaAccounts:this._availableAadAccounts,h;s.length>0&&(o=s.find(function(n){return n.accountUserName.toLocaleLowerCase()==r.toLocaleLowerCase()}));o?(h=t?n.getSubstrateResourceOrScope(i):n.getBingResourceOrScope(i),this.getAccount(i,h,u,f,e,o)):e(null)},e.prototype.getAccount=function(n,t,i,r,u,f){var o=this,s,e;if(!t)throw new Error("Resource or Scope has to be set");if(s=function(n){var t=o._pendingCallbacks[e];o._pendingCallbacks[e]=null;t.forEach(function(t){return t(n)})},!this.authTypeMatchesWindowsAccountType(n)){u(null);return}if(f||(f=this.getCachedAccountInfo(n)),e=t+i+r+(f?f.accountId:""),this._pendingCallbacks[e]){this._pendingCallbacks[e].push(u);return}this._pendingCallbacks[e]=[u];this.authenticate(n,t,i,r,s,f)},e.prototype.authenticate=function(t,i,r,e,o,s){var v=this,a=t+"."+i+(s?"|"+s.accountId:""),h,c,y,p;if(e){var w=r?0:f,b=n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.noAuthCache,l=b?null:this._tokenStore.findAccount(a,w);if(l){t==1&&(n.isMsftAccountConnected=l.RoutingHint&&l.RoutingHint.indexOf(u)>-1);o(l);return}}h=function(){return o(null)};n.isBrowserOnline()?(c=SearchAppWrapper.CortanaApp.authenticationManager.createAuthenticateRequest(),c.accountType="Windows",c.silentMode=e,t==1?c.resource=i:c.scope=i,y=s&&SearchAppWrapper.CortanaApp.authenticationManager.authenticateSearchWebAccountAsync,p=y?function(){return SearchAppWrapper.CortanaApp.authenticationManager.authenticateSearchWebAccountAsync(c,s)}:function(){return SearchAppWrapper.CortanaApp.authenticationManager.authenticateAsync(c)},n.Async.safeChain("authenticateAsyncWAM",p,function(i){var r,f,s,c,l;if(n.TestHookUrlParameters)if(e){if(n.TestHookUrlParameters.ssoAuthFail){h();return}}else if(n.TestHookUrlParameters.uxAuthFail){h();return}if(!i){n.log("WAM returned null");h();return}if(i.token){if(r=i.properties,f=r.UPN||i.userName,!f){n.log("WAM didn't return UPN");h();return}s=void 0;t==0?s="MSA:"+f:(c=r.tid,n.isMsftAccountConnected=c==u,c&&r.OID&&(s="OID:"+r.OID+"@"+c));l={Token:i.token,ExpireDateTime:r.exp?parseInt(r.exp)*1e3-3e5:null,TenantName:r.tenant_display_name||"",RoutingHint:s||f,UserName:f};t==0&&(l.ExpireDateTime=n.getCurrentTime()+n.HourToMs);v._tokenStore.setToken(l,a);o(v._tokenStore.findAccount(a))}else i.errorCode||i.errorMessage?n.log("WAM error "+i.errorCode+": "+i.errorMessage):n.log("WAM returned an empty token"),h()},h)):h()},e.prototype.bindAccessTokenAvailable=function(n){this._accessTokenAvailableHandlers.push(n)},e.prototype.bindVerifyAccountRequired=function(n){this._verifyAccountRequired.push(n)},e.prototype.bindAccountTypesChanged=function(n){this._accountTypeChangedHandlers.push(n)},e.prototype.bindSelectedAccountChanged=function(n){this._selectedAccountChangedHandlers.push(n)},e.prototype.fireAccountTypeChanged=function(){this._accountTypeChangedHandlers.forEach(function(n){return n()})},e.prototype.fireSelectedAccountChanged=function(n){this._selectedAccountChangedHandlers.forEach(function(t){return t(n)})},e.prototype.tryConnect=function(t,i){var u=this,f=t==1?n.isSubstrateO365AccountConnected:n.isSubstrateOutlookAccountConnected,r;f||(r=n.getSubstrateResourceOrScope(t),this.getAccount(t,r,!1,!0,function(i){var f=!!i;t==1?n.isSubstrateO365AccountConnected=f:n.isSubstrateOutlookAccountConnected=f;f?u._accessTokenAvailableHandlers.forEach(function(i){return n.safeExecute(function(){return i(t,r)},"accessTokenAvailable",null,""+t)}):u._verifyAccountRequired.forEach(function(i){return n.safeExecute(function(){return i(t,r)},"accessTokenAvailable",null,""+t)})},i))},e.prototype.updateWindowsAccountType=function(i){for(var h,r,o,f=!1,u=!1,e=0,s=i;e<s.length;e++)h=s[e],h.accountProviderAuthority==t?f=n.isCloudSearchEnabledMsaCache:u=n.isCloudSearchEnabledAadCache;r=3;n.config.userProfileButtonEnabled?(o=this.getSelectedAccountInfo(),o&&(r=o.accountProviderAuthority==t?2:1)):!u||!n.isMsbEnterprise()||(n.MockUrlParameters===null||n.MockUrlParameters===void 0?void 0:n.MockUrlParameters.isTest)?f&&u?r=4:u?r=1:f&&(r=2):r=1;this.setWindowsAccountType(r)},e.prototype.connectAccounts=function(i){var f,e,u;for(n.isSubstrateO365AccountConnected=!1,n.isSubstrateOutlookAccountConnected=!1,f=0,e=i;f<e.length;f++)u=e[f],u.accountProviderAuthority==t&&n.isCloudSearchEnabledMsaCache?this.tryConnect(0,u):u.accountProviderAuthority==r&&n.isCloudSearchEnabledAadCache&&this.tryConnect(1,u)},e.prototype.accountTypeToAuthType=function(n){switch(n){case 2:return 0;case 1:return 1;default:throw new Error("Not a logged in account: "+n);}},e.prototype.enumerateAccountAuthority=function(i){var u=this;n.Async.safeChain("enumerateAccountAuthorityAsync",function(){return SearchAppWrapper.CortanaApp.authenticationManager.enumerateAccountAuthorityAsync()},function(f){var o,s,h;if(o=e.getWindowsAccountType(),o==0){s=3;switch(f.Windows){case t:s=2;break;case r:s=1}u.setWindowsAccountType(s);o=e.getWindowsAccountType();o!=3&&(h=u.accountTypeToAuthType(o),u.getAccount(h,n.getBingResourceOrScope(h),!1,!0,function(n){return e.internalSetWindowsIdentity(n&&n.UserName?n.UserName:"")}))}n.substrateProvidersEnabled()&&(n.isCloudSearchEnabledAadCache&&o==1?u.tryConnect(1,null):n.isCloudSearchEnabledMsaCache&&o==2&&u.tryConnect(0,null));i()})},e.prototype.enumerateMultiAccountAuthority=function(i){var u=this;if(!SearchAppWrapper.CortanaApp.authenticationManager.getAllSearchWebAccountsAsync){this.enumerateAccountAuthority(i);return}n.Async.safeChain("getAllSearchWebAccountsAsync",function(){return SearchAppWrapper.CortanaApp.authenticationManager.getAllSearchWebAccountsAsync()},function(f){var o,h,c,a,p,v,l,y,s;if(u.cacheAllAccounts(f),o=[],u._availableMsaAccounts.length>0&&(h=Math.max(u._availableMsaAccounts.findIndex(function(n){return n.isDefaultAccount}),0),o.push(u._availableMsaAccounts[h])),u._availableAadAccounts.length>0&&(h=Math.max(u._availableAadAccounts.findIndex(function(n){return n.isDefaultAccount}),0),o.push(u._availableAadAccounts[h])),!n.config.userProfileButtonEnabled)for(c=0,a=o;c<a.length;c++)s=a[c],u.cacheAccount(s);if(p=e.getWindowsAccountType(),u.updateWindowsAccountType(o),e.getWindowsAccountType()!=p)for(v=function(t,i){u.getAccount(t,n.getBingResourceOrScope(t),!1,!0,function(n){return e.internalSetWindowsIdentity(n&&n.UserName?n.UserName:"")},i)},l=0,y=o;l<y.length;l++)s=y[l],s.accountProviderAuthority==t&&n.isCloudSearchEnabledMsaCache?v(0,s):s.accountProviderAuthority==r&&n.isCloudSearchEnabledAadCache&&v(1,s);(n.isCloudSearchEnabledAadCache||n.isCloudSearchEnabledMsaCache)&&n.substrateProvidersEnabled()&&u.connectAccounts(o);i()})},e.prototype.promptAutheticateDialog=function(t,i,r,u){var f=this,e=function(e){var o=!!e;t==1?n.isSubstrateO365AccountConnected=o:n.isSubstrateOutlookAccountConnected=o;o?(r(),f._accessTokenAvailableHandlers.forEach(function(r){return n.safeExecute(function(){return r(t,i)},"promptAccessTokenAvailable",null,""+t)})):(u(),f._verifyAccountRequired.forEach(function(r){return n.safeExecute(function(){return r(t,i)},"promptAccessTokenAvailable",null,""+t)}))};this.getAccount(t,i,!1,!1,e)},e._windowsAccountType=0,e}();n.AccessTokenManager=e}(WSB||(WSB={})),function(n){var i="cohortProfile",r="WSBFirstOpenedDate",u=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z$/,t=29,f=function(){function f(t){var i=this;this._lightweightStorage=t;this._cohortProfile=[];n.Host.bindShown(function(){i.deserializeCohortProfile();i.updateCohortProfileBasedOnWSBOpenedDate();i.determineWSBNewUser()});n.Host.bindDismissed(function(){i.serializeCohortProfile()})}return f.getSingleton=function(){return f._singleton||SharedLogHelper.LogError("cohortProfileManager.getSingleton()",null,"CohortProfileManager._singleton should be initialized first!"),f._singleton},f.initSingleton=function(n){return f._singleton||(f._singleton=new f(n)),f._singleton},f.prototype.serializeCohortProfile=function(){this._lightweightStorage.setItem(i,JSON.stringify(this._cohortProfile));this._lightweightStorage.setItem(r,JSON.stringify(this._WSBFirstOpenedDate))},f.prototype.deserializeCohortProfile=function(){var u=this,f=this._lightweightStorage.getItem(i),t;f&&(this._cohortProfile=n.safeExecute(function(){return JSON.parse(f,u.reviver)},"cohortProfile",null));t=this._lightweightStorage.getItem(r);t&&(this._WSBFirstOpenedDate=n.safeExecute(function(){return JSON.parse(t,u.reviver)},"firstOpen",null))},f.prototype.reviver=function(n,t){return typeof t=="string"&&u.test(t)?new Date(t):t},f.prototype.createCohortProfile=function(){var n,i;for(this._cohortProfile=[],n=0;n<30;n++)this._cohortProfile.push({date:null,count:0});i=new Date;this._cohortProfile[t].date=this.getCurrentDate(i);this._cohortProfile[t].count=1},f.prototype.recordWSBFirstOpenedDate=function(){for(var n=0;n<30;n++)this._cohortProfile[n].date&&(!this._WSBFirstOpenedDate||this._cohortProfile[n].date<this._WSBFirstOpenedDate)&&(this._WSBFirstOpenedDate=this._cohortProfile[n].date)},f.prototype.updateCohortProfileBasedOnWSBOpenedDate=function(){var i,f,n,r;if(this._cohortProfile.length==0)this.createCohortProfile(),this.recordWSBFirstOpenedDate();else{this._WSBFirstOpenedDate||this.recordWSBFirstOpenedDate();var e=this.getWSBLastOpenedDate(),o=new Date,u=this.getCurrentDate(o);if(e.getTime()===u.getTime())this._cohortProfile[t].count+=1;else if(i=this.getDaysBetween(e,u),i>30)this.createCohortProfile();else{for(f=[],n=0;n<30;n++)f.push({date:this._cohortProfile[n].date,count:this._cohortProfile[n].count});for(n=i;n<30;n++)this._cohortProfile[n-i]=f[n];for(n=0,r=30-i;n<i;n++,r++)this._cohortProfile[r].date=null,this._cohortProfile[r].count=0;this._cohortProfile[t].date=u;this._cohortProfile[t].count=1}}},f.prototype.getCurrentDate=function(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate())},f.prototype.getDaysBetween=function(n,t){var i=n.getTime(),r=t.getTime(),u=r-i;return Math.round(u/864e5)},f.prototype.determineWSBNewUser=function(){var t,i,n;for(this._isWSBNewUser=!1,t=7,i=0,n=30-t;n<30-i;n++)this._WSBFirstOpenedDate!=null&&this._cohortProfile[n].date!=null&&this._WSBFirstOpenedDate.getTime()===this._cohortProfile[n].date.getTime()&&(this._isWSBNewUser=!0)},f.prototype.isWSBNewUser=function(){return this._isWSBNewUser},f.prototype.getWSBFirstOpenedDate=function(){return this._WSBFirstOpenedDate},f.prototype.getWSBLastOpenedDate=function(){return this._cohortProfile[t].date},f.prototype.getTimesOfWSBOpenedInLastNDays=function(n){var i,t;if(n>30)return-1;for(i=0,t=30-n;t<30;t++)i+=this._cohortProfile[t].count;return i},f.prototype.isWWEVisible=function(){if(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.showWWE)return n.config.enableWWENewUsers&&this._lightweightStorage.getItem("wweTourRefreshed")!="1";var t=SearchAppWrapper.CortanaApp,r=t.entryPoint=="19h1wwe"||t.entryPoint=="19h2wwe",u=n.config.enableWWEUpsell&&r,i=n.config.enableWWENewUsers&&this.isWSBNewUser()&&this._lightweightStorage.getItem("wweTourTook")!="1";return this.isWSBNewUser()&&this._lightweightStorage.getItem("newUsersLogged")!="1"&&(n.InstrumentationHelper.logClientInstEvent("Select","newUsers",null),this._lightweightStorage.setItem("newUsersLogged","1")),i&&this._lightweightStorage.getItem("newUsersEnabledLogged")!="1"&&(n.InstrumentationHelper.logClientInstEvent("Select","newUsersEnabled",null),this._lightweightStorage.setItem("newUsersEnabledLogged","1")),(u||i)&&this._lightweightStorage.getItem("wweTourRefreshed")!="1"},f.prototype.isWWEVisibleSinglePane=function(){return this.isWWEVisible()&&!n.RuntimeConfig.AlwaysWide},f.prototype.isTourVisible=function(){var t=new n.LightweightStorage;return t.getItem("wweTourEnabled")=="1"},f.prototype.resetCohortProfileManager=function(){f._singleton=null;this._cohortProfile=[];this._WSBFirstOpenedDate=null},f.prototype.resetWSBFirstOpenedDate=function(){this._WSBFirstOpenedDate=null},f}();n.CohortProfileManager=f}(WSB||(WSB={})),function(n){var t;(function(t){function v(){n.Host.bindAppHidden(function(){SearchAppWrapper.CortanaApp.isBingEnabled&&n.isBrowserOnline()&&n.safeExecute(function(){return ut("asgw",["fp.msedge.net/conf/v1/asgw/fpconfig.min.json"],2e3)},"AFDFootprint.start",null,null)})}function ut(n,t,i){var o;if(n&&n.trim().length!==0&&Number(i)===i&&i%1==0&&!(i<0)){var e=h,v=rt,y=a(),p=f(),s="MonitorID="+n+"&rid="+p+"&w3c="+y+"&prot="+window.location.protocol+"&v="+v+"&DATA=";if(r)l(e,s,i);else{for(o in t)t[o]=e+t[o];u(t,0,c,e,s,i)}}}function l(n,t,i){var o=ft(r,n),s,f,u,e,h;if(o.length!==0){for(s=et(o,n,w),f=[],u=0,e=r.r;u<e.length;u++)h=e[u],f.push(n+h+"?"+t);ht(s,k,i,f)}}function u(t,i,f,e,o,s){var a=f!==it?0:1,h=t[i],v=SearchAppWrapper.CortanaApp.createStringMap(),c=SearchAppWrapper.CortanaApp.createStringMap();c["Content-Type"]="application/json";n.Async.safeChain("fetchAFDUrl",function(){return SearchAppWrapper.CortanaApp.makeHttpRequestAsync(a,h,v,"",c)},function(c){c.statusCode===200&&e!=null&&o!=null&&s!=null&&n.Async.safeChain("readAFDResponse",function(){return c.readAsStringAsync()},function(n){try{r=JSON.parse(n);l(e,o,s)}finally{}},function(){++i<t.length&&u(t,i,f,e,o,s)},null,h,0)},function(){++i<t.length&&u(t,i,f,e,o,s)},null,h,0,"makeHttpRequestAsync failed")}function ft(n,t){var o=[],l,a,r,v,w,u,h,b;if(!n||!n.e)return o;var k=t.toLowerCase()===p?s:e,nt=n.e,f=[],c=0;for(l=0,a=nt;l<a.length;l++)r=a[l],r.w>0&&(e<=r.m&&r.m<=y&&r.m&k||r.m===i)&&(c+=r.w,f.push({endpoint:r.e,cumWeight:c,weight:r.w,measurementType:r.m}));for(v=Math.min(n.n,f.length);o.length<v;){w=Math.floor(Math.random()*c);u=null;for(h in f)u==null?w<f[h].cumWeight&&(u=f[h],delete f[h]):f[h].cumWeight-=u.weight;c-=u.weight;b=u.measurementType&i?g:d;o.push({id:u.endpoint,testImage:b,measurementType:u.measurementType})}return o.sort(function(n,t){return n.measurementType-t.measurementType}),o}function et(n,t,r){for(var o,p,d,a=[],v=0,w=n;v<w.length;v++){var y=w[v],l=y.measurementType,k=y.testImage,u=y.id,c=t+u;u.indexOf(".")===-1?c+=".clo.footprintdns.com":u.charAt(0)==="*"&&(o=u.substring(2),p=f(),c=t+p+"."+o,u=o==="clo.footprintdns.com"||o==="nrb.footprintdns.com"||o==="azr.footprintdns.com"?p:o);c+=b;var g=c+r+"?"+f(),nt=l===i?t===h?e:s:l,tt=l!==i;a.push({url:g,requestID:u,object:r,conn:"cold",measurementType:nt,report:tt});d=c+k+"?"+f();a.push({url:d,requestID:u,object:k,conn:"warm",measurementType:l,report:!0})}return a}function ot(n,t){for(var r=[],i=0;i<t.length;i++)if(t[i].report){var f=n[i],u=t[i].measurementType,e=st(f,u);r.push({RequestID:t[i].requestID,Object:t[i].object,Conn:t[i].conn,Result:e,T:u})}return JSON.stringify(r)}function st(n,t){if(n===o)return n;if(t===i&&n>0){var r=nt/(n/tt);return Math.round(r)}return Math.round(n)}function f(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+n()+n()+n()+n()+n()+n()}function a(){return window.performance&&window.performance.getEntriesByName?!0:!1}function ht(n,t,i,r){function l(i){var k,p,g,w,nt,d,b,tt;if(f!=null&&clearTimeout(f),s[i]=h!=null?(new Date).getTime()-h:o,i=(v+y)%n.length,e=new Image,v++<n.length)h=(new Date).getTime(),e.onload=function(){l(i)},k=function(){e.onload=null;e.onerror=null;h=null;l(i)},f=setTimeout(function(){k()},t),e.onerror=function(){f!=null&&clearTimeout(f);f=null;k()},e.src=n[i].url;else if(r!=null&&r.length!==0){if(a())for(p=0;p<n.length;p++)g=n[p].url,w=window.performance.getEntriesByName(g),s[p]!==o&&w&&w[0]&&(s[p]=w[0].duration);for(nt=ot(s,n),d=[],b=0;b<r.length;b++)tt=r[b]+nt,d.push(tt);u(d,0,c,null,null,null)}}var h=null,f=null,s=[],v=0,e,y=0;setTimeout(function(){l(0)},i)}t.init=v;var r,e=1,s=2,y=3,i=8,p="http://",h="https://",w="trans.gif",b="/apc/",k=5e3,d="trans.gif",g="100k.gif",nt=822.128,tt=1e3,c="GET",it="POST",o=-1,rt="20180228"})(t=n.AFDFootprint||(n.AFDFootprint={}))}(WSB||(WSB={}));__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},function(n){var t=function(){function t(n,t){this.id=n;this._controller=t;this.flyoutMaxHeight=170;this.slackSize=10;this.currentStep=0;this.steps=[];this.dismissIntervalMs=0;this.repeatMax=1}return t.prototype.addMessage=function(n,t,i,r,u){t===void 0&&(t=null);var f={message:n,title:t};return i&&(f=__assign(__assign({},f),this.getPositions(i))),r&&(f.id=r),u&&(f.iconKey=u),this.steps.push(f),this},t.prototype.button=function(n,t,i){var r=this;return this.buttonMessage=n,this.buttonIcon={content:i,type:2},this.buttonClickHandler=function(n,i){r.dismiss();t(n,i)},this},t.prototype.showButton=function(n){return this.showButtonMessage=n,this},t.prototype.icon=function(n){return this._icon=n,this},t.prototype.overlay=function(n){return this._overlay=n,this},t.prototype.hasOverlay=function(){return this._overlay},t.prototype.isLinkTextButton=function(n){return this._isLinkText=n,this},t.prototype.getPositions=function(t,i){var d=n.RuntimeConfig.QfMode===0||n.RuntimeConfig.QfMode===4,f=d?336:400,e=152,p,w,o,h,b,c,l,s,a,k;this.flyoutClass==="miniflyout"&&(f=327,e=60);var r=_ge("root"),v=r?r.scrollHeight:document.body.scrollHeight,y=r?r.scrollWidth:document.body.scrollWidth,u=t.getBoundingClientRect();i||(p=u.bottom>v-this.flyoutMaxHeight,i=p?"Top":"Bottom");l=u.top+u.height/2;s=r?r.getBoundingClientRect().top:0;switch(i){case"Top":w=v-u.top+this.slackSize;break;case"Bottom":o=u.bottom+this.slackSize-s;break;case"Left":o=Math.max(Math.min(l-e/2-s,y-e),4);break;default:return null}switch(i){case"Top":case"Bottom":a=u.left+u.width/2;h=Math.max(Math.min(a-f/2,y-f),this.slackSize);c=Math.max(Math.min(a-h-this.slackSize,f-this.slackSize),this.slackSize);break;case"Left":k=r?r.getBoundingClientRect().right:0;b=k-u.left+this.slackSize;c=Math.max(Math.min(l-o-s-this.slackSize,e-this.slackSize),this.slackSize)}return{position:i,top:o,bottom:w,left:h,right:b,beakOffset:c}},t.prototype.target=function(n,t){if(!n)return this;var i=this.getPositions(n,t);return this.position=i.position,this.bottom=i.bottom,this.top=i.top,this.beakOffset=i.beakOffset,this.left=i.left,this.right=i.right,this},t.prototype.setSticky=function(){return this.sticky=!0,this},t.prototype.isSticky=function(){return this.sticky},t.prototype.show=function(){return(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.isTest)&&!(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.showFlyoutInTests)||this._controller.showFlyout(this),this},t.prototype.dismissible=function(n,t){return this.dismissIntervalMs=n,this.dismissMessage=t,this},t.prototype.repeat=function(n){return this.repeatMax=n,this},t.prototype.dataModel=function(){var t=this;if(!this.isValid())return null;var n=this.steps[this.currentStep],i=n.message,r=n.title;return{title:r,message:i,flyoutClass:this.flyoutClass,left:this.stepHasProperty("left")?n.left:this.left,right:this.stepHasProperty("right")?n.right:this.right,top:this.stepHasProperty("top")?n.top:this.top,bottom:this.stepHasProperty("bottom")?n.bottom:this.bottom,beakOffset:this.stepHasProperty("beakOffset")?n.beakOffset:this.beakOffset,nextStep:function(){return t.nextStep()},nbSteps:this.steps.length,currentStep:this.currentStep,position:this.stepHasProperty("position")?n.position:this.position,iconKey:this.stepHasProperty("iconKey")?n.iconKey:this._icon,showDismissButton:this.dismissIntervalMs!=null&&this.dismissMessage!=null,buttonClickHandler:function(i,r){t.buttonClickHandler(i,r);t._controller.instrumentClientEvent("FlyoutSubmit",{id:t.stepHasProperty("id")?n.id:t.id})},showButtonMessage:this.showButtonMessage,buttonMessage:this.buttonMessage,buttonIcon:this.buttonIcon,dismissMessage:this.dismissMessage,dismissClickHandler:function(){t.dismiss();t._controller.instrumentClientEvent("FlyoutDismiss",{id:t.stepHasProperty("id")?n.id:t.id})},id:this.stepHasProperty("id")?n.id:this.id,overlay:this._overlay,isLinkText:this._isLinkText}},t.prototype.setClass=function(n){return this.flyoutClass=n,this},t.prototype.isValid=function(){return this.steps.length>0&&(!isNaN(this.left)||!isNaN(this.right))&&(!isNaN(this.top)||!isNaN(this.bottom))},t.prototype.dismiss=function(){return this._controller.dismissFlyout(this.id),this},t.prototype.shouldBeShown=function(){var t=this._controller.getLastTimeShown(this.id),i=this._controller.getTimesShown(this.id);return(t==0||t+this.dismissIntervalMs<=n.getCurrentTime())&&i<this.repeatMax},t.prototype.hide=function(){return this.currentStep=0,this._controller.hideFlyout(this.id),this},t.prototype.nextStep=function(){this.currentStep=Math.min(this.currentStep+1,this.steps.length-1);this.show()},t.prototype.stepHasProperty=function(n){return n in this.steps[this.currentStep]},t}(),i=function(){function i(n,t){this._page=n;this._lightweightStorage=t;this.lastShownKey=function(n){return"flyout-last-shown-"+n};this.timesShownKey=function(n){return"flyout-times-shown-"+n}}return i.prototype.createFlyout=function(n){return new t(n,this)},i.prototype.showFlyout=function(n){var i=this.currentFlyout&&this.currentFlyout.id!=n.id,t;i&&(this.currentFlyout=n);this.currentFlyout=n;this.shouldShow(this.currentFlyout)&&(t=n.dataModel(),t&&(this._page.renderFlyoutAreaView(t),this.instrumentClientEvent("FlyoutShow",{id:this.currentFlyout.id})))},i.prototype.hideFlyout=function(t){(t===void 0&&(t=null),t&&this.currentFlyout&&t!==this.currentFlyout.id)||(this.currentFlyout&&this.currentFlyout.hasOverlay()&&(this._page.hideOverlayAreaView(),_ge("root").classList.remove("overlayEnabled")),this.currentFlyout=null,this._page.hideFlyoutAreaView(),n.config.enableWWETour&&(this._lightweightStorage.removeItem("wweTourEnabled"),n.Host.refreshCurrentPane(),this._lightweightStorage.removeItem("wweTourRefreshed")))},i.prototype.dismissFlyout=function(t){t&&this.currentFlyout&&t!==this.currentFlyout.id||(this.hideFlyout(t),n.config.enableWWETour&&this._lightweightStorage.setItem("wweTourTook","1"),n.shouldShowThreeFingerTap()&&this._lightweightStorage.setItem("ThreeFingerTapFlyoutDismissed","1"),this._lightweightStorage.setItem(this.lastShownKey(t),n.getCurrentTime().toString()),this._lightweightStorage.setItem(this.timesShownKey(t),(this.getTimesShown(t)+1).toString()))},i.prototype.wasDismissed=function(n){return!!this._lightweightStorage.getItem(this.lastShownKey(n))},i.prototype.shouldShow=function(n){return n.shouldBeShown()},i.prototype.getLastTimeShown=function(n){var t=parseInt(this._lightweightStorage.getItem(this.lastShownKey(n)));return t?t:0},i.prototype.getTimesShown=function(n){var t=parseInt(this._lightweightStorage.getItem(this.timesShownKey(n)));return t?t:0},i.prototype.onQueryChange=function(n){this.currentFlyout&&!this.currentFlyout.isSticky()&&this.queryOnActivation&&n.fullPartialQuery!=this.queryOnActivation.fullPartialQuery&&this.currentFlyout.hide()},i.prototype.setQuery=function(n){this.queryOnActivation=n},i.prototype.instrumentClientEvent=function(t,i){(i===void 0&&(i={}),n.InstrumentationHelper!=null)&&n.InstrumentationHelper.logClientInstEvent("Select",t,n.SequenceNumberManager.getSequenceNumber(),i)},i}();n.FlyoutController=i}(WSB||(WSB={})),function(n){var r="show",i=10,t=7,u=function(){function u(t){var i=this;this._page=t;this._root=_ge("root");this._popoverContainer=_ge("popoverContainer");n.Host.bindKeyEscape(function(n){i.isPopoverVisible()&&(n.handled=!0,i.dismiss(!0))});n.Host.bindShown(function(){i.dismiss(!1)});sj_be(this._popoverContainer,"mouseenter",function(){i.clearDismissTimer()});sj_be(this._popoverContainer,"mouseleave",function(){i.waitForEnterBeforeDismiss()});this.onMouseLeavesParent=this.onMouseLeavesParent.bind(this)}return u.prototype.getElementOffsetFromRoot=function(n){for(var t=0,i=0;n&&n!=this._root;)t+=n.offsetLeft,i+=n.offsetTop-n.scrollTop,n=n.offsetParent;return[t,i]},u.prototype.showPopover=function(n,t,i,r,u,f,e){if(this._parentElement){if(this._parentElement==i){this.clearDismissTimer();return}this.dismiss(e)}if(this._returnFocusToSearchBox=r,this._finishedOpening=!1,this._parentElement=i,sj_be(this._parentElement,"mouseleave",this.onMouseLeavesParent),n){this._text=n;this._buttons=t;this._className=f||"";var o=this.getElementOffsetFromRoot(i),s=o[0],h=o[1];s+=i.offsetWidth/2;this.showPopoverAt(s,h,u,e)}},u.prototype.isPopoverVisible=function(){return!!this._text&&this._finishedOpening},u.prototype.dismiss=function(t,i){this.clearDismissTimer();this._text&&(this._text=null,this._buttons=[],this._className="",this._popoverContainer.firstChild.blur(),this._selectedItem&&(this._selectedItem.selected=!1,this._selectedItem=null),this._page.updatePopoverView(this.getDataModel(i)),this._popoverContainer.classList.remove(r),n.setVisibility(this._popoverContainer,!1),this._popoverContainer.style.top=null,this._popoverContainer.style.width=null,this._popoverContainer.style.bottom=null,this._popoverContainer.style.left=null);this._parentElement&&(sj_ue(this._parentElement,"mouseleave",this.onMouseLeavesParent),t&&(this._parentElement.focus(),this._returnFocusToSearchBox&&n.Host.setFocusInSearchBox(null,"popoverDismissed")));this._parentElement=null},u.prototype.getSelectableItems=function(){return this._buttons||[]},u.prototype.getSelectableItemsByGroup=function(){return[]},u.prototype.getSelectedItem=function(){return this._selectedItem},u.prototype.select=function(n,t,i){var r;this._selectedItem&&(r=_ge(this._selectedItem.id),r&&r.blur(),this._selectedItem.selected=!1);this._selectedItem=n;this._selectedItem&&(r=_ge(this._selectedItem.id),r&&r.focus(),this._selectedItem.selected=!0);this._page.updatePopoverView(this.getDataModel(i))},u.prototype.submit=function(t){var f,e,r,u,o,i;if(t.action){if(f=n.getCurrentTime(),t.instItem)for(n.InstrumentationHelper.instrumentItemClick(f,t.instItem,t.sequenceNumber,null,2,null),e=this.getSelectableItems(),r=0,u=e;r<u.length;r++)o=u[r],i=o,i.instItem&&n.InstrumentationHelper.instrumentSyntheticInstrumentedItem(i.sequenceNumber,i.instItem.getQsCode(),i.instItem);t.action()}},u.prototype.onAfterKeyDown=function(t){var i,u,r;return(t=n.getRtlAdjustedKey(t),t==39||t==37)?(i=this.getSelectableItems(),i.length>0&&(u=this.getSelectedItem(),r=i.indexOf(u),r+=t==39?1:-1,r<0?this.select(i[i.length-1],!1):this.select(i[r%i.length],!1)),!0):t==13},u.prototype.onItemClick=function(n,t){t.button==0&&this.submit(n)},u.prototype.onMouseLeavesParent=function(){this.waitForEnterBeforeDismiss()},u.prototype.waitForEnterBeforeDismiss=function(){var t=this;this.clearDismissTimer();this._dismissTimer=n.safeSetTimeout(function(){t._dismissTimer=null;!t._parentElement||t._parentElement.matches(":hover")||t._popoverContainer.matches(":hover")||t.dismiss()},100,"waitForDismiss")},u.prototype.clearDismissTimer=function(){this._dismissTimer&&(sb_ct(this._dismissTimer),this._dismissTimer=null)},u.prototype.getDataModel=function(n){var t=this;return{text:this._text,items:this._buttons,clickHandler:function(n,i){return t.onItemClick(n,i)},className:this._className,isSideBeak:n}},u.prototype.showPopoverAtSide=function(n,r){var e,s,h;if(this._text){var u=this._popoverContainer,f=u.offsetWidth+1,o=this._root.offsetWidth-2*i;f>o&&(f=o);e=n;s=r-t;e+=t*2;u.style.width=f+"px";u.style.left=e+"px";u.style.top=s+"px";h=_qs(".popover .beak.sidebeak",this._popoverContainer);h.style.top=t*4+"px";this._finishedOpening=!0}},u.prototype.showPopoverAtTop=function(n,r){var f,o,h;if(this._text){var e=this._popoverContainer,u=e.offsetWidth+1,s=this._root.offsetWidth-2*i;u>s&&(u=s);f=0;o=this._root.offsetHeight-r;n-=u/2;o+=t;n<i?f=i-n:n+u>this._root.offsetWidth-i&&(f=this._root.offsetWidth-i-(n+u));e.style.width=u+"px";e.style.left=n+f+"px";e.style.bottom=o+"px";f<u/-2+t?f=u/-2+t:f>u/2-t&&(f=u/2-t);h=_qs(".popover .beak",this._popoverContainer);h.style.left="calc(50% - "+f+"px";this._finishedOpening=!0}},u.prototype.showPopoverAt=function(t,i,u,f){var e=this,s,o;n.setVisibility(this._popoverContainer,!0);s=this.getDataModel(f);this._page.updatePopoverView(s);o="renderPopover";n.safeSetTimeout(function(){if(f?e.showPopoverAtSide(t,i):e.showPopoverAtTop(t,i),e._popoverContainer.classList.add(r),u&&e._buttons&&e._buttons.length!=0)e.select(e.getSelectableItems()[0],!1,f);else{var s=e._popoverContainer.firstElementChild;s.focus()}n.Host.setFocusInWebView(o)},0,o)},u}();n.PopoverFactory=u}(WSB||(WSB={})),function(n){function e(n,t){return n<<t|n>>>32-t}function t(n,t){var i=(n&65535)+(t&65535),r=(n>>16)+(t>>16)+(i>>16);return r<<16|i&65535}function h(n,t,i){return n&t|~n&i}function c(n,t,i){return n&i|t&~i}function l(n,t,i){return n^t^i}function a(n,t,i){return t^(n|~i)}function i(n,i,r,u,f,o,s){return n=t(n,t(t(h(i,r,u),f),s)),t(e(n,o),i)}function r(n,i,r,u,f,o,s){return n=t(n,t(t(c(i,r,u),f),s)),t(e(n,o),i)}function u(n,i,r,u,f,o,s){return n=t(n,t(t(l(i,r,u),f),s)),t(e(n,o),i)}function f(n,i,r,u,f,o,s){return n=t(n,t(t(a(i,r,u),f),s)),t(e(n,o),i)}function v(n){var i=[],r=n.length*8,t;for(i[(n.length>>2)-1]=undefined,t=0;t<i.length;t+=1)i[t]=0;for(t=0;t<r;t+=8)i[t>>5]|=(n.charCodeAt(t/8)&255)<<t%32;return i[r>>5]|=128<<r%32,i[(r+64>>>9<<4)+14]=r,i}function o(n){for(var u,t="",i="",r=0;r<=3;r++)u=n>>>r*8&255,i="0"+u.toString(16),t=t+i.substr(i.length-2,2);return t}function y(n){var ht,ct,lt,at,e=1732584193,s=4023233417,h=2562383102,c=271733878,y=7,p=12,w=17,b=22,k=5,d=9,g=14,nt=20,tt=4,it=11,rt=16,ut=23,ft=6,et=10,ot=15,st=21,a,l;for(n=unescape(encodeURIComponent(n)),a=v(n),l=0;l<a.length;l+=16)ht=e,ct=s,lt=h,at=c,e=i(e,s,h,c,a[l+0],y,3614090360),c=i(c,e,s,h,a[l+1],p,3905402710),h=i(h,c,e,s,a[l+2],w,606105819),s=i(s,h,c,e,a[l+3],b,3250441966),e=i(e,s,h,c,a[l+4],y,4118548399),c=i(c,e,s,h,a[l+5],p,1200080426),h=i(h,c,e,s,a[l+6],w,2821735955),s=i(s,h,c,e,a[l+7],b,4249261313),e=i(e,s,h,c,a[l+8],y,1770035416),c=i(c,e,s,h,a[l+9],p,2336552879),h=i(h,c,e,s,a[l+10],w,4294925233),s=i(s,h,c,e,a[l+11],b,2304563134),e=i(e,s,h,c,a[l+12],y,1804603682),c=i(c,e,s,h,a[l+13],p,4254626195),h=i(h,c,e,s,a[l+14],w,2792965006),s=i(s,h,c,e,a[l+15],b,1236535329),e=r(e,s,h,c,a[l+1],k,4129170786),c=r(c,e,s,h,a[l+6],d,3225465664),h=r(h,c,e,s,a[l+11],g,643717713),s=r(s,h,c,e,a[l+0],nt,3921069994),e=r(e,s,h,c,a[l+5],k,3593408605),c=r(c,e,s,h,a[l+10],d,38016083),h=r(h,c,e,s,a[l+15],g,3634488961),s=r(s,h,c,e,a[l+4],nt,3889429448),e=r(e,s,h,c,a[l+9],k,568446438),c=r(c,e,s,h,a[l+14],d,3275163606),h=r(h,c,e,s,a[l+3],g,4107603335),s=r(s,h,c,e,a[l+8],nt,1163531501),e=r(e,s,h,c,a[l+13],k,2850285829),c=r(c,e,s,h,a[l+2],d,4243563512),h=r(h,c,e,s,a[l+7],g,1735328473),s=r(s,h,c,e,a[l+12],nt,2368359562),e=u(e,s,h,c,a[l+5],tt,4294588738),c=u(c,e,s,h,a[l+8],it,2272392833),h=u(h,c,e,s,a[l+11],rt,1839030562),s=u(s,h,c,e,a[l+14],ut,4259657740),e=u(e,s,h,c,a[l+1],tt,2763975236),c=u(c,e,s,h,a[l+4],it,1272893353),h=u(h,c,e,s,a[l+7],rt,4139469664),s=u(s,h,c,e,a[l+10],ut,3200236656),e=u(e,s,h,c,a[l+13],tt,681279174),c=u(c,e,s,h,a[l+0],it,3936430074),h=u(h,c,e,s,a[l+3],rt,3572445317),s=u(s,h,c,e,a[l+6],ut,76029189),e=u(e,s,h,c,a[l+9],tt,3654602809),c=u(c,e,s,h,a[l+12],it,3873151461),h=u(h,c,e,s,a[l+15],rt,530742520),s=u(s,h,c,e,a[l+2],ut,3299628645),e=f(e,s,h,c,a[l+0],ft,4096336452),c=f(c,e,s,h,a[l+7],et,1126891415),h=f(h,c,e,s,a[l+14],ot,2878612391),s=f(s,h,c,e,a[l+5],st,4237533241),e=f(e,s,h,c,a[l+12],ft,1700485571),c=f(c,e,s,h,a[l+3],et,2399980690),h=f(h,c,e,s,a[l+10],ot,4293915773),s=f(s,h,c,e,a[l+1],st,2240044497),e=f(e,s,h,c,a[l+8],ft,1873313359),c=f(c,e,s,h,a[l+15],et,4264355552),h=f(h,c,e,s,a[l+6],ot,2734768916),s=f(s,h,c,e,a[l+13],st,1309151649),e=f(e,s,h,c,a[l+4],ft,4149444226),c=f(c,e,s,h,a[l+11],et,3174756917),h=f(h,c,e,s,a[l+2],ot,718787259),s=f(s,h,c,e,a[l+9],st,3951481745),e=t(e,ht),s=t(s,ct),h=t(h,lt),c=t(c,at);return(o(e)+o(s)+o(h)+o(c)).toLowerCase()}function p(n){var i=y(n),r,u,t;if(i==null||i.length!==32)return null;for(t=0;t<32;t++)if(r=i[t],!(/^\d+$/.test(r)||r>="a"&&r<="f"))return null;for(i+=0,u="",t=0;t<11;t++){var f=i[t*3],e=i[t*3+1],o=i[t*3+2],s=((f>="a"?f.charCodeAt(0)-"a".charCodeAt(0)+10:f.charCodeAt(0)-"0".charCodeAt(0))<<8)+((e>="a"?e.charCodeAt(0)-"a".charCodeAt(0)+10:e.charCodeAt(0)-"0".charCodeAt(0))<<4)+(o>="a"?o.charCodeAt(0)-"a".charCodeAt(0)+10:o.charCodeAt(0)-"0".charCodeAt(0));u=w(u,s)}return u}function w(n,t){return n.concat(s[Math.floor(t/64)]).concat(s[t%64])}var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";n.generateKeyFromDomain=p}(WSB||(WSB={}))