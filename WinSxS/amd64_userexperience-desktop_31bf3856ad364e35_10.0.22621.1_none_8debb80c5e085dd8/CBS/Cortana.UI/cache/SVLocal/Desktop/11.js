var __awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},WSB;(function(n){function l(){return o}function e(n,t,i,r,u){if(!n)return i;if(typeof n!="string")try{return{content:URL.createObjectURL(n),type:0,bgColor:r}}catch(f){return SharedLogHelper.LogError("convertToHtmlImage "+t,u,f),i}else return{content:n,type:0,bgColor:r}}var o="data:img/png;base64,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",s=!!_ge("wsb_form_q"),t,f,r,i,u,h=-933981677285477,c=400;n.getEdgeFallbackIcon=l;n.toIcon=e;var a={"action://Help/Launch":"Help","ms-cortana://navigate/Notebook":"Notebook"},v={"ms-cortana://navigate/Settings":n.config.settingsUri},y=function(){function l(){}return l.isBingWallpaperAppInstalled=function(){return l._bingWallpaperAppInstalled},l.checkBingWallpaperAppInstalled=function(){n.Async.safeChain("getAllAppsAsync",function(){return SearchAppWrapper.CortanaApp.queryFormulationView.deviceSearch.getAllAppsAsync().then(function(n){var i,t;l._bingWallpaperAppInstalled=!1;for(i in n)if(t=n[i],t.filePath&&t.filePath.endsWith("BingWallpaperApp.exe")){l._bingWallpaperAppInstalled=!0;break}})})},l.Init=function(o){var c,s;l._currentQuery=null;l._queryParamsCache={};l._locStrings=[];l._enUsLocStrings=[];l._modifierKeyState={altKey:!1,ctrlKey:!1,shiftKey:!1};l._bootstrapDoneEventHandlers=[];l._appVisibleEventHandlers=[];l._shownEventHandlers=[];l._conversationStartEventHandlers=[];l._dismissedEventHandlers=[];l._appHiddenEventHandlers=[];l._searchBoxGotFocusEventHandlers=[];l._searchBoxLostFocusEventHandlers=[];l._onSubmitHandlers=[];l._onFeedbackClosingHandlers=[];l._onSearchBoxGlyphIconClick=[];l._onSearchBoxClick=[];l._onButtonRightOfSearchBoxClick=[];l._queryChangedHandlers=[];l._rawQueryChangedHandlers=[];l._keyDownHandlers=[];l._keyUpHandlers=[];l._keyEscapeHandlers=[];l._accessTokenAvailableHandlers=[];l._scopeListRequiresUpdate=[];l._accountChangedHandlers=[];l._dynamicSearchBoxUpdateHandlers=[];l._pinnedApps={};l._state=0;l._paneCloseCount=0;l._qfDismissCount=0;l._defaultWindowsTheme=0;l._defaultAppTheme=0;l._currentPaneHeight=0;l._root=_ge("root");l._rootContainer=_ge("rootContainer");l._defaultBrowser=0;l._accessTokenManager=o;l._suggestionsContainer=_ge("suggestionsList");l._fuzzyRankSuggestionCount=-1;l._coldRankSuggestionCount=-1;l._notColdRankSuggestionCount=-1;l._finalColdRankSuggestionCount=-1;t=SearchAppWrapper.CortanaApp;f=t.queryFormulationView;r=t.launcher;i=typeof SearchBoxController=="object"?SearchBoxController:t.searchBox;u=n.Service.QueryParams;l._currentCVID=n.cleanGuid(l.createGuid());l._randomPrivacyNumber=l.getNewPrivacyNumber();l.initCortanaEnabledAndRegion();l.initLanguage();n.refreshBingEnabledCache(t.isBingEnabled,l.getRegion(),l.getLanguage());l.initLocStrings();c=n.safeExecute(function(){return+f.perfMetrics.lookup(32)},"perfMetricsFallbackLookup",h);l._hasFallbackHappened=c!=h;s=f.searchHistory;s&&s.addEventListener("cleardevicehistoryrequested",function(){var t=function(t){return n.safeExecute(function(){return s.signalClearDeviceHistoryCompleted(t)},"signalClearDeviceHistoryCompleted")};l._clearStorageRequestedHandlers?n.safeExecute(function(){return l._clearStorageRequestedHandlers(t),!0},"clearDeviceHistoryRequested")||t(!1):t(!1)});t.addEventListener("statechanged",function(n){l.updateState(l._state,n.newState,!1)});t.addEventListener("dynamicsearchboxcontentchanged",function(){l.chainHandlerPromises(l._dynamicSearchBoxUpdateHandlers).then(function(){return n.safeExecute(function(){return t.notifyDynamicSearchBoxUpdateCompleted()},"notifyDynamicSearchBoxUpdateCompleted")})});i.addEventListener("querytextchanged",function(n){if(!l._qfDisabled){l._feedbackFormIsVisible&&l.closeFeedbackForm();var t=n.queryText;l._queryPropertiesOverrides&&l._queryPropertiesOverrides.query!=t&&(l._queryPropertiesOverrides=null);l.updateState(l._state,2,!0);l._queryToIgnoreOnQueryTextChangedEvent!=n.queryText&&(l._queryToIgnoreOnQueryTextChangedEvent=null);l.callQueryChangedHandlers(n,!1,l._queryToIgnoreOnQueryTextChangedEvent!=null,n.impressionId)}});i.addEventListener("keydown",function(r){var u,f,e,o,s;if(u=r.keyCode,n.config.debugDismissEvents){if(u==121){l.updateState(l._state,1,!1);return}if(u==122){f=l._state==0?2:0;f==2&&(l._currentCVID=null);l.updateState(l._state,f,!1);return}}if(l._qfDisabled){if(t.hostingEnvironment==3&&u==13){e=i.getQueryText().queryText;t.fileExplorerSuggestionPage.onSuggestionSelection(e)}return}if(u!=9&&!n.isFunctionalKey(u)){if(u==27){l.keyDownEscapeHandler();return}o={shiftKey:r.isShiftKeyPressed,ctrlKey:r.isControlKeyPressed,altKey:!1};s=r.isHandled;n.InstrumentationHelper.instrumentKeyDown(n.getCurrentTime());l._keyDownHandlers.forEach(function(t){return n.safeExecute(function(){return t(u,o,s)},"keyDown")})}});sj_b.addEventListener("keydown",function(t){var i,u,o,r,f,e;if(!l._qfDisabled){if(i=t.keyCode,n.config.debugDismissEvents){if(i==121){l.updateState(l._state,1,!1);return}if(i==122){u=l._state==0?2:0;u==2&&(l._currentCVID=null);l.updateState(l._state,u,!1);return}}if(!n.isFunctionalKey(i)){if(i!=9||l._feedbackFormIsVisible||t.preventDefault(),o=n.RuntimeConfig.AlwaysWide,r=t.target,r){if(i==27){if(l._feedbackFormIsVisible){l.closeFeedbackForm();return}l.keyDownEscapeHandler();return}if(f=_ge("fbpgdg"),f&&f.contains(r))return;if(!o&&n.RuntimeConfig.PreviewPaneAvailable&&(e=_ge("qfPreviewPane"),e&&e.contains(r)&&(!n.DialogBox||n.DialogBox.isVisible())))if(i==37)sj_pd(t);else return}n.contains([38,40],i)&&sj_pd(t);l._keyDownHandlers.forEach(function(i){return n.safeExecute(function(){return i(t.keyCode,t,!1)},"body.keyDown")})}}});i.addEventListener("keyup",function(t){var i,r,u;l._qfDisabled||(i=t.keyCode,i==9||n.isFunctionalKey(i))||(r={shiftKey:t.isShiftKeyPressed,ctrlKey:t.isControlKeyPressed,altKey:!1},u=t.isHandled,l._keyUpHandlers.forEach(function(t){return n.safeExecute(function(){return t(i,r,u)},"keyUp")}))});sj_b.addEventListener("keyup",function(t){if(!l._qfDisabled){var i=t.keyCode;n.isFunctionalKey(i)||l._keyUpHandlers.forEach(function(r){return n.safeExecute(function(){return r(i,t,!1)},"keyUp")})}});i.addEventListener("gotfocus",function(){l._qfDisabled||l._searchBoxGotFocusEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"gotfocus")})});i.addEventListener("lostfocus",function(){l._qfDisabled||l._searchBoxLostFocusEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"lostfocus")})});i.addEventListener("submitbuttonclick",function(){if(!l._qfDisabled){var i=n.getCurrentTime(),t=l.getFeatureString("SubmitButtonGlyph").featureValue;t&&t!=""?l._onButtonRightOfSearchBoxClick.forEach(function(i){return n.safeExecute(function(){return i(t)},"submitbuttonclick.custom")}):l._onSubmitHandlers.forEach(function(t){return n.safeExecute(function(){return t(i,!0,null)},"submitbuttonclick")})}});i.addEventListener("searchboxglyphclick",function(){l._qfDisabled||l._onSearchBoxGlyphIconClick.forEach(function(t){return n.safeExecute(function(){return t()},"searchboxglyphclick")})});i.addEventListener("searchboxtapped",function(){l._qfDisabled||l._onSearchBoxClick.forEach(function(t){return n.safeExecute(function(){return t()},"searchboxtapped")})});i.addEventListener("searchboxclick",function(){l._qfDisabled||l._onSearchBoxClick.forEach(function(t){return n.safeExecute(function(){return t()},"searchboxclick")})});sj_evt.bind("ajax.feedback.initialized",sj_dm(this,l.registerFeedbackDebugCallback),!0);l.bindAppVisible(function(){return l.appVisibleInit()});l.bindShown(function(t){if(n.safeFireEvent("ajax.threshold.pageStart",t),l.shownInit(),l.checkBingWallpaperAppInstalled(),!l._qfDisabled){var i=l.getNewConversationId();n.updateErrorHandlingCVID(i);l._currentCVID!=i&&(l._currentCVID=i,l._randomPrivacyNumber=l.getNewPrivacyNumber(),l._conversationStartEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"conversationStart")}));l._lastKeyWasEnter=!1}});l.bindDismissed(function(){l._qfDismissCount+=1;n.safeFireEvent("threshold.pageUnload");l.dismissCleanup()});l.bindAppHidden(function(){l._paneCloseCount+=1;l.appHiddenCleanup();l.uploadClientErrorLog()});l.bindKeyDown(function(t,i){var r,u;l._modifierKeyState=i;r=t==13;!r||l._lastKeyWasEnter||typeof n.isMsbWorkShortcutsAvailable=="function"&&n.isMsbWorkShortcutsAvailable(t,i)||(u=n.getCurrentTime(),l._onSubmitHandlers.forEach(function(t){return n.safeExecute(function(){return t(u,!1,i)},"onSubmit handlers")}));l._lastKeyWasEnter=r});l.bindKeyUp(function(n){l._lastKeyWasEnter=!1;switch(n){case 16:l._modifierKeyState.shiftKey=!1;break;case 17:l._modifierKeyState.ctrlKey=!1}});l.bindOnFeedbackClosing(function(n){n&&l.setFocusInSearchBox(null,"onFeedbackClosing")});(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.refreshWhenTokenArrives)&&l.bindAccessTokenAvailable(function(t){var r=t==1?function(n){return n.dataSource=="SSEE"||n.dataSource=="SSUE"}:function(n){return n.dataSource=="SSEC"||n.dataSource=="SSUC"};l._currentQuery&&(l._currentQuery.queryToFetch.length>=n.config.minLengthFor3SonL1||n.isL2(l._currentQuery))&&l._currentQuery.originalQuery==i.getQueryText().queryText&&n.ScopeConfig[l._currentQuery.scope].enabledDataSources.some(r)&&l.refreshCurrentPane()});_G.PN="QF";l._edgeIconCache=n.Async.safeChainWithGlobalCaching("edgeIcon",function(t){return f.deviceSearch.findAppsAsync(n.EdgeAppIds).then(function(i){var r=n.EdgeAppIds.map(function(n){return i[n]}).filter(function(n){return!!n})[0];return r.getImageAsync(n.getImageSizeValue(t)).then(function(n){return e(n,"edgeIcon",null,r.isImmersive?r.logoBackgroundColor:null)})})},function(n){return n+"_edgeIcon"});sj_evt.bind("onFeedbackStarting",function(n){var t=n===void 0?[undefined,undefined]:n,i=t[1];l._feedbackFormIsVisible=!0;l._feedbackFormIsOpenedByClient=i;l.adjustHeight()});sj_evt.bind("onFeedbackClosing",function(){l._feedbackFormIsVisible=!1;l.adjustHeight();l._onFeedbackClosingHandlers.forEach(function(t){return n.safeExecute(function(){return t(l._feedbackFormIsOpenedByClient)},"onFeedbackClosing handlers")})});l.initCloudSearch();l._accessTokenManager&&(l._accessTokenManager.bindAccessTokenAvailable(function(n){l._accessTokenAvailableHandlers.forEach(function(t){return t(n)})}),l._accessTokenManager.bindAccountTypesChanged(function(){return l.updateScopeList()}),l._accessTokenManager.enumerateMultiAccountAuthority(function(){return l.initHeadersOverrides(l._qfDismissCount)}));(n.osSKUCache==undefined||n.osSKUCache==0)&&ThresholdUtilities.getOsSKU(function(t){switch(t){case"4":n.osSKUCache=4;break;case"48":n.osSKUCache=48;break;case"101":n.osSKUCache=101;break;case"27":n.osSKUCache=27;break;default:n.osSKUCache=0}})},l.refreshDefaultBrowserInfo=function(){if(l._defaultBrowser=0,t.getDefaultBrowserInfo){var i=n.safeExecute(function(){return t.getDefaultBrowserInfo()},"getDefaultBrowserInfo");i&&(l._defaultBrowser=l.calculateBrowserType(i.path),l._defaultBrowserIconCache=f.deviceSearch.getIconForDefaultBrowserAsync&&l.getUriLaunchPolicy()==0&&l._defaultBrowser!=3?n.Async.safeChainWithGlobalCaching("defaultBrowserIcon",function(t){return f.deviceSearch.getIconForDefaultBrowserAsync(n.getImageSizeValue(t),0).then(function(n){return n?e(n,"defaultBrowserIcon"):{type:0,content:o}})},function(n){return n+"_"+i.progId}):null)}t.setDefaultUriLaunchPolicy&&t.setDefaultUriLaunchPolicy(l.getUriLaunchPolicy())},l.chainHandlerPromises=function(n){return __awaiter(this,void 0,void 0,function(){var t,i,r,u;return __generator(this,function(f){switch(f.label){case 0:t=0;i=n;f.label=1;case 1:if(!(t<i.length))return[3,6];r=i[t];f.label=2;case 2:return f.trys.push([2,4,,5]),[4,r()];case 3:return f.sent(),[3,5];case 4:return u=f.sent(),SharedLogHelper.LogError("chainHandlerPromises",null,u),[3,5];case 5:return t++,[3,1];case 6:return[2]}})})},l.getDefaultBrowser=function(){return l._defaultBrowser},l.getFRSuggCount=function(){return l._fuzzyRankSuggestionCount},l.setFRSuggCount=function(n){n===void 0&&(n=0);l._fuzzyRankSuggestionCount=n},l.getCRCount=function(){return l._coldRankSuggestionCount},l.setCRCount=function(n){n===void 0&&(n=0);l._coldRankSuggestionCount=n},l.incrementCRCount=function(){l._coldRankSuggestionCount<0?l._coldRankSuggestionCount=1:l._coldRankSuggestionCount++},l.getNCRCount=function(){return l._notColdRankSuggestionCount},l.setNCRCount=function(n){n===void 0&&(n=0);l._notColdRankSuggestionCount=n},l.incrementNCRCount=function(){l._notColdRankSuggestionCount<0?l._notColdRankSuggestionCount=1:l._notColdRankSuggestionCount++},l.getFCRCount=function(){return l._finalColdRankSuggestionCount},l.setFCRCount=function(n){n===void 0&&(n=0);l._finalColdRankSuggestionCount=n},l.getOsSKU=function(){return n.osSKUCache},l.getWindowsTheme=function(){return l._defaultWindowsTheme},l.getAppTheme=function(){return l._defaultAppTheme},l.getAccentColor=function(n){if(n===void 0&&(n=0),!Number.isInteger(n))throw"Invalid argument "+n;if(l._accentColorShades){var t=n<0?l._accentColorShades.light:l._accentColorShades.dark,i=Math.min(3,Math.abs(n));return t[i]}return l._accentColor},l.refreshAccentColorShades=function(){l._accentColorShades=null;var n=t.themeColors;n&&(l._accentColorShades={dark:[n.accent,n.accentDark1,n.accentDark2,n.accentDark3,],light:[n.accent,n.accentLight1,n.accentLight2,n.accentLight3,]},l._accentColorShades.dark=l._accentColorShades.dark.map(function(n){return"#"+n.substr(3)}),l._accentColorShades.light=l._accentColorShades.light.map(function(n){return"#"+n.substr(3)}))},l.calculateBrowserType=function(n){return n?n.endsWith("\\chrome.exe")?6:n.endsWith("LaunchWinApp.exe")?3:n.endsWith("firefox.exe")?5:n.endsWith("\\msedge.exe")?4:n.endsWith("Opera\\Launcher.exe")?7:n.endsWith("\\iexplore.exe")?2:0:0},l.getUriLaunchPolicy=function(){return 2},l.getConnectedAccountInfo=function(n){return l._accessTokenManager?l._accessTokenManager.getCachedAccountInfo(n):null},l.isInternetConnectionMetered=function(){return n.safeExecute(function(){return t.networkEnvironment&&t.networkEnvironment.isMeteredConnection},"isInternetConnectionMetered",!1)},l.isInputPanelVisible=function(){return n.safeExecute(function(){return i.isInputPaneVisible},"isInputPanelVisible")},l.uploadClientErrorLog=function(){var o,u,e,i,f,r;if(t.getFlightingLogsAndDelete)for(o=n.safeExecute(function(){return t.getFlightingLogsAndDelete()},"getFlightingLogsAndDelete",""),u=0,e=o.split("\r\n");u<e.length;u++)i=e[u],i!=""&&(f=i.indexOf("|"),f<0||f+1==i.length?SharedLogHelper.LogWarning("clientError",i,"Malformed clientError data"):(r=i.substr(f+1),r.startsWith("Critical:")||r.startsWith("Error:")?SharedLogHelper.LogError("clientError",null,r):SharedLogHelper.LogWarning("clientError",null,r)))},l.registerFeedbackDebugCallback=function(n){var t=n[1].debugCollector;t.registerCollectionCallback(sj_dm(this,l.collectDebugInfo))},l.collectDebugInfo=function(){var i={},e=l._currentQuery&&l._currentQuery.originalQuery,r,u;return e&&(i.query=e),i.conversationId=l._currentCVID,i.entryPoint=t.entryPoint,i.previousExperience=f.previousExperience,n.ConstraintIndex&&(i.ciVersion=n.ConstraintIndex.currentCIVersion),n.config.snrVersion&&(i.snrVersion=n.config.snrVersion),n.osSKUCache!==undefined&&(i.ossku=n.osSKUCache.toString()),r=t.width,r&&(i.width=r.toString()),u=t.height,u&&(i.height=u.toString()),i},l.clearInitialFetchTimer=function(){l._initialFetchTimer&&(sb_ct(l._initialFetchTimer),l._initialFetchTimer=null)},l.callQueryChangedHandlers=function(i,r,u,f,e){var o,s,h;if(l._qfDisabled)throw"Not supported";(o=l.getStructuredQuery(i,null,l._currentQuery),l._rawQueryChangedHandlers.forEach(function(t){return n.safeExecute(function(){return t(o,r)},"rawQueryTextChanged")}),u||l.clearInitialFetchTimer(),f||(s=t.impressionId,l.usedImpressionIds[s]||(f=s,l.usedImpressionIds[s]=!0)),h=e&&!o.originalQuery,h||!f||f==l._currentRawImpressionId?(l._currentRawImpressionId=l.createGuid(),l._currentRawImpressionIdCreatedByTheClient=!1):(l._currentRawImpressionId=f,l._currentRawImpressionIdCreatedByTheClient=!0),u)||(l._previousQuery=l._currentQuery,l._currentQuery=o,l._queryChangedHandlers.forEach(function(t){return n.safeExecute(function(){return t(o,r)},"queryTextChanged")}))},l.getStructuredQuery=function(i,r,u){var o,e=i.queryText,c=i.cursorPosition,s,f,h;return r&&r.originalQuery===e&&r.originalCursorPosition===c?r:(s=l._queryPropertiesOverrides&&l._queryPropertiesOverrides.query==e,f=s&&n.isCortanaEnabledCache?(o=l._queryPropertiesOverrides)===null||o===void 0?void 0:o.taskFrame:null,!f&&n.isCortanaEnabledCache&&t.searchResultsView.getTaskFrame&&(h=n.safeExecute(function(){return t.searchResultsView.getTaskFrame(e)},"getTaskFrame"),h&&(f=n.parseTaskFrame(h))),!f&&u&&u.taskFrame&&u.originalQuery==e&&(f=u.taskFrame),n.parseQuery(e,c,u,f,s&&l._queryPropertiesOverrides))},l.updateState=function(r,u,f){var o,e,s,h;r!=u&&(l._state=u,r==0&&(o=n.getCurrentTime(),l._appVisibleEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"appVisible")}),n.InstrumentationHelper.instrumentAppVisibleFinish(o)),u==2&&(e=n.getCurrentTime(),l._shownEventHandlers.forEach(function(t){return n.safeExecute(function(){return t(e)},"shown")}),n.InstrumentationHelper.instrumentAppShownFinish(e),f||l._qfDisabled||(s=t.entryPoint=="WNSSTB",l._initialFetchTimer=n.safeSetTimeout(function(){return l.callQueryChangedHandlers(i.getQueryText(),!1,!1,null,!0)},s?n.config.initialFetchTimerDelayFromStartMenu||0:0,"initialFetch"))),r==2&&(l.clearInitialFetchTimer(),h=l._currentQuery,l._dismissedEventHandlers.forEach(function(t){return n.safeExecute(function(){return t(h)},"dismissed")})),u==0&&l._appHiddenEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"appHidden")}))},l.searchBoxHasFocus=function(){return i.hasFocus},l.initializeEvents=function(){l.updateState(l._state,t.currentState,!1)},l.bindClearMRURequested=function(n){l._clearStorageRequestedHandlers&&SharedLogHelper.LogError("bindClearMRURequested",null,new Error("Only one event handler supported"));l._clearStorageRequestedHandlers=n},l.shouldRequestEltoken=function(){return l._shouldRequestEltoken},l.getElToken=function(){return l._elToken},l.setElToken=function(n){l._elToken=n;l._shouldRequestEltoken=!1},l.sendElToken=function(){l._sendElTokenInSuggstionRequest=!0},l.canHaveSearchHistory=function(){return n.searchHistoryAllowed()},l.getInstrumentationParameters=function(n){var i=t.createStringMap?t.createStringMap():{};return _G.nclid&&(i[u.HashedMuid]=_G.nclid),i[u.FormCode]=n||l.getFormCode(),i[u.ConversationId]=l.getConversationId(),i},l.appHiddenCleanup=function(){n.Async.clearGlobalCache();l._locStrings=[];n.cleanScopePrefixes();l.cleanTaskBarPinnedItems();n.clearPathExpansionCache();n.config.perfInstV2&&n.InstrumentationHelper.instrumentConversationTimelineFinish()},l.initCloudSearch=function(){var i=t.isCloudSearchEnabled!==!1,r=t.isMultiAccountCloudSearchSupported!==!1;n.isCloudSearchEnabledMsaCache=n.RuntimeConfig.QfMode==5||(r?t.isCloudSearchEnabledForMSA:i);n.isCloudSearchEnabledAadCache=n.RuntimeConfig.QfMode==5||(r?t.isCloudSearchEnabledForAAD:i)},l.initLanguage=function(){n.uiLanguageCache=(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.setLang)||t.systemLanguage||t.uiLanguage||"";l._queryParamsCache[u.SetLang]=n.uiLanguageCache},l.initLocStrings=function(){var r,u,t,i,f;for(r=l._enUsLocStrings.length==0,u=function(t){var i={uiCulture:"en-US",name:t,namespace:"WindowsSearchBox"},u;r&&l._enUsLocStrings.push(LocStringManager.getLocString(i));n.uiLanguageCache.toLowerCase()!="en-us"&&(i.uiCulture=n.uiLanguageCache,u=n.safeExecute(function(){return LocStringManager.getLocString(i)},"getLocString",null,i.uiCulture),u&&l._locStrings.push(u))},t=0,i=n.config.locStrings;t<i.length;t++)f=i[t],u(f)},l.appVisibleInit=function(){l.initCortanaEnabledAndRegion();var i=n.uiLanguageCache;l.initLanguage();n.config.noLocStringRefresh&&i!=n.uiLanguageCache?l.initLocStrings():n.config.noLocStringRefresh||l.initLocStrings();n.refreshBingEnabledCache(t.isBingEnabled,l.getRegion(),l.getLanguage());n.RuntimeConfig.OnAppVisible();l._isFileExplorerOrControlPanel=n.RuntimeConfig.QfMode==5||n.RuntimeConfig.QfMode==9;n.setZeroInputDataSourcesForL1();l.initCloudSearch();l.checkIfBitmapInClipboardSupported();l.updateScopeList();l._suggestionsContainer.setAttribute("aria-label",l.getLocString("ResultsList"));l._elToken=null;t.theme&&(l._defaultWindowsTheme=l._isFileExplorerOrControlPanel&&t.fileExplorerSuggestionPage?t.fileExplorerSuggestionPage.useDarkTheme?2:1:t.theme.startsWith("000000")?2:1,l._accentColor="#"+t.theme.substr(7),t.appsUseLightTheme!==null&&(l._defaultAppTheme=t.appsUseLightTheme?1:2));l.refreshAccentColorShades();l.refreshDefaultBrowserInfo();ThresholdUtilities.setBodyLangAttributes(n.uiLanguageCache);ThresholdUtilities.getCortanaHeaders(function(n){l._ageAccountType=0;n&&(n["X-UserAgeClass"]==="Child"?l._ageAccountType=1:n["X-UserAgeClass"]==="Adult"&&(l._ageAccountType=2))})},l.shownInit=function(){var e=l._qfDismissCount,i,f,r;if(l._queryPropertiesOverrides=null,n.RuntimeConfig.QfMode==999999||n.config.enableSnipSearchV2&&t.entryPoint=="WNSSBS"){l._qfDisabled=!0;return}n.RuntimeConfig.QfMode==5&&(i=n.safeExecute(function(){return t.fileExplorerSuggestionPage.currentLocation},"fileExplorerSuggestionPage.currentLocation"),l._fileExplorerCurrentPath=i&&!i.startsWith("::")?i:null);l.initCortanaEnabledAndRegion();f=t.isBingEnabled;f!=n.isBingEnabled()&&(n.refreshBingEnabledCache(f,l.getRegion(),l.getLanguage()),l.updateScopeList());r=t.homeGeographicRegion;l._queryParamsCache[u.CountryCode]=n.regionCache;r&&r!=n.regionCache&&(l._queryParamsCache[u.HomeGeographicRegion]=r);l._accessTokenManager&&l._accessTokenManager.enumerateMultiAccountAuthority(function(){return l.initHeadersOverrides(e)});l.initHeadersOverrides(e);l.keepWSBOpen(n.config.keepCortanaOpened||n.getTweakedSetting("keepCortanaOpenedTweak"))},l.initCortanaEnabledAndRegion=function(){n.isCortanaEnabledCache=t.isCortanaEnabled;n.regionCache=(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.cc)||(n.config.ignoreCortanaMarketOverride?t.homeGeographicRegion:t.region)||"";n.revIpRegionCache=typeof _G=="object"&&_G.RevIpCC&&_G.RevIpCC.toUpperCase()||""},l.updateScopeList=function(n){n&&t.currentState!==2||l._scopeListRequiresUpdate.forEach(function(n){return n()})},l.dismissCleanup=function(){l.keepWSBOpen(!1);delete l._queryParamsCache[u.HomeGeographicRegion];l._queryToIgnoreOnQueryTextChangedEvent=null;l._currentQuery=null;l._queryPropertiesOverrides=null;l._fileExplorerCurrentPath=null;n.regionCache=null;l.closeFeedbackForm();l.removeFeedbackForm();l._qfDisabled=!1},l.closeFeedbackForm=function(){n.safeFireEvent("WindowsFeedback.Form.Hide")},l.removeFeedbackForm=function(){typeof WindowsFeedbackForm!="undefined"&&WindowsFeedbackForm.Remove&&WindowsFeedbackForm.Remove()},l.checkIfBitmapInClipboardSupported=function(){if(t.getClipboardAvailableFormats)try{var n=t.getClipboardAvailableFormats();l._isBitmapInClipboardSupported=n!=null}catch(i){l._isBitmapInClipboardSupported=!1}else l._isBitmapInClipboardSupported=!1},l.isBitmapInClipboardSupported=function(){return l._isBitmapInClipboardSupported},l.getBitmapURIFromClipboardAsync=function(i){var r=n.safeExecute(function(){return t.getClipboardAvailableFormats()},"getClipboardAvailableFormats",[]);n.contains(r,"Bitmap")||i(null);n.Async.safeChain("getClipboardBitmapAsync",function(){return t.getClipboardBitmapAsync()},function(n){return i(URL.createObjectURL(n))},function(){return i(null)})},l.setAuthHeadersFromWindowsTokens=function(){var t,i,r,u;l._accessTokenManager&&(t=l._headersCache,i=n.AccessTokenManager.getWindowsAccountType(),n.config.userProfileButtonEnabled?(r=l._accessTokenManager.getSelectedAccountInfo(),r&&(u=r.accountProviderAuthority=="consumers"?0:1,l._accessTokenManager.getAccountByUserName(!1,u,r.accountUserName,!1,!0,function(n){n&&n.Token&&(u==0?(t["X-Search-RPSToken"]=n.Token,delete t.Authorization):(t.Authorization="Bearer "+n.Token,delete t["X-Search-RPSToken"]))}))):i==2||i==4?l._accessTokenManager.getAccount(0,n.getBingResourceOrScope(0),!1,!0,function(n){n&&n.Token&&(t["X-Search-RPSToken"]=n.Token)}):i==1&&l._accessTokenManager.getAccount(1,n.getBingResourceOrScope(1),!1,!0,function(n){n&&n.Token&&(t.Authorization="Bearer "+n.Token)}))},l.initHeadersOverrides=function(i){var r=[];l._headersCache={};t.systemRAMInMB&&t.systemRAMInMB<=512&&r.push("LowMemoryDevice");r.push("FontV22");r.push("LightAnswers");n.RuntimeConfig.PreviewPaneAvailable&&r.push("PreviewPaneAvailable");r.length>0&&(l._headersCache["X-BM-ClientFeatures"]=r.join());l.setAuthHeadersFromWindowsTokens();ThresholdUtilities.getCortanaHeaders(function(t){if(t&&i==l._qfDismissCount){l._shouldRequestEltoken=!!t["X-Search-Location"];var u=t["X-BM-ClientFeatures"];u&&(Array.prototype.push.apply(r,u.split(",")),l._headersCache["X-BM-ClientFeatures"]=r.join());l._safeSearchSetting=t["X-Search-SafeSearch"];l._isEducationEnvironment=t["X-Device-EnableRegulatoryPsm"]=="1";l._isWindowsS=t["X-Device-EnableCPsm"]=="1";l._partnerSearchCode=t["X-Device-PSC"];n.substrateProvidersEnabled()||l.updateScopeList()}})},l.createGuid=function(){return n.safeExecute(function(){return t.createGuid()},"createGuid","")},l.getLocString=function(t){for(var i,u,e,o,f=[],r=1;r<arguments.length;r++)f[r-1]=arguments[r];for(u=0,e=l._locStrings;u<e.length;u++)if(o=e[u],i=o[t],i)break;return i||(i=l.getEnUsLocString(t)),i&&f.length>0&&(i=n.formatString(i,f)),i},l.getEnUsLocString=function(n){for(var u,r,t=0,i=l._enUsLocStrings;t<i.length;t++)if(u=i[t],r=u[n],r)return r;return undefined},l.getRawImpressionGuid=function(){return l._currentRawImpressionId},l.getConversationId=function(){return l._currentCVID},l.getPrivacyNumber=function(){return l._randomPrivacyNumber},l.getNewConversationId=function(){var t=n.cleanGuid(n.safeExecute(function(){return f.perfMetrics.conversationId},"conversationId"));return t||(SharedLogHelper.LogWarning("getNewConversationId",null,new Error("Client returned null conversation ID")),t=n.cleanGuid(l.createGuid())),t},l.getNewPrivacyNumber=function(){return Math.floor(Math.random()*Number.MAX_VALUE)},l.keyDownEscapeHandler=function(){var t={handled:!1};l._keyEscapeHandlers.forEach(function(i){return n.safeExecute(function(){return i(t)},"escapeKey")});t.handled||n.safeExecute(function(){return SearchAppWrapper.CortanaApp.dismissApp()},"dismissApp");return},l.bindQueryChangedOrInitialized=function(n,t){t?l._rawQueryChangedHandlers.push(n):l._queryChangedHandlers.push(n)},l.bindOnSubmit=function(n){l._onSubmitHandlers.push(n)},l.bindOnFeedbackClosing=function(n){l._onFeedbackClosingHandlers.push(n)},l.bindSearchBoxGlyphIconClick=function(n){l._onSearchBoxGlyphIconClick.push(n)},l.bindSearchBoxClick=function(n){l._onSearchBoxClick.push(n)},l.bindButtonRightOfSearchBoxClick=function(n){l._onButtonRightOfSearchBoxClick.push(n)},l.bindSearchBoxGotFocus=function(n){l._searchBoxGotFocusEventHandlers.push(n)},l.bindSearchBoxLostFocus=function(n){l._searchBoxLostFocusEventHandlers.push(n)},l.getModifierKeyState=function(){return l._modifierKeyState},l.notifyBootstrapDone=function(){l._bootstrapDoneEventHandlers.forEach(function(n){return n()})},l.bindBootstrapDone=function(n){l._bootstrapDoneEventHandlers.push(n)},l.bindAppVisible=function(n){l._appVisibleEventHandlers.push(n)},l.bindShown=function(n){l._shownEventHandlers.push(n)},l.bindConversationStart=function(n){l._conversationStartEventHandlers.push(n)},l.bindDismissed=function(n){l._dismissedEventHandlers.push(n)},l.bindAppHidden=function(n){l._appHiddenEventHandlers.push(n)},l.bindKeyEscape=function(n){l._keyEscapeHandlers.push(n)},l.bindKeyDown=function(n){l._keyDownHandlers.push(n)},l.bindKeyUp=function(n){l._keyUpHandlers.push(n)},l.bindAccessTokenAvailable=function(n){l._accessTokenAvailableHandlers.push(n)},l.bindScopeListRequiresUpdate=function(n){l._scopeListRequiresUpdate.push(n)},l.bindAccountChanged=function(n){l._accountChangedHandlers.push(n)},l.bindDynamicSearchboxUpdate=function(n){l._dynamicSearchBoxUpdateHandlers.push(n)},l.getQuery=function(){return l.getStructuredQuery(i.getQueryText(),l._currentQuery,l._previousQuery)},l.refreshCurrentPane=function(n){if(!n||t.currentState===2){var i=l._currentQuery?l._currentQuery.originalQuery:"";l.setQuery(i,!1,!0)}},l.keepWSBOpen=function(n){var i=t.hostingEnvironment==3;!i&&t.changeExplicitDismissMode&&t.changeExplicitDismissMode(n)},l.notifyAccountSelected=function(n){l.setAuthHeadersFromWindowsTokens();l.refreshCurrentPane();l._accountChangedHandlers.forEach(function(t){return t(n)})},l.updateQueryWithoutRefetching=function(t){n.isNullOrUndefined(t)&&(t=l._currentQuery?l._currentQuery.originalQuery:"");l.setQuery(t,!1,!1)},l.reformulate=function(n,t,i,r){var u={query:n,taskFrame:t,topHitRestriction:i,forceGroupOnTop:r};l.setQuery(n||"",!0,!1,u)},l.reformulateOnSuggestionClick=function(n,t,i,r){var u={query:n,fromSearchHome:t,fromSuggestionType:i,inorganic:!0,serpURLParams:r};l.setQuery(n||"",!0,!1,u)},l.reformulateNonForcedMiniSerp=function(n,t,i){var r={query:n,fromSearchHome:t,fromSuggestionType:i};l.setQuery(n||"",!0,!1,r)},l.setQuery=function(r,u,f,e){var o,s,h,c;if(n.isNullOrUndefined(r))throw new Error("query parameter can't be null");if(!u&&e)throw new Error("Property overrides only allowed on query reformulations");o=!u&&!f;l._queryPropertiesOverrides=e;o&&(l._queryToIgnoreOnQueryTextChangedEvent=r);s=!!n.config.setQueryKeyboardNavParamAvailable&&o&&i.getQueryText().queryText!=r;n.safeExecute(function(){return i.setQueryText(r,u,l._currentRawImpressionIdCreatedByTheClient?l._currentRawImpressionId:t.impressionId,s)},"setQueryText");h=u&&l.getQuery().originalQuery==r||f;h&&(c=function(){return l.callQueryChangedHandlers({queryText:r,cursorPosition:r.length},f,!1)},n.safeExecute(c,"triggerQueryTextChangedEvent"))},l.setAutoCompleteQueryText=function(t){n.safeExecute(function(){return i.setAutoCompleteQueryText(t,l._currentRawImpressionId)},"setAutoCompleteQueryText")},l.manuallyDismissApp=function(){!n.config.manuallyDismissApp||n.config.keepCortanaOpened||n.getTweakedSetting("keepCortanaOpenedTweak")||SearchAppWrapper.CortanaApp.dismissApp()},l.launchUri=function(t,i,u,f){var e=function(n){n?u&&u():f&&f()};n.Async.safeChain("launchUri",function(){var n=r.createUriLaunchOptions();return n.launchPolicy=l.getUriLaunchPolicy(),n.dismissAppBeforeLaunchingURI=i,r.launchUriAsync(t,n)},e,f)},l.launchUrlWithEdgeProtocol=function(t,i,r,u,f){n.config.enableAnaheimLaunchWithProtocol&&(t=t?"microsoft-edge:?url="+encodeURIComponent(t)+"&timestamp="+n.getCurrentTime():"microsoft-edge:?timestamp="+n.getCurrentTime(),n.config.anaheimDataLaunchSource&&(t+="&source="+encodeURIComponent(n.config.anaheimDataLaunchSource)),i.campaign&&(t+="&campaign="+encodeURIComponent(i.campaign)),i.medium&&(t+="&medium="+encodeURIComponent(i.medium)),i.cid&&(t+="&cid="+encodeURIComponent(i.cid)),i.oid&&(t+="&oid="+encodeURIComponent(i.oid)),i.edgeSettingsUrl&&(t+="&ux="+encodeURIComponent(i.edgeSettingsUrl)));l.launchUri(t,r,u,f)},l.DSBLaunchUri=function(t,i,r,u){var f,e,o;n.InstrumentationHelper.instrumentItemClick(n.getCurrentTime(),i,n.SequenceNumberManager.getSequenceNumber(),null,n.getInputType(r),null);f=u?u:i===null||i===void 0?void 0:i.getQsCode();(i===null||i===void 0?void 0:i.getHandoffType())===20?(e=n.getDSBOCID(f),e&&(t=n.setUrlParameter(t,"ocid",e),t=n.setUrlParameter(t,"pc","DSBPC"))):(o=n.getDSBFormCode(f),o&&(t=n.setUrlParameter(t,"form",o)));n.Host.launchUri(t)},l.launchOutlook=function(t,i,u){n.Async.safeChain("launchOutlook",function(){return r.launchEmailInOutlookNativeAsync(t)},function(n){n?(i&&i(),l.manuallyDismissApp()):u&&u()},u)},l.submitFileExplorerTextSuggestion=function(i){n.safeExecute(function(){return t.fileExplorerSuggestionPage.onSuggestionSelection(i)},"submitFileExplorerTextSuggestion")},l.submitFileExplorerFolderSuggestion=function(i){n.safeExecute(function(){return t.fileExplorerSuggestionPage.onFolderSelection(i)},"submitFileExplorerFolderSuggestion")},l.removeItemFromPinnedToTaskbar=function(n){l._pinnedApps[n]=!1},l.addItemToPinnedToTaskbar=function(n){l._pinnedApps[n]=!0},l.cleanTaskBarPinnedItems=function(){l._pinnedApps={}},l.isPinnedToTaskbar=function(n){return l._pinnedApps[n]},l.launchSearchInFileExplorer=function(i){n.safeExecute(function(){return t.launcher.launchExplorerSearch("query="+n.encodeURIComponentForWindowsProtocol(i)+"&crumb=kind:docs&crumb=location:")},"launchExplorerSearch")},l.isRequestFocusAvailable=function(){return!!i.requestFocus},l.setFocusInSearchBox=function(t,r){var u,f,e;l.isRequestFocusAvailable()&&(u=function(){return i.requestFocus()},f="requestFocus",t==9?n.safeSetTimeout(u,0,f,r):n.safeExecute(u,f,null,r),e=n.getCurrentActiveElement(),e&&e.blur())},l.setFocusInWebView=function(i){t.focusWebView&&n.safeExecute(function(){return t.focusWebView()},"focusWebView",null,i)},l.getFeatureEnabled=function(i){var r={validFeature:!1,featureEnabled:!1};return t.getFeatureEnabled?n.safeExecute(function(){return t.getFeatureEnabled(i)},"getFeatureEnabled",r,i):r},l.getFeatureDWORD=function(i){var r={validFeature:!1,featureValue:0};return t.getFeatureDWORD?n.safeExecute(function(){return t.getFeatureDWORD(i)},"getFeatureDWORD",r,i):r},l.getFeatureString=function(i){var r={validFeature:!1,featureValue:""};return t.getFeatureString?n.safeExecute(function(){return t.getFeatureString(i)},"getFeatureString",r,i):r},l.launchInApp=function(t,i,r){l.updateQueryWithoutRefetching(i);n.safeExecute(r,t)},l.launchVoiceFlow=function(n){l.launchInApp("launchVoiceFlow",n,function(){return r.launchRAFAsync(n,l.getFormCode(),l.getInstrumentationParameters())})},l.launchSearch=function(t,i,r){if(r&&!n.config.disableRAF)l.launchVoiceFlow(t);else{if(n.config.anaheimPrototype&&this._accessTokenManager){var u=this._accessTokenManager.getSelectedAccountInfo();i=u?"microsoft-edge:?upn="+u.accountUserName+";url="+i:"microsoft-edge:?url="+i}l.launchUri(i)}},l.launchCat1=function(n,i,u){var f=a[i],e;f?l.launchInApp("launch"+f,n,function(){return t.launchExperienceByName(f,null)}):(e=v[i],e?l.launchUri(e):l.launchInApp("launchCat1",n,function(){return r.launchCat1Async(n,u,l.getInstrumentationParameters())}))},l.launchCat2or3a=function(n,t){l.launchInApp("launchCat2",n,function(){return r.launchCat2Async(n,l.getFormCode(),t,l.getInstrumentationParameters())})},l.launchStoreSearch=function(t){var i="ms-windows-store:search?query="+n.encodeQueryParameter(t)+"&ocid="+n.encodeQueryParameter(n.config.storeHandoffTag)+"&type=apps";l.launchUri(i)},l.launchFolder=function(t){n.safeExecute(function(){return r.startLaunchFolder(t)},"launchFolder")},l.launchWindowsCortanaSettings=function(){l.launchUri("ms-settings:cortana")},l.launchWindowsIndexingOptions=function(){n.LocalDataProvider.launchIndexingOptions(!1)},l.launchCortanaSignIn=function(){l.launchUri("ms-cortana://CapabilitiesPrompt/?RequestedCapabilities=Personalization")},l.launchCortanaNotebook=function(){l.launchUri("ms-cortana://StartMode=Notebook")},l.launchCortanaDevices=function(){l.launchUri("ms-cortana://StartMode=Devices")},l.launchWindowsAccountSettings=function(){l.launchUri("ms-settings:emailandaccounts")},l.launchSearchSettings=function(){l.launchUri("ms-settings:cortana-windowssearch")},l.launchSearchDetails=function(){l.launchUri("ms-settings:search-moredetails")},l.launchSearchPermissions=function(){l.launchUri("ms-settings:search-permissions")},l.launchDeviceItem=function(i,u){var f=i.id,e=u,o,s;n.localDataSourceMayContainPII(u)||(e+="\n"+f);f.startsWith("shell:")?n.safeExecute(function(){return r.startLaunchFolder(f)},"launchDeviceItem",null,e):(o=function(){if(l._isFileExplorerOrControlPanel)t.fileExplorerSuggestionPage.onFileSelection(i)},s=i.originalDeviceItem||i,n.Async.safeChain("launchDeviceItem",function(){return r.launchSearchItemAsync(s)},o,null,null,e,0))},l.launchAppItem=function(t,i,u){var f=t.id,e=i+"\n"+f,o;u&&e+"\n"+u;f.startsWith("shell:")?n.safeExecute(function(){return r.startLaunchFolder(f)},"launchAppItem",null,e):(o=t.originalDeviceItem||t,n.Async.safeChain("launchAppItem",function(){var n;return u&&(n=r.createAppLaunchOptions(),n.appContext=u),r.launchSearchItemAsync(o,n)},null,null,null,e,0))},l.launchWebContent=function(n,t,i){l.launchInApp("launchWebContent",t,function(){var t=r.createWebContentLaunchOptions();t.uri=n;i&&t.setAuthorization("Bearer",i);r.launchWebContent(t)})},l.launchPrivacyPortal=function(){l.launchUri("https://go.microsoft.com/fwlink/?LinkId=780764")},l.getCustomUrlParameters=function(t){var i=Object.assign({},l._queryParamsCache),r=t.scope;return r==n.Scope.All?delete i[u.Scope]:i[u.Scope]=n.Scope[r].toLowerCase(),n.searchHistoryAllowed()||(i[n.Service.QueryParams.NoHistory]="1"),l._sendElTokenInSuggstionRequest&&(i[n.Service.QueryParams.ElTokenValue]=l._elToken),n.RuntimeConfig.QfMode&&(i[n.Service.QueryParams.QfMode]=n.RuntimeConfig.QfMode.toString()),i},l.getCustomHeaders=function(t){var i=Object.assign({},l._headersCache),r;return t&&t.scope==n.Scope.Apps||(r=(i["X-BM-ClientFeatures"]||"").split(","),r.push("RevStore"),i["X-BM-ClientFeatures"]=r.join()),i},l.reloadWebView=function(){n.Async.safeChain("reloadWebViewAsync",function(){return t.reloadWebViewAsync()})},l.throwIfResourcesMissing=function(){var t=_ge("cssCanary"),i=_w.getComputedStyle(t).fontFamily,u=_w.getComputedStyle(t).getPropertyValue("list-style-type"),r;if((n.config.useCobaltCSS||sa_config.undocked)&&(r=_w.getComputedStyle(t).fontSize,r!="1px"&&n.log("WSBCobalt.css missing. useCobaltCSS="+n.config.useCobaltCSS+" undocked="+sa_config.undocked)),i!="CANARY"&&i!='"CANARY"'||u!="none")throw new Error("Missing CSS Bundle.");},l.getFormCode=function(){return SearchAppWrapper.CortanaApp.entryPoint!="WNSHVR"?n.mapOSFormCode("WNSGPH"):"WNSHVR"},l.getRegion=function(){return n.regionCache||this.initCortanaEnabledAndRegion(),n.regionCache},l.getLanguage=function(){return n.uiLanguageCache||this.initLanguage(),n.uiLanguageCache},l.dataSourceDependencies=function(n){return n=="Web"?["OSTMA","QS"]:n=="SSUE"?["SREE"]:[]},l.getPaneCloseCount=function(){return l._paneCloseCount},l.hasFallbackHappened=function(){return l._hasFallbackHappened},l.getSafeSearchSetting=function(){return l._safeSearchSetting},l.isEducationEnvironment=function(){return l._isEducationEnvironment},l.isWindowsS=function(){return l._isWindowsS},l.getPartnerSearchCode=function(){return l._partnerSearchCode},l.getAgeAccountType=function(){return l._ageAccountType},l.getMSNRefIg=function(){return null},l.setSearchBoxGlyphIcon=function(t){var r,u,f;i.setSearchBoxGlyphIcon&&(t?(r=t.content||"",r.startsWith("&#x")&&(u=parseInt(r.substr(3),16),r=u?String.fromCharCode(u):""),f=t.type==2?"/Assets/Fonts/CortMDL2.ttf#Cortana MDL2 Assets":"",n.safeExecute(function(){return i.setSearchBoxGlyphIcon(r,f)},"setSearchBoxGlyphIcon custom")):n.safeExecute(function(){return i.setSearchBoxGlyphIcon("","")},"setSearchBoxGlyphIcon default"))},l.adjustHeightWithoffset=function(){},l.adjustHeight=function(){var i,r;n.RuntimeConfig.PanelCanResize&&t.setWebViewHeight&&(l._pendingAdjustHeightTimer&&(sb_ct(l._pendingAdjustHeightTimer),l._pendingAdjustHeightTimer=null),(n.MockUrlParameters===null||n.MockUrlParameters===void 0?void 0:n.MockUrlParameters.clientVersion)&&(s?l._rootContainer.style.height="auto":l._root.style.height="auto"),i=l._feedbackFormIsVisible?c:l._root.offsetHeight,s&&(i+=36),r=function(){i*=t.textScaleFactor||1;t.setWebViewHeight(i);l._currentPaneHeight=i;l._pendingAdjustHeightTimer=null},!n.config.paneResizeDelay||i>=l._currentPaneHeight?r():l._pendingAdjustHeightTimer=n.safeSetTimeout(r,n.config.paneResizeDelay,"adjustHeight"))},l.isClientLocationAvailable=function(){return l._shouldRequestEltoken||!!l._elToken},l.getFileExplorerCurrentPath=function(){if(n.RuntimeConfig.QfMode!=5)throw"Not supported";return l._fileExplorerCurrentPath},l._queryParamsCache={},l._locStrings=[],l._enUsLocStrings=[],l._modifierKeyState={altKey:!1,ctrlKey:!1,shiftKey:!1},l._bootstrapDoneEventHandlers=[],l._appVisibleEventHandlers=[],l._shownEventHandlers=[],l._conversationStartEventHandlers=[],l._dismissedEventHandlers=[],l._appHiddenEventHandlers=[],l._searchBoxGotFocusEventHandlers=[],l._searchBoxLostFocusEventHandlers=[],l._onSubmitHandlers=[],l._onFeedbackClosingHandlers=[],l._onSearchBoxGlyphIconClick=[],l._onSearchBoxClick=[],l._onButtonRightOfSearchBoxClick=[],l._queryChangedHandlers=[],l._rawQueryChangedHandlers=[],l._keyDownHandlers=[],l._keyUpHandlers=[],l._keyEscapeHandlers=[],l._accessTokenAvailableHandlers=[],l._scopeListRequiresUpdate=[],l._accountChangedHandlers=[],l._dynamicSearchBoxUpdateHandlers=[],l._pinnedApps={},l._state=0,l._paneCloseCount=0,l._qfDismissCount=0,l._defaultWindowsTheme=0,l._defaultAppTheme=0,l._currentPaneHeight=0,l._root=_ge("root"),l._rootContainer=_ge("rootContainer"),l._defaultBrowser=0,l._fuzzyRankSuggestionCount=-1,l._coldRankSuggestionCount=-1,l._notColdRankSuggestionCount=-1,l._finalColdRankSuggestionCount=-1,l.usedImpressionIds={},l.getEdgeIcon=function(n,t){var i=l._defaultBrowserIconCache&&l.getUriLaunchPolicy()==0?l._defaultBrowserIconCache:l._edgeIconCache;return i(n,t)},l}();n.Host=y})(WSB||(WSB={}))