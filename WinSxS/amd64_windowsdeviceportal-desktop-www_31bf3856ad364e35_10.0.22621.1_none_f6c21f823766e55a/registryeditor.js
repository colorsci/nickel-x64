function RegistryValuesViewer(n,t){function r(n,t,i){var r=i;return i==""&&(r="(Default)"),r}function u(n,t,i){var r=i;return i==""&&(r="(value not set)"),r}function o(){this.registryValuesGrid.updateRowCount();this.registryValuesGrid.render()}function s(n,t){this.registryValuesGrid.invalidateRows(t.rows);this.registryValuesGrid.render()}function h(n,t){this.dataView.sort(gridCaseInsensitiveObjectComparer.bind(t),t.sortAsc)}var i=this,f=[{id:"Name",name:"Name",field:"Name",sortable:!0,width:250,cssClass:"tableCell",headerCssClass:"tableHeader",formatter:r},{id:"Type",name:"Type",field:"Type",sortable:!0,width:150,cssClass:"tableCell",headerCssClass:"tableHeader"},{id:"Data",name:"Data",field:"Data",sortable:!0,width:800,cssClass:"tableCell",headerCssClass:"tableHeader",formatter:u},],e={selectedCellCssClass:"rowSelected",enableCellNavigation:!0,enableColumnReorder:!1,showHeaderRow:!0,syncColumnCellResize:!0,autoHeight:!0,enableTextSelectionOnCells:!0,rowHeight:36.5,headerRowHeight:40.45,gridLabel:t.gridLabel,rowHeaderName:t.rowHeaderName,rowHeaderId:t.rowHeaderId,rowHeaderColumn:t.rowHeaderColumn};this.dataView=new Slick.Data.DataView;this.registryValuesGrid=new Slick.Grid("#"+n,this.dataView,f,e);$(window).resize(this.registryValuesGrid.resizeCanvas.bind(this.registryValuesGrid));this.dataView.onRowCountChanged.subscribe(o.bind(this));this.dataView.onRowsChanged.subscribe(s.bind(this));this.registryValuesGrid.onSort.subscribe(h.bind(this));this.registryValuesGrid.setSortColumn("Name",!0);this.updateTable=function(n,t){var r=new WebbRest;r.getRegValues(selectedRegistryContainerId,n,t).done(function(n){i.dataView.setItems(n.Values,"Name")})}}var WebbRest,selectedRegistryContainerId=null;$(function(){function r(t,i){var r=t.children("button")[0];switch(i){case n.COLLAPSED:t.removeClass("registry-expanded").addClass("registry-collapsed");r.innerText=l;r.ariaLabel=t.children("div").text();r.ariaExpanded=!1;break;case n.EXPANDED:t.removeClass("registry-collapsed").addClass("registry-expanded");r.innerText=a;r.ariaLabel=t.children("div").text();r.ariaExpanded=!0;break;case n.EMPTY:t.removeClass("registry-collapsed").addClass("registry-empty");r.innerText=v;r.ariaLabel=t.children("div").text()}}function u(t,i,u){var o="",e,f,s;if(t.data("path")&&(o=t.data("path")+"\\"),i.length==0)r(t,n.EMPTY);else{for(e=$(document.createElement("ul")).addClass("registry-list"),f=0;f<i.length;f++)listItemElement=$(document.createElement("li")),u?listItemElement.data("rootkey",i[f].Name).attr("id",i[f].Name):listItemElement.data("rootkey",t.data("rootkey")).data("path",o+i[f].Name),listItemInnerDiv=$(document.createElement("div")).text(i[f].Name).attr("style","display:inline"),listItemInnerDiv.appendTo(listItemElement),s=$(document.createElement("button")).addClass("blackTextButton symbol").prependTo(listItemElement),r(listItemElement,i[f].ChildCount=="0"?n.EMPTY:n.COLLAPSED),listItemElement.appendTo(e);e.appendTo(t);u||r(t,n.EXPANDED)}}function o(t){t.children("ul").remove();t.hasClass("registry-expanded")&&r(t,n.COLLAPSED)}function y(n){if(n.hasClass("registry-collapsed")){var i=n.data("rootkey"),r=n.data("path");t.getSubKeys(selectedRegistryContainerId,i,r).done(function(t){u(n,t.SubKeys,!1)})}else o(n);s(n)}function s(n){var r=n.data("rootkey"),t=n.data("path"),i=r;t!=undefined&&(i+="\\"+t);$("#registryPath").val(i);$("#registryPath").attr("aria-label","Registry Path: "+i);h(n);e.updateTable(r,t)}function h(n){i&&i.removeClass("registry-selected");i=n.children("div");i.addClass("registry-selected")}function c(n,i){var l,r="",f,s,o;for(i&&(l=i.data("rootkey"),i.data("path")&&(r+=i.data("path")+"\\")),(n===undefined||n.length==0)&&i&&(h(i),i[0].scrollIntoView(),e.updateTable(l,r)),r+=n[0],n.shift(),f=undefined,s=i.children("ul").eq(0).children(),o=0;o<s.length;o++)if(s.eq(o).data("path")==r){f=s.eq(o);break}f&&t.getSubKeys(selectedRegistryContainerId,l,r).done(function(t){u(f,t.SubKeys,!1);c(n,f)})}function p(){for(var t=$("#registry").children("ul").eq(0).children(),n=0;n<t.length;n++)o(t.eq(n))}function w(){var n=$("#registryPath").val().split("\\"),i;n!==undefined&&n.length!=0&&($("#registryPath").attr("aria-label","Registry Path: "+$("#registryPath").val()),p(),i=n[0],n.shift(),t.getSubKeys(selectedRegistryContainerId,i,"").done(function(t){u($("#"+i),t.SubKeys,!1);c(n,$("#"+i))}))}function f(){t.getRootKeys(selectedRegistryContainerId).done(function(n){$("#registry").empty();u($("#registry"),n.RootKeys,!0)})}function b(){var n=$("#RegistryContainerIdSelect"),t;n.on("change",function(){selectedRegistryContainerId=n.val();document.cookie="RegistryContainerId="+selectedRegistryContainerId;f()});oldContainerId=getCookie("RegistryContainerId");t=new WebbRest;t.getContainersList().done(function(t){if(t.Supported){for(index=0;index<t.Containers.length;index++){container=t.Containers[index];var i=container.Id.replace("{","").replace("}",""),r=i===oldContainerId;n.append($("<option>",{value:i,text:container.Owner,selected:r}));r&&f()}n.show()}})}var t=new WebbRest,e=new RegistryValuesViewer("registryValuesGrid",{gridLabel:"Registry values",rowHeaderName:"Name"}),i;const n={COLLAPSED:"collapsed",EXPANDED:"expanded",EMPTY:"empty"};var l="",a="",v="";$("#registry").on("click","button",function(n){y($(this).parent());n.stopPropagation()});$("#registry").on("click","div",function(n){s($(this).parent());n.stopPropagation()});$("#registryPath").on("change",function(){w()});b();f()})