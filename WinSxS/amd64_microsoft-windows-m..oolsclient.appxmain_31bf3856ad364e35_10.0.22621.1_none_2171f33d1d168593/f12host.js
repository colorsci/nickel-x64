!function(e){function t(t){for(var i,r,a=t[0],l=t[1],c=t[2],h=0,p=[];h<a.length;h++){r=a[h];n[r]&&p.push(n[r][0]);n[r]=0}for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);d&&d(t);for(;p.length;)p.shift()();o.push.apply(o,c||[]);return s()}function s(){for(var e,t=0;t<o.length;t++){for(var s=o[t],i=!0,a=1;a<s.length;a++){var l=s[a];0!==n[l]&&(i=!1)}if(i){o.splice(t--,1);e=r(r.s=s[0])}}return e}var i={},n={12:0},o=[];function r(t){if(i[t])return i[t].exports;var s=i[t]={i:t,l:!1,exports:{}};e[t].call(s.exports,s,s.exports,r);s.l=!0;return s.exports}r.m=e;r.c=i;r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:s})};r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})};r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};r.d(t,"a",t);return t};r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};r.p="";var a=window.webpackJsonp=window.webpackJsonp||[],l=a.push.bind(a);a.push=t;a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var d=l;o.push([202,4]);s()}({202:function(e,t,s){"use strict";s.r(t);var i=s(124),n=s(5),o=s(0),r=s(144),a=s(60),l=s(22),c=s(50),d=s(126),h=s(91),p=s(9),u=s(63),g=s(136),m=s(135),f=s(10),b=s(156);class y{constructor(){this.clients=new Map;this.pageOrigin=Object(f.d)()}registerClient(e){if(this.clients.has(e.id))throw new Error(`Client ${e.id} already registered.`);this.clients.set(e.id,{config:e,messageQueue:[]})}activateClient(e,t){const s=this.clients.get(e);if(!s)throw new Error(`Client ${e} not registered.`);if(s.messageWindow)throw new Error(`Client ${e} already active.`);s.messageWindow=t;const i=s.messageQueue;s.messageQueue=[];for(const t of i)this.sendMessageToClient(e,t)}handleMessage(e){switch(e.type){case"METHOD_CALL":this.sendMessageToClient(e.destinationId,e);break;case"METHOD_SUCCESS_RESULT":case"METHOD_ERROR_RESULT":this.sendMessageToClient(e.callerId,e);break;case"EVENT_BROADCAST":this.sendEventToRelevantClients(e)}}notifyClient(e,t,s){this.sendMessageToClient(e,{type:"EVENT_BROADCAST",name:t,args:s})}augmentClientEvents(e,t){const s=this.clients.get(e);if(!s)throw new Error(`Error augmenting client '${e}'; it is not registered.`);t.forEach(e=>{s.config.subscribedEvents.add(e)})}sendMessageToClient(e,t){const s=this.clients.get(e);if(!s)throw new Error(`Error sending message, client ${e} is not registered.`);s.messageWindow?s.messageWindow.postMessage(t,this.pageOrigin):s.messageQueue.push(t)}sendEventToRelevantClients(e){for(const[t,s]of this.clients)s.config.subscribedEvents.has(e.name)&&this.sendMessageToClient(t,e)}}var C=s(113),w=s(35);const E=Object(w.d)(()=>"1"===n.b.utilities.getEnvironmentVariable("F12PLUGINLOG")||"1"===n.b.utilities.getEnvironmentVariable("f12pluginlog"));let v=null;const I=[];let S=P,k=!1;function O(e){return e&&"function"==typeof e.then}async function P(e){if(!E()){S=M;return M(e)}const t=n.b.utilities.logToFile(e);if(O(t)){S=D;return t}S=T;return Promise.resolve()}function M(e){return Promise.resolve()}function T(e){return new Promise(t=>{n.b.utilities.logToFile(e);t()})}function D(e){return n.b.utilities.logToFile(e)}const x=['"showPopup"','"PopupShown"','"hidePopup"','"PopupHidden"','"callerId":"ms:popup"'];async function _(e){if(e&&0!==e.length){for(const t of x)if(e.indexOf(t)>-1)return;if(!k){F();k=!0}I.push(e)}}async function H(e){E()&&_(e())}function R(){if(0===I.length){F();return}if(v)return;const e=I.splice(0,I.length).join("\n");v=S(e).then(()=>{v=null});F()}function F(){setTimeout(R,5e3)}class L{constructor(e,t){this.protocol=e;this.currentResponseId=0;this.responseMap=new Map;this.onMessage=(e=>{let t;const s=JSON.parse(e.data);if(j(s)){const e=this.responseMap.get(s.id);if(e)if(s.error){t="Error";e.reject(s)}else{t="Callback";e.resolve(s)}this.responseMap.delete(s.id)}else{t="Event";const e=s.method,[i]=e.split(".");if(!this.domainHandlers.has(i))return;const n=this.domainHandlers.get(i);n&&n(s)}H(()=>`EDP ${t} from host to client: ${e.data}`)});this.onError=(e=>{this.emit("error",e);_("EDP error occurred")});this.onOpen=(e=>{this.emit("open",e);_("EDP connection established")});this.onClose=(e=>{this.emit("close",e);_("EDP connection closed gracefully");if(n.b.isWinRTHost){const e=new Event("targetclosed");window.dispatchEvent(e)}});if(!e)throw new ReferenceError("protocol was null or undefined. A valid EDP protocol definition must be specified.");C.a.mixin(this);this.domainHandlers=new Map;t?this.socket=t:n.b.launchMode===n.a.Remote?this.socket=new WebSocket(n.b.debugTargetEndpoint):this.socket=new LocalDevToolsSocket(n.b.debugTargetEndpoint);this.socket.onmessage=this.onMessage;this.socket.onerror=this.onError;this.socket.onopen=this.onOpen;this.socket.onclose=this.onClose;n.b.isWinRTHost&&window.addEventListener("toolsclosed",()=>{this.socket.close()})}addHandler(e,t){if(this.domainHandlers.has(e))throw new RangeError(`Domain "${e}" already is registered for this client.`);this.domainHandlers.set(e,t)}removeHandler(e){if(!this.domainHandlers.has(e))throw new RangeError(`No domain handlers have been registered for the "${e}" domain.`);this.domainHandlers.delete(e)}send(e){this.currentResponseId++;e.id=this.currentResponseId;const t=JSON.stringify(e),s=new Promise((t,s)=>{this.responseMap.set(e.id,{resolve:t,reject:s})});this.socket.send(t);H(()=>`EDP message from client to host: ${t}`);return s}}function j(e){return void 0!==e.id}function N(e,t){return e<t?-1:e>t?1:0}function B(e){e.sort((e,t)=>{const s=N(e.toLowerCase(),t.toLowerCase());return 0===s?N(t,e):s})}function A(e){let t=1;for(;t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}function K(e){const t=e.slice(0);B(t);A(t);return t}var U=s(83),W=s(153),z=s(16);class ${constructor(e){this.enabled=!1;this.awaitingEnableCall=!1;this.existingDocuments=new Set;this.lineEndings=new Map;this.localsMap=new Map;this.objectIdMap=new Map;this.breakpointInfoCache=new Map;this.unresolvedBreakpointMap=new Map;this.framesMap=new Map;this.executionContextIdMap=new Map;this._asyncFrameId=0;this.currentBreakpointId=0;this.endpoint=e}handleEvent(e){switch(e.method){case"Debugger.breakpointResolved":this.handleBreakpointResolved(e.params);break;case"Debugger.paused":this.handlePaused(e.params);break;case"Debugger.resumed":this.handleResumed();break;case"Debugger.scriptParsed":this.handleScriptParsed(e.params);break;case"Page.frameAttached":this.handleFrameAttached(e.params);break;case"Page.frameDetached":this.handleFrameDetached(e.params);break;case"Page.frameNavigated":this.handleFrameNavigated(e.params);break;case"Runtime.consoleAPICalled":this.handleConsoleAPICalled(e.params);break;case"Runtime.exceptionThrown":this.handleExceptionThrown(e.params);break;case"Runtime.executionContextCreated":this.handleExecutionContextCreated(e.params);break;case"Runtime.executionContextsCleared":this.handleNavigate()}}async enableDynamicDebugging(){if(this.enabled||this.awaitingEnableCall)return 0;try{this.awaitingEnableCall=!0;await this.callMethod("Debugger.enable");await this.callMethod("Runtime.enable");await this.callMethod("Page.enable");this.notifyConnectionEstablished();this.getFrameTree();this.enabled=!0;return 0}catch(e){return 1}finally{this.awaitingEnableCall=!1}}async disableDynamicDebugging(){if(this.awaitingEnableCall||!this.enabled)return 0;try{await this.callMethod("Debugger.disable");await this.callMethod("Runtime.disable");await this.callMethod("Page.disable");this.enabled=!1;return 0}catch(e){return 1}}async getSourceText(e){try{return{loadFailed:!1,text:(await this.callMethod("Debugger.getScriptSource",{scriptId:e})).result.scriptSource}}catch(e){return{loadFailed:!0,text:""}}}async isDocContainingMatch(e,t){const s=new RegExp(e,"gi"),i=await this.getSourceText(t);return s.test(i.text)}async addPendingBreakpoint(e,t){const s=`:failed:${e.url}`;if(!e.url||void 0===e.oneBasedStartColumn||void 0===e.oneBasedStartLine)return s;try{const i=t||this.getNextBreakpointId(),n=e.isEnabled;let o;if(n){const t=(await this.callMethod("Debugger.setBreakpointByUrl",{columnNumber:e.oneBasedStartColumn-1,condition:e.condition,lineNumber:e.oneBasedStartLine-1,url:e.url})).result;o=t.breakpointId;this.unresolvedBreakpointMap.set(o,i);t.locations.length&&setTimeout(()=>{this.handleBreakpointResolved({breakpointId:o,location:t.locations[0]})},0)}this.breakpointInfoCache.set(i,{frontendBreakpointId:i,remoteBreakpointId:o,enabled:n,condition:e.condition,isPseudoBreakpoint:!1,isTracepoint:e.isTracepoint,persistedData:e});return i}catch(e){return s}}async addCodeBreakpoint(e,t,s,i,n,o){try{const r=await this.getLocationFromOffset(e,t),a=(await this.callMethod("Debugger.setBreakpoint",{location:r,condition:s})).result,l=await this.getOffsetFromLocation(a.actualLocation),c=o||this.getNextBreakpointId(),d={breakpointId:c,failed:!1,isBound:!0,isEnabled:!0,condition:s,isTracepoint:i,isPseudoBreakpoint:n,location:{docId:e,length:a.actualLocation.msLength,start:l}};this.breakpointInfoCache.set(c,{frontendBreakpointId:c,remoteBreakpointId:a.breakpointId,enabled:!0,location:d.location,condition:d.condition,isPseudoBreakpoint:d.isPseudoBreakpoint,isTracepoint:d.isTracepoint});return d}catch(s){return{breakpointId:`:failed:${e}`,failed:!0,isBound:!1,isEnabled:!1,location:{docId:e,start:t,length:1}}}}async getBreakpointIdFromSourceLocation(e,t){let s=z.b;this.breakpointInfoCache.forEach((i,n)=>{const o=i.location;o&&o.docId===e&&o.start<=t&&t<=o.start+o.length&&(s=n)});return Promise.resolve(s)}async removeBreakpoint(e,t=!0){try{if(!this.breakpointInfoCache.has(e))return!1;const s=this.breakpointInfoCache.get(e),i=s.remoteBreakpointId;t?this.breakpointInfoCache.delete(e):this.breakpointInfoCache.set(e,Object.assign({},s,{enabled:!1}));if(!s.enabled||!i)return!0;await this.callMethod("Debugger.removeBreakpoint",{breakpointId:i});s.remoteBreakpointId=void 0;return!0}catch(e){return!1}}async causeBreak(e){if(0===e)try{await this.callMethod("Debugger.pause");return!0}catch(e){return!1}}async resume(e){try{switch(e){case 1:await this.callMethod("Debugger.resume");break;case 2:await this.callMethod("Debugger.stepInto");break;case 3:await this.callMethod("Debugger.stepOver");break;case 4:await this.callMethod("Debugger.stepOut");break;default:return!1}}catch(e){return!1}this.currentFrames=void 0;return!0}async getFrames(e){const t=[];if(!this.currentFrames)return[];let s=this.currentFrames;e>0&&(s=this.currentFrames.slice(0,e));try{for(const e of s){const s=await this.getOffsetFromLocation(e.location);t.push({callFrameId:e.callFrameId,functionName:e.functionName,isInTryBlock:!1,isInternal:!1,isWorker:!1,isAsync:!1,location:{docId:e.location.scriptId,length:e.location.msLength,start:s}})}return t}catch(e){throw new Error("Failed to retrieve frames")}}async getLocals(e){if(!this.currentFrames)return null;const t=this.currentFrames.find(t=>t.callFrameId===e);if(!t)return null;const s=t.scopeChain.find(e=>"local"===e.type);if(s){const t=s.object.msDebuggerPropertyId;this.localsMap.set(t,{callFrameId:e});this.objectIdMap.set(t,s.object.objectId);return t}return null}async getCurrentThreadDescription(){try{return{description:"",displayName:"",fullScriptFileName:"",htmlFileName:"",id:0,isWorker:!1,label:"",poundLabel:"",scriptFileName:""}}catch(e){throw new Error("Failed to get current thread description")}}async getChildProperties(e){try{const t=this.localsMap.get(e),s=this.objectIdMap.get(e),i=[];if(t){const e=this.currentFrames.find(e=>e.callFrameId===t.callFrameId);if(e)for(const t of e.scopeChain)if("local"!==t.type){this.objectIdMap.set(t.object.msDebuggerPropertyId,t.object.objectId);i.push({expandable:!0,fake:!0,fullName:t.name,invalid:!1,name:t.name,propertyId:t.object.msDebuggerPropertyId,readOnly:!1,returnValue:!1,type:"",value:""})}}const n=(await this.callMethod("Runtime.getProperties",{objectId:s})).result.result,o=new Set;n.forEach(e=>{e.isOwn&&o.add(e.name)});let r=n.filter(e=>!!e.isOwn||!o.has(e.name)).map(e=>{const t=e.value;if(!t)return this.createErrorProperty(e.name);t.objectId&&this.objectIdMap.set(t.msDebuggerPropertyId,t.objectId);return{expandable:Boolean(t.objectId),fake:!1,fullName:e.name,invalid:!1,name:e.name,propertyId:t?t.msDebuggerPropertyId:"FAKE",readOnly:!e.writable,returnValue:e.msReturnValue||!1,type:t.type,value:this.getStringValue(t)}});return{hasAdditionalChildren:!1,propInfos:r=r.concat(i)}}catch(e){return{hasAdditionalChildren:!1,propInfos:[]}}}async setCodeBreakpointCondition(e,t,s){let i=!1;try{const n=this.breakpointInfoCache.get(e);if(n.enabled){if(i=await this.removeBreakpoint(e,!1)){if(n.persistedData){n.persistedData.isTracepoint=s;n.persistedData.condition=t;return!(await this.addPendingBreakpoint(n.persistedData,e)).startsWith(":failed:")}if(n.location){i=!(await this.addCodeBreakpoint(n.location.docId,n.location.start,t,s,!1,e)).failed}}}else{i=!0;if(n.persistedData){n.persistedData.isTracepoint=s;n.persistedData.condition=t}else{n.isTracepoint=s;n.condition=t}}return i}catch(e){return!1}}async setBreakpointEnabledState(e,t){const s=this.breakpointInfoCache.get(e);if(t!==s.enabled){if(t){if(s.persistedData){s.persistedData.isEnabled=!0;return!(await this.addPendingBreakpoint(s.persistedData,e)).startsWith(":failed:")}return!(await this.addCodeBreakpoint(s.location.docId,s.location.start,s.condition,s.isTracepoint,s.isPseudoBreakpoint,e)).failed}s.persistedData&&(s.persistedData.isEnabled=!1);return this.removeBreakpoint(e,!1)}}async evaluate(e,t,s,i,n,o){const r=await this.callMethod("Runtime.evaluate",{awaitPromise:t,contextId:this.currentContextId,expression:e,includeCommandLineAPI:s,objectGroup:i,returnByValue:n,silent:o});let a;if(r.result&&r.result.result&&(a=r.result.result).objectId){const e=a.objectId,t=await this.callMethod("Runtime.getProperties",{objectId:e});a.value=t.result.result}return a}async getObjectChildren(e){const t=(await this.callMethod("Runtime.getProperties",{objectId:e})).result.result;return Object(W.a)(t)}async evaluateOnCallFrame(e,t){try{const s=(await this.callMethod("Debugger.evaluateOnCallFrame",{callFrameId:e,expression:t})).result.result;s.objectId&&this.objectIdMap.set(s.msDebuggerPropertyId,s.objectId);return{expandable:Boolean(s.objectId),fake:!1,fullName:"",invalid:!1,name:"",propertyId:s.msDebuggerPropertyId,readOnly:!1,returnValue:!1,type:s.type,value:this.getStringValue(s)}}catch(e){return this.createErrorProperty()}}async setPropertyValueAsString(e,t){try{await this.callMethod("Debugger.msSetDebuggerPropertyValue",{debuggerPropertyId:e,newValue:t});return!0}catch(e){return!1}}async discardConsoleEntries(){try{await this.callMethod("Runtime.discardConsoleEntries");return!0}catch(e){return!1}}async getIntellisenseChoices(e){const t=e||"this";let s=[];if(!e){const e=await this.callMethod("Runtime.globalLexicalScopeNames",{});s=this.convertGlobalScopeNamesToIntellisenseChoices(e.result.names)}const i=await this.evaluate(t,!1,!0,"completion",!1,!0);if(i.objectId){const e=i.objectId,t=await this.callMethod("Runtime.getProperties",{objectId:e});return{choices:[...this.convertPropertyDescriptorsToIntellisenseChoices(t.result.result),...s]}}return{choices:[]}}async getIntellisenseChoicesOnCallFrame(e,t){const s="window"===t.searchContext;let i=t.searchContext;t.searchExpression&&(i=`${i}.${t.searchExpression}`);const n=await this.evaluateOnCallFrame(e,i);if(n.invalid||!n.propertyId)return{choices:[]};{let e=(await this.getChildProperties(n.propertyId)).propInfos.map(e=>e.name);s&&(e=e.concat(t.locals));return{choices:(e=K(e)).map(e=>({info:"",name:e}))}}}async setExceptionFilter(e){try{let t;t=2===e?"all":1===e?"uncaught":"none";await this.callMethod("Debugger.setPauseOnExceptions",{state:t});return!0}catch(e){return!1}}async executeOnTargetPage(e,t=!1){try{await this.callMethod("Runtime.evaluate",{expression:e,silent:!0});return!0}catch(e){return!1}}async downloadUrl(e,t,s){try{const t=new XMLHttpRequest;t.onreadystatechange=(()=>{if(4===t.readyState){const s=200===t.status,i=s?t.responseText:"";let n=null;s&&(n=(n=t.getResponseHeader("content-type"))?U.a.getCanonicalMediaType(n):null);this.notify("onDownloadUrlComplete",[s,e,i,n,null])}});t.open("GET",e,!0);t.send(null)}catch(t){this.notify("onDownloadUrlComplete",[!1,e,"",null,t.message])}}switchTarget(e,t){this.currentContextId=this.executionContextIdMap.get(e);this.notify("onTargetChanged",[{targetType:t,targetId:e}]);return Promise.resolve()}convertPropertyDescriptorsToIntellisenseChoices(e){return e.map(e=>({info:e.name,name:e.name}))}convertGlobalScopeNamesToIntellisenseChoices(e){return e.map(e=>({info:e,name:e}))}callMethod(e,t){return this.endpoint.send({method:e,params:t})}notify(e,t){this.endpoint.broadcastEvent("notificationFromEdp",{event:e,params:t})}async handleScriptParsed(e){const t=this.lineEndings.get(e.scriptId);t&&0!==t.length||this.processLineEndings(e.scriptId);const s={id:e.scriptId,isDynamicCode:e.msIsDynamicCode,length:e.length,longDocumentId:e.msLongDocumentId,mimeType:e.msMimeType,parentId:e.msParentId,sourceMapUrl:e.sourceMapURL,url:e.url};if(this.existingDocuments.has(s.id))this.notify("onUpdateDocuments",[s]);else{this.existingDocuments.add(s.id);this.notify("onAddDocuments",[s]);"ROOT"===s.parentId&&this.notify("onSetRootDocument",[s.id])}}async handleExceptionThrown(e){this.notify("onExceptionThrown",[e])}async handleConsoleAPICalled(e){this.notify("onConsoleAPICalled",[e])}handleFrameAttached(e){let t;if(this.framesMap.has(e.frameId)){t=this.framesMap.get(e.frameId);this.notify("onFrameAttached",[{targetType:"Frame",targetId:e.frameId,href:t.url,origin:t.securityOrigin}])}else{const t=this.framesMap.get(e.parentFrameId),s={id:e.frameId,parentId:e.parentFrameId,url:t.url,securityOrigin:t.securityOrigin,mimeType:t.mimeType,loaderId:t.loaderId};this.framesMap.set(e.frameId,s);this.notify("onFrameAttached",[{targetType:"Frame",targetId:s.id,href:s.url,origin:s.securityOrigin}])}}handleFrameDetached(e){const t=this.framesMap.get(e.frameId);this.notify("onFrameDetached",[{targetType:"Frame",targetId:t.id,href:t.url,origin:t.securityOrigin}]);this.framesMap.delete(e.frameId)}handleFrameNavigated(e){const t=e.frame;this.framesMap.set(t.id,t);this.notify("onFrameNavigated",[{targetType:"Frame",targetId:t.id,href:t.url,origin:t.securityOrigin}])}async handleBreakpointResolved(e){const t=await this.getOffsetFromLocation(e.location),s=this.unresolvedBreakpointMap.get(e.breakpointId);if(s&&this.breakpointInfoCache.has(s)){this.unresolvedBreakpointMap.delete(s);const i={breakpointId:s,isBound:!0,location:{docId:e.location.scriptId,length:e.location.msLength,start:t}};this.notify("onResolveBreakpoint",[s,i])}}handleExecutionContextCreated(e){const t=e.context.auxData;t.frameId&&this.executionContextIdMap.set(t.frameId,e.context.id)}handleNavigate(){if(this.existingDocuments.size){const e=Array.from(this.existingDocuments);this.notify("onRemoveDocuments",e);this.existingDocuments.clear();this.lineEndings.clear()}this.notify("onExecutionContextsCleared",[]);if(this.framesMap.size){this.framesMap.clear();this.notify("onClearTargets",[])}if(this.executionContextIdMap){this.executionContextIdMap.clear();this.currentContextId=1}this.getFrameTree()}async getFrameTree(){const e=(await this.callMethod("Page.getFrameTree")).result.frameTree,t=[];if(e){t.push(e);for(;0!==t.length;){const e=t.pop(),s=e.frame,i="0"===s.id?"_top":"Frame";this.framesMap.set(s.id,s);this.notify("onFrameAttached",[{targetType:i,targetId:s.id,href:s.url,origin:s.securityOrigin}]);if(e.childFrames)for(const s of e.childFrames)t.push(s)}}}notifyConnectionEstablished(){this.notify("onEdpConnectionEstablished",[])}async handlePaused(e){this.localsMap.clear();this.objectIdMap.clear();let t,s="";this.currentFrames=e.callFrames;switch(e.reason){case"breakpoint":t=1;break;case"exception":t=6;s=e.data&&e.data.description||s;break;case"step":t=0;break;case"other":default:t=4}const i={asyncCallStackInfo:this.transformAsyncStacktrace(e.asyncStackTrace),breakEventType:void 0,breakReason:t,callFrames:await this.getFrames(0),description:s,errorId:-1,firstChance:!1,isUserUnhandled:!1,threadDescription:{description:"",displayName:"",fullScriptFileName:"",htmlFileName:"",id:0,isWorker:!1,label:"",poundLabel:"",scriptFileName:""}};this.notify("onBreak",[i])}transformAsyncStacktrace(e){if(!e)return;const t=[];let s,i=e;for(;i;){s={description:i.description,callFrames:i.callFrames.map(e=>({callFrameId:"AsyncFrame"+this._asyncFrameId++,isInTryBlock:void 0,isAsync:!0,isInternal:void 0,isWorker:!1,functionName:e.functionName,location:{docId:e.scriptId,start:e.lineNumber,length:e.columnNumber}}))};t.push(s);i=i.parent}return t}handleResumed(){}async getLocationFromOffset(e,t){let s=this.lineEndings.get(e);if(!s||0===s.length){await this.processLineEndings(e);s=this.lineEndings.get(e)}let i=0,n=0,o=0;if(s)for(let e=0;e<s.length;e++)if(t<(o+=s[e])){n=e;i=s[e]-(o-t);break}return{scriptId:e,lineNumber:n,columnNumber:i}}async getOffsetFromLocation(e){let t=0,s=this.lineEndings.get(e.scriptId);if(!s||0===s.length){await this.processLineEndings(e.scriptId);s=this.lineEndings.get(e.scriptId)}if(s){for(let i=0;i<e.lineNumber;i++)t+=s[i];e.columnNumber&&(t+=e.columnNumber)}return t}async processLineEndings(e){const t=(await this.getSourceText(e)).text,s=[];let i=0;const n=t.length-1;for(let e=0;e<t.length;e++){i++;if(e===n)s.push(i);else if("\r"===t[e]&&"\n"===t[e+1]||"\n"===t[e]&&"\r"===t[e+1]){s.push(i+1);i=0;e++}else if("\r"===t[e]||"\n"===t[e]){s.push(i);i=0}}this.lineEndings.set(e,s)}createErrorProperty(e=""){return{expandable:!1,fake:!1,fullName:e,invalid:!0,name:e,propertyId:"ERROR",readOnly:!1,returnValue:!1,type:"",value:""}}getStringValue(e){return e.value?String(e.value):e.unserializableValue?e.unserializableValue:e.description?e.description:""}getNextBreakpointId(){this.currentBreakpointId++;return`BP${this.currentBreakpointId}`}}class V{constructor(e,t,s){this.client=e;this.rpcClient=t;this.connectionOpen=!1;this.messageQueue=[];this.notify=(e=>{this.debugProvider.handleEvent(e)});this.onError=(()=>{_("EDP error occurred")});this.onOpen=(()=>{this.connectionOpen=!0;this.drainHandlerQueue();_("EDP connection established")});this.onClose=(()=>{this.connectionOpen=!1;_("EDP connection closed gracefully");if(n.b.isWinRTHost){const e=new Event("targetclosed");window.dispatchEvent(e)}});this.client.addHandler("Debugger",this.notify);this.client.addHandler("Runtime",this.notify);this.client.addHandler("Page",this.notify);this.debugProvider=s||new $(this);this.client.on("error",this.onError).on("open",this.onOpen).on("close",this.onClose)}send(e){return this.client.send(e)}broadcastEvent(e,t){this.rpcClient.broadcast(e,t)}callEdpHandler(e,t){return this.connectionOpen?this.callEdpHandlerImpl(e,t):this.queueEdpHandler(e,t)}queueEdpHandler(e,t){return new Promise((s,i)=>{this.messageQueue.push({method:e,params:t,resolve:s,reject:i})})}drainHandlerQueue(){for(const e of this.messageQueue)this.callEdpHandlerImpl(e.method,e.params).then(e.resolve).catch(e.reject);this.messageQueue=[]}callEdpHandlerImpl(e,t){switch(e){case"addCodeBreakpoint":return this.debugProvider.addCodeBreakpoint(t[0],t[1],t[2],t[3],t[4]);case"addEventBreakpoint":return Promise.reject("Not yet implemented");case"addPendingBreakpoint":return this.debugProvider.addPendingBreakpoint(t[0]);case"canSetNextStatement":return Promise.reject("Not yet implemented");case"causeBreak":return this.debugProvider.causeBreak(t[0]);case"disableDynamicDebugging":return this.debugProvider.disableDynamicDebugging();case"discardConsoleEntries":return this.debugProvider.discardConsoleEntries();case"downloadUrl":return this.debugProvider.downloadUrl(t[0],t[1],t[2]);case"enableDynamicDebugging":return this.debugProvider.enableDynamicDebugging();case"eval":return this.debugProvider.evaluateOnCallFrame(t[0],t[1]);case"evaluate":return this.debugProvider.evaluate(t[0]);case"executeOnTargetPage":return this.debugProvider.executeOnTargetPage(t[0],t[1]);case"getBreakpointIdFromSourceLocation":return this.debugProvider.getBreakpointIdFromSourceLocation(t[0],t[1]);case"getChildProperties":return this.debugProvider.getChildProperties(t[0]);case"getCurrentThreadDescription":return this.debugProvider.getCurrentThreadDescription();case"getFrames":return this.debugProvider.getFrames(t[0]);case"getIntellisenseChoices":return this.debugProvider.getIntellisenseChoices(t[0]);case"getIntellisenseChoicesOnCallFrame":return this.debugProvider.getIntellisenseChoicesOnCallFrame(t[0],t[1]);case"getLocals":return this.debugProvider.getLocals(t[0]);case"getObjectChildren":return this.debugProvider.getObjectChildren(t[0]);case"getSourceText":return this.debugProvider.getSourceText(t[0]);case"isDocContainingMatch":return this.debugProvider.isDocContainingMatch(t[0],t[1]);case"removeBreakpoint":return this.debugProvider.removeBreakpoint(t[0]);case"resume":return this.debugProvider.resume(t[0]);case"setBreakpointCondition":return this.debugProvider.setCodeBreakpointCondition(t[0],t[1],t[2]);case"setBreakpointEnabledState":return this.debugProvider.setBreakpointEnabledState(t[0],t[1]);case"setExceptionFilter":return this.debugProvider.setExceptionFilter(t[0]);case"setNextStatement":return Promise.reject("Not yet implemented");case"setPropertyValueAsString":return this.debugProvider.setPropertyValueAsString(t[0],t[1]);case"switchTargetWrapper":return this.debugProvider.switchTarget(t[0],t[1]);case"triggerSourceRundown":return Promise.reject("Not yet implemented")}return Promise.resolve()}}var Q=s(2),q=s(18);function Z(){return{type:"SHOW_QUICK_OPEN"}}function J(){return{type:"HIDE_QUICK_OPEN"}}var G=s(49),X=s(116),Y=s.n(X),ee=s(168);var te=e=>e=>t=>{let s=t;if("object"==typeof t&&"EXECUTE_HOST_ACTION"===t.type){s=ee.a(t.name)(...t.args)}return e(s)},se=s(160);const ie=Object(G.e)(se.a,Object(G.a)(te,Y.a,m.b));var ne=s(6);class oe{}oe.QUICK_OPEN_LAUNCHED="QuickOpenLaunched";oe.FILE_OPENED_FROM_QUICK_OPEN="FileOpenedFromQuickOpen";oe.COMMAND_PALLETE_DESIRED="CommandPalleteDesired";oe.COMMAND_PALLETE_DESIRED_WITH_CARET="CommandPalleteDesiredWithCaret";const re=new a.a("Host");class ae{constructor(e,t){this._zoomBoxElement=null;this._anchorElement=null;const s=document.createElement("div");s.id="f12HostZoomBox";s.className="f12HostZoomContainer";s.innerHTML="<div>                            <div id='f12HostZoomMessageBold' class='f12HostZoomMessageBold'></div>                            <div id='f12HostZoomMessage' class='f12HostZoomMessageNotBold'></div>                        </div>";s.addEventListener("keydown",e=>{if(!e.ctrlKey&&!e.shiftKey&&!e.altKey&&27===e.keyCode){this.close();return!1}return!0});this._zoomBoxElement=s;this._anchorElement=t;e.appendChild(s)}get isShown(){return"block"===this._zoomBoxElement.style.display}show(e,t){const s=document.getElementById("f12HostZoomMessageBold"),i=document.getElementById("f12HostZoomMessage");s.innerText=Object(o.b)("ZoomDialogCurrentLevel",e);i.innerText=Object(o.b)("ZoomDialogShortcutInfo");i.style.display=100!==e?"":"none";if("number"==typeof t&&t>0){this.removeTimer();this._timeoutId=window.setTimeout(()=>this.close(),t)}else this._timeoutId=null;this.setupPosition();this._zoomBoxElement.style.display="block"}close(){this.removeTimer();this._zoomBoxElement.style.display="none"}removeTimer(){if(this._timeoutId){window.clearTimeout(this._timeoutId);this._timeoutId=null}}setupPosition(){const e=window.innerWidth;let t=window.innerHeight;this._anchorElement&&"none"!==this._anchorElement.style.display&&(t=this._anchorElement.getBoundingClientRect().top);const s=(e-ae.DIALOG_WIDTH)/2,i=(t-ae.DIALOG_HEIGHT)/2;this._zoomBoxElement.style.top=i+"px";this._zoomBoxElement.style.left=s+"px"}}ae.DIALOG_WIDTH=180;ae.DIALOG_HEIGHT=80;class le{constructor(e){this.isConsoleShown=!1;this.selectedPluginId=ne.c.none;this._zoomLevel=100;this._rpcClient=e;this.addHandlers()}addShortcutHandler(e){e.addEventListener("load",()=>{e.contentWindow.document.addEventListener("keydown",e=>this.onKeyDown(e),!0);e.contentWindow.document.addEventListener("mousedown",()=>{ie.getState().host.quickOpenVisible&&ie.dispatch(J())},!1)})}addHandlers(){document.addEventListener("keydown",e=>this.onKeyDown(e),!0);document.addEventListener("mousedown",e=>{const t=document.getElementById("quickOpenDialog");t&&ie.getState().host.quickOpenVisible&&!t.contains(e.target)&&ie.dispatch(J())},!1);document.addEventListener("contextmenu",e=>{e.preventDefault();e.stopPropagation();return!1});window.addEventListener("mousewheel",e=>{if(e.ctrlKey){e.preventDefault();e.stopPropagation();return!1}})}onKeyDown(e){let t=!1,s=!1;if(116===e.keyCode||121===e.keyCode&&e.shiftKey||70===e.keyCode&&e.ctrlKey&&!e.altKey){e.preventDefault();t=!1}else if(73===e.keyCode&&!e.ctrlKey&&e.altKey&&e.shiftKey){const s=this.selectedPluginId!==ne.c.console;if(this.isConsoleShown||s){const i=this.getViewIframe(ne.c.console);if(e.view!==i.contentWindow){this._rpcClient.broadcast("consoleStateChange",{shown:!0,isSplit:!s});t=!0}}}else if(e.keyCode>=49&&e.keyCode<=57&&e.ctrlKey&&!e.altKey&&!e.shiftKey){const s=e.keyCode-49;this.notifyTabSelectedListeners("tabSelectedByIndex",[s]);t=!0}else if(117===e.keyCode&&e.ctrlKey&&!e.altKey){this.notifyTabSelectedListeners("tabSelectedByDirection",[!e.shiftKey]);t=!0}else if(219!==e.keyCode&&221!==e.keyCode||!e.ctrlKey||e.altKey||!e.shiftKey)if(116===e.keyCode&&e.ctrlKey&&!e.altKey&&e.shiftKey||82===e.keyCode&&e.ctrlKey&&!e.altKey&&!e.shiftKey){this.notifyTabSelectedListeners("refreshPage",[]);t=!0}else if(112!==e.keyCode||e.ctrlKey||e.altKey||e.shiftKey)if(68===e.keyCode&&e.ctrlKey&&!e.altKey&&e.shiftKey){this.notifyTabSelectedListeners("cycleDock",[]);t=!0}else if(80!==e.keyCode&&79!==e.keyCode||!Object(q.c)(e)){if(80===e.keyCode&&Object(q.f)(e)&&!ie.getState().host.quickOpenVisible)re.logExecuteCommand(oe.COMMAND_PALLETE_DESIRED,Q.c.KeyboardShortcut);else if(27!==e.keyCode||e.ctrlKey||e.altKey||e.shiftKey)if(123!==e.keyCode||!e.ctrlKey||e.altKey||e.shiftKey)if(123!==e.keyCode||e.ctrlKey||e.altKey||e.shiftKey)if(192!==e.keyCode||!e.ctrlKey||e.altKey||e.shiftKey)if(117!==e.keyCode||e.ctrlKey||e.altKey)if(187!==e.keyCode&&107!==e.keyCode||!e.ctrlKey||e.altKey)if(189!==e.keyCode&&109!==e.keyCode||!e.ctrlKey||e.altKey){if(48===e.keyCode&&e.ctrlKey&&!e.altKey){this._zoomLevel=100;this.showZoom();s=!0;t=!0}}else{s=this.zoomOut();t=!0}else{s=this.zoomIn();t=!0}else{t=!this.navigateSubFrames(e.view,!e.shiftKey)}else{const e=new Event("toggleconsole");dispatchEvent(e);t=!0}else{this.notifyTabSelectedListeners("toggleForegound",[]);t=!0}else{this.notifyTabSelectedListeners("bringRemoteToForegound",[]);t=!0}else if(ie.getState().host.quickOpenVisible&&ie.getState().host.quickOpenVisible){ie.dispatch(J());t=!0}}else{const s=this.selectedPluginId===ne.c.visualProfiler||this.selectedPluginId===ne.c.memoryAnalyzer;if(!(79===e.keyCode&&s||ie.getState().host.quickOpenVisible)){re.logExecuteCommand(oe.QUICK_OPEN_LAUNCHED,Q.c.KeyboardShortcut);ie.dispatch(Z());t=!0}}else{this.notifyTabSelectedListeners("showHelp",[]);t=!0}else{this.notifyTabSelectedListeners("tabSelectedByHistory",[221===e.keyCode]);t=!0}if(t){s||e.preventDefault();e.stopImmediatePropagation();return!1}return!0}navigateSubFrames(e,t){const s=new CustomEvent("navigatesubframes",{cancelable:!0,detail:{isForward:t,useActiveElement:!0}});if(e.dispatchEvent(s)){const s=parseInt(e.frameElement.getAttribute("id"),10);let i=ne.c.none,n=!1;switch(s){case ne.c.none:i=t?ne.c.header:this.isConsoleShown?ne.c.console:this.selectedPluginId;break;case ne.c.header:if(t)i=this.selectedPluginId;else if(this.isConsoleShown){i=ne.c.console;n=!0}else{i=this.selectedPluginId;n=!0}break;case ne.c.console:if(t){i=ne.c.header;n=!0}else i=this.selectedPluginId!==ne.c.console?this.selectedPluginId:ne.c.header;break;default:if(t&&this.isConsoleShown)i=ne.c.console;else if(t){i=ne.c.header;n=!0}else i=ne.c.header}const o=document.getElementById(i.toString()),r=new CustomEvent("navigatesubframes",{cancelable:!0,detail:{isForward:t,useActiveElement:!1}});o.contentWindow.dispatchEvent(r);if(n)return!0}return!1}notifyTabSelectedListeners(e,t){this._rpcClient.call("ms:header",e,t)}getViewIframe(e){return document.getElementById(e.toString())}zoomIn(){if(this._zoomLevel>=le.ZOOM_MAX)return!1;this._zoomLevel+=le.ZOOM_DELTA;this.showZoom();return!0}zoomOut(){if(this._zoomLevel<=le.ZOOM_MIN)return!1;this._zoomLevel-=le.ZOOM_DELTA;this.showZoom();return!0}showZoom(){this._zoomNotification||(this._zoomNotification=new ae(document.body));window.setImmediate(()=>{this._zoomNotification.show(this._zoomLevel,2e3)})}}le.ZOOM_MAX=400;le.ZOOM_MIN=50;le.ZOOM_DELTA=25;const ce="perfBadge",de="perfClose",he="perfData",pe="warn",ue="showHUD",ge="F12PERFHUD",me="perf",fe="perfHUD",be="keydown",ye="click",Ce="perfTab";class we{constructor(){this.badgeCount=0;this.isOpen=!1;const e=document.getElementById(Ce),t=document.getElementById(de);e&&e.addEventListener(ye,this.toggleHUD.bind(this));t&&t.addEventListener(ye,this.toggleHUD.bind(this));document.addEventListener(be,this.keydownHandler.bind(this))}static isEnabled(){return"1"===n.b.utilities.getEnvironmentVariable(ge)}show(){const e=document.getElementById(me);e&&(e.style.display="block")}onPerfEvent(e,t){const s=Ee[e],i=document.getElementById(he),n=document.createElement("div"),o=s&&t>s,r=o?"color: red;":"color: green;";n.innerHTML=`<strong>${e}:</strong> <span style="${r}">${t} ms</span>`;if(i){i.appendChild(n);i.scrollTop=i.scrollHeight}if(o&&!this.isOpen){this.badgeCount++;const e=document.getElementById(Ce),t=document.getElementById(ce);if(e&&t){e.classList.toggle(pe);t.innerHTML=`<div>${this.badgeCount}</div>`;t.style.display="block";setTimeout(()=>{e.classList.toggle(pe)},500)}}}clearHUD(){const e=document.getElementById(he);e&&(e.innerHTML="")}toggleHUD(){const e=document.getElementById(fe);this.isOpen=!this.isOpen;if(this.isOpen){const e=document.getElementById(ce);e&&(e.style.display="none");this.badgeCount=0}e&&e.classList.toggle(ue)}keydownHandler(e){e.ctrlKey&&e.shiftKey&&85===e.keyCode?this.toggleHUD():e.ctrlKey&&e.shiftKey&&67===e.keyCode&&this.clearHUD()}}const Ee={Dom_ComputedTabLoad:50,Dom_StylesTabLoaded:100};var ve=s(132),Ie=s(149);class Se{constructor(e,t,s,i){this.eventCount=0;this.thresholdReached=!1;this.analytics=e;this.eventName=t;this.threshold=s;this.floodOverCallback=i}static nextCorrelationId(){const e=++Se.correlationId;return String(e)}start(){void 0===this.intervalId&&(this.intervalId=setInterval(()=>{this.checkEventCount()},Se.TIMEOUT_LENGTH))}stop(){if(void 0!==this.intervalId){clearInterval(this.intervalId);this.intervalId=void 0}}eventHappened(){this.eventCount++}checkEventCount(){if(this.eventCount>this.threshold){if(!this.thresholdReached){this.activeCorrelationId=Se.nextCorrelationId();this.fireEvent(`${this.eventName}_Start`,{correlationId:this.activeCorrelationId,eventCount:this.eventCount});this.thresholdReached=!0;this.thresholdReachedTime=performance.now()}}else if(this.eventCount<Math.floor(this.threshold/2)&&this.thresholdReached){const e=performance.now()-this.thresholdReachedTime;this.fireEvent(`${this.eventName}_Stop`,{correlationId:this.activeCorrelationId,duration:e,eventCount:this.eventCount});this.thresholdReached=!1;this.floodOverCallback&&this.floodOverCallback(this.activeCorrelationId,Date.now())}this.eventCount=0}fireEvent(e,t){this.analytics.log(e,t,2,Q.b.Measure)}}Se.TIMEOUT_LENGTH=1e3;Se.correlationId=0;var ke=s(56);function Oe(e){return new Promise((t,s)=>{let i=new XMLHttpRequest;i.open("GET",e,!0);i.onload=(()=>{t(i.responseText)});i.onerror=(()=>{s(new Error(`XHR retrieval failed with status code ${i.status}.`))});i.ontimeout=(()=>{s(new Error("XHR retrieval failed due to timeout."))});i.onabort=(()=>{s(new Error("XHR retrieval failed due to abort."))});i.send()})}async function Pe(e,t,s=!1){if(s){await xe(e,t);De.set(e,!0);const s=new Map;Te.forEach((t,i)=>{e===t?i():s.set(i,t)});Te=s}else{if(!De.get(e)){let s=null;const i=new Promise(e=>{s=e}).then(()=>xe(e,t));Te.set(s,e);return i}xe(e,t)}}async function Me(){De.clear();Te.clear()}let Te=new Map;const De=new Map;async function xe(e,t){const s=await Promise.all(t.map(Oe));for(let i=0;i<t.length;i++){const o=t[i],r=s[i];n.b.loadScriptInProc(e,o,r)}}const _e="RemoteMessageFlood",He=50,Re="debuggerPort";class Fe{constructor(e,t){this.rpcMap=new Map;this.rpcMapQueue=new Map;this.rpcMapPorts=new Map;this.SCRIPTS=["../common/Remote/RemoteDiagnostics.js","../common/assert.js","../common/remote/rpc.js","../common/perftools/PerfRemoteHelpers.js","../common/remoteHelpers.js","../common/encodingUtilities.js","../common/Intellisense/intellisenseRemoteHelpers.js","../common/remoteEditStack.js","../common/MediaTypeManager.js"];this.SCRIPTS_ETW=["../common/remote/etw.js"];this.SCRIPTS_CONSOLE=["../remote/console/console.remote.bundle.js"];this.handleDiagOmMessage=(e=>{const t=JSON.parse(e.message),s=t.id;switch(t.type){case"connect":{const e=new Ie.a(`COMMUNICATION_PROXY_${s}`,(e,t,s,i)=>{this.jsonRpcMethodReceive(e,t,s,i)},(e,t,s)=>this.jsonRpcNotificationReceive(e,t,s),e=>{n.b.postMessageToRemote(0,JSON.stringify({id:s,data:e}))},e=>{this.rpcMapPorts.set(s,e)});this.rpcMap.set(s,e);const t=this.rpcMapQueue.get(s);t&&t.forEach(t=>{e.jsonRpcMethodCall(t.method,t.params,t.completed,t.error)});"headerPort"===s&&this.hostRpcClient.call("ms:header","attachSelfTests",[]);this.rpcMapQueue.delete(s);break}case"message":{this.messageFloodMonitor.eventHappened();const e=this.rpcMapPorts.get(s);e&&e(t);break}}});this.handleDebuggerOmMessage=(e=>{const t=JSON.parse(e.message),s=t.id;if(s===Re)switch(t.type){case"connect":const e=new Ie.a("CLIENT",()=>{},(e,t)=>{this.hostRpcClient.broadcast("notificationFromRemoteDebuggerOM",{event:e,params:t})},e=>{n.b.postMessageToRemote(1,JSON.stringify({id:s,data:e}))},e=>{this.rpcMapPorts.set(s,e)});this.rpcMap.set(s,e);const i=this.rpcMapQueue.get(s);i&&i.forEach(t=>{e.jsonRpcMethodCall(t.method,t.params,t.completed,t.error)});this.rpcMapQueue.delete(s);this.hostRpcClient.broadcast("debuggerRemoteAttached",{});break;case"message":const o=this.rpcMapPorts.get(s);o&&o(t)}});this.networkToolActive=!1;this.networkToolLoaded=!1;this.hostRpcClient=t;this.messageFloodMonitor=new Se(e,_e,He,(e,t)=>{this.messageHeaderFloodOver(e,t)});this.messageFloodMonitor.start();n.b.addEventListener("diagnosticsommessage",this.handleDiagOmMessage);n.b.addEventListener("debuggerommessage",this.handleDebuggerOmMessage);n.b.addEventListener("attach",()=>this.onAttach());n.b.addEventListener("detach",()=>this.onDetach());n.b.isAttached&&this.onAttach()}jsonRpcMethodReceive(e,t,s,i){}jsonRpcNotificationReceive(e,t,s){let i=t;const n=s.split("|"),o=n?n[0].split("_"):"";let r=parseInt(o&&o.length>2?o[2]:"",ne.c.onewpc);if("etwmessage"===e){r=i[1];i=i[0];if(r===ne.c.onewpc){const e=i;this.hostRpcClient.broadcast("networkEvent",{message:e});return}}switch(e){case"Handshake":case"ClearTargets":case"TargetCreated":case"TargetClosed":case"TargetUpdated":this.hostRpcClient.broadcast("targetsUpdatedNotification",{event:e,params:i})}H(()=>`Notification from Remote: ${e} - ${JSON.stringify(i)}`);this.hostRpcClient.broadcast(`notificationFromRemote|${Object(f.c)(r)}`,{event:e,params:i})}loadScriptsAsync(e,t=!1){return Pe(0,e,t).then(()=>!0).catch(e=>{H(()=>`Loading remote scripts failed with error ${e}`);return!1})}callRemote(e,t,s){return new Promise((i,n)=>{const o=this.rpcMap.get(e);H(()=>`Remote call ${o?"":"queued "}via ${e}: "${t}", ${JSON.stringify(s||[])}`);if(o)o.jsonRpcMethodCall(t,s,i,n);else{const o={method:t,params:s,completed:i,error:n},r=this.rpcMapQueue.get(e);r?r.push(o):this.rpcMapQueue.set(e,[o])}})}async startNetworkCollection(){this.networkToolActive=!0;this.networkToolLoaded=!0}stopNetworkCollection(){this.networkToolActive=!1;return this.stopNetworkCollector()}sendNetworkCollection(e){return this.etwNetworkDataCollectorSession?this.etwNetworkDataCollectorSession.sendStringToCollectionAgent(e).then(t=>{const s=JSON.parse(e);"Network.enable"===s.method?this.notifyBadgeListeners("profilerstarted",[ne.c.network]):"Network.disable"===s.method&&this.notifyBadgeListeners("profilerstopped",[ne.c.network]);return Promise.resolve(t)}):Promise.resolve("")}async onAttach(){await Promise.all([this.attachDiagOMScripts(),this.debuggerAttach()]);await this.startNetworkCollector();if(this.networkToolLoaded&&!this.networkToolActive){const e=JSON.stringify({id:1,method:"Network.disable",params:[]});await this.sendNetworkCollection(e)}}async attachDiagOMScripts(){await this.loadScriptsAsync(this.SCRIPTS,!0);await this.loadScriptsAsync(this.SCRIPTS_ETW,!0);Object(l.isEdpEnabled)()||await this.loadScriptsAsync(this.SCRIPTS_CONSOLE)}async onDetach(){Me();this.rpcMap.clear();this.rpcMapQueue.clear();this.rpcMapPorts.clear();await this.stopNetworkCollector();this.debuggerDetach()}async startNetworkCollector(){this.etwDataCollector||(this.etwDataCollector=new ve.a(this.callRemote.bind(this)));if(!this.etwNetworkDataCollectorSession){this.etwNetworkDataCollectorSession=await this.etwDataCollector.startSession("NetworkCollectionAgent.dll","{514A5E80-CC1B-4844-9139-0DA4AFDCF814}",!1,ne.c.onewpc);const e={id:1,method:"Network.enable"};this.etwNetworkDataCollectorSession.sendStringToCollectionAgent(JSON.stringify(e))}this.notifyBadgeListeners("profilerstarted",[ne.c.network])}async stopNetworkCollector(){this.etwDataCollector=null;this.etwNetworkDataCollectorSession=null;this.networkToolActive=!1;this.notifyBadgeListeners("profilerstopped",[ne.c.network])}notifyBadgeListeners(e,t){this.hostRpcClient.call("ms:header",e,t)}messageHeaderFloodOver(e,t){this.hostRpcClient.call("ms:header","floodOverNotification",[e,t])}async debuggerAttach(){if(Object(l.isEdpEnabled)()||!n.b.isAttached)return;try{n.b.createDebuggerEngine()}catch(e){const t=e&&e.toString?e.toString():"Unknown Exception";H(()=>`Failed to createDebuggerEngine: ${t}`);return}const e=["../common/Remote/RemoteDiagnostics.js","../common/assert.js","../common/remote/rpc.js","../debugger/Remote/debuggerRemote.js"];await Pe(1,e,!0);await this.loadScriptsAsync(["../debugger/remote/debuggerDiagRemote.js"])}debuggerDetach(){this.hostRpcClient.broadcast("debuggerRemoteDetached",{});ke.f()}}var Le=s(12),je=s(30),Ne=s(109),Be=s(33);function Ae(e,t){switch(e){case g.a:ie.dispatch(t.action);break;case"notificationFromEdp":case"notificationFromRemoteDebuggerOM":{const{event:e,params:s}=t;switch(e){case"onAddDocuments":s.forEach(e=>{const t=Ue(e);t&&ie.dispatch(Object(je.a)({id:e.id,url:t,isDynamicCode:e.isDynamicCode,mimeType:e.mimeType||Le.a.guessMimeTypeFromUrlExtension(t)},{sourceMapUrl:e.sourceMapUrl}))});break;case"onRemoveDocuments":{const e=s;e.forEach(e=>{Ke.delete(e)});ie.dispatch(Object(je.f)(e));break}case"onBreak":ie.dispatch(Object(je.c)(s[0]));break;case"onWebWorkerStarted":ie.dispatch(Object(je.q)(s[0]));break;case"onWebWorkerFinished":ie.dispatch(Object(je.p)(s[0]))}break}case"notificationFromRemote|ms:debugger":{const{event:e,params:s}=t;switch(e){case"styleSheetAdded":{const e=s[0];ie.dispatch(Object(je.a)({id:e.key,url:e.url,mimeType:"text/css"},{processFileForSourceMap:!0}));break}case"styleSheetRemoved":{const e=s[0];ie.dispatch(Object(je.f)([e.key]));break}}break}case"jmcRulesChanged":{const e=t,s=e.currentType===Be.a.Library;ie.dispatch(Object(je.e)(e.url,s));break}case"debuggerRemoteDetached":ie.dispatch(Object(je.d)())}}const Ke=new Map;function Ue(e){const t=e.url;if(e.sourceUrlOverride)return e.sourceUrlOverride;if(t.startsWith(Ne.e)||t.startsWith(Ne.d)||t.startsWith(Ne.c))return"";if(t.startsWith(Ne.b)){const s=t.indexOf("-"),i=t.slice(s+2);Ke.set(e.id,i);return""}if(Ke.has(e.parentId)&&!t.startsWith(Ne.a)){const s=Ke.get(e.parentId);return`${Ne.a}${s}/${t}`}return t}var We=s(1),ze=s(66),$e=s(29),Ve=s(21);const Qe=100;function qe(e,t){return t.sort((t,s)=>Ze(e,t,s))}function Ze(e,t,s){const i=-1,n=1;if(!e.containsPathSeparators){if(t.labelHighlights.length!==s.labelHighlights.length){if(0===s.labelHighlights.length)return i;if(0===t.labelHighlights.length)return n}if(t.labelHighlights.length>0&&s.labelHighlights.length>0){if(t.labelHighlights[0].start!==s.labelHighlights[0].start)return t.labelHighlights[0].start<s.labelHighlights[0].start?i:n;{const e=Je(t.label,s.label);if(0!==e)return e}}}return t.descriptionHighlights.length>0&&s.descriptionHighlights.length>0?t.descriptionHighlights[0].start!==s.descriptionHighlights[0].start?t.descriptionHighlights[0].start<s.descriptionHighlights[0].start?i:n:Je(t.description,s.description):i}function Je(e,t){if(e.toLowerCase()===t.toLowerCase())return 0;const s=-1,i=1;return e.length!==t.length?e.length<t.length?s:i:e<t?s:i}function Ge(e,t,s,i){const n=Xe(e);let o=Ye(s,i),r=Ye(t,i);if(n.value){o=qe(n,et(n,o));r=qe(n,et(n,r))}0===r.size&&0===o.size&&(r=Ve.Seq.Indexed([{label:Le.a.loadString("QuickOpenNoResultsFound"),description:"",labelHighlights:[],descriptionHighlights:[],isSelectable:!1}]));return{entries:o.concat(r).slice(0,Qe).valueSeq(),indexOfSeparation:o.size}}function Xe(e){const t=e.trim().toLowerCase().replace(/\\/g,"/");return{value:t,containsPathSeparators:t.includes("/")}}function Ye(e,t){return e.map(e=>({label:e?Le.a.createShortenedUrlText(e):"",description:e,descriptionHighlights:[],labelHighlights:[],isSelectable:!!e,urlState:t.get(e)}))}function et(e,t){return t.filter(t=>{let s=!1,i=t.label.toLowerCase().indexOf(e.value);if(i>=0){t.labelHighlights=[{start:i,end:i+e.value.length-1}];s=!0}if((i=t.description.toLowerCase().indexOf(e.value))>=0){t.descriptionHighlights=[{start:i,end:i+e.value.length-1}];s=!0}return s})}var tt=s(20),st=s(44),it=s(165),nt=s(7);const ot=Object(nt.css)({fontFamily:'"Consolas","Lucida Console",monospace',fontSize:"12px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",marginRight:"7px",marginLeft:"2px"}),rt={dialogBox:Object(nt.css)({position:"absolute",top:"43px",bottom:"20px",left:"0px",right:"0px",marginLeft:"auto",marginRight:"auto",marginTop:"8px",width:"50%",minWidth:"300px",maxHeight:"400px",outline:"none",boxSizing:"border-box"}),flexContainer:Object(nt.css)({position:"relative",bottom:"auto",display:"flex",flexDirection:"column",maxHeight:"100%",border:"1px solid #555",outline:"none",padding:"0px",boxSizing:"border-box",background:"white","@media (-ms-high-contrast:active)":{background:"Window"},zIndex:16}),inputBox:Object(nt.css)({border:"none",borderBottom:"1px solid black","@media (-ms-high-contrast:active)":{borderBottomColor:"ActiveBorder"},display:"block",margin:"auto",outline:"none",padding:"7px 5px 7px 5px",width:"100%",boxSizing:"border-box",fontFamily:'"Consolas","Lucida Console",monospace',fontSize:"12px",flex:"1"}),entryList:Object(nt.css)({boxSizing:"border-box",listStyleType:"none",margin:"0px",overflowX:"hidden",overflowY:"auto",padding:"0px",position:"relative"}),description:Object(nt.css)(ot,{color:"gray","@media (-ms-high-contrast:active)":{color:"inherit"}}),descriptionHighlight:Object(nt.css)({color:"#00a0ff","@media (-ms-high-contrast:active)":{color:"inherit"},fontWeight:"bold"}),label:Object(nt.css)(ot,{color:"black","@media (-ms-high-contrast:active)":{color:"inherit"}}),labelHighlight:Object(nt.css)({color:"#0080ff","@media (-ms-high-contrast:active)":{color:"inherit"},fontWeight:"bold"}),tagForTypeOfResults:Object(nt.css)({color:"#007ACC","@media (-ms-high-contrast:active)":{color:"inherit"},float:"right",marginRight:"2px"}),separator:Object(nt.css)({margin:"0px",border:"0.25px solid #d3d3d3","@media (-ms-high-contrast:active)":{borderColor:"ActiveBorder"}})},at=Object(nt.css)({background:"rgba(0, 103, 184, 0.1)","@media (-ms-high-contrast:active)":{background:"Highlight",color:"HighlightText"}}),lt=Object(nt.css)(Object(nt.focus)(at),Object(nt.hover)(at),{cursor:"pointer",display:"block",width:"100%",padding:"5px"}),ct=Object(nt.css)(lt,{backgroundColor:"rgba(214, 214, 214, .28)","@media (-ms-high-contrast:active)":{background:"Highlight",color:"HighlightText"}}),dt={verticalAlign:"middle",color:"#F5BD00",paddingBottom:"3px",width:"11px",height:"11px",marginRight:"2px"};class ht extends We.PureComponent{constructor(){super(...arguments);this.refHandlers={entry:e=>this.entryElement=e};this.selectItem=(()=>{if(this.props.entry.isSelectable){re.logExecuteCommand(oe.FILE_OPENED_FROM_QUICK_OPEN,Q.c.Ui);this.props.onSelected(this.props.entry)}});this.onMouseEnter=(e=>{Object(tt.c)({content:e})})}componentDidMount(){this.props.isFocused&&this.entryElement.scrollIntoView()}componentWillUnmount(){Object(tt.a)()}componentDidUpdate(){this.props.isFocused&&this.entryElement.scrollIntoView(!1)}render(){const e=0===this.props.entry.labelHighlights.length?We.createElement("span",null,this.props.entry.label):pt(this.props.entry.label,this.props.entry.labelHighlights,rt.labelHighlight),t=0===this.props.entry.descriptionHighlights.length?We.createElement("span",null,this.props.entry.description):pt(this.props.entry.description,this.props.entry.descriptionHighlights,rt.descriptionHighlight),s=this.props.isFocused?ct:lt,i=this.props.tagForEntry?We.createElement("span",Object.assign({},rt.tagForTypeOfResults),this.props.tagForEntry):null,n=this.props.entry.urlState&&this.props.entry.urlState.hasPendingEdit?"*":null;let o;this.props.entry.urlState&&this.props.entry.urlState.badgeText&&"error"===this.props.entry.urlState.badgeType&&(o=We.createElement(st.n,{style:dt,onMouseEnter:this.onMouseEnter.bind(this,this.props.entry.urlState.badgeText)}));const r=this.props.entry.description?Object(it.a)(this.props.mimeType,dt):void 0;return We.createElement("li",{ref:this.refHandlers.entry,tabIndex:-1,id:`quickopen_${this.props.indexOfEntry}_${this.props.entry.description}`},this.props.hasTopSeparator?We.createElement("hr",Object.assign({},rt.separator)):null,We.createElement("div",Object.assign({onMouseDown:this.selectItem},s),We.createElement(We.Fragment,null,We.createElement("div",Object.assign({},rt.label),r,o,e,n,i),We.createElement("div",Object.assign({},rt.description,{onMouseEnter:this.onMouseEnter.bind(this,this.props.entry.description)}),t))))}}function pt(e,t,s){const i=t[0];return We.createElement(We.Fragment,null,e.substring(0,i.start),We.createElement("span",Object.assign({},s),e.substring(i.start,i.end+1)),e.substring(i.end+1,e.length))}class ut extends We.PureComponent{constructor(e){super(e);this.refHandlers={list:e=>this.list=e};this.mapEntry=((e,t)=>{const s=t===this.props.indexOfSeparation,i=0===t&&!s,n=!e.description,o=s&&!n?Le.a.loadString("NewFileResults"):i?Le.a.loadString("RecentlyOpened"):"",r=e.description?this.props.fileInfoMap.get(e.description):"";return We.createElement(ht,{key:e.description,entry:e,hasTopSeparator:this.props.indexOfSeparation>0&&s,isFocused:t===this.props.focusedIndex,indexOfEntry:t,onSelected:this.props.onSelected,tagForEntry:o,mimeType:r})});this.state={focusedIndex:0,isFocused:!1}}componentWillReceiveProps(e){this.props.entries!==e.entries&&this.setState({focusedIndex:0})}render(){const e=this.props.entries.map(this.mapEntry);return We.createElement("ul",Object.assign({},rt.entryList,{ref:this.refHandlers.list,tabIndex:0}),e)}}const gt=100,mt=150;class ft extends We.PureComponent{constructor(e){super(e);this.disposed=!1;this.refHandlers={input:e=>this.inputElement=e};this.onKeyUp=(e=>{!e.ctrlKey&&80!==e.keyCode&&17===e.keyCode&&this.state.ctrlPHeldDown&&this.selectEntry()});this.onKeyDown=(e=>{const t=80===e.keyCode&&Object(q.c)(e),s=80===e.keyCode&&Object(q.f)(e);if(e.key===q.h.ENTER)this.selectEntry();else if(e.key===q.h.UP||e.key===q.h.DOWN||t||s){const i=this.state.results.entries.size-1,n=this.state.focusedIndex;let o=n;e.key===q.h.UP||s?o=0===n?i:n-1:(e.key===q.h.DOWN||t)&&(o=n===i?0:n+1);event.stopPropagation();event.preventDefault();this.setState({focusedIndex:o,ctrlPHeldDown:t||s})}});this.selectEntry=(()=>{const e=this.state.results.entries.get(this.state.focusedIndex);if(e.isSelectable){re.logExecuteCommand(oe.FILE_OPENED_FROM_QUICK_OPEN,Q.c.KeyboardShortcut);this.props.onSelected(e)}});this.onChange=(e=>{const t=e.target.value;">"===t&&re.logExecuteCommand(oe.COMMAND_PALLETE_DESIRED_WITH_CARET,Q.c.KeyboardShortcut);this.setState({userInput:t,focusedIndex:0,results:this.computeEntries(t,this.props.newFileUrls,this.props.recentFileUrls)})});this.computeEntriesAndUpdateState=(e=>{if(!this.disposed){const t=this.computeEntries(this.state.userInput,e.newFileUrls,e.recentFileUrls);this.setState({focusedIndex:this.state.focusedIndex<t.entries.size?this.state.focusedIndex:0,results:t})}});this.computeEntries=((e,t,s)=>Ge(e,t,s,this.props.urlStates));this.state={userInput:"",focusedIndex:0,results:this.computeEntries("",this.props.newFileUrls,this.props.recentFileUrls),ctrlPHeldDown:!1};this.onKeyDownThrottled=Object(w.e)(this.onKeyDown,this,mt)}render(){const e=this.state.results.entries.get(this.state.focusedIndex);return We.createElement("div",Object.assign({id:"quickOpenDialog"},rt.dialogBox),We.createElement("div",Object.assign({},rt.flexContainer),We.createElement("input",Object.assign({},rt.inputBox,{value:this.state.userInput,placeholder:Le.a.loadString("QuickOpenTypeToSearchPlaceholder"),onChange:this.onChange,ref:this.refHandlers.input,onKeyDown:this.onKeyDownThrottled,onKeyUp:this.onKeyUp,"aria-activedescendant":`quickopen_${this.state.focusedIndex}_${e.description}`})),We.createElement(ut,{entries:this.state.results.entries,indexOfSeparation:this.state.results.indexOfSeparation,onSelected:this.props.onSelected,focusedIndex:this.state.focusedIndex,fileInfoMap:this.props.fileInfoMap})))}componentDidMount(){this.inputElement&&this.inputElement.focus()}componentDidUpdate(){this.inputElement&&this.inputElement.focus()}componentWillUnmount(){this.disposed=!0}componentWillReceiveProps(e){e.newFileUrls===this.props.newFileUrls&&e.recentFileUrls===this.props.recentFileUrls||Object(w.a)(this.computeEntriesAndUpdateState,this,gt,e)}}class bt extends We.PureComponent{constructor(){super(...arguments);this.onItemSelected=(e=>{this.props.hideQuickOpen();this.props.showDocument(e.description)})}render(){if(this.props.isOpen){const e=new Map,t=this.props.files.filter(t=>{const s=t.url;if(e.has(s))return!1;e.set(s,t.mimeType);return!0}).map(e=>e.url),s=this.props.recentFiles.filter(e=>t.includes(e)),i=t.filter(e=>!this.props.recentFiles.includes(e)).valueSeq(),n=s.reverse().valueSeq();return We.createElement(ft,{newFileUrls:i,recentFileUrls:n,onSelected:this.onItemSelected,urlStates:this.props.urlStates,fileInfoMap:e})}return null}}function yt(e){return{files:e.debugger.files,recentFiles:e.debugger.recentFiles,isOpen:e.host.quickOpenVisible,urlStates:e.debugger.urls}}function Ct(e){return{showDocument:t=>e(Object(je.m)(t)),hideQuickOpen:()=>e(J())}}var wt=Object($e.b)(yt,Ct)(bt);function Et(e){Object(ze.render)(We.createElement($e.a,{store:ie},We.createElement(wt,null)),e)}function vt(){ie.dispatch(J())}const It=22,St="ToolLoadStrategy",kt="nopreload",Ot=[ne.c.console,ne.c.debugger],Pt=[ne.c.console,ne.c.debugger,ne.c.dom,ne.c.elements,ne.c.emulation,ne.c.memoryAnalyzer,ne.c.network,ne.c.visualProfiler,ne.c.storage,ne.c.serviceworker],Mt=130,Tt=3,Dt=100;class xt{constructor(){this._isF12loading=!0;this._isConsoleShown=!1;this._toolsLoaded=!1;this._splitConsoleHeight=Mt;this._throttledResizeSplitConsole=Object(u.e)(this.resizeSplitConsole,this,Dt);this._pluginIframeMap=new Map;this.postPendingMessageToPlugin=(async e=>{H(()=>`Fire Pending PostMessage to ${ne.d[e]}`);const t=this._pluginIframeMap.get(e).contentWindow,s=Object(f.c)(e);this.rpcHost.activateClient(s,t)})}initialize(){this._consoleSplitter=document.getElementById("consoleSplitter");this._toolIframeRoot=document.getElementById("toolIframes");this._quickOpenDialog=document.getElementById("quickOpenDialogContainer");this.rpcHost=new y;this.registerRpcClients();this.rpcClient.listenAll(Ae);this._globalKeyHandler=new le(this.rpcClient);this.analytics=new a.a("Host");this.analytics.logPerformance({id:p.a.Shell_LoadHost_Start});this._remoteCommunications=new Fe(this.analytics,this.rpcClient);c.c.realize();this.registerEventHandlers();this.loadHeader();if(we.isEnabled()){this._perfHud=new we;this._perfHud.show()}Et(this._quickOpenDialog);if(Object(l.isEdpEnabled)()){this.edpClient=new L(Object(l.getProtocolJson)());this._edpEndpoint=new V(this.edpClient,this.rpcClient);window.__EDP_CLIENT=this.edpClient}this._supportedPluginList=Object(l.getSupportedPlugins)(n.b.launchMode,n.b.hostType);n.b.markToolReady(ne.c.onewpc);n.b.notifyOnToolActivated(ne.c.onewpc);this.analytics.logPerformance({id:p.a.Shell_LoadHost_Stop,isUserPerceived:!0});const e=Object(f.d)();window.addEventListener("message",t=>{if(t.data&&t.data.type&&t.origin===e){H(()=>`Message received by RpcHost: ${JSON.stringify(t.data)}`);this.rpcHost.handleMessage(t.data)}})}get selectedPluginId(){return this._selectedPluginId}set selectedPluginId(e){this._selectedPluginId=e;this._globalKeyHandler.selectedPluginId=e;this.render()}render(){if(null===this.selectedPluginId||void 0===this.selectedPluginId)return;const e=this.selectedPluginId;let t=this._pluginIframeMap.get(e);t||(t=this.loadTool(e));if("block"!==t.style.display){this.sendShowETW(ne.c[e]);t.style.display="block"}const s=window.getComputedStyle(t),i=window.innerHeight-It-this.getSplitConsoleHeight()+"px";s.height!==i&&(t.style.height=i);for(const[t,s]of this._pluginIframeMap.entries())t!==ne.c.console&&t!==ne.c.header&&t!==ne.c.popup&&t!==e&&"none"!==s.style.display&&(s.style.display="none")}async notifyKeyPressed(e,t){27===e&&0===t&&await this.toggleConsole()}getKeyboardRegistrations(){return Promise.resolve([{key:27,chord:0,description:"Toggle console split"}])}loadHeader(){this.sendLaunchETW("Header");const e=document.getElementById("header"),t=this.createIframe(ne.c.header,"header");e.appendChild(t);this._globalKeyHandler.addShortcutHandler(t)}preloadAllPlugins(e){const t=Object(l.getSupportedPlugins)(n.b.launchMode,n.b.hostType).map(e=>e.id),s="F12SELFTEST",i="1"===n.b.utilities.getEnvironmentVariable(s);let o=Ot;i&&(o=Pt);for(const s of o)if(s!==e&&t.includes(s)&&!this._pluginIframeMap.has(s)){this.loadTool(s).style.display="none"}}registerEventHandlers(){n.b.addEventListener("jsonmessage",e=>{if(e.targetPluginId===ne.c.onewpc){const t=JSON.parse(e.message);switch(t.method){case"tabSelected":{const e=t.params[0];vt();this.onTabSelectedByFrame(e);break}case"nativePerfEvent":{const[e,s]=t.params;switch(e){case p.a.Shell_LaunchTool_Start:this.analytics.logPerformance({id:e});break;default:this.analytics.logPerformanceNative(e,s)}}}}});window.addEventListener("toggleconsole",()=>this.toggleConsole());window.addEventListener("resize",()=>this.onResize());this.registerSplitterEvents()}onTabSelectedByFrame(e){let t=e;if(this._isF12loading){const e=this._supportedPluginList.filter(e=>e.id===t);e&&0===e.length&&(t=this._supportedPluginList[0].id);this._isF12loading=!1;this._launchPluginId=t}this.showOrHideConsole(t);this.notifyTabSelectedListeners("tabSelected",[t]);this.selectedPluginId=t;return!0}onToolReady(e){this.sendLaunchedETW(ne.c[e]);this.pushServiceLocatorRegistrationsTo(e);return Promise.resolve(!0)}pushServiceLocatorRegistrationsTo(e){const t=Object(f.c)(e);Object(d.d)().forEach(e=>{this.rpcHost.notifyClient(t,c.a,e)})}onPreloadTools(e){if(e===this._launchPluginId&&!this._toolsLoaded){this._toolsLoaded=!0;this.analytics.logPerformance({id:p.a.Shell_LaunchTool_Stop});const e=n.b.utilities.getRegEntryForF12(St),t=document.getElementById("popup"),s=this.createIframe(ne.c.popup,"popup");t.appendChild(s);e.toLowerCase()!==kt&&this.preloadAllPlugins(this._launchPluginId)}return Promise.resolve(!0)}toggleConsole(){if(this._selectedPluginId!==ne.c.console){const e=this.getConsoleIframe();e&&this._isConsoleShown?this._splitConsoleHeight=e.offsetHeight:this._splitConsoleHeight=Mt;this._isConsoleShown=!this._isConsoleShown;this._globalKeyHandler.isConsoleShown=this._isConsoleShown;this.showOrHideConsole(this.selectedPluginId);this.render()}return Promise.resolve(!0)}showOrHideConsole(e){if(e===ne.c.console){this.displayConsole(ne.a.Full);this.notifyConsoleStateListeners(!0,!0)}else if(this._isConsoleShown){this.displayConsole(ne.a.Split);this.notifyConsoleStateListeners(!0)}else{this.hideConsole();const t=this._pluginIframeMap.get(e);t&&t.contentWindow.focus();this.notifyConsoleStateListeners(!1)}}notifyConsoleStateListeners(e,t=!1){this.rpcClient.broadcast("consoleStateChange",{shown:e,isSplit:!t})}notifyTabSelectedListeners(e,t){this.rpcClient.call("ms:header",e,t)}displayConsole(e){const t=this.getConsoleIframe(),s=this._consoleSplitter;if(t)switch(e){case ne.a.Split:t.classList.remove("toolIframe");t.classList.remove("fullConsole");t.classList.add("splitConsole");t.style.height=this._splitConsoleHeight+"px";s.style.display="block";s.style.bottom=this._splitConsoleHeight+"px";break;case ne.a.Full:default:t.classList.remove("splitConsole");t.classList.add("toolIframe");t.classList.add("fullConsole");s.style.display="none"}}hideConsole(){const e=this.getConsoleIframe(),t=this._consoleSplitter;if(e){e.classList.add("toolIframe");e.classList.remove("splitConsole");e.classList.remove("fullConsole");e.removeAttribute("style");e.style.display="none";t.style.display="none"}}resizeSplitConsole(e){const t=this.getConsoleIframe(),s=this._consoleSplitter;if(t){const i=window.innerHeight-e-Tt;t.style.height=i+"px";this._splitConsoleHeight=i;s.style.bottom=i+"px";this.render()}return!0}registerSplitterEvents(){const e=this._consoleSplitter;let t=null;e.addEventListener("pointerdown",s=>{if(null===t){e.setPointerCapture(s.pointerId);t=s.pointerId}});const s=s=>{if(null!==t&&t===s.pointerId){e.releasePointerCapture(s.pointerId);t=null}};e.addEventListener("pointermove",e=>{null!==t&&e.pointerId===t&&this._throttledResizeSplitConsole(e.pageY)});e.addEventListener("pointerup",s);e.addEventListener("pointercancel",s)}getSplitConsoleHeight(){return this._isConsoleShown&&this.selectedPluginId!==ne.c.console?this._splitConsoleHeight+Tt:0}onResize(){this.render()}getConsoleIframe(){return this._pluginIframeMap.get(ne.c.console)}sendLaunchETW(e){const t=`Shell_LaunchTool_${e.charAt(0).toUpperCase()+e.slice(1)}_Start`,s=p.a[t]?p.a[t]:t;this.analytics.logPerformance({id:s})}sendLaunchedETW(e){const t=`Shell_LaunchTool_${e.charAt(0).toUpperCase()+e.slice(1)}_Stop`,s=p.a[t]?p.a[t]:t;this.analytics.logPerformance({id:s})}sendShowETW(e){const t=`Shell_ShowTool_${e.charAt(0).toUpperCase()+e.slice(1)}_Start`,s=p.a[t]?p.a[t]:t;this.analytics.logPerformance({id:s})}createIframe(e,t){const s=document.createElement("iframe");s.id=String(e);s.src=`${document.location.origin}/23/${t}/${t}.html`;this._pluginIframeMap.set(e,s);return s}loadTool(e){const t=ne.c[e];this.sendLaunchETW(t);const s=this.createIframe(e,t);s.classList.add("toolIframe");this._globalKeyHandler.addShortcutHandler(s);this._toolIframeRoot.appendChild(s);return s}registerHostEventsAndMethods(){this.rpcClient.register(c.b,async(e,t)=>{this.rpcHost.augmentClientEvents(e,t)});this.rpcClient.register("postPendingMessageToPlugin",this.postPendingMessageToPlugin);this.rpcClient.listen("perfEvent",e=>{this._perfHud.onPerfEvent(e.eventName,e.duration)});this.rpcClient.register("loadScripts",e=>this._remoteCommunications.loadScriptsAsync(e));this.rpcClient.register("callRemote",(e,t,s)=>this._remoteCommunications.callRemote(e,t,s));this.rpcClient.register("startNetworkCollection",()=>this._remoteCommunications.startNetworkCollection());this.rpcClient.register("stopNetworkCollection",()=>this._remoteCommunications.stopNetworkCollection());this.rpcClient.register("sendNetworkCollection",e=>this._remoteCommunications.sendNetworkCollection(e));this.rpcClient.register("toolready",e=>this.onToolReady(e));this.rpcClient.register("preloadTools",e=>this.onPreloadTools(e));this.rpcClient.register("toggleConsole",()=>this.toggleConsole());this.rpcClient.register("callEdp",(e,t)=>this._edpEndpoint?this._edpEndpoint.callEdpHandler(e,t):Promise.resolve(!1));Object(h.initializeServices)();c.c.register("HostKeyboardService",this)}registerRpcClients(){let e;const t=Object(f.d)();this.rpcClient=new f.a("ms:host",{postMessage:(e,s,i)=>{if(s===t){H(()=>`Local message received by RPCHost: ${JSON.stringify(e)}`);this.rpcHost.handleMessage(e)}}},{addEventListener:(t,s)=>{e=s},removeEventListener:(t,s)=>{e=void 0}});this.rpcClient.initialize();Object(b.b)(this.rpcClient);this.registerHostEventsAndMethods();this.rpcHost.registerClient({id:"ms:host",subscribedEvents:new Set(["perfEvent",c.a,g.a,"notificationFromEdp","notificationFromRemoteDebuggerOM","notificationFromRemote|ms:debugger","jmcRulesChanged","debuggerRemoteDetached"])});this.rpcHost.activateClient("ms:host",{postMessage:(t,s,i)=>{e&&e({data:t,origin:s})}});this.rpcHost.registerClient({id:"ms:console",subscribedEvents:new Set(["onDebuggerEvent","onUnhandledException","notificationFromRemote|ms:console","notificationFromEdp","consoleStateChange",c.a])});this.rpcHost.registerClient({id:"ms:debugger",subscribedEvents:new Set(["onSourceMapStateChanged","jmcAvailabilityChanged","jmcRulesChanged","consoleOutput","notificationFromEdp","notificationFromRemote|ms:debugger","notificationFromRemoteDebuggerOM","debuggerRemoteAttached","debuggerRemoteDetached","triggerSteppingFromConsole",c.a,m.a,"consoleStateChange"])});this.rpcHost.registerClient({id:"ms:dom",subscribedEvents:new Set(["onSourceMapStateChanged","notificationFromRemote|ms:dom","toolMessage",c.a])});this.rpcHost.registerClient({id:"ms:elements",subscribedEvents:new Set(["contextMenuPopupMessage",c.a])});this.rpcHost.registerClient({id:"ms:emulation",subscribedEvents:new Set(["notificationFromRemote|ms:emulation",c.a])});this.rpcHost.registerClient({id:"ms:header",subscribedEvents:new Set(["contextMenuPopupMessage","notificationFromRemote|ms:header","consoleStateChange",c.a])});this.rpcHost.registerClient({id:"ms:memory",subscribedEvents:new Set(["notificationFromRemote|ms:memory",c.a])});this.rpcHost.registerClient({id:"ms:network",subscribedEvents:new Set(["onSourceMapStateChanged","networkEvent","notificationFromRemote|ms:network",c.a])});this.rpcHost.registerClient({id:"ms:popup",subscribedEvents:new Set(c.a)});this.rpcHost.registerClient({id:"ms:serviceworker",subscribedEvents:new Set(["notificationFromRemote|ms:serviceworker","targetsUpdatedNotification",c.a])});this.rpcHost.registerClient({id:"ms:storage",subscribedEvents:new Set(["notificationFromRemote|ms:storage","targetsUpdatedNotification",c.a])});this.rpcHost.registerClient({id:"ms:performance",subscribedEvents:new Set(["notificationFromRemote|ms:performance",c.a])})}}window.__PERCEIVED_LAUNCH_TIMESTAMP=r.a;window.addEventListener("uwpReady",async()=>{const e="F12BREAKON1WPC",t="F12CHOOSERBREAKON1WPC",s=n.b.utilities.getEnvironmentVariable(e),r=n.b.utilities.getEnvironmentVariable(t);i.a.addGlobalErrorHandler();await Object(o.d)();if("1"===s&&(n.b.launchMode===n.a.Edge||n.b.launchMode===n.a.Remote)||"1"===r&&n.b.launchMode===n.a.Chooser){const e=document.getElementById("startF12button");e.style.display="block";e.onclick=(()=>{(new xt).initialize();e.parentElement&&e.parentElement.removeChild(e)})}else{(new xt).initialize()}})}});
