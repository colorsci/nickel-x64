!function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};e[r].call(n.exports,n,n.exports,i);n.l=!0;return n.exports}i.m=e;i.c=t;i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})};i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})};i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};i.d(t,"a",t);return t};i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};i.p="";i(i.s=7)}([,function(e,t,i){"use strict";i.d(t,"a",function(){return r});class r{static isTrue(e,t){if(!e){t=t?"Internal error. "+t:"Internal error. Unexpectedly false.";r.fail(t)}}static isFalse(e,t){if(e){t=t?"Internal error. "+t:"Internal error. Unexpectedly true.";r.fail(t)}}static isNull(e,t){if(null!==e){t=t?"Internal error. "+t:"Internal error. Unexpectedly not null.";t+=" '"+e+"'";r.fail(t)}}static isUndefined(e,t){0;if(void 0!==e){t=t?"Internal error. "+t:"Internal error. Unexpectedly not undefined.";t+=" '"+e+"'";r.fail(t)}}static hasValue(e,t){if(null===e||void 0===e){t=t?"Internal error. "+t:"Internal error. Unexpectedly "+(null===e?"null":"undefined")+".";r.fail(t)}}static areEqual(e,t,i){e!==t&&r.fail(`Error: ${i}, Unexpectedly not equal- Actual: '${e}', Expected: '${t}'`)}static areNotEqual(e,t,i){e===t&&r.fail(`Error: ${i}, Identical input passed to areNotEqual: '${e}'`)}static failDebugOnly(e){r.fail(e)}static fail(e){var t=new Error((e||"Assert failed.")+"\n");try{throw t}catch(e){e.stack&&(e.description=e.stack);throw e}}}},function(e,t,i){"use strict";i.d(t,"a",function(){return n});var r=i(1);class n{constructor(e,t,i,r,n){this._ourIdentifier=e;this._nextId=0;this._promiseTable={};this._jsonRpcMethodReceive=t;this._jsonRpcNotificationReceive=i;this._postMessage=r;Date.now||(Date.now=function(){return+new Date});n(e=>{this.onMessage(e)})}jsonRpcMethodCall(e,t,i,n,s){i||r.a.failDebugOnly("Trying to insert a promise into the queue without a completed function: The front end will have no way of knowing this promise completed");var a=this._ourIdentifier+"|"+this._nextId;this._nextId++;this._promiseTable[a]={completed:i,error:n};var d=JSON.stringify({id:a,method:e,params:t});if(o.RandomDelay){o.queueData(()=>{this._postMessage(d,s)},d);return!0}return this._postMessage(d,s)}jsonRpcNotification(e,t,i){var r=this._ourIdentifier+"|NULL",n=JSON.stringify({id:r,method:e,params:t});o.RandomDelay?o.queueData(()=>{this._postMessage(n,i)},n):this._postMessage(n,i)}onMessage(e){var t=JSON.parse(e.data),i=t.id.split("|");r.a.areEqual(i.length,2);"NULL"===i[1]?i[0]!==this._ourIdentifier&&this._jsonRpcNotificationReceive(t.method,t.params,t.id):i[0]!==this._ourIdentifier||t.method?o.RandomDelay?o.queueData(()=>{this.handleCall(t)},e.data):this.handleCall(t):o.RandomDelay?o.queueData(()=>{this.handleReply(t)},e.data):this.handleReply(t)}handleReply(e){if(this._promiseTable[e.id]&&this._promiseTable[e.id].completed){if(e.error){r.a.isUndefined(e.data,"Can't have both data and error");this._promiseTable[e.id].error(e.error)}else this._promiseTable[e.id].completed(e.data);delete this._promiseTable[e.id]}else r.a.failDebugOnly("Can't complete a promise that does not exist in the promise table. Probably a dup reply msg.")}handleCall(e){this._jsonRpcMethodReceive(e.method,e.params,(t,i)=>{var r;r=i?JSON.stringify({id:e.id,error:i}):JSON.stringify({id:e.id,data:t});this._postMessage(r)},e.id)}}class s{constructor(e,t){this.callback=e;this.message=t}}class o{static enableDelay(e,t){o.RandomDelay=!0;o.CalculateDelayTime=e;o.DelayedMessage=t}static disableDelay(){o.RandomDelay=!1;if(o.RandomDelayTimeout){clearTimeout(o.RandomDelayTimeout);o.RandomDelayTimeout=null;o.clearQueue()}}static queueData(e,t){var i=new s(e,t);o.DelayedQueue.push(i);if(!o.RandomDelayTimeout){var r=o.CalculateDelayTime(t);o.RandomDelayTimeout=setTimeout(o.fireRandomly,r)}}static fireRandomly(){var e=o.DelayedQueue.shift();o.DelayedMessage(e.message);e.callback();if(o.DelayedQueue.length>0){var t=o.CalculateDelayTime(o.DelayedQueue[0].message);o.RandomDelayTimeout=setTimeout(o.fireRandomly,t)}else o.RandomDelayTimeout=null}static clearQueue(){for(var e=0;e<o.DelayedQueue.length;e++){var t=o.DelayedQueue[e];o.DelayedMessage(t.message);t.callback()}o.DelayedQueue=[]}}o.RandomDelay=!1;o.DelayedQueue=[]},,,,,function(e,t,i){"use strict";i.r(t);var r=i(1),n=i(2);const s="browsertools://browsertools.library.js",o="document.__IE_DEVTOOLBAR_CONSOLE_EVAL_RESULT";function a(e,t=!1){const i={sourceMap:null,sourceUrl:null};if(e){i.sourceMap=d("sourceMappingURL",e);i.sourceUrl=d("sourceURL",e);!i.sourceUrl&&t&&0===e.indexOf(o)&&(i.sourceUrl=s)}return i}function d(e,t){let i=null;if(t){const r=`(#|@) *${e} *= *(.*?)\\s*`,n=new RegExp(`^\\s*(//${r}$|/\\*${r}\\*/)`,"img");let s=n.exec(t);for(;s;){i=s[3]||s[5];s=n.exec(t)}}return i}var l;!function(e){e[e.On=0]="On";e[e.Off=1]="Off";e[e.Disabled=2]="Disabled"}(l||(l={}));const u="BKP:notfound:",c=/^(InternetExplorer|InternetExplorerExtension|ServiceWorkerHost|ServiceUI \d+|MSAppHost\/\d+\.\d)$/;class h{constructor(e){this._asyncFrameId=0;this._callHandler=e;this._isEnabled=!1;this._isBreakOnNextError=!1;this._documentMap=new Map;this._breakIntoSpecificWorkerIds=[];this._rootDocIdQueue=[];this._sessionNumber=0;this._initialDocumentDocId=0;this._exceptionFilter=0;this._workersToIgnore=[];this._lastSourceUpdateMap=[];this._debugger=debug;this._debugger.addEventListener("onAddDocuments",e=>this.onAddDocuments(e));this._debugger.addEventListener("onRemoveDocuments",e=>this.onRemoveDocuments(e));this._debugger.addEventListener("onUpdateDocuments",e=>this.onUpdateDocuments(e));this._debugger.addEventListener("onResolveBreakpoints",e=>this.onResolveBreakpoints(e));this._debugger.addEventListener("onBreak",e=>this.onBreak(e));this._debugger.addEventListener("onDebuggerEvent",e=>this.onDebuggerEvent(e));this._debugger.addEventListener("onDomMutationBreak",e=>this.onDomMutationBreak(JSON.parse(e)));this._debugger.addEventListener("onPdmClose",()=>{this._sessionNumber++;this._isEnabled=!1;this.enableDynamicDebugging(!1,()=>{})});toolUI.addEventListener("detach",()=>{this._callHandler.detach();this._isEnabled=!1;this._sessionNumber++;this._debugger.resume(1)});toolUI.addEventListener("resumeScriptExecution",()=>{this._callHandler.notify("onResumeScriptExecution",[])});this._debugger.addEventListener("webworkerstarted",(e,t)=>{if(!e){-1===this._workersToIgnore.indexOf(t)&&this._workersToIgnore.push(t);return}const i=this.parseThreadDescription(t,e,null);this._breakOnAnyNewWorkerStarting&&(this._lastStartedWorkerId=t);for(let e=this._rootDocIdQueue.length-1;e>=0;e--){const t=this._documentMap.get(this._rootDocIdQueue[e]);t&&t.url===i.fullScriptFileName&&this._rootDocIdQueue.splice(e,1)}this._callHandler.notify("onWebWorkerStarted",[i])});this._debugger.addEventListener("webworkerfinished",e=>{const t=this._workersToIgnore.indexOf(e);if(t>=0)this._workersToIgnore.splice(t,1);else{this.removeWorkerFromWaitToBreakList(e);this._callHandler.notify("onWebWorkerFinished",[e])}});this._debugger.addEventListener("debuggingdisabled",()=>{this._isEnabled=!1});this._debugger.addEventListener("debugapplicationcreate",e=>{e||this.enableDynamicDebugging(!1,()=>{})});toolUI.addEventListener("scripterror",e=>{this._callHandler.notify("onDebuggerOMScriptError",[e.message,e.file,e.line,e.column,e.additionalInfo])})}static assertIsValidId(e,t){r.a.isTrue(e&&e.length>t.length&&e.substr(0,t.length)===t)}isAsyncMethod(e){return"enableDynamicDebugging"===e||"disableDynamicDebugging"===e}enableDynamicDebugging(e,t){if(this._isEnabled||this._isAwaitingDebuggerEnableCall)t&&t(0);else{const i=r=>{let n=r?0:1;this._debugger.removeEventListener("debuggingenabled",i);this._isAwaitingDebuggerEnableCall=!1;if(r){const t=2===(n=this._debugger.connect(!0))&&e;if(0===n||t){this._isEnabled=!0;t&&(n=0)}}t&&t(n)};this._debugger.addEventListener("debuggingenabled",i);this._isAwaitingDebuggerEnableCall=!0;this._debugger.enable()}}disableDynamicDebugging(e){this._isAwaitingDebuggerEnableCall&&e&&e(0);if(this._isEnabled){const t=i=>{this._isEnabled=!i;e&&e(i?0:1);this._debugger.removeEventListener("debuggingdisabled",t)};this._debugger.addEventListener("debuggingdisabled",t);this._debugger.disable()}else e&&e(0)}getSourceText(e,t,i){try{const r=parseInt(e,10),n=this._debugger.getSourceText(r);let s=n.text;"number"==typeof t&&t>=0&&(s="number"==typeof i&&i>=0?s.substr(t,i):s.substr(t));n.text=s;return n}catch(e){return{loadFailed:!0,text:""}}}causeBreak(e,t){let i=t;("number"!=typeof i||isNaN(i))&&(i=0);switch(e){case 0:this._breakOnAny=!0;this._isNextBreakCausedByUser=!0;break;case 1:this._breakOnAnyNewWorkerStarting=!0;break;case 2:this._breakIntoSpecificWorkerIds.push(i);break;case 3:this._breakOnAnyNewWorkerStarting=!1;this._lastStartedWorkerId=void 0;break;default:throw new Error("CauseBreakAction not known")}return this._debugger.causeBreak(e,i)}resume(e){1!==e&&(this._isNextBreakCausedByUser=!0);return this._debugger.resume(e)}getBreakpointIdFromSourceLocation(e,t){const i=parseInt(e,10),r=this._debugger.getBreakpointIdFromSourceLocation(i,t);return 0!==r?this.bpString(r):u}addEventBreakpoint(e,t,i="",r=!1){const n=this._debugger.addEventBreakpoint(e,t,i,r);return n?{breakpointId:this.bpString(n.breakpointId),condition:i,eventTypes:n.eventTypes,failed:!1,isBound:n.isBound,isEnabled:n.isEnabled,isTracepoint:r}:{breakpointId:":failed:"+e.join(","),eventTypes:e,failed:!0,isBound:!1,isEnabled:!1}}addCodeBreakpoint(e,t,i,r=!1,n=!1){const s=parseInt(e,10);if(isNaN(s)||!this._documentMap.has(s))return{breakpointId:":failed:"+e,failed:!0,isBound:!1,isEnabled:!1,location:{docId:e,start:t,length:1}};const o=this._debugger.addCodeBreakpoint(s,t,i,r);if(o){o.location.docId=String(o.location.docId);return{breakpointId:this.bpString(o.breakpointId),condition:i,failed:!1,isBound:o.isBound,isEnabled:o.isEnabled,isPseudoBreakpoint:n,isTracepoint:r,location:o.location}}return{breakpointId:":failed:"+e,failed:!0,isBound:!1,isEnabled:!1,location:{docId:e,start:t,length:1}}}addPendingBreakpoint(e){const t=this._debugger.addPendingBreakpoint(e.url,e.rawLocation.start,e.condition,e.isEnabled,e.isTracepoint);return t?this.bpString(t):""}removeBreakpoint(e){const t=this.getBpIdNumber(e);return this._debugger.removeBreakpoint(t)}setBreakpointEnabledState(e,t){const i=this.getBpIdNumber(e);return this._debugger.setBreakpointEnabledState(i,t)}setBreakpointCondition(e,t,i){const r=this.getBpIdNumber(e);return this._debugger.updateBreakpoint(r,t,i)}setExceptionFilter(e){this._exceptionFilter=e;return this._debugger.setBreakOnFirstChanceExceptions(2===e)}isDocContainingMatch(e,t){const i=new RegExp(e,"gi"),r=this.getSourceText(t).text;return i.test(r)}triggerSourceRundown(){return this._debugger.connect(!1)}getFrames(e){const t=this._debugger.getFrames(e);for(const e of t){e.callFrameId=this.frameString(e.callFrameId);e.location.docId=String(e.location.docId)}return t}getCurrentThreadDescription(){const e=this._debugger.getThreadDescription();return this.parseThreadDescription(null,null,e)}eval(e,t){let i=this._debugger.eval(this.getFrameIdNumber(e),t);i?i.propertyId=this.propString(i.propertyId):i={expandable:!1,fake:!1,fullName:"",invalid:!1,name:"",propertyId:"ERROR",readOnly:!0,returnValue:!1,type:"",value:""};return i}getLocals(e){return this.propString(this._debugger.getLocals(this.getFrameIdNumber(e)))}getChildProperties(e,t,i){const r=this._debugger.getChildProperties(this.getPropIdNumber(e),t,i),n=r.propInfos;for(const e of n)e.propertyId=this.propString(e.propertyId);return r}setPropertyValueAsString(e,t){return this._debugger.setPropertyValueAsString(this.getPropIdNumber(e),t)}setNextStatement(e,t){const i=parseInt(e,10);return this._debugger.setNextStatement(i,t)}canSetNextStatement(e,t){const i=parseInt(e,10);return this._debugger.canSetNextStatement(i,t)}getFrameIdNumber(e){h.assertIsValidId(e,h.FRAME_ID_PREFIX);return this.parseIdNumber(e)}getBpIdNumber(e){h.assertIsValidId(e,h.BREAKPOINT_ID_PREFIX);return this.parseIdNumber(e)}getPropIdNumber(e){h.assertIsValidId(e,h.PROPERTY_ID_PREFIX);return this.parseIdNumber(e)}removeWorkerFromWaitToBreakList(e){for(let t=0;t<this._breakIntoSpecificWorkerIds.length;t++)if(e===this._breakIntoSpecificWorkerIds[t]){this._breakIntoSpecificWorkerIds.splice(t,1);return!0}return!1}flushMessageQueue(e,t){if(e.length>0)switch(t){case"onAddDocuments":case"onRemoveDocuments":case"onUpdateDocuments":this._callHandler.notify(t,e);e.length=0;break;default:r.a.fail("Batching of '"+t+"' messages isn't supported.")}}onAddDocuments(e){const t=[];for(const i of e){if(i.url&&i.url.match(c)){this._initialDocumentDocId=i.docId;continue}this._documentMap.set(i.docId,{url:i.url,start:0,length:i.length});const e=i.parentDocId===this._initialDocumentDocId,r=this.getSourceText(String(i.docId)).text;let n={sourceMap:null,sourceUrl:null};"text/html"!==i.mimeType.toLowerCase()&&(n=a(r,i.isDynamicCode));const s={id:String(i.docId),isDynamicCode:i.isDynamicCode,length:i.length,longDocumentId:String(i.longDocumentId),mimeType:i.mimeType,parentId:String(i.parentDocId),sourceMapUrl:i.sourceMapUrlFromHeader||n.sourceMap,sourceUrlOverride:n.sourceUrl,url:i.url};t.push(s);if(e)if(this._documentMap.size>0){this.flushMessageQueue(t,"onAddDocuments");this._rootDocId=i.docId;this._callHandler.notify("onSetRootDocument",[String(i.docId)])}else this._rootDocIdQueue.push(i.docId)}this.flushMessageQueue(t,"onAddDocuments")}onRemoveDocuments(e){const t=[];for(const i of e){this._documentMap.delete(i);delete this._lastSourceUpdateMap[i];const e=this._rootDocIdQueue.indexOf(i);e>-1&&this._rootDocIdQueue.splice(e,1);i!==this._initialDocumentDocId&&t.push(String(i));if(i===this._rootDocId&&this._rootDocIdQueue.length>0&&this._documentMap.has(this._rootDocIdQueue[0])){this._rootDocId=this._rootDocIdQueue[0];this.flushMessageQueue(t,"onRemoveDocuments");this._rootDocId&&this._callHandler.notify("onSetRootDocument",[String(this._rootDocId)])}}this.flushMessageQueue(t,"onRemoveDocuments")}onUpdateDocuments(e){const t=[];for(const i of e){const e=i.docId,r={id:String(e),isDynamicCode:i.isDynamicCode,length:i.length,mimeType:i.mimeType,url:i.url},n=this._lastSourceUpdateMap[e];if(!n||r.length!==n.length||r.mimeType!==n.mimeType||r.url!==n.url){t.push(r);this._lastSourceUpdateMap[e]=r}}this.flushMessageQueue(t,"onUpdateDocuments")}onResolveBreakpoints(e){for(const t of e){const e={breakpointId:this.bpString(t.breakpointId),isBound:t.isBound,location:{docId:String(t.newDocId),length:t.length,start:t.start}};this._callHandler.notify("onResolveBreakpoint",[e.breakpointId,e])}}onBreak(e){if(!this._isEnabled||this._isAwaitingDebuggerEnableCall){this._debugger.resume(1);return!1}let t=!0;const i=this.getCurrentThreadDescription();if(5===e.breakReason){t=!1;if(this._breakOnAnyNewWorkerStarting&&i.id===this._lastStartedWorkerId){this._lastStartedWorkerId=void 0;t=!0}if(!t){this.removeWorkerFromWaitToBreakList(i.id)&&(t=!0)}!t&&this._isNextBreakCausedByUser&&(t=!0)}else if(6===e.breakReason){t=!1;if(this._isBreakOnNextError||2===this._exceptionFilter||1===this._exceptionFilter&&!e.isFirstChanceException){this._isBreakOnNextError=!1;t=!0}if(!e.isFirstChanceException&&!i.isWorker&&!e.isUserUnhandled){const t=this.getFrames(1);if(t&&t.length>0){const i=t[0];this._callHandler.notify("onUnhandledException",[String(i.location.docId),e.description,e.errorId,i.location.start])}}}else if(1===e.breakReason&&!(t=this._breakOnAny)&&void 0!==e.breakpoints)for(const i of e.breakpoints)this.evaluateBreakpointCondition(e.firstFrameId,i)&&(t=!0);if(t){this._breakOnAny=!1;const t=e.asyncCallStackInfo?JSON.parse(e.asyncCallStackInfo):void 0,r={asyncCallStackInfo:this.transformAsyncStacktrace(t),breakEventType:e.breakEventType,breakReason:e.breakReason,callFrames:this.getFrames(0),description:e.description,errorId:e.errorId,firstChance:e.isFirstChanceException,isUserUnhandled:e.isUserUnhandled,threadDescription:i};this._callHandler.notify("onBreak",[r])}else this._debugger.resume(1);this._isNextBreakCausedByUser=!1;return t}transformAsyncStacktrace(e){if(!e)return;const t=[];let i,r=e;for(;r;){i={description:r.description,callFrames:r.callFrames.map(e=>({callFrameId:"AsyncFrame"+this._asyncFrameId++,isInTryBlock:void 0,isAsync:!0,isInternal:void 0,isWorker:!1,functionName:e.functionName,location:{docId:String(e.scriptId),start:e.startIndex,length:e.length}}))};t.push(i);r=r.parent}return t}onDebuggerEvent(e){this._callHandler.notify("onDebuggerEvent",[e.messageType,e.message,e.url])}onDomMutationBreak(e){this._callHandler.notify("onDomMutationBreak",[e])}evaluateBreakpointCondition(e,t){if(!t)return!1;if(t.isTracepoint){const i=this._debugger.eval(e,"console.log("+t.condition+");");"Error"===i.type&&this._debugger.eval(e,'console.log("'+i.value+'");');return!1}if(!t.condition)return!0;const i=this._debugger.eval(e,t.condition);return!("Undefined"===i.type&&"undefined"===i.value||"Null"===i.type&&"null"===i.value||"Number"===i.type&&"0"===i.value||"String"===i.type&&('""'===i.value||"''"===i.value)||"Boolean"===i.type&&"false"===i.value)}parseThreadDescription(e,t,i){const n={description:"",displayName:"",fullScriptFileName:"",htmlFileName:"",id:0,isWorker:!1,label:"",poundLabel:"",scriptFileName:""};null!==e&&e>=1&&(n.id=e);if(null!==t){n.label=t;const e=t.split("\r\n");r.a.areEqual(e.length,3);if(3===e.length){n.poundLabel=e[0];const t=e[1].split("/");n.fullScriptFileName=e[1];n.scriptFileName=t[t.length-1];const i=e[2].split("/");n.htmlFileName=i[i.length-1];n.isWorker=!0;n.displayName="[Worker"+n.poundLabel+" "+n.scriptFileName+" ("+n.htmlFileName+")]"}}if(null!==i){n.description=i;if(/^([0-9]+)##/gi.test(i)){n.id=parseInt(i.split("##")[0],10);const e=i.split("/");n.scriptFileName=e[e.length-1];n.isWorker=!0;n.displayName="Worker-"+n.id+" "+n.scriptFileName}}return n}parseIdNumber(e){const t=e.indexOf("_");r.a.isTrue(t>=3&&t<e.length-1,"Malformed id string detected");return parseInt(e.substr(t+1,10),10)}frameString(e){return h.FRAME_ID_PREFIX+this._sessionNumber+"_"+e}bpString(e){return h.BREAKPOINT_ID_PREFIX+this._sessionNumber+"_"+e}propString(e){return h.PROPERTY_ID_PREFIX+this._sessionNumber+"_"+e}}h.BREAKPOINT_ID_PREFIX="BKP";h.FRAME_ID_PREFIX="FRM";h.PROPERTY_ID_PREFIX="PRP";i.d(t,"default",function(){return g});i.d(t,"remoteDebugger",function(){return p});class g{constructor(){this._port=toolUI.createPort("debuggerPort");toolUI.connect(this._port);this._rpc=new n.a("SERVER",(e,t,i)=>this.jsonRpcMethodReceive(e,t,i),(e,t)=>this.jsonRpcNotificationReceive(e,t),e=>{this.postMessage(e)},e=>{this._port.addEventListener("message",t=>{e(t)})});this._dbg=new h(this)}methodCall(e,t,i,r){this._rpc.jsonRpcMethodCall(e,t,i,r)}notify(e,t){this._rpc.jsonRpcNotification(e,t)}detach(){this._rpc.jsonRpcMethodCall=(()=>!1);this._rpc.jsonRpcNotification=(()=>{});this.postMessage=(()=>!1)}postMessage(e){return this._port.postMessage(e)}jsonRpcMethodReceive(e,t,i){r.a.hasValue(this._dbg,"Method received when debugger not attached.");let n,s=t,o=!1;if(this._dbg.isAsyncMethod(e)){(s=s||[]).push(i);o=!0}n=s?this._dbg[e].apply(this._dbg,s):this._dbg[e].apply(this._dbg);o||i(n,void 0)}jsonRpcNotificationReceive(e,t){}}const p=new g}]);
