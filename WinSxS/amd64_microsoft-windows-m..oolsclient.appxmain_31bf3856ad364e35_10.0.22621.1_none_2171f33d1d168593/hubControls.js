!function(e){!function(e){!function(e){"use strict";var t=function(){function e(){this._eventListeners=[]}e.prototype.invokeEvent=function(e){this._eventListeners.forEach(function(t){return t(e)})};e.prototype.addEventListener=function(e){this._eventListeners.push(e)};e.prototype.removeEventListener=function(e){var t=this._eventListeners.indexOf(e);t>-1&&this._eventListeners.splice(t,1)};e.prototype.dispose=function(){this._eventListeners=null};return e}();e.AggregatedEvent=t}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){"use strict";!function(e){var t=function(){function e(){}e.isUndefined=function(e,t){};e.isNotUndefined=function(e,t){};e.isNull=function(e,t){};e.isNotNull=function(e,t){};e.isTrue=function(e,t){};e.isFalse=function(e,t){};e.fail=function(e){};e.isDebugBuild=function(){return!1};return e}();e.Assert=t}(e.Debug||(e.Debug={}));e.Debug}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){"use strict";var t=function(){function e(e){this._postFilters={};this._preFilters={};this._alertFilters={};this._confirmationFilters={};this._logger=e}e.prototype.getAutomationPromise=function(e,t,i,n){var o=this,r=this._postFilters[e],s=this._preFilters[e],a=null;if(s){a=this.getPreFilterPromise(s,n);a=r?a.then(function(){return o.getPostFilterPromise(r,t,i,n)},function(e){o._logger.error("Error '"+JSON.stringify(e)+"' while executing pre-filter'")}):a.then(function(){return new Promise(function(e,i){t(e,i)})},function(e){o._logger.error("Error '"+JSON.stringify(e)+"' while executing pre-filter'")})}else a=r?this.getPostFilterPromise(r,t,i,n):new Promise(function(e,i){t(e,i)});return a};e.prototype.getAlertPromise=function(e,t){var i=this._alertFilters[e];return i?i.bypass(t):new Promise(function(e,i,n){window.alert(t);e(!0)})};e.prototype.getConfirmationPromise=function(e,t){var i=this._confirmationFilters[e];return i?i.bypass(t):new Promise(function(e,i,n){e(window.confirm(t))})};e.prototype.addAutomationPostFilter=function(e,t){this.addAutomationFilter(this._postFilters,e,"IAutomationPostFilter",t)};e.prototype.removeAutomationPostFilter=function(e){this.removeAutomationFilter(this._postFilters,e,"IAutomationPostFilter")};e.prototype.addAutomationPreFilter=function(e,t){this.addAutomationFilter(this._preFilters,e,"IAutomationPreFilter",t)};e.prototype.removeAutomationPreFilter=function(e){this.removeAutomationFilter(this._preFilters,e,"IAutomationPreFilter")};e.prototype.addAutomationAlertBypassFilter=function(e,t){this.addAutomationFilter(this._alertFilters,e,"IAutomationAlertBypassFilter",t)};e.prototype.removeIAutomationAlertBypassFilter=function(e){this.removeAutomationFilter(this._alertFilters,e,"IAutomationAlertBypassFilter")};e.prototype.addAutomationConfirmationBypassFilter=function(e,t){this.addAutomationFilter(this._confirmationFilters,e,"IAutomationConfirmationBypassFilter",t)};e.prototype.removeAutomationConfirmationBypassFilter=function(e){this.removeAutomationFilter(this._confirmationFilters,e,"IAutomationConfirmationBypassFilter")};e.prototype.getPreFilterPromise=function(e,t){if(e)return e.onFilter(t);throw"Pre-filter is null or undefined"};e.prototype.removeAutomationFilter=function(e,t,i){if(!t)throw new Error("key is null, undefined or evaluates to false");if(!e)throw new Error("key is null, undefined or evaluates to false");if(!i)throw new Error("automationFilterType is null, undefined or evaluates to false");delete e[t];this._logger.debug(i+" with key '"+t+"' has been removed")};e.prototype.addAutomationFilter=function(e,t,i,n){if(!e)throw new Error("Invalid filterStore");if(!n)throw new Error("Invalid filter");if(!t)throw new Error("Invalid automation key");if(!i)throw new Error("Invalid automation filter type");e[t]&&this._logger.debug("Replacing existing "+i+" with key '"+t+"'");e[t]=n;this._logger.debug(i+" with key '"+t+"' has been added")};e.prototype.getPostFilterPromise=function(e,t,i,n){var o=this;return new Promise(function(i,r){t(function(t){return e.onComplete(t,n).then(function(){i(t)},function(){o._logger.error("Error occured during execution of post-filter onComplete handler")})},function(t){return e.onError(t,n).then(function(){r(t)},function(){o._logger.error("Error occured during execution of post-filter onError handler")})},function(e){},n)},i)};return e}(),i=function(){function e(){}e.SearchNoResultsAlertKey="Microsoft.VisualStudio.DiagnosticsHub.CpuUsageTreeGrid.Search";e.SearchNoResultsConfirmationKey="Microsoft.VisualStudio.DiagnosticsHub.CpuUsageTreeGrid.Search";e.DataWarehouseRequestKey="Microsoft.VisualStudio.DiagnosticsHub.DatawarehouseRequest";return e}();e.AutomationConstants=i;var n=null;function o(e){null===n&&(n=new t(e));return n}e.getAutomationManager=o}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function t(t,i){this._isHighNegative=!1;this._isLowNegative=!1;if(!("number"==typeof t&&t<4294967296&&t>=-2147483648&&"number"==typeof i&&i<4294967296&&i>=-2147483648))throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.1000"));if(t<0){t>>>=0;this._isHighNegative=!0}if(i<0){i>>>=0;this._isLowNegative=!0}this._value={h:t,l:i}}Object.defineProperty(t,"oldest",{get:function(){return t.OldestTimestampFormat},enumerable:!0,configurable:!0});Object.defineProperty(t,"latest",{get:function(){return t.LatestTimestampFormat},enumerable:!0,configurable:!0});Object.defineProperty(t,"zero",{get:function(){t.Zero||(t.Zero=new t(0,0));return t.Zero},enumerable:!0,configurable:!0});Object.defineProperty(t,"one",{get:function(){t.One||(t.One=new t(0,1));return t.One},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"jsonValue",{get:function(){if(!this._jsonValue){var e=this._value.h;(this._isHighNegative||e>2147483647)&&(e<<=0);var t=this._value.l;(this._isLowNegative||t>2147483647)&&(t<<=0);this._jsonValue={h:e,l:t}}return this._jsonValue},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"value",{get:function(){this._stringValue||(this._value.h>0?this._stringValue="0x"+this._value.h.toString(16)+t.padLeadingZeros(this._value.l.toString(16),8):this._stringValue="0x"+this._value.l.toString(16));return this._stringValue},enumerable:!0,configurable:!0});t.max=function(e,t){return e.greaterOrEqual(t)?e:t};t.min=function(e,t){return e.greaterOrEqual(t)?t:e};t.add=function(e,i){return t.addition(e,i)};t.subtract=function(e,i){if(i.greater(e))return t.zero;var n=t.convertToManagedTimeFormat(i.jsonValue),o=~n.h,r=~n.l,s=t.addition(new t(o,r),t.one,!0);return t.addition(e,s,!0)};t.multiply=function(e,i){return t.multiplication(e,i)};t.divide=function(e,i){return t.division(e,i,!1)};t.modulo=function(e,i){return t.division(e,i,!0)};t.addNumber=function(e,i){return i<0?t.subtract(e,t.convertFromNumber(-i)):t.addition(e,t.convertFromNumber(i))};t.subtractNumber=function(e,i){return i<0?t.addition(e,t.convertFromNumber(-i)):t.subtract(e,t.convertFromNumber(i))};t.multiplyNumber=function(i,n){if(n<0)throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.1000"));return t.multiply(i,t.convertFromNumber(n))};t.divideNumber=function(i,n){if(n<0)throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.1000"));return t.divide(i,t.convertFromNumber(n))};t.moduloNumber=function(i,n){if(n<0)throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.1000"));return t.modulo(i,t.convertFromNumber(n))};t.convertFromNumber=function(i){if(i<0||!(i<9007199254740992))throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.1000"));var n=4294967295&(i=Math.floor(i));if(i<=4294967295)return new t(0,n);var o=i.toString(16);o=o.substring(0,o.length-8);return new t(parseInt(o,16),n)};t.convertFromBinaryString=function(i){if(!i||i.match("[^10]")||i.length>64)throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.1000 "+i));var n=0,o=0;if(i.length<=32)o=parseInt(i,2);else{o=parseInt(i.slice(i.length-32),2);n=parseInt(i.slice(0,i.length-32),2)}return new t(n,o)};t.getBinaryString=function(t){var i=t._value.l.toString(2);return t._value.h>0?t._value.h.toString(2)+e.VisualStudio.DiagnosticsHub.BigNumber.padLeadingZeros(i,32):i};t.padLeadingZeros=function(e,t){var i=e,n="00000000";if(i&&t&&t>0){for(;t-i.length>=8;)i=n+i;i=n.substr(0,t-i.length)+i}return i};t.prototype.equals=function(e){var i=t.convertToManagedTimeFormat(e.jsonValue);return this._value.h===i.h&&this._value.l===i.l};t.prototype.greater=function(e){var i=!1,n=t.convertToManagedTimeFormat(e.jsonValue);this._value.h>n.h?i=!0:this._value.h===n.h&&this._value.l>n.l&&(i=!0);return i};t.prototype.greaterOrEqual=function(e){var i=!1,n=t.convertToManagedTimeFormat(e.jsonValue);this._value.h>n.h?i=!0:this._value.h===n.h&&this._value.l>=n.l&&(i=!0);return i};t.prototype.compareTo=function(e){return this.greater(e)?1:this.equals(e)?0:-1};t.convertToManagedTimeFormat=function(e){return{h:e.h<0?e.h>>>0:e.h,l:e.l<0?e.l>>>0:e.l}};t.addition=function(i,n,o){void 0===o&&(o=!1);var r=t.convertToManagedTimeFormat(i.jsonValue),s=t.convertToManagedTimeFormat(n.jsonValue),a=(255&r.l)+(255&s.l),u=(a>>>8)+(r.l>>>8&255)+(s.l>>>8&255);a&=255;var l=(u>>>8)+(r.l>>>16&255)+(s.l>>>16&255);u&=255;var c=(l>>>8)+(r.l>>>24&255)+(s.l>>>24&255);l&=255;var h=(c>>>8)+(255&r.h)+(255&s.h);c&=255;var d=(h>>>8)+(r.h>>>8&255)+(s.h>>>8&255);h&=255;var g=(d>>>8)+(r.h>>>16&255)+(s.h>>>16&255);d&=255;var m=(g>>>8)+(r.h>>>24&255)+(s.h>>>24&255);g&=255;if(!o&&m>>>8>0){e.VisualStudio.DiagnosticsHub.getLogger().error("Addition overflow. Lost upper bits from: 0x"+m.toString(16));return new t(4294967295,4294967295)}return new t(((m&=255)<<8|g)<<16|(d<<8|h),(c<<8|l)<<16|(u<<8|a))};t.multiplication=function(i,n){var o=t.convertToManagedTimeFormat(i.jsonValue),r=t.convertToManagedTimeFormat(n.jsonValue);if(0===o.h&&0===r.h&&0<o.l&&o.l<=67108864&&0<r.l&&r.l<=67108864){var s=o.l*r.l;return t.convertFromNumber(s)}var a=65535&o.l,u=o.l>>>16,l=65535&o.h,c=o.h>>>16,h=65535&r.l,d=r.l>>>16,g=65535&r.h,m=r.h>>>16,p=a*h,f=p>>>16;p&=65535;var _=(f+=u*h)>>>16;f&=65535;_+=(f+=a*d)>>>16;f&=65535;var b=(_+=l*h)>>>16;_&=65535;b+=(_+=u*d)>>>16;_&=65535;b+=(_+=a*g)>>>16;_&=65535;(b+=c*h+l*d+u*g+a*m)>65535&&e.VisualStudio.DiagnosticsHub.getLogger().error("Multiplication overflow. Lost upper 16-bits from: 0x"+b.toString(16));return new t((b&=65535)<<16|_,f<<16|p)};t.division=function(i,n,o){if(n.greater(i))return o?i:t.zero;if(n.equals(t.zero)){if(o)return i;throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.1000"))}var r=t.getBinaryString(i),s=t.getBinaryString(n).length,a=r.length;if(new t(2097152,0).greater(i)){var u=parseInt(i.value),l=parseInt(n.value);return o?t.convertFromNumber(u%l):t.convertFromNumber(u/l)}for(var c="",h=s,d=t.convertFromBinaryString(r.substr(0,s));h<=a;){if(d.greater(n)||d.equals(n)){c+="1";d=t.subtract(d,n)}else c+="0";h!==a&&(d=t.convertFromBinaryString(t.getBinaryString(d)+r[h]));h++}return o?d:t.convertFromBinaryString(c)};t.OldestTimestampFormat={h:0,l:0};t.LatestTimestampFormat={h:4294967295,l:4294967295};return t}();t.BigNumber=i;var n=function(){function t(t,i){if(t.greater(i))throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.1000"));this._begin=t;this._end=i}Object.defineProperty(t.prototype,"begin",{get:function(){return this._begin},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"end",{get:function(){return this._end},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"elapsed",{get:function(){this._elapsed||(this._elapsed=i.subtract(this.end,this.begin));return this._elapsed},enumerable:!0,configurable:!0});t.prototype.equals=function(e){return this.begin.equals(e.begin)&&this.end.equals(e.end)};t.prototype.contains=function(e){return e.greaterOrEqual(this.begin)&&this.end.greaterOrEqual(e)};return t}();t.JsonTimespan=n}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){!function(e){"use strict";var t=function(){function e(){}return e}();e.DhContextData=t}(e.DataWarehouse||(e.DataWarehouse={}));e.DataWarehouse}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function t(){var t=this;this._isInfoOn=!0;this._isDebugOn=!0;this._isWarningOn=!0;this._isErrorOn=!0;this._loggerProxy=e.Plugin.Utilities.JSONMarshaler.attachToPublishedObject("Microsoft.DiagnosticsHub.VisualStudio.Presentation.JavaScriptModels.LoggerPortMarshaler",{},!0);this._loggerProxy._call("isInfoOn").then(function(e){t._isInfoOn=e});this._loggerProxy._call("isDebugOn").then(function(e){t._isDebugOn=e});this._loggerProxy._call("isWarningOn").then(function(e){t._isWarningOn=e});this._loggerProxy._call("isErrorOn").then(function(e){t._isErrorOn=e});try{var i=e.Plugin.Utilities.JSONMarshaler.attachToPublishedObject("Microsoft.Test.Apex.DiagnosticsHub.ApexJSExtension",{},!0);null!==i?i._call("getApexJavaScript").then(function(e){if(e){t.debug("got apex javascript files");var i=document.createElement("script");i.setAttribute("type","text/javascript");i.setAttribute("src",e);var n=document.getElementsByTagName("head");if(n){n[0].appendChild(i);t.debug("Added ApexJSExtension '"+e+"' to document")}else t.debug("Unable to add apex script to document")}else t.debug("no file was returned by getApexJavaScript, cannot inject TestExtension.ts for ApexJS framework")},function(e){t.debug("Error when calling getApexJavaScript function:"+String(e))}):this.debug("Unable to connect to port marshaler 'Microsoft.Test.Apex.DiagnosticsHub.ApexJSExtension'")}catch(e){this.error(e.toString())}}t.prototype.info=function(e){this._isInfoOn&&this._loggerProxy._call("logInfo",e)};t.prototype.debug=function(e){this._isDebugOn&&this._loggerProxy._call("logDebug",e)};t.prototype.warning=function(e){this._isWarningOn&&this._loggerProxy._call("logWarning",e)};t.prototype.error=function(e){this._isErrorOn&&this._loggerProxy._call("logError",e)};return t}(),n=null;function o(){null===n&&(n=new i);return n}t.getLogger=o;window.addEventListener("load",function(){o()})}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";function i(){window.onerror=function(i,n,o,r,s){var a=t.getLogger(),u="Script error caught in: "+(n||"unknown script file")+" at "+o+"\n"+i;a.error(u);e.VisualStudio.DiagnosticsHub.Debug.Assert.fail(u);e.Plugin.Diagnostics.reportError(i,n,o,i,r);e.Plugin.Diagnostics.terminate()}}t.InitializeErrorReporting=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){"use strict";function t(e,t){var i=!1,n=!1,o=null,r=function(){for(var s=[],a=0;a<arguments.length-0;a++)s[a]=arguments[a+0];o=s;if(i)n=!0;else{e.apply(null,s);i=!0;window.setTimeout(function(){i=!1;n&&window.setTimeout(r,0,o);n=!1},t)}};return r}e.eventThrottler=t}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function e(e){this._onHandlerCompleted=e}e.prototype.complete=function(){this._onHandlerCompleted()};return e}(),n=function(){function e(e,t){this._eventArgs=e;this._waitHandler=!1;this._onHandlerCompleted=t;this._eventDeferral=null}Object.defineProperty(e.prototype,"currentState",{get:function(){return this._eventArgs.CurrentState},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"previousState",{get:function(){return this._eventArgs.PreviousState},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"waitHandler",{get:function(){return null!==this._eventDeferral},enumerable:!0,configurable:!0});e.prototype.getDeferral=function(){null===this._eventDeferral&&(this._eventDeferral=new i(this._onHandlerCompleted));return this._eventDeferral};return e}(),o=function(){function t(t){var i=this;this._eventsListeners=new Array;this._logger=t;this._isInitialized=!1;this._sessionProxy=e.Plugin.Utilities.JSONMarshaler.attachToPublishedObject("Microsoft.DiagnosticsHub.VisualStudio.Presentation.JavaScriptModels.SessionPortMarshaler",{},!0);this._initializationPromise=this._sessionProxy._call("initialize");this._initializationPromise.then(function(){i._logger.debug("JavaScript session object connected to host. Ready to get session state notification events.");i._isInitialized=!0},function(e){i._logger.error("Cannot initialize session, error name: '"+e.name+"', error message: '"+e.message+"'")});this._sessionProxy.addEventListener("sessionStateChanged",this.stateChangedHandler.bind(this))}t.prototype.stopCollection=function(){return this._sessionProxy._call("stopCollection")};t.prototype.canStopCollection=function(){return this._sessionProxy._call("canStopCollection")};t.prototype.getPerformanceDebuggerSessionTargetProcessInformation=function(){return this._sessionProxy._call("getPerformanceDebuggerSessionTargetProcessInformation")};t.prototype.getState=function(){return this._sessionProxy._call("getState")};t.prototype.addStateChangedEventListener=function(e){this._eventsListeners.push(e);this._logger.debug("State changed event handler added.")};t.prototype.isInitialized=function(){return this._isInitialized};t.prototype.removeStateChangedEventListener=function(e){for(var t=0;t<this._eventsListeners.length;t++)if(this._eventsListeners[t]===e){this._logger.debug("State changed event handler removed.");this._eventsListeners.splice(t,1);break}};t.prototype.stateChangedHandler=function(e){var t=this;this._logger.debug("Invoking JavaScript handlers for State Change Event.");var i=0,o=function(){--i<=0?t._sessionProxy._call("sessionStateChangedCompleted",e.Token):t._logger.debug("Still waiting when all event state change handlers will complete their work. Handlers count: "+i)};for(var r in this._eventsListeners){var s=this._eventsListeners[r];if(this._eventsListeners.hasOwnProperty(r))if("function"==typeof s)try{var a=new n(e,o);s(a);if(a.waitHandler){i++;this._logger.debug("JavaScipt handlers for event state changed asked to wait while they will finish. Handlers count: "+i)}}catch(e){this._logger.error(e.toString())}else this._logger.warning("One of the listeners not a 'function', it has type "+typeof s)}0===i&&o()};return t}(),r=null;function s(){null===r&&(r=new o(t.getLogger()));return r}t.getCurrentSession=s;window.addEventListener("load",function(){s()})}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){!function(i){"use strict";var n=function(){function i(){this._serviceProxy=e.Plugin.Utilities.JSONMarshaler.attachToPublishedObject("Microsoft.DiagnosticsHub.VisualStudio.Presentation.JavaScriptModels.DataWarehouseServiceMarshaler",{},!0);this._logger=t.getLogger()}i.prototype.getAllDataSourceInfos=function(e){var t=this;this._serviceProxy._call("getAllDataSourceInfos").then(function(i){for(var n=[],o=0;o<i.length;o++){var r=i[o];1===r.type||2===r.type||4===r.type?n.push(r):t._logger.error("Unknown data source info type: "+r.type)}e(n)})};return i}(),o=null;function r(){null===o&&(o=new n);return o}i.getDataWarehouseService=r;window.addEventListener("load",function(){r()})}(t.DataWarehouse||(t.DataWarehouse={}));t.DataWarehouse}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){"use strict";var t=function(){function e(e){void 0===e&&(e=null);this._events={};this._listeners={};if(e&&e.length>0)for(var t=0;t<e.length;t++){var i=e[t];i&&(this._events[i]=i)}else this._events=null}e.prototype.dispose=function(){delete this._events;delete this._listeners};e.prototype.addEventListener=function(e,t){if(e&&t&&(null===this._events||this._events[e])){(this._listeners[e]?this._listeners[e]:this._listeners[e]=[]).push(t)}};e.prototype.removeEventListener=function(e,t){if(e&&t&&(null===this._events||this._events[e])){var i=this._listeners[e];if(i){for(var n=0;n<i.length;n++)if(t===i[n]){i.splice(n,1);break}0===i.length&&delete this._listeners[e]}}};e.prototype.invokeListener=function(e,t){if(e&&(null===this._events||this._events[e])){var i=this._listeners[e];if(i)for(var n=0;n<i.length;n++){var o=i[n];o&&o(t)}}};return e}();e.Publisher=t}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";!function(){function i(i){var n=this;this._eventsListeners={};this._publisher=new t.Publisher;this._logger=i;this._eventAggregatorProxy=e.Plugin.Utilities.JSONMarshaler.attachToPublishedObject("Microsoft.DiagnosticsHub.VisualStudio.Presentation.JavaScriptModels.EventAggregatorMarshaler",{},!0);this._eventAggregatorProxy.addEventListener("globalEventHandler",function(e){n.globalEventHandler(e)})}i.prototype.addEventListener=function(e,t){this._publisher.addEventListener(e,t);this._logger.debug("EventAggregator:: Event listener added for event type '"+e+"'")};i.prototype.removeEventListener=function(e,t){this._publisher.removeEventListener(e,t);this._logger.debug("EventAggregator:: Event listener removed for event type '"+e+"'")};i.prototype.globalEventHandler=function(e){var t=e.EventType;this._logger.debug("EventAggregator:: Handling event type "+t+".");var i=e.Data.Json;this._logger.debug("EventAggregator:: Raise handler for event type "+t+" with data "+i+".");try{var n=null;null!==i&&"string"==typeof i&&""!==i&&(n=JSON.parse(i));this._publisher.invokeListener(t,n)}catch(e){this._logger.error(e.toString())}};i.prototype.raiseEvent=function(e,t){var i=null;null!==t&&void 0!==t&&(i=JSON.stringify(t));this._logger.debug("EventAggregator:: Raising event type "+e+" with data "+i+".");this._eventAggregatorProxy._call("raiseEvent",e,i)}}();var i=function(){function e(){this._publisher=new t.Publisher}e.prototype.addEventListener=function(e,t){this._publisher.addEventListener(e,t)};e.prototype.removeEventListener=function(e,t){this._publisher.removeEventListener(e,t)};e.prototype.raiseEvent=function(e,t){this._publisher.invokeListener(e,t)};return e}();t.LocalEventAggregator=i;var n=null;function o(){null===n&&(n=new i);return n}t.getEventAggregator=o;window.addEventListener("load",function(){o()})}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){"use strict";var t=function(){function t(){this._logger=e.getLogger();this._controllers={};this._requestId=1;this._requestProgressCallbacks={};this._automationManager=e.getAutomationManager(this._logger);this._serviceHubClient=require("serviceHub").createHubClient()}t.prototype.request=function(i,n,o,r){(r=r||{}).sessionId=o;var s,a=this.getController(i),u=function(i,o,u){var l=function(n,r){a.request(n,r).then(function(r){if(r.type===t.DATAWAREHOUSE_HOST_RESPONSE_TYPE_SUCCESS)i(JSON.parse(r.content));else if(r.type===t.DATAWAREHOUSE_HOST_RESPONSE_TYPE_PENDING){n!==e.DataWarehouse.Constants.ACTION_DATAWAREHOUSE_GETSTATUS?s=r.content:u&&u(JSON.parse(r.content));l(e.DataWarehouse.Constants.ACTION_DATAWAREHOUSE_GETSTATUS,s)}else if(r.type===t.DATAWAREHOUSE_HOST_RESPONSE_TYPE_CANCELED)o&&o(new Error("Canceled"));else{if(r.type!==t.DATAWAREHOUSE_HOST_RESPONSE_TYPE_FAILURE)throw new Error("Invalid response from DataWarehouse");var a=new Error(r.content);if(!o)throw a;o(a)}})};l(n,JSON.stringify(r))},l=function(){s&&a.request(e.DataWarehouse.Constants.ACTION_DATAWAREHOUSE_CANCELTASK,s)},c={controllerId:i,actionId:n,sessionId:o,request:r};return this._automationManager.getAutomationPromise(e.AutomationConstants.DataWarehouseRequestKey,u,l,c)};t.prototype.requestSync=function(e,t,i,n){throw new Error("Not Implemented.")};t.prototype.initialize=function(){var t=this,i=[];i.push(this._serviceHubClient.getSessionId().then(function(e){t._hostSessionId=e}));i.push(e.DataWarehouseController.create(this._serviceHubClient).then(function(i){t._controllers[e.DataWarehouse.Constants.CONTROLLER_ID_DATAWAREHOUSE]=i}));i.push(e.ContextServiceController.create(this._serviceHubClient).then(function(i){t._controllers[e.DataWarehouse.Constants.CONTROLLER_ID_DATAWAREHOUSECONTEXTSERVICE]=i}));i.push(e.ContextController.create(this._serviceHubClient).then(function(i){t._controllers[e.DataWarehouse.Constants.CONTROLLER_ID_DATAWAREHOUSECONTEXT]=i}));i.push(e.JmcServiceController.create(this._serviceHubClient).then(function(i){t._controllers[e.DataWarehouse.Constants.CONTROLLER_ID_DATAWAREHOUSEJMCSERVICE]=i}));i.push(e.ActiveCollectionController.create(this._serviceHubClient).then(function(i){t._controllers[e.DataWarehouse.Constants.CONTROLLER_ID_DATAWAREHOUSEACTIVECOLLECTION]=i}));return Promise.all(i)};t.prototype.getController=function(e){if(!this._controllers[e])throw new Error("Invalid controller ID");return this._controllers[e]};t.DATAWAREHOUSE_HOST_RESPONSE_TYPE_SUCCESS=1;t.DATAWAREHOUSE_HOST_RESPONSE_TYPE_FAILURE=2;t.DATAWAREHOUSE_HOST_RESPONSE_TYPE_PENDING=3;t.DATAWAREHOUSE_HOST_RESPONSE_TYPE_CANCELED=4;return t}();e.DataWarehouseServiceHubHost=t}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function t(i){38===i.length&&"{"===i[0]&&"}"===i[37]&&(i=i.substr(1,36));if(36!==i.length)throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.1010"));this._value=i.toLowerCase();if(!t.GuidRegEx.test(this._value))throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.1010"))}Object.defineProperty(t,"empty",{get:function(){return new t("00000000-0000-0000-0000-000000000000")},enumerable:!0,configurable:!0});t.newGuid=function(){return new t(t.createRandomToken())};t.prototype.equals=function(e){return this._value.toLowerCase()===e._value.toLowerCase()};t.prototype.toString=function(){return this._value};t.createRandomToken=function(){return"rrrrrrrr-rrrr-4rrr-srrr-rrrrrrrrrrrr".replace(/[rs]/g,function(e){var t=16*Math.random()|0;"r"!==e&&(t=3&t|8);return t.toString(16)})};t.GuidRegEx=new RegExp("^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$");return t}();t.Guid=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){"use strict";var t=function(){function e(){}Object.defineProperty(e,"standardCollectorClassId",{get:function(){return"44d04ed9-f786-458c-93a9-7207a3cc52e1"},enumerable:!0,configurable:!0});return e}();e.Guids=t}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function t(){this._loggerProxy=e.Plugin.Utilities.JSONMarshaler.attachToPublishedObject("Microsoft.DiagnosticsHub.VisualStudio.Presentation.JavaScriptModels.OutputWindowServiceMarshaler",{},!0)}t.prototype.outputLine=function(e){this._loggerProxy._call("outputLine",e)};t.prototype.outputLineAndShow=function(e){this._loggerProxy._call("outputLineAndShow",e)};t.prototype.outputString=function(e){this._loggerProxy._call("outputString",e)};t.prototype.outputStringAndShow=function(e){this._loggerProxy._call("outputStringAndShow",e)};return t}(),n=null;function o(){null===n&&(n=new i);return n}t.getOutputWindowsService=o;window.addEventListener("load",function(){o()})}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i,n=function(){function i(){this._proxy=e.Plugin.Utilities.JSONMarshaler.attachToPublishedObject("Microsoft.DiagnosticsHub.VisualStudio.Presentation.JavaScriptModels.PerformanceDebuggerToolsServiceMarshaler",{},!0);this._toolStateChangedEvent=new t.ObservableEvent(this._proxy,"DiagnosticsHub.ToolStateChangedEvent")}Object.defineProperty(i.prototype,"toolStateChangedEvent",{get:function(){return this._toolStateChangedEvent},enumerable:!0,configurable:!0});i.prototype.getAvailableToolsInformationAndState=function(){return this._proxy._call("getAvailableToolsInformation")};i.prototype.setToolEnabled=function(e,t){this._proxy._call("setToolEnabled",e,t)};i.prototype.invokeSettingsDialog=function(){this._proxy._call("invokeSettingsDialog")};return i}();t.PerformanceDebuggerToolsService=n;function o(){i||(i=new n);return i}t.getPerformanceDebuggerToolsService=o}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function e(e,t){this._eventName=t;this._eventSource=e}e.prototype.addEventListener=function(e){this._eventSource.addEventListener(this._eventName,e)};e.prototype.removeEventListener=function(e){this._eventSource.removeEventListener(this._eventName,e)};return e}();t.ObservableEvent=i;var n=function(){function e(){this._proxy=c();this._debugModeBreak=new i(this._proxy,"DebugModeBreakEvent");this._debugModeRun=new i(this._proxy,"DebugModeRunEvent")}Object.defineProperty(e.prototype,"debugModeRunEvent",{get:function(){return this._debugModeRun},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"debugModeBreakEvent",{get:function(){return this._debugModeBreak},enumerable:!0,configurable:!0});e.prototype.isDebuggerInBreakMode=function(){return this._proxy._call("isDebuggerInBreakMode")};return e}(),o=function(){function e(){this._proxy=c();this._statusMessageChanged=new i(this._proxy,"StatusMessageChangedEvent")}Object.defineProperty(e.prototype,"statusMessageChangedEvent",{get:function(){return this._statusMessageChanged},enumerable:!0,configurable:!0});e.prototype.getLastNonActiveStatusMessage=function(){return this._proxy._call("getLastNonActiveStatusMessage")};e.prototype.isDocumentActiveSession=function(){return this._proxy._call("isDocumentActiveSession")};return e}(),r=null;function s(){null===r&&(r=new n);return r}t.getPerformanceDebuggerEventManager=s;var a=null;function u(){null===a&&(a=new o);return a}t.getPerformanceDebuggerStateService=u;var l=null;function c(){null===l&&(l=e.Plugin.Utilities.JSONMarshaler.attachToPublishedObject("Microsoft.DiagnosticsHub.VisualStudio.Presentation.JavaScriptModels.PerformanceDebuggerStateMarshaler",{},!0));return l}}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));var __extends=this.__extends||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);function n(){this.constructor=e}n.prototype=t.prototype;e.prototype=new n};!function(e){!function(e){!function(e){"use strict";var t=function(){function t(e,t){this._peer=require("streamJsonRpc").attach(e);this._actionIdToOperationMap=t}t.prototype.request=function(t,i){e.Debug.Assert.isNotUndefined(this._actionIdToOperationMap[t],"Unknown action ID");return this._peer.request(this._actionIdToOperationMap[t],[i])};return t}();e.ServiceHubControllerBase=t;var i=function(e){__extends(t,e);function t(){e.apply(this,arguments)}t.create=function(e){return e.requestService("DataWarehouseController").then(function(e){return new t(e,t.ActionIdToOperationMap)})};t.ActionIdToOperationMap={1:"BeginInitialization",2:"EndInitialization",3:"GetData",4:"GetResult",5:"DisposeResult",6:"PushDataSources",7:"PushActiveCollectionDataSource",8:"CompleteActiveCollectionDataSource",9:"RetrieveDataBlob",10:"StoreDataBlob",11:"DeleteDataBlob",12:"SymbolResolverConfigurationUpdate",400:"Close",401:"GetPrivateData",402:"SetPrivateData",403:"GetStatus",404:"CancelTask",405:"AbortAnalysis"};return t}(t);e.DataWarehouseController=i;var n=function(e){__extends(t,e);function t(){e.apply(this,arguments)}t.create=function(e){return e.requestService("DataWarehouseContextServiceController").then(function(e){return new t(e,t.ActionIdToOperationMap)})};t.ActionIdToOperationMap={1:"CreateContext",2:"DeleteContext",3:"CopyContext",4:"GetContext",5:"GetGlobalContext"};return t}(t);e.ContextServiceController=n;var o=function(e){__extends(t,e);function t(){e.apply(this,arguments)}t.create=function(e){return e.requestService("DataWarehouseContextController").then(function(e){return new t(e,t.ActionIdToOperationMap)})};t.ActionIdToOperationMap={1:"GetTimeDomain",2:"SetTimeDomain",3:"GetMachineDomain",4:"AddMachineDomain",5:"ClearMachineDomain",6:"GetProcessDomain",7:"AddProcessDomain",8:"ClearProcessDomain",9:"GetThreadDomain",10:"AddThreadDomain",11:"ClearThreadDomain",12:"GetCustomDomain",13:"SetCustomDomain",14:"GetData",15:"SetData"};return t}(t);e.ContextController=o;var r=function(e){__extends(t,e);function t(){e.apply(this,arguments)}t.create=function(e){return e.requestService("DataWarehouseJmcServiceController").then(function(e){return new t(e,t.ActionIdToOperationMap)})};t.ActionIdToOperationMap={1:"GetJmc",2:"SetJmc"};return t}(t);e.JmcServiceController=r;var s=function(e){__extends(t,e);function t(){e.apply(this,arguments)}t.create=function(e){return e.requestService("DataWarehouseActiveCollectionController").then(function(e){return new t(e,t.ActionIdToOperationMap)})};t.ActionIdToOperationMap={1:"NewTargetProcess",2:"GraphUpdates"};return t}(t);e.ActiveCollectionController=s}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){!function(i){"use strict";var n=function(){function i(t){var i=this;this._messageListeners={};this._logger=t;this._proxy=e.Plugin.Utilities.JSONMarshaler.attachToPublishedObject("Microsoft.DiagnosticsHub.VisualStudio.Presentation.JavaScriptModels.CollectorTransportServiceControllerMarshaler",{},!0);this._proxy.addEventListener("stringMessageReceived",function(e){i.onStringMessageReceived(e)})}i.prototype.sendStringToCollectionAgent=function(e,i,n){return this._proxy._call("sendStringToCollectionAgent",e,i,n||t.Guids.standardCollectorClassId)};i.prototype.downloadFile=function(e,i,n){return this._proxy._call("downloadFile",e,i,n||t.Guids.standardCollectorClassId)};i.prototype.addMessageListener=function(e,i,n){var o=this,r=e.toString();this._logger.debug("Adding message listener ("+r+") for collector "+n||t.Guids.standardCollectorClassId);if(this._messageListeners[r]){this._logger.error("Listener already exists with guid = "+r);throw new Error("Listener already exists with guid = "+r)}this._messageListeners[r]=i;return this._proxy._call("enableEventsForListenerId",r,n||t.Guids.standardCollectorClassId).then(null,function(e){o._messageListeners[r]=null;o._logger.error(JSON.stringify(e))})};i.prototype.onStringMessageReceived=function(e){var t=e.ListenerId,i=e.Message;if(this._messageListeners[t]){(0,this._messageListeners[t])(i)}else this._logger.warning("Unexpected message received without a message listener - ID: "+t)};return i}(),o=null;function r(){null===o&&(o=new n(t.getLogger()));return o}i.getCollectorTransportServiceController=r;function s(){return r()}i.getStandardTransportService=s}(t.Collectors||(t.Collectors={}));t.Collectors}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(i){this._externalObject=null;this._logger=i;this._externalObject=e.Plugin.Utilities.loadExtension("DiagnosticsHub.ScriptedSandboxPlugin.dll","{339B3787-FC17-4BF5-A0DC-CBEF24DB2EDE}");this._automationManager=t.getAutomationManager(this._logger)}i.prototype.requestSync=function(e,t,i,n){this._externalObject?this._externalObject.requestSync(e,t,i,"string"==typeof n?n:null!==n&&void 0!==n?JSON.stringify(n):""):this._logger.warning("External object is null. Verify that DiagnosticsHub.ScriptedSandboxPlugin.dll was loaded into ScriptedSandbox.")};i.prototype.request=function(e,i,n,o){var r=this,s=function(e,t){try{e(t)}catch(e){r._logger.error(JSON.stringify(e))}},a=null,u=null,l=function(){r._externalObject&&r._externalObject.cancel&&u&&u.requestId&&r._externalObject.cancel(u.requestId)},c=function(e,t,i){if(null!==e){var n=null;if(null!==t)try{n=null===t||""===t||"string"!=typeof t?t:JSON.parse(t)}catch(e){r._logger.error("Could not parse "+i+" response: "+t);r._logger.error(e.Message)}s(e,n)}else r._logger.warning("DataWarehouseNativeHost: "+i+" callback is null.")},h=function(t,s,l){r._externalObject?a=r._externalObject.request(e,i,n,"string"==typeof o?o:null!==o&&void 0!==o?JSON.stringify(o):"",function(e){c(t,e,"completePromise")},function(e){c(s,e,"errorPromise")},function(e){}):r._logger.warning("External object is null. Verify that DiagnosticsHub.ScriptedSandboxPlugin.dll was loaded into ScriptedSandbox.");if(0!==(u=null===a||"string"!=typeof a?{hresult:1}:JSON.parse(a)).hresult){r._logger.error("Could not invoke request method of native host: "+a);var h=new Error;h.message=h.name=u.hresult.toString(16);s(h)}},d={controllerId:e,actionId:i,sessionId:n,request:o};return this._automationManager.getAutomationPromise(t.AutomationConstants.DataWarehouseRequestKey,h,l,d)};return i}();t.DataWarehouseNativeHost=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){!function(e){"use strict";var t=function(){function e(){}e.DiagnosticsPackage="DiagnosticsHub.Resource.DiagnosticsPackage";e.EtlFile="DiagnosticsHub.Resource.EtlFile";e.JavaScriptSource="DiagnosticsHub.Resource.JavaScript.SourceDirectory";e.SymbolCache="DiagnosticsHub.Resource.SymbolCache";e.UserNativeImageDirectory="DiagnosticsHub.Resource.UserNativeImageDirectory";e.PlatformNativeImage="DiagnosticsHub.Resource.PlatformNativeImage";e.PlatformWinmd="DiagnosticsHub.Resource.PlatformWinmd";e.CountersFile="DiagnosticsHub.Resource.CountersFile";e.DWJsonFile="DiagnosticsHub.Resource.DWJsonFile";e.UnknownFile="DiagnosticsHub.Resource.File";e.UnknownDirectory="DiagnosticsHub.Resource.Directory";return e}();e.ResourceIdentity=t}(e.DataWarehouse||(e.DataWarehouse={}));e.DataWarehouse}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){!function(i){"use strict";var n=function(){function e(){}e.CONTROLLER_ID_DATAWAREHOUSE=1;e.CONTROLLER_ID_DATAWAREHOUSECONTEXTSERVICE=2;e.CONTROLLER_ID_DATAWAREHOUSECONTEXT=3;e.CONTROLLER_ID_DATAWAREHOUSEJMCSERVICE=4;e.CONTROLLER_ID_DATAWAREHOUSEACTIVECOLLECTION=5;e.ACTION_DATAWAREHOUSE_BEGININITIALIZATION=1;e.ACTION_DATAWAREHOUSE_ENDINITIALIZATION=2;e.ACTION_DATAWAREHOUSE_GETDATA=3;e.ACTION_DATAWAREHOUSE_GETRESULT=4;e.ACTION_DATAWAREHOUSE_DISPOSERESULT=5;e.ACTION_DATAWAREHOUSE_PUSHDATASOURCES=6;e.ACTION_DATAWAREHOUSE_PUSHACTIVECOLLECTIONDATASOURCE=7;e.ACTION_DATAWAREHOUSE_COMPLETEACTIVECOLLECTIONDATASOURCE=8;e.ACTION_DATAWAREHOUSE_RETRIEVEDATABLOB=9;e.ACTION_DATAWAREHOUSE_STOREDATABLOB=10;e.ACTION_DATAWAREHOUSE_DELETEDATABLOB=11;e.ACTION_DATAWAREHOUSE_SYMBOLRESOLVERCONFIGURATIONUPDATE=12;e.ACTION_DATAWAREHOUSE_INITIALIZATION_DEPRECATED=100;e.ACTION_DATAWAREHOUSE_CLOSE=400;e.ACTION_DATAWAREHOUSE_GETPRIVATEDATA=401;e.ACTION_DATAWAREHOUSE_SETPRIVATEDATA=402;e.ACTION_DATAWAREHOUSE_GETSTATUS=403;e.ACTION_DATAWAREHOUSE_CANCELTASK=404;e.ACTION_DATAWAREHOUSE_ABORTANALYSIS=405;e.ACTION_DATAWAREHOUSECONTEXTSERVICE_CREATECONTEXT=1;e.ACTION_DATAWAREHOUSECONTEXTSERVICE_DELETECONTEXT=2;e.ACTION_DATAWAREHOUSECONTEXTSERVICE_COPYCONTEXT=3;e.ACTION_DATAWAREHOUSECONTEXTSERVICE_GETCONTEXT=4;e.ACTION_DATAWAREHOUSECONTEXTSERVICE_GETGLOBALCONTEXT=5;e.ACTION_DATAWAREHOUSECONTEXT_GETTIMEDOMAIN=1;e.ACTION_DATAWAREHOUSECONTEXT_SETTIMEDOMAIN=2;e.ACTION_DATAWAREHOUSECONTEXT_GETMACHINEDOMAIN=3;e.ACTION_DATAWAREHOUSECONTEXT_ADDTOMACHINEDOMAIN=4;e.ACTION_DATAWAREHOUSECONTEXT_CLEARMACHINEDOMAIN=5;e.ACTION_DATAWAREHOUSECONTEXT_GETPROCESSDOMAIN=6;e.ACTION_DATAWAREHOUSECONTEXT_ADDTOPROCESSDOMAIN=7;e.ACTION_DATAWAREHOUSECONTEXT_CLEARPROCESSDOMAIN=8;e.ACTION_DATAWAREHOUSECONTEXT_GETTHREADDOMAIN=9;e.ACTION_DATAWAREHOUSECONTEXT_ADDTOTHREADDOMAIN=10;e.ACTION_DATAWAREHOUSECONTEXT_CLEARTHREADDOMAIN=11;e.ACTION_DATAWAREHOUSECONTEXT_GETCUSTOMDOMAIN=12;e.ACTION_DATAWAREHOUSECONTEXT_SETCUSTOMDOMAIN=13;e.ACTION_DATAWAREHOUSECONTEXT_GETDATA=14;e.ACTION_DATAWAREHOUSECONTEXT_SETDATA=15;e.ACTION_DATAWAREHOUSEJMCSERVICE_GETJMCENABLED=1;e.ACTION_DATAWAREHOUSEJMCSERVICE_SETJMCENABLED=2;e.ACTION_DATAWAREHOUSEACTIVECOLLECTION_NEWTARGETPROCESS=1;e.ACTION_DATAWAREHOUSEACTIVECOLLECTION_GRAPHUPDATES=2;return e}();i.Constants=n;var o=function(){function e(e,t,i){this._resultId=e;this._sessionId=t;this._controller=i}Object.defineProperty(e.prototype,"resultId",{get:function(){return this._resultId},enumerable:!0,configurable:!0});e.prototype.getResult=function(e){var t=null;t=null!==e?{resultId:this._resultId,customData:JSON.stringify(e)}:{resultId:this._resultId};return this._controller.request(n.ACTION_DATAWAREHOUSE_GETRESULT,t)};e.prototype.dispose=function(){return this._controller.request(n.ACTION_DATAWAREHOUSE_DISPOSERESULT,{resultId:this._resultId})};return e}(),r=function(){function i(){this._getConfigurationPromise=null;this._serviceProxy=e.Plugin.Utilities.JSONMarshaler.attachToPublishedObject("Microsoft.DiagnosticsHub.VisualStudio.Presentation.JavaScriptModels.DataWarehouseServiceMarshaler",{},!0);this._logger=t.getLogger()}i.prototype.getDataWarehouse=function(e){var t=this;void 0===e&&(e=null);(null===this._getConfigurationPromise||e)&&(this._getConfigurationPromise=null===e?this._serviceProxy._call("getDataWarehouseConfiguration"):Promise.resolve(e));return this._getConfigurationPromise.then(function(e){t._logger.debug("Got the sessionId '"+e.sessionId+"'. Creating datawarehouse...");return new s(e)})};return i}();i.DataWarehouseFactory=r;var s=function(){function i(e){this._logger=null;this._dwConfiguration=null;this._controller=null;this._contextService=null;this._jmcService=null;this._logger=t.getLogger();this._dwConfiguration=e;this._controller=new t.HostController(this._dwConfiguration.sessionId,n.CONTROLLER_ID_DATAWAREHOUSE)}i.prototype.getConfiguration=function(){return this._dwConfiguration};i.prototype.getData=function(e,t){var i=null;i=e?{contextId:e,analyzerId:t}:{analyzerId:t};return this.getDataFromAnalyzer(i)};i.prototype.getFilteredData=function(e,t){return this.getDataFromAnalyzer({filter:a(null,e),analyzerId:t})};i.prototype.getResultId=function(t){var i=t;if(!i.resultId)throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.1011"));return i.resultId};i.prototype.getResultById=function(e){return new o(e,this._dwConfiguration.sessionId,this._controller)};i.prototype.getContextService=function(){this._contextService||(this._contextService=new u(this._dwConfiguration.sessionId));return this._contextService};i.prototype.getJmcService=function(){this._jmcService||(this._jmcService=new c(this._dwConfiguration.sessionId));return this._jmcService};i.prototype.close=function(){return this._controller.request(n.ACTION_DATAWAREHOUSE_CLOSE)};i.prototype.closeSynchronous=function(){this._controller.requestSync(n.ACTION_DATAWAREHOUSE_CLOSE)};i.prototype.initialize=function(){this._logger.debug("Initializing DataWarehouse...");var e={analyzers:this._dwConfiguration.analyzers,dataSources:this._dwConfiguration.dataSources,symbolStorePath:this._dwConfiguration.symbolStorePath||"",symbolCachePath:this._dwConfiguration.symbolCachePath||"",isJmcEnabled:void 0===this._dwConfiguration.isJmcEnabled||this._dwConfiguration.isJmcEnabled};this._logger.debug("DataWarehouse configuration: "+JSON.stringify(e));return this._controller.request(n.ACTION_DATAWAREHOUSE_INITIALIZATION_DEPRECATED,e)};i.prototype.beginInitialization=function(){this._logger.debug("Begin initializing DataWarehouse");var e={analyzers:this._dwConfiguration.analyzers,dataSources:this._dwConfiguration.dataSources,symbolStorePath:this._dwConfiguration.symbolStorePath||"",symbolCachePath:this._dwConfiguration.symbolCachePath||"",isJmcEnabled:void 0===this._dwConfiguration.isJmcEnabled||this._dwConfiguration.isJmcEnabled,symbolLocatorServiceFullPath:this._dwConfiguration.symbolLocatorServiceFullPath||"",portablePdbLibraryFullPath:this._dwConfiguration.portablePdbLibraryFullPath||""};this._logger.debug("DataWarehouse configuration: "+JSON.stringify(e));return this._controller.request(n.ACTION_DATAWAREHOUSE_BEGININITIALIZATION,e)};i.prototype.pushDataSources=function(e){this._logger.debug("Begin pushing data source(s) to DataWarehouse");var t={dataSources:e};this._logger.debug("PushDataSources payload: "+JSON.stringify(t));return this._controller.request(n.ACTION_DATAWAREHOUSE_PUSHDATASOURCES,t)};i.prototype.endInitialization=function(){this._logger.debug("End initializing DataWarehouse");return this._controller.request(n.ACTION_DATAWAREHOUSE_ENDINITIALIZATION)};i.prototype.getPrivateData=function(e,t){this._logger.debug("Getting private data from DataWarehouse...");var i={id:e,dataArg:t};return this._controller.request(n.ACTION_DATAWAREHOUSE_GETPRIVATEDATA,i)};i.prototype.setPrivateData=function(e,t){this._logger.debug("Setting private data in DataWarehouse...");var i={id:e,data:t};return this._controller.request(n.ACTION_DATAWAREHOUSE_SETPRIVATEDATA,i)};i.prototype.getDataFromAnalyzer=function(e){var t,i,r,s=this,a=function(e,n,o){t=e;i=n;r=o};this._controller.request(n.ACTION_DATAWAREHOUSE_GETDATA,e).then(function(e){var i=null;if(null!==e&&void 0!==e&&"number"==typeof e.dh_r_id){s._logger.debug("Result ID ("+e.dh_r_id+") received for Session ID: "+s._dwConfiguration.sessionId);i=new o(e.dh_r_id,s._dwConfiguration.sessionId,s._controller)}else i=e;t(i)},function(e){i&&i(e)},function(e){e&&r(e)});return new Promise(a)};return i}();function a(e,t){var i={};e&&(i.contextId=e);t.timeDomain&&(i.timeDomain={begin:t.timeDomain.begin.jsonValue,end:t.timeDomain.end.jsonValue});t.machineDomain&&(i.machineDomain=t.machineDomain);t.processDomain&&(i.processDomain=t.processDomain);t.threadDomain&&(i.threadDomain=t.threadDomain);t.customDomain&&(i.customDomain=t.customDomain);return i}var u=function(){function e(e){this._controller=new t.HostController(e,n.CONTROLLER_ID_DATAWAREHOUSECONTEXTSERVICE);this._sessionId=e}e.prototype.createContext=function(e){var t=this,i={};null!==e&&void 0!==e&&(i.data=a(null,e));return this._controller.request(n.ACTION_DATAWAREHOUSECONTEXTSERVICE_CREATECONTEXT,i).then(function(e){return new l(e,t._sessionId)})};e.prototype.deleteContext=function(e){return this._controller.request(n.ACTION_DATAWAREHOUSECONTEXTSERVICE_DELETECONTEXT,{contextId:e})};e.prototype.copyContext=function(e){var t=this;return this._controller.request(n.ACTION_DATAWAREHOUSECONTEXTSERVICE_COPYCONTEXT,{contextId:e}).then(function(e){return new l(e,t._sessionId)})};e.prototype.getContext=function(e){var t=this;return this._controller.request(n.ACTION_DATAWAREHOUSECONTEXTSERVICE_GETCONTEXT,{contextId:e}).then(function(e){return new l(e,t._sessionId)})};e.prototype.getGlobalContext=function(){var e=this;return this._controller.request(n.ACTION_DATAWAREHOUSECONTEXTSERVICE_GETGLOBALCONTEXT).then(function(t){return new l(t,e._sessionId)})};return e}(),l=function(){function e(e,i){this._info=e;this._sessionId=i;this._controller=new t.HostController(this._sessionId,n.CONTROLLER_ID_DATAWAREHOUSECONTEXT)}e.prototype.getContextId=function(){return this._info.contextId};e.prototype.getParentContextId=function(){return this._info.parentContextId};e.prototype.setData=function(e){return this._controller.request(n.ACTION_DATAWAREHOUSECONTEXT_SETDATA,a(this._info.contextId,e))};e.prototype.getData=function(){return this._controller.request(n.ACTION_DATAWAREHOUSECONTEXT_GETDATA,{contextId:this._info.contextId}).then(function(e){return{timeDomain:new t.JsonTimespan(new t.BigNumber(e.timeDomain.begin.h,e.timeDomain.begin.l),new t.BigNumber(e.timeDomain.end.h,e.timeDomain.end.l)),machineDomain:e.machineDomain,processDomain:e.processDomain,threadDomain:e.threadDomain,customDomain:e.customDomain}})};e.prototype.getTimeDomain=function(){return this._controller.request(n.ACTION_DATAWAREHOUSECONTEXT_GETTIMEDOMAIN,{contextId:this._info.contextId}).then(function(e){return new t.JsonTimespan(new t.BigNumber(e.begin.h,e.begin.l),new t.BigNumber(e.end.h,e.end.l))})};e.prototype.setTimeDomain=function(e){return this._controller.request(n.ACTION_DATAWAREHOUSECONTEXT_SETTIMEDOMAIN,{contextId:this._info.contextId,timeDomain:{begin:e.begin.jsonValue,end:e.end.jsonValue}})};e.prototype.getMachineDomain=function(){return this._controller.request(n.ACTION_DATAWAREHOUSECONTEXT_GETMACHINEDOMAIN,{contextId:this._info.contextId})};e.prototype.addToMachineDomain=function(e){return this._controller.request(n.ACTION_DATAWAREHOUSECONTEXT_ADDTOMACHINEDOMAIN,{contextId:this._info.contextId,machineName:e})};e.prototype.clearMachineDomain=function(){return this._controller.request(n.ACTION_DATAWAREHOUSECONTEXT_CLEARMACHINEDOMAIN,{contextId:this._info.contextId})};e.prototype.getProcessDomain=function(){return this._controller.request(n.ACTION_DATAWAREHOUSECONTEXT_GETPROCESSDOMAIN,{contextId:this._info.contextId})};e.prototype.addToProcessDomain=function(e){return this._controller.request(n.ACTION_DATAWAREHOUSECONTEXT_ADDTOPROCESSDOMAIN,{contextId:this._info.contextId,processId:e})};e.prototype.clearProcessDomain=function(){return this._controller.request(n.ACTION_DATAWAREHOUSECONTEXT_CLEARPROCESSDOMAIN,{contextId:this._info.contextId})};e.prototype.getThreadDomain=function(){return this._controller.request(n.ACTION_DATAWAREHOUSECONTEXT_GETTHREADDOMAIN,{contextId:this._info.contextId})};e.prototype.addToThreadDomain=function(e){return this._controller.request(n.ACTION_DATAWAREHOUSECONTEXT_ADDTOTHREADDOMAIN,{contextId:this._info.contextId,threadId:e})};e.prototype.clearThreadDomain=function(){return this._controller.request(n.ACTION_DATAWAREHOUSECONTEXT_CLEARTHREADDOMAIN,{contextId:this._info.contextId})};e.prototype.getCustomDomain=function(e){return this._controller.request(n.ACTION_DATAWAREHOUSECONTEXT_GETCUSTOMDOMAIN,{contextId:this._info.contextId,name:e}).then(function(e){return e.value})};e.prototype.setCustomDomain=function(e,t){return this._controller.request(n.ACTION_DATAWAREHOUSECONTEXT_SETCUSTOMDOMAIN,{contextId:this._info.contextId,name:e,value:t})};return e}(),c=function(){function i(i){this._controller=new t.HostController(i,n.CONTROLLER_ID_DATAWAREHOUSEJMCSERVICE);this._logger=t.getLogger();this._viewEventManager=e.VisualStudio.DiagnosticsHub.getViewEventManager()}i.prototype.getJmcEnabledState=function(){var t=this;return this._controller.request(n.ACTION_DATAWAREHOUSEJMCSERVICE_GETJMCENABLED).then(function(i){if(void 0===i.jmcOn){t._logger.error("getJmcEnabledState() result is ill-formed");throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.9999"))}return i.jmcOn})};i.prototype.setJmcEnabledState=function(t){var i=this;return this._controller.request(n.ACTION_DATAWAREHOUSEJMCSERVICE_SETJMCENABLED,{jmcOn:t}).then(function(t){if(void 0===t.prevEnabledState||void 0===t.currEnabledState){i._logger.error("setJmcEnabledState() result is ill-formed");throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.9999"))}t.prevEnabledState!==t.currEnabledState&&i._viewEventManager.jmcEnabledStateChanged.raiseEvent(t)})};return i}(),h=null;function d(e){void 0===e&&(e=null);null===h&&(h=new r);return h.getDataWarehouse(e)}i.loadDataWarehouse=d}(t.DataWarehouse||(t.DataWarehouse={}));t.DataWarehouse}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){!function(t){"use strict";var i;!function(e){e[e.UserCode=0]="UserCode";e[e.Library=1]="Library";e[e.Unrelated=2]="Unrelated";e[e.Unsure=3]="Unsure"}(i||(i={}));var n=function(){function t(){this._serviceProxy=u()}t.prototype.getJmcTypeForUrls=function(t){return e.Plugin.F12.JMC.getJMCTypeForUrls(t).then(function(e){if(!e)return[];for(var t=0;t<e.length;++t)switch(e[t]){case 0:e[t]=0;break;case 1:e[t]=1;break;case 2:e[t]=2;break;case 3:default:e[t]=-1}return e})};return t}();t.JavaScriptJmc=n;var o=function(){function e(){this._serviceProxy=u()}e.prototype.getAllExecutableCodeOutputs=function(e){return this._serviceProxy._call("getSolutionExecutableCodeOutputs",e)};return e}();t.SolutionService=o;var r=function(){function e(){this._serviceProxy=u()}e.prototype.showDocument=function(e,t){return this._serviceProxy._call("showDocument",e,t)};e.prototype.getAccessiblePathToFile=function(e){return this._serviceProxy._call("getAccessiblePathToFile",e)};return e}();t.SourceService=r;var s=function(){function e(){this._serviceProxy=u()}e.prototype.isDataWarehouseInVsHub=function(){return this._serviceProxy._call("isDataWarehouseInVsHub")};return e}();t.DataWarehouseRegistryService=s;var a=null;function u(){null===a&&(a=e.Plugin.Utilities.JSONMarshaler.attachToPublishedObject("Microsoft.DiagnosticsHub.VisualStudio.Presentation.JavaScriptModels.VisualStudioServiceMarshaler",{},!0));return a}t.getVisualStudioService=u}(t.Controllers||(t.Controllers={}));t.Controllers}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function e(e){this._onHandlerCompleted=e}e.prototype.complete=function(e){this._onHandlerCompleted(e)};return e}();t.DocumentClosingEventDeferral=i;var n=function(){function e(e){this._onHandlerCompleted=e;this._eventDeferral=null}Object.defineProperty(e.prototype,"waitHandler",{get:function(){return null!==this._eventDeferral},enumerable:!0,configurable:!0});e.prototype.getDeferral=function(){null===this._eventDeferral&&(this._eventDeferral=new i(this._onHandlerCompleted));return this._eventDeferral};return e}();t.DocumentClosingEventArgs=n;var o=function(){function i(){this._documentProxy=e.Plugin.Utilities.JSONMarshaler.attachToPublishedObject("Microsoft.DiagnosticsHub.VisualStudio.Presentation.JavaScriptModels.DocumentPortMarshaler",{},!0);this._logger=t.getLogger()}i.prototype.getTools=function(){return this._documentProxy._call("getTools")};i.prototype.openInAlternateFormat=function(t){if(1===t){this._logger.debug("Opening current document as a Vspx");return this._documentProxy._call("openAsVspx")}throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.1000"))};i.prototype.isPerformanceDebuggerDocument=function(){return this._documentProxy._call("isPerformanceDebuggerDocument")};return i}(),r=null;function s(){null===r&&(r=new o);return r}t.getCurrentDocument=s}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){!function(i){"use strict";!function(e){e[e.SwimLane=0]="SwimLane";e[e.DoubleSlider=1]="DoubleSlider";e[e.DoubleSliderHandles=2]="DoubleSliderHandles"}(i.SelectionChangeSource||(i.SelectionChangeSource={}));i.SelectionChangeSource;var n=function(){function e(){this._serviceProxy=l()}e.prototype.jmcToggle=function(e){this._serviceProxy._post("reportJmcToggle",e)};e.prototype.enabledAtStart=function(e){this._serviceProxy._post("cpuUsageEnabledInitially",e)};return e}();i.CpuUsage=n;var o=function(){function e(){this._serviceProxy=c()}e.prototype.selectToolsDropdown=function(){this._serviceProxy._post("reportSelectToolsDropdown")};return e}();i.PerformanceDebugger=o;var r=function(){function e(){this._serviceProxy=l()}e.prototype.zoomIn=function(){this._serviceProxy._post("reportZoomIn")};e.prototype.zoomOut=function(){this._serviceProxy._post("reportZoomOut")};e.prototype.resetZoom=function(){this._serviceProxy._post("reportResetZoom")};e.prototype.clearSelection=function(){this._serviceProxy._post("reportClearSelection")};e.prototype.selectionChanged=function(e,i,n){var o=n||t.Guid.empty.toString();this._serviceProxy._post("reportSelectionChanged",e,i,o)};e.prototype.showGraphTooltip=function(e){this._serviceProxy._post("reportGraphTooltip",e)};return e}();i.ViewportController=r;var s=function(){function e(){this._serviceProxy=l()}e.prototype.lostEvents=function(e){this._serviceProxy._post("countLostEvents",e)};return e}();i.CollectedData=s;var a=null,u=null;function l(){null===a&&(a=e.Plugin.Utilities.JSONMarshaler.attachToPublishedObject("Microsoft.DiagnosticsHub.VisualStudio.Presentation.JavaScriptModels.TelemetryAnalysisServiceMarshaler",{},!0));return a}function c(){null===u&&(u=e.Plugin.Utilities.JSONMarshaler.attachToPublishedObject("Microsoft.DiagnosticsHub.VisualStudio.Presentation.JavaScriptModels.TelemetryGlobalServiceMarshaler",{},!0));return u}}(t.Telemetry||(t.Telemetry={}));t.Telemetry}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(){this._publisher=new t.Publisher([i.EventName]);this._eventAggregator=e.VisualStudio.DiagnosticsHub.getEventAggregator();this._eventAggregator.addEventListener(i.EventGlobalName,this.forwardSelectionTimeRangeEvent.bind(this));this._timeRangeMarshaler=e.Plugin.Utilities.JSONMarshaler.attachToPublishedObject("Microsoft.DiagnosticsHub.VisualStudio.Presentation.JavaScriptModels.SwimlaneDataServiceMarshaler",{},!0);if(!this._timeRangeMarshaler)throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.1007"))}i.prototype.addEventListener=function(e){this._publisher.addEventListener(i.EventName,e)};i.prototype.removeEventListener=function(e){this._publisher.removeEventListener(i.EventName,e)};i.prototype.raiseEvent=function(e){this.setTimeRange(e.position);var t={i:e.isIntermittent};e.position&&(t.ts={begin:e.position.begin.jsonValue,end:e.position.end.jsonValue});this._eventAggregator.raiseEvent(i.EventGlobalName,t)};i.prototype.getTimeRange=function(){return this._timeRangeMarshaler._call("getCurrentTimeRange").then(function(e){return e&&e.begin&&e.end?new t.JsonTimespan(new t.BigNumber(e.begin.h,e.begin.l),new t.BigNumber(e.end.h,e.end.l)):null})};i.prototype.setTimeRange=function(e){var t=null;e&&(t={begin:e.begin.jsonValue,end:e.end.jsonValue});this._timeRangeMarshaler._call("setCurrentTimeRange",t)};i.prototype.forwardSelectionTimeRangeEvent=function(e){var n;void 0!==e.ts&&(n=new t.JsonTimespan(new t.BigNumber(e.ts.begin.h,e.ts.begin.l),new t.BigNumber(e.ts.end.h,e.ts.end.l)));var o={position:n,isIntermittent:e.i};this._publisher.invokeListener(i.EventName,o)};i.EventGlobalName="DiagnosticsHub.EventAggregator.SelectionTimeRangeChanged";i.EventName="DiagnosticsHub.SelectionTimeRangeChanged";return i}(),n=function(){function i(){this._publisher=new t.Publisher([i.EventName]);this._eventAggregator=e.VisualStudio.DiagnosticsHub.getEventAggregator();this._eventAggregator.addEventListener(i.EventGlobalName,this.forwardChangeViewportEvent.bind(this))}i.prototype.addEventListener=function(e){this._publisher.addEventListener(i.EventName,e)};i.prototype.removeEventListener=function(e){this._publisher.removeEventListener(i.EventName,e)};i.prototype.raiseEvent=function(e){var t=null;e&&(t={beginH:e.begin.jsonValue.h,beginL:e.begin.jsonValue.l,endH:e.end.jsonValue.h,endL:e.end.jsonValue.l});this._eventAggregator.raiseEvent(i.EventGlobalName,t)};i.prototype.forwardChangeViewportEvent=function(e){var n=null;void 0!==e.beginH&&void 0!==e.beginL&&void 0!==e.endH&&void 0!==e.endL&&(n=new t.JsonTimespan(new t.BigNumber(e.beginH,e.beginL),new t.BigNumber(e.endH,e.endL)));this._publisher.invokeListener(i.EventName,n)};i.EventGlobalName="DiagnosticsHub.EventAggregator.ChangeViewport";i.EventName="DiagnosticsHub.ChangeViewport";return i}(),o=function(){function i(){this._publisher=new t.Publisher([i.EventName]);this._eventAggregator=e.VisualStudio.DiagnosticsHub.getEventAggregator();this._eventAggregator.addEventListener(i.EventGlobalName,this.forwardJmcEnabledStateChangedEvent.bind(this))}i.prototype.addEventListener=function(e){this._publisher.addEventListener(i.EventName,e)};i.prototype.removeEventListener=function(e){this._publisher.removeEventListener(i.EventName,e)};i.prototype.raiseEvent=function(e){this._eventAggregator.raiseEvent(i.EventGlobalName,e)};i.prototype.forwardJmcEnabledStateChangedEvent=function(e){this._publisher.invokeListener(i.EventName,e)};i.EventGlobalName="DiagnosticsHub.EventAggregator.JmcEnabledStateChanged";i.EventName="DiagnosticsHub.JmcEnabledStateChanged";return i}(),r=function(){function i(){this._publisher=new t.Publisher([i.EventName]);this._eventAggregator=e.VisualStudio.DiagnosticsHub.getEventAggregator();this._eventAggregator.addEventListener(i.EventGlobalName,this.forwardDetailsViewSelectionChangedEvent.bind(this))}i.prototype.addEventListener=function(e){this._publisher.addEventListener(i.EventName,e)};i.prototype.removeEventListener=function(e){this._publisher.removeEventListener(i.EventName,e)};i.prototype.raiseEvent=function(e){this._eventAggregator.raiseEvent(i.EventGlobalName,e)};i.prototype.forwardDetailsViewSelectionChangedEvent=function(e){this._publisher.invokeListener(i.EventName,e)};i.EventGlobalName="DiagnosticsHub.EventAggregator.DetailsViewSelectionChangedEvent";i.EventName="DiagnosticsHub.DetailsViewSelectionChangedEvent";return i}(),s=function(){function i(){this._publisher=new t.Publisher([i.EventName]);this._eventAggregator=e.VisualStudio.DiagnosticsHub.getEventAggregator();this._eventAggregator.addEventListener(i.EventGlobalName,this.forwardDetailsViewSelectionChangedEvent.bind(this))}i.prototype.addEventListener=function(e){this._publisher.addEventListener(i.EventName,e)};i.prototype.removeEventListener=function(e){this._publisher.removeEventListener(i.EventName,e)};i.prototype.raiseEvent=function(e){this._eventAggregator.raiseEvent(i.EventGlobalName,e)};i.prototype.forwardDetailsViewSelectionChangedEvent=function(e){this._publisher.invokeListener(i.EventName,e)};i.EventGlobalName="DiagnosticsHub.EventAggregator.DetailsViewReadyEvent";i.EventName="DiagnosticsHub.DetailsViewReadyEvent";return i}(),a=function(){function e(){this._selectionChanged=new i;this._changeViewport=new n;this._jmcEnabledStateChanged=new o;this._detailsViewSelectionChangedEvent=new r;this._detailsViewReady=new s}Object.defineProperty(e.prototype,"selectionChanged",{get:function(){return this._selectionChanged},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"changeViewport",{get:function(){return this._changeViewport},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"jmcEnabledStateChanged",{get:function(){return this._jmcEnabledStateChanged},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"detailsViewSelectionChanged",{get:function(){return this._detailsViewSelectionChangedEvent},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"detailsViewReady",{get:function(){return this._detailsViewReady},enumerable:!0,configurable:!0});return e}(),u=null;function l(){null===u&&(u=new a);return u}t.getViewEventManager=l}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){"use strict";var t=function(){function e(){}e.VSHUB_E_INVALID_REGEX=3776045057;return e}();e.ErrorCodes=t}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function t(t,i){this._sessionId=t;this._controllerId=i;this._dataWarehouseRegistryService=new e.VisualStudio.DiagnosticsHub.Controllers.DataWarehouseRegistryService}t.prototype.request=function(e,t){var i=this;if(this._host)return this._host.request(this._controllerId,e,this._sessionId,t);var n=this.ensureIsPerformanceDebuggerDocument(),r=this.ensureDataWarehouseInVsHub();return Promise.all([n,r]).then(function(n){if(n){var r=!1;n.forEach(function(e){r=r||e});return o(r).then(function(n){i._host=n;return i._host.request(i._controllerId,e,i._sessionId,t)})}})};t.prototype.requestSync=function(e,t){this._host||(this._host=r(!1));return this._host.requestSync(this._controllerId,e,this._sessionId,t)};t.prototype.ensureIsPerformanceDebuggerDocument=function(){return Promise.resolve(!1)};t.prototype.ensureDataWarehouseInVsHub=function(){return Promise.resolve(!1)};return t}();t.HostController=i;var n=null;function o(e){if(!n){if(e){var i=new t.DataWarehouseServiceHubHost;return i.initialize().then(function(){return n=i})}n=new t.DataWarehouseNativeHost(t.getLogger())}return Promise.resolve(n)}function r(e){n||(n=e?new t.DataWarehouseServiceHubHost:new t.DataWarehouseNativeHost(t.getLogger()));return n}}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){"use strict";var t=function(){function e(){}e.ZoomIn="ZoomIn";e.ZoomToSelection="ZoomToSelection";e.ZoomOut="ZoomOut";e.ResetZoom="ResetZoom";e.ResetView="ResetView";e.ClearSelection="ClearSelection";return e}();e.CommandIds=t}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){"use strict";var t=function(){function e(){}Object.defineProperty(e,"GridLineZIndex",{get:function(){return 2},enumerable:!0,configurable:!0});Object.defineProperty(e,"SelectionOverlayZIndex",{get:function(){return 130},enumerable:!0,configurable:!0});Object.defineProperty(e,"DropDownMenuZIndex",{get:function(){return 1e3},enumerable:!0,configurable:!0});Object.defineProperty(e,"DefaultSwimlaneGraphHeight",{get:function(){return 70},enumerable:!0,configurable:!0});Object.defineProperty(e,"MinimumSwimlaneGraphHeight",{get:function(){return 50},enumerable:!0,configurable:!0});Object.defineProperty(e,"MaximumSwimlaneGraphHeight",{get:function(){return 200},enumerable:!0,configurable:!0});Object.defineProperty(e,"TimeoutImmediate",{get:function(){return 0},enumerable:!0,configurable:!0});Object.defineProperty(e,"WindowResizeThrottle",{get:function(){return 200},enumerable:!0,configurable:!0});Object.defineProperty(e,"TooltipTimeoutMs",{get:function(){return 750},enumerable:!0,configurable:!0});return e}();e.Constants=t}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(i){var n=this;this._viewportStateChangedEvent=new t.AggregatedEvent;this._isSelecting=!1;this._commands=[];this._currentSelection=null;this._viewportTimeRange=i;this._viewableTimeRange=i;this._scrollbar=new t.Scrollbar;this._scrollbar.onScroll=this.onScroll.bind(this);this._onSelectionChangedBoundFunction=this.onSelectionChanged.bind(this);this._telemetry=new t.Telemetry.ViewportController;this._viewEventManager=e.VisualStudio.DiagnosticsHub.getViewEventManager();this._viewEventManager.selectionChanged.addEventListener(this._onSelectionChangedBoundFunction);this._commands.push({id:t.CommandIds.ZoomIn,callback:this.zoomToSelection.bind(this),label:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarZoomInButton"),ariaLabel:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarZoomInAriaLabel"),tooltip:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarZoomInButton"),type:1,iconEnabled:"vs-image-toolbar-chartzoom-in",iconDisabled:"vs-image-toolbar-chartzoom-in-disabled",accessKey:null,hidden:function(){return!1},disabled:function(){return!n.canZoomTo()},checked:function(){return!1},cssClass:null,submenu:null,displayOnToolbar:!0,displayOnContextMenu:!0});this._commands.push({id:t.CommandIds.ResetZoom,callback:this.resetZoom.bind(this),label:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarResetZoomButton"),ariaLabel:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarResetZoomAriaLabel"),tooltip:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarResetZoomButton"),type:1,iconEnabled:"vs-image-toolbar-chartzoom-reset",iconDisabled:"vs-image-toolbar-chartzoom-reset-disabled",accessKey:null,hidden:function(){return!1},disabled:function(){return!n.canResetZoom()},checked:function(){return!1},cssClass:null,submenu:null,displayOnToolbar:!0,displayOnContextMenu:!0});this._commands.push({id:t.CommandIds.ClearSelection,callback:this.clearSelection.bind(this),label:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarClearSelectionButton"),ariaLabel:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarClearSelectionAriaLabel"),tooltip:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarClearSelectionButton"),type:1,iconEnabled:"vs-image-toolbar-chartselection-clear",iconDisabled:"vs-image-toolbar-chartselection-clear-disabled",accessKey:null,hidden:function(){return!1},disabled:function(){return!n.canClearSelection()},checked:function(){return!1},cssClass:null,submenu:null,displayOnToolbar:!0,displayOnContextMenu:!0});this._viewportStateChangedEvent.addEventListener(function(){n._commands.forEach(function(e){e.onDisabledChanged&&e.onDisabledChanged()})})}Object.defineProperty(i.prototype,"container",{get:function(){return this._scrollbar.container},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"viewportStateChanged",{get:function(){return this._viewportStateChangedEvent},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"visible",{get:function(){return this._viewportTimeRange},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"viewable",{get:function(){return this._viewableTimeRange},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"selection",{get:function(){return this._currentSelection},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"scrollbar",{get:function(){return this._scrollbar},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"commands",{get:function(){return this._commands},enumerable:!0,configurable:!0});i.prototype.dispose=function(){this._scrollbar.onScroll=null;this._scrollbar.dispose();this._viewEventManager.selectionChanged.removeEventListener(this._onSelectionChangedBoundFunction);this._viewportStateChangedEvent.dispose()};i.prototype.resize=function(e){this._scrollbar.resize(e)};i.prototype.requestViewportChange=function(e){if(this._isSelecting)return!1;var i=this._viewableTimeRange.contains(e.currentTimespan.begin)&&this._viewableTimeRange.contains(e.currentTimespan.end),n=!e.selectionTimespan||this._viewableTimeRange.contains(e.selectionTimespan.begin)&&this._viewableTimeRange.contains(e.selectionTimespan.end);if(!i||!n){t.Debug.Assert.isTrue(i,"Invalid viewport specified");t.Debug.Assert.isTrue(n,"Invalid selection specified");return!1}var o=!this.isSameSelection(e.selectionTimespan);if(!o&&this._viewportTimeRange.equals(e.currentTimespan))return!1;this._viewportTimeRange=e.currentTimespan;if(o){this._currentSelection=e.selectionTimespan;this._viewEventManager.selectionChanged.raiseEvent({position:this._currentSelection,isIntermittent:!1})}this.fireViewportStateChanged(!1);return!0};i.prototype.canZoomTo=function(){return void 0!==this._currentSelection&&null!==this._currentSelection&&!this._viewportTimeRange.equals(this._currentSelection)&&!this._viewableTimeRange.equals(this._currentSelection)&&!i.MinimumZoomTimeInMs.greater(this._currentSelection.elapsed)};i.prototype.zoomToSelection=function(){if(this.canZoomTo()){this._telemetry.zoomIn();this._viewportTimeRange=this._currentSelection;this._scrollbar.update(this._viewableTimeRange,this._viewportTimeRange);this.fireViewportStateChanged()}};i.prototype.canResetZoom=function(){return!this._viewableTimeRange.equals(this._viewportTimeRange)};i.prototype.resetZoom=function(){if(this.canResetZoom()){this._telemetry.resetZoom();this._viewportTimeRange=this._viewableTimeRange;this._scrollbar.update(this._viewableTimeRange,this._viewportTimeRange);this.fireViewportStateChanged()}};i.prototype.canClearSelection=function(){return void 0!==this._currentSelection&&null!==this._currentSelection&&!this._currentSelection.equals(this._viewableTimeRange)};i.prototype.clearSelection=function(){if(this.canClearSelection()){this._telemetry.clearSelection();this._viewEventManager.selectionChanged.raiseEvent({position:this._viewableTimeRange,isIntermittent:!1})}};i.prototype.onScroll=function(e){if(e.totalLength){var i=t.BigNumber.addNumber(this._viewableTimeRange.begin,parseInt(this._viewableTimeRange.elapsed.value)*e.position/e.totalLength),n=t.BigNumber.add(i,this._viewportTimeRange.elapsed);this._viewportTimeRange=new t.JsonTimespan(i,n);this.fireViewportStateChanged()}};i.prototype.onSelectionChanged=function(e){this._isSelecting=e.isIntermittent;if(null!==e.position&&void 0!==e.position&&e.position.end.greater(this._viewableTimeRange.end))this._viewEventManager.selectionChanged.raiseEvent({position:new t.JsonTimespan(e.position.begin,this._viewableTimeRange.end),isIntermittent:e.isIntermittent});else if(!this.isSameSelection(e.position)){this._currentSelection=e.position;this.fireViewportStateChanged(this._isSelecting)}};i.prototype.fireViewportStateChanged=function(e){void 0===e&&(e=!1);this._viewportStateChangedEvent.invokeEvent({currentTimespan:this._viewportTimeRange,selectionTimespan:this._currentSelection,isIntermittent:e})};i.prototype.isSameSelection=function(e){return!this._currentSelection&&!e||this._currentSelection&&e&&this._currentSelection.equals(e)};i.MinimumZoomTimeInMs=t.BigNumber.convertFromNumber(1e4);return i}();t.ViewportController=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function t(t){t&&t.forEach(function(e){e.iconEnabled=null;e.iconDisabled=null});this._contextMenu=e.Plugin.ContextMenu.create(t,null,null,null,function(){})}t.prototype.onMouseDown=function(e){if(this._contextMenu&&3===e.which){var t=e.clientX,i=e.clientY;this._contextMenu.show(t,i);return!1}return!0};return t}();t.ContextMenu=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){"use strict";var t=function(){function e(e){this._decoratedControl=e}Object.defineProperty(e.prototype,"container",{get:function(){return this._decoratedControl.container},enumerable:!0,configurable:!0});e.prototype.onDataUpdate=function(e){this._decoratedControl.onDataUpdate&&this._decoratedControl.onDataUpdate(e)};e.prototype.resize=function(e){this._decoratedControl.resize&&this._decoratedControl.resize(e)};e.prototype.onViewportChanged=function(e){this._decoratedControl.onViewportChanged&&this._decoratedControl.onViewportChanged(e)};e.prototype.dispose=function(){this._decoratedControl.dispose&&this._decoratedControl.dispose()};return e}();e.ControlDecorator=t}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(i,n){var o=this;this._container=document.createElement("div");this._container.id="informationContainer";this._container.classList.add("main-information-container");var r=document.createElement("div");r.classList.add("information-icon");r.appendChild(t.Utilities.getSVGPlaceHolder("vs-image-information-icon"));e.Plugin.Theme.processInjectedSvg(r);this._container.appendChild(r);var s=document.createElement("div");s.classList.add("information-message");s.innerHTML=i;this._container.appendChild(s);if(n){var a=document.createElement("div");a.classList.add("information-link");this._container.appendChild(a);var u=document.createElement("a");u.href=n||"";u.target="blank";u.text=e.Plugin.Resources.getString("/DiagnosticsHubResources/InformationLink");u.setAttribute("role","link");u.setAttribute("aria-label",e.Plugin.Resources.getString("/DiagnosticsHubResources/InformationLink"));a.appendChild(u)}var l=document.createElement("div");l.classList.add("information-close-div");this._container.appendChild(l);var c=document.createElement("div");c.classList.add("information-close");c.innerHTML="r";c.tabIndex=0;c.setAttribute("role","button");c.setAttribute("aria-label",e.Plugin.Resources.getString("/DiagnosticsHubResources/InformationClose"));c.setAttribute("data-plugin-vs-tooltip",JSON.stringify({content:e.Plugin.Resources.getString("/DiagnosticsHubResources/InformationClose"),delay:0}));c.onkeypress=function(e){13===e.keyCode&&o.collapse()};c.onclick=this.collapse.bind(this);l.appendChild(c)}Object.defineProperty(i.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0});i.prototype.collapse=function(){this._container.classList.add("main-information-container-hidden");this.onClose&&this.onClose()};return i}();t.InformationBarControl=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(t,i){var n=this;this._localizedUnits=[];var o=e.VisualStudio.DiagnosticsHub.getLogger();if(t){t.forEach(function(e){if(i&&i[e.Unit])n._localizedUnits.push({Decimals:e.Decimals,Divider:e.Divider,LowerBound:e.LowerBound,Unit:i[e.Unit]});else{n._localizedUnits.push({Decimals:e.Decimals,Divider:e.Divider,LowerBound:e.LowerBound,Unit:e.Unit});o.error("Missing resource string for: "+e.Unit)}});t.sort(function(e,t){return e.LowerBound<t.LowerBound?-1:e.LowerBound>t.LowerBound?1:0})}}i.prototype.formatNumber=function(i,n){var o=this.scaleValue(i),r="number"==typeof n?n:o.decimals,s=t.Utilities.formatNumber(o.value,r);return o.unit?e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/FormattedNumberWithUnits",s,o.unit):s};i.prototype.scaleValue=function(e){for(var t,i=e,n=0,o=0;o<this._localizedUnits.length;++o){var r=this._localizedUnits[o];if(!(r.LowerBound<=e))break;i=e;n=r.Decimals;r.Divider&&(i/=r.Divider);var s=Math.pow(10,r.Decimals);i=Math.round(i*s)/s;t=r.Unit}return{value:i,unit:t,decimals:n}};return i}();t.LocalizedUnitConverter=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){"use strict";var t=function(){function e(){}e.registerClass=function(e){if(!e)throw new Error("Invalid class name.");for(var t=window||this,i=e.split("."),n=null,o=0;o<i.length;o++){if(!(n=t[i[o]]))throw new Error("Invalid class name.");t=n}this.RegisteredClasses[e]=n};e.registerFunction=function(e){for(var t=window||this,i=e.split("."),n=null,o=0;o<i.length;o++){if(!(n=t[i[o]]))throw new Error("Invalid function name.");t=n}this.RegisteredFunctions[e]=n};e.getRegisteredClass=function(e){return this.RegisteredClasses[e]};e.getRegisteredFunction=function(e){return this.RegisteredFunctions[e]};e.RegisteredClasses={};e.RegisteredFunctions={};return e}();e.RegisterNamespace=t}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function t(){this._logger=e.VisualStudio.DiagnosticsHub.getLogger();this._container=document.createElement("div");this._container.classList.add("scrollbar");this._onScrollBoundFunction=this.onScrollEvent.bind(this);this._container.onscroll=this._onScrollBoundFunction;this._scrollbarCalculator=document.createElement("div");this._scrollbarCalculator.classList.add("scrollbar-width-calculator");this._scrollbarCalculator.id="scrollbarWidthCalculator";this._container.appendChild(this._scrollbarCalculator);this._scrollbarCalculator.style.left=this._container.clientWidth-2+"px";this._container.scrollLeft=this._container.scrollWidth-this._container.offsetWidth}Object.defineProperty(t.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0});t.prototype.dispose=function(){this._container.onscroll=null;this._animationFrameHandle&&window.cancelAnimationFrame(this._animationFrameHandle)};t.prototype.resize=function(e){var t=this;this._animationFrameHandle||(this._animationFrameHandle=window.requestAnimationFrame(function(){return t.onScrollAnimation()}))};t.prototype.update=function(e,t){var i=this,n=parseInt(t.elapsed.value),o=parseInt(t.begin.value),r=parseInt(e.elapsed.value),s=parseInt(e.begin.value);if(!(isNaN(n)||isNaN(o)||isNaN(r)||isNaN(s)||0===n)){this._startPages=(o-s)/n;this._totalPages=r/n;this._animationFrameHandle||(this._animationFrameHandle=window.requestAnimationFrame(function(){return i.onScrollAnimation()}))}};t.prototype.scrollTo=function(e){var t=this;this._startPages=e*this._totalPages/100;this._animationFrameHandle||window.cancelAnimationFrame(this._animationFrameHandle);this._animationFrameHandle=window.requestAnimationFrame(function(){return t.onScrollAnimation(!1)})};t.prototype.onScrollAnimation=function(e){void 0===e&&(e=!0);var t=this._container.clientWidth,i=this._totalPages*t,n=this._totalPages<=1?0:this._startPages*t;this._scrollbarCalculator.style.left=i-2+"px";if(this._container.scrollLeft!==n)if(e){this._container.onscroll=null;this._container.scrollLeft=n;this._container.onscroll=this._onScrollBoundFunction}else this._container.scrollLeft=n;this._animationFrameHandle=null};t.prototype.onScrollEvent=function(e){this._startPages=this._container.scrollLeft/this._container.clientWidth;this.onScroll&&this.onScroll({position:this._container.scrollLeft,visibleLength:this._container.clientWidth,totalLength:this._container.scrollWidth})};return t}();t.Scrollbar=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(i){void 0===i&&(i=6e7);var n=this;this._viewportStateChangedEvent=new t.AggregatedEvent;this._isZoomed=!1;this._isScrolling=!1;this._isSelecting=!1;this._isUserInteracting=!1;this._commands=[];var o=new t.JsonTimespan(t.BigNumber.zero,t.BigNumber.zero);this._currentSelection=null;this._viewportTimeRange=o;this._viewableTimeRange=o;this._rolledViewableTimeRange=o;this._timeInNsPerPixel=i;this._maxViewableWidthInNs=t.BigNumber.convertFromNumber(100*this._timeInNsPerPixel);this._scrollbar=new t.Scrollbar;this._scrollbar.onScroll=this.onScroll.bind(this);this._scrollbar.update(this._viewableTimeRange,this._viewportTimeRange);this._onSelectionChangedBoundFunction=this.onSelectionChanged.bind(this);this._onChangeViewportBoundFunction=this.onChangeViewport.bind(this);this._telemetry=new t.Telemetry.ViewportController;this._viewEventManager=e.VisualStudio.DiagnosticsHub.getViewEventManager();this._viewEventManager.selectionChanged.addEventListener(this._onSelectionChangedBoundFunction);this._viewEventManager.changeViewport.addEventListener(this._onChangeViewportBoundFunction);this._commands.push({id:t.CommandIds.ZoomIn,callback:this.zoomIn.bind(this),label:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarZoomInButton"),ariaLabel:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarZoomInAriaLabel"),tooltip:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarZoomInButton"),type:1,iconEnabled:"vs-image-toolbar-chartzoom-in",iconDisabled:"vs-image-toolbar-chartzoom-in-disabled",accessKey:null,hidden:function(){return!1},disabled:function(){return!n.canZoomIn()},checked:function(){return!1},cssClass:null,submenu:null,displayOnToolbar:!0,displayOnContextMenu:!0});this._commands.push({id:t.CommandIds.ZoomToSelection,callback:this.zoomToSelection.bind(this),label:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarZoomToSelectionButton"),ariaLabel:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarZoomToSelectionAriaLabel"),tooltip:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarZoomToSelectionButton"),type:1,iconEnabled:"vs-image-toolbar-chartzoom-in",iconDisabled:"vs-image-toolbar-chartzoom-in-disabled",accessKey:null,hidden:function(){return!1},disabled:function(){return!n.canZoomToSelection()},checked:function(){return!1},cssClass:null,submenu:null,displayOnToolbar:!1,displayOnContextMenu:!0});this._commands.push({id:t.CommandIds.ZoomOut,callback:this.zoomOut.bind(this),label:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarZoomOutButton"),ariaLabel:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarZoomOutAriaLabel"),tooltip:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarZoomOutButton"),type:1,iconEnabled:"vs-image-toolbar-chartzoom-reset",iconDisabled:"vs-image-toolbar-chartzoom-reset-disabled",accessKey:null,hidden:function(){return!1},disabled:function(){return!n.canZoomOut()},checked:function(){return!1},cssClass:null,submenu:null,displayOnToolbar:!0,displayOnContextMenu:!0});this._commands.push({id:t.CommandIds.ResetView,callback:this.resetView.bind(this),label:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarResetViewButton"),ariaLabel:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarResetViewAriaLabel"),tooltip:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarResetViewButton"),type:1,iconEnabled:"vs-image-toolbar-reset-view",iconDisabled:"vs-image-toolbar-reset-view-disabled",accessKey:null,hidden:function(){return!1},disabled:function(){return!n.canResetView()},checked:function(){return!1},cssClass:null,submenu:null,displayOnToolbar:!0,displayOnContextMenu:!0});this._viewportStateChangedEvent.addEventListener(function(){n._commands.forEach(function(e){e.onDisabledChanged&&e.onDisabledChanged()})})}Object.defineProperty(i.prototype,"container",{get:function(){return this._scrollbar.container},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"viewportStateChanged",{get:function(){return this._viewportStateChangedEvent},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"visible",{get:function(){return this._viewportTimeRange},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"viewable",{get:function(){return this._viewableTimeRange},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"selection",{get:function(){return this._currentSelection},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"scrollbar",{get:function(){return this._scrollbar},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"commands",{get:function(){return this._commands},enumerable:!0,configurable:!0});i.prototype.dispose=function(){this._scrollbar.onScroll=null;this._scrollbar.dispose();this._viewEventManager.selectionChanged.removeEventListener(this._onSelectionChangedBoundFunction);this._viewEventManager.changeViewport.removeEventListener(this._onChangeViewportBoundFunction);this._viewportStateChangedEvent.dispose()};i.prototype.resize=function(e){this._scrollbar.resize(e);var i=Math.max(this.container.clientWidth,100);this._maxViewableWidthInNs=t.BigNumber.convertFromNumber(i*this._timeInNsPerPixel);this.rollTimeRange(!0)};i.prototype.onDataUpdate=function(e){if(t.BigNumber.subtract(e,i.DropPointLimitInNs).greater(this._viewableTimeRange.begin)){this._viewableTimeRange=new t.JsonTimespan(t.BigNumber.subtract(e,i.OneHourInNs),e);this.rollTimeRange(!0)}else{this._viewableTimeRange=new t.JsonTimespan(this._viewableTimeRange.begin,e);this.rollTimeRange()}};i.prototype.canZoomIn=function(){var e=t.BigNumber.divideNumber(this._viewportTimeRange.elapsed,2);return!i.MinimumZoomTimeInNs.greater(e)};i.prototype.zoomIn=function(){if(this.canZoomIn()){this._telemetry.zoomIn();var e,i,n=t.BigNumber.divideNumber(this._viewportTimeRange.elapsed,4);if(this._currentSelection){var o=t.BigNumber.add(this._currentSelection.begin,t.BigNumber.divideNumber(this._currentSelection.elapsed,2));e=t.BigNumber.subtract(o,n);i=t.BigNumber.add(o,n)}else if(this._viewableTimeRange.elapsed.greater(this._viewportTimeRange.elapsed)){e=t.BigNumber.add(this._viewportTimeRange.begin,n);i=t.BigNumber.subtract(this._viewportTimeRange.end,n)}else{e=this._viewableTimeRange.begin;i=t.BigNumber.add(e,t.BigNumber.divideNumber(this._viewportTimeRange.elapsed,2))}this._viewportTimeRange=new t.JsonTimespan(e,i);this._isZoomed=!0;this._isUserInteracting=!0;this._scrollbar.update(this._rolledViewableTimeRange,this._viewportTimeRange);this.fireViewportStateChanged()}};i.prototype.canZoomToSelection=function(){return this._currentSelection&&!this._currentSelection.equals(this._viewportTimeRange)&&!i.MinimumZoomTimeInNs.greater(this._currentSelection.elapsed)};i.prototype.zoomToSelection=function(){if(this.canZoomToSelection()){this._telemetry.zoomIn();this._viewportTimeRange=this._currentSelection;this._isZoomed=!0;this._scrollbar.update(this._rolledViewableTimeRange,this._viewportTimeRange);this.fireViewportStateChanged()}};i.prototype.canZoomOut=function(){return i.OneHourInNs.greater(this._viewportTimeRange.elapsed)};i.prototype.zoomOut=function(){if(this.canZoomOut()){this._telemetry.zoomOut();var e=t.BigNumber.divideNumber(this._viewportTimeRange.elapsed,2),n=t.BigNumber.subtract(this._viewportTimeRange.begin,e);n=n.greater(this._viewableTimeRange.begin)?n:this._viewableTimeRange.begin;var o=t.BigNumber.min(i.OneHourInNs,t.BigNumber.multiplyNumber(e,4));this._viewportTimeRange=new t.JsonTimespan(n,t.BigNumber.add(n,o));this._viewportTimeRange.end.greater(this._rolledViewableTimeRange.end)&&(this._rolledViewableTimeRange=new t.JsonTimespan(this._rolledViewableTimeRange.begin,this._viewportTimeRange.end));this._isZoomed=!0;this._scrollbar.update(this._rolledViewableTimeRange,this._viewportTimeRange);this.fireViewportStateChanged()}};i.prototype.canResetView=function(){return void 0!==this._currentSelection&&null!==this._currentSelection||this._isZoomed||this._isScrolling};i.prototype.resetView=function(){if(this.canResetView()){this._telemetry.clearSelection();this._isZoomed=!1;this._isScrolling=!1;this._isUserInteracting=!1;this.rollTimeRange(!0);this._viewEventManager.selectionChanged.raiseEvent({position:null,isIntermittent:!1})}};i.prototype.requestViewportChange=function(e){if(this._isSelecting)return!1;var n=e.currentTimespan.begin.equals(t.BigNumber.zero)&&e.currentTimespan.end.equals(t.BigNumber.zero)||this._rolledViewableTimeRange.contains(e.currentTimespan.begin)&&this._rolledViewableTimeRange.contains(e.currentTimespan.end),o=!e.selectionTimespan||this._viewableTimeRange.contains(e.selectionTimespan.begin)&&this._viewableTimeRange.contains(e.selectionTimespan.end);if(!n||!o){t.Debug.Assert.isTrue(n,"Invalid viewport specified");t.Debug.Assert.isTrue(o,"Invalid selection specified");return!1}var r=e.currentTimespan,s=new t.JsonTimespan(t.BigNumber.zero,t.BigNumber.zero),a=e.currentTimespan.equals(s);a&&(r=new t.JsonTimespan(t.BigNumber.subtract(this._rolledViewableTimeRange.end,t.BigNumber.min(this._viewportTimeRange.elapsed,this._rolledViewableTimeRange.end)),this._rolledViewableTimeRange.end));if(r.begin.greaterOrEqual(this._rolledViewableTimeRange.end)||this._rolledViewableTimeRange.begin.greaterOrEqual(r.end))return!1;if(a||r.end.greater(this._viewableTimeRange.end)&&this._rolledViewableTimeRange.end.greater(r.end)){this._rolledViewableTimeRange=new t.JsonTimespan(this._rolledViewableTimeRange.begin,r.end);this._isScrolling=!1;this._isUserInteracting=!1}else this._isUserInteracting=!0;r=new t.JsonTimespan(t.BigNumber.max(r.begin,this._rolledViewableTimeRange.begin),t.BigNumber.min(r.end,this._rolledViewableTimeRange.end));if(i.MinimumZoomTimeInNs.greater(r.elapsed)){var u=t.BigNumber.subtract(r.end,i.MinimumZoomTimeInNs);if(u.greaterOrEqual(this._rolledViewableTimeRange.begin))r=new t.JsonTimespan(u,r.end);else{var l=t.BigNumber.add(r.begin,i.MinimumZoomTimeInNs);if(!this._rolledViewableTimeRange.end.greaterOrEqual(l))return!1;r=new t.JsonTimespan(r.begin,l)}}var c=!this.isSameSelection(e.selectionTimespan);if(!c&&this._viewportTimeRange.equals(r))return!1;this._isZoomed=!0;this._viewportTimeRange=r;this._scrollbar.update(this._rolledViewableTimeRange,this._viewportTimeRange);if(c){this._currentSelection=e.selectionTimespan;this._viewEventManager.selectionChanged.raiseEvent({position:this._currentSelection,isIntermittent:!1})}this.fireViewportStateChanged(!1);return!0};i.prototype.rollTimeRange=function(e){void 0===e&&(e=!1);var i=!1;if(this._viewableTimeRange.end.greater(this._rolledViewableTimeRange.end)||e){for(var n=e?new t.JsonTimespan(this._viewableTimeRange.begin,t.BigNumber.add(this._viewableTimeRange.begin,this._maxViewableWidthInNs)):this._rolledViewableTimeRange;this._viewableTimeRange.end.greater(n.end);){var o=t.BigNumber.divideNumber(this._maxViewableWidthInNs,3);n=new t.JsonTimespan(n.begin,t.BigNumber.add(n.end,o))}i=!this._rolledViewableTimeRange.equals(n);this._rolledViewableTimeRange=n}if(!(this._isSelecting||this._currentSelection||this._isUserInteracting||this._isScrolling)){var r=e?this._maxViewableWidthInNs:t.BigNumber.max(this._maxViewableWidthInNs,this._viewportTimeRange.elapsed),s=new t.JsonTimespan(t.BigNumber.subtract(this._rolledViewableTimeRange.end,r),this._rolledViewableTimeRange.end);if(!this._viewportTimeRange.equals(s)){i=!0;this._viewportTimeRange=s;this.fireViewportStateChanged()}}i&&this._scrollbar.update(this._rolledViewableTimeRange,this._viewportTimeRange)};i.prototype.onChangeViewport=function(e){var n=new t.JsonTimespan(t.BigNumber.zero,t.BigNumber.zero),o=e.equals(n);o&&(e=new t.JsonTimespan(t.BigNumber.subtract(this._rolledViewableTimeRange.end,t.BigNumber.min(this._viewportTimeRange.elapsed,this._rolledViewableTimeRange.end)),this._rolledViewableTimeRange.end));if(e.begin.greaterOrEqual(this._rolledViewableTimeRange.end)||this._rolledViewableTimeRange.begin.greaterOrEqual(e.end))return!1;if(o||e.end.greater(this._viewableTimeRange.end)&&this._rolledViewableTimeRange.end.greater(e.end)){this._rolledViewableTimeRange=new t.JsonTimespan(this._rolledViewableTimeRange.begin,e.end);this._isScrolling=!1;this._isUserInteracting=!1}else this._isUserInteracting=!0;var r=new t.JsonTimespan(t.BigNumber.max(e.begin,this._rolledViewableTimeRange.begin),t.BigNumber.min(e.end,this._rolledViewableTimeRange.end));if(i.MinimumZoomTimeInNs.greater(r.elapsed)){var s=t.BigNumber.subtract(r.end,i.MinimumZoomTimeInNs);if(s.greaterOrEqual(this._rolledViewableTimeRange.begin))r=new t.JsonTimespan(s,r.end);else{var a=t.BigNumber.add(r.begin,i.MinimumZoomTimeInNs);if(!this._rolledViewableTimeRange.end.greaterOrEqual(a))return!1;r=new t.JsonTimespan(r.begin,a)}}if(this._viewportTimeRange.equals(r))return!1;this._isZoomed=!0;this._viewportTimeRange=r;this._scrollbar.update(this._rolledViewableTimeRange,this._viewportTimeRange);this.fireViewportStateChanged();return!0};i.prototype.onSelectionChanged=function(e){this._isSelecting=e.isIntermittent;if(null!==e.position&&void 0!==e.position&&e.position.end.greater(this._viewableTimeRange.end)){var i=t.BigNumber.min(e.position.begin,this._viewableTimeRange.end);this._viewEventManager.selectionChanged.raiseEvent({position:new t.JsonTimespan(i,this._viewableTimeRange.end),isIntermittent:this._isSelecting})}else if(!this.isSameSelection(e.position)){this._currentSelection=e.position;this.fireViewportStateChanged(this._isSelecting)}};i.prototype.onScroll=function(e){if(e.totalLength){if(Math.abs(e.position+e.visibleLength-e.totalLength)>1)this._isScrolling=!0;else{this._isScrolling=!1;this._isUserInteracting=!1}var i=t.BigNumber.addNumber(this._rolledViewableTimeRange.begin,parseInt(this._rolledViewableTimeRange.elapsed.value)*e.position/e.totalLength),n=t.BigNumber.add(i,this._viewportTimeRange.elapsed);this._viewportTimeRange=new t.JsonTimespan(i,n);this.fireViewportStateChanged()}};i.prototype.fireViewportStateChanged=function(e){void 0===e&&(e=!1);this._viewportStateChangedEvent.invokeEvent({currentTimespan:this._viewportTimeRange,selectionTimespan:this._currentSelection,isIntermittent:e})};i.prototype.isSameSelection=function(e){return!this._currentSelection&&!e||this._currentSelection&&e&&this._currentSelection.equals(e)};i.MinimumZoomTimeInNs=t.BigNumber.convertFromNumber(1e4);i.OneHourInNs=t.BigNumber.convertFromNumber(36e11);i.DropPointLimitInNs=t.BigNumber.convertFromNumber(366e10);return i}();t.RollingViewportController=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));var Microsoft;__extends=this.__extends||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);function n(){this.constructor=e}n.prototype=t.prototype;e.prototype=new n};!function(e){!function(t){!function(t){"use strict";var i=function(){function e(){}Object.defineProperty(e,"Line",{get:function(){return"Line"},enumerable:!0,configurable:!0});Object.defineProperty(e,"Mark",{get:function(){return"Mark"},enumerable:!0,configurable:!0});return e}();t.SeriesType=i;var n=function(){function e(){}Object.defineProperty(e,"Graph",{get:function(){return"Graph"},enumerable:!0,configurable:!0});Object.defineProperty(e,"Ruler",{get:function(){return"Ruler"},enumerable:!0,configurable:!0});return e}();t.ViewType=n;!function(e){e[e.None=0]="None";e[e.Live=1]="Live";e[e.PostMortem=2]="PostMortem"}(t.GraphBehaviourType||(t.GraphBehaviourType={}));t.GraphBehaviourType;var o=function(){function e(){}Object.defineProperty(e,"ScaleInfoChanged",{get:function(){return"scaleInfoChanged"},enumerable:!0,configurable:!0});return e}();t.GraphEvents=o;!function(e){e[e.Left=0]="Left";e[e.Right=1]="Right"}(t.ScaleType||(t.ScaleType={}));t.ScaleType;!function(e){e[e.LessThanOrEqual=0]="LessThanOrEqual";e[e.Nearest=1]="Nearest";e[e.GreaterThanOrEqual=2]="GreaterThanOrEqual"}(t.PointToFind||(t.PointToFind={}));t.PointToFind;!function(e){e[e.Unknown=0]="Unknown";e[e.Standard=1]="Standard";e[e.Custom=2]="Custom";e[e.FullCustom=3]="FullCustom"}(t.SwimlaneType||(t.SwimlaneType={}));t.SwimlaneType;!function(e){e[e.LifeCycleEvent=1]="LifeCycleEvent";e[e.UserMark=2]="UserMark";e[e.Custom=3]="Custom"}(t.MarkType||(t.MarkType={}));t.MarkType;!function(e){e[e.Big=0]="Big";e[e.Medium=1]="Medium";e[e.Small=2]="Small"}(t.TickMarkType||(t.TickMarkType={}));t.TickMarkType;!function(e){e[e.italicizedAbbreviations=0]="italicizedAbbreviations";e[e.fullName=1]="fullName"}(t.UnitFormat||(t.UnitFormat={}));t.UnitFormat;!function(e){e[e.perfDiagnosticsHub_ZoomSelectionBegin=25225]="perfDiagnosticsHub_ZoomSelectionBegin";e[e.perfDiagnosticsHub_ZoomSelectionEnd=25226]="perfDiagnosticsHub_ZoomSelectionEnd";e[e.perfDiagnosticsHub_SwimlaneFullRenderBegin=25227]="perfDiagnosticsHub_SwimlaneFullRenderBegin";e[e.perfDiagnosticsHub_SwimlaneFullRenderEnd=25228]="perfDiagnosticsHub_SwimlaneFullRenderEnd";e[e.perfDiagnosticsHub_GraphContentFullRenderBegin=25229]="perfDiagnosticsHub_GraphContentFullRenderBegin";e[e.perfDiagnosticsHub_GraphContentFullRenderEnd=25230]="perfDiagnosticsHub_GraphContentFullRenderEnd";e[e.perfDiagnosticsHub_GraphContentPartialRenderBegin=25231]="perfDiagnosticsHub_GraphContentPartialRenderBegin";e[e.perfDiagnosticsHub_GraphContentPartialRenderEnd=25232]="perfDiagnosticsHub_GraphContentPartialRenderEnd";e[e.perfDiagnosticsHub_OnSelectionChangedBegin=25233]="perfDiagnosticsHub_OnSelectionChangedBegin";e[e.perfDiagnosticsHub_OnSelectionChangedEnd=25234]="perfDiagnosticsHub_OnSelectionChangedEnd";e[e.perfDiagnosticsHub_OnDataUpdateBegin=25235]="perfDiagnosticsHub_OnDataUpdateBegin";e[e.perfDiagnosticsHub_OnDataUpdateEnd=25236]="perfDiagnosticsHub_OnDataUpdateEnd";e[e.perfDiagnosticsHub_ResetZoomBegin=25237]="perfDiagnosticsHub_ResetZoomBegin";e[e.perfDiagnosticsHub_ResetZoomEnd=25238]="perfDiagnosticsHub_ResetZoomEnd";e[e.perfDiagnosticsHub_ZoomOutBegin=25255]="perfDiagnosticsHub_ZoomOutBegin";e[e.perfDiagnosticsHub_ZoomOutEnd=25256]="perfDiagnosticsHub_ZoomOutEnd"}(t.ControlsCodeMarkers||(t.ControlsCodeMarkers={}));t.ControlsCodeMarkers;var r=function(){function e(e,t,i,n){this.left=e;this.top=t;this.right=i;this.bottom=n}return e}();t.Padding=r;var s=function(t){__extends(i,t);function i(i,n,o,r){t.call(this,i,n,o,r);if(this.left>this.right||this.top>this.bottom)throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.1000"))}Object.defineProperty(i.prototype,"width",{get:function(){return this.right-this.left},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"height",{get:function(){return this.bottom-this.top},enumerable:!0,configurable:!0});return i}(r);t.RectangleDimension=s;var a=function(){function e(e,t){this.min=e;this.max=t}Object.defineProperty(e.prototype,"range",{get:function(){return!this.min&&0!==this.min||!this.max&&0!==this.max?null:this.max-this.min},enumerable:!0,configurable:!0});return e}();t.MinMaxNumber=a}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function t(){this._graphConfigurationMarshaler=e.Plugin.Utilities.JSONMarshaler.attachToPublishedObject("Microsoft.DiagnosticsHub.VisualStudio.Presentation.JavaScriptModels.SwimLanesViewMarshaler",{},!0);if(!this._graphConfigurationMarshaler)throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.1007"))}t.prototype.getConfigurations=function(e){this._graphConfigurationMarshaler._call("getConfigurations").then(e)};t.prototype.dataUpdate=function(e){this._graphConfigurationMarshaler.addEventListener("dataUpdate",e)};return t}();t.DiagnosticsHubDataManager=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){!function(t){var i=function(){function t(){}t.loadCss=function(t){if("string"!=typeof t&&t.lastIndexOf(".css")!==t.length-4)throw new Error("file name is null or undefined.");var i=t.substring(t.lastIndexOf("\\")+1,t.lastIndexOf(".css"));if(!document.getElementById(i))return e.Plugin.Theme.processCSSFileForThemeing(t).then(function(e){var i=document.createElement("style");i.setAttribute("data-plugin-theme","true");i.setAttribute("data-plugin-theme-href",t);i.type="text/css";i.innerHTML=e;document.getElementsByTagName("head")[0].appendChild(i)})};t.loadDependency=function(e){var i=t.toFileUri(e.url).toUpperCase();if(t.isScriptAppended(i)){var n=Promise.resolve(null);t.LoadingDependenciesMap[i]&&(n=t.LoadingDependenciesMap[i]);return n.then(function(){return t.registerDependency(e)})}var o=document.createElement("script");o.type="text/javascript";o.src=e.url;t.LoadingDependenciesMap[i]=new Promise(function(n,r,s){o.onload=function(){delete t.LoadingDependenciesMap[i];t.registerDependency(e);n(null)};o.onerror=function(){if(!r)throw new Error("Unable to load resource: "+e.url);r(null)}});document.getElementsByTagName("head")[0].appendChild(o);return t.LoadingDependenciesMap[i]};t.registerDependency=function(t){t.objType&&e.VisualStudio.DiagnosticsHub.RegisterNamespace.registerClass(t.objType);t.functionName&&e.VisualStudio.DiagnosticsHub.RegisterNamespace.registerFunction(t.functionName)};t.isScriptAppended=function(e){for(var t=0;t<document.scripts.length;++t){var i=document.scripts[t];if(i.src&&decodeURIComponent(i.src).toUpperCase()===e.toUpperCase())return!0}return!1};t.toFileUri=function(e){var i=e.split("\\").join("/");i.substr(0,t.FileUriPrefix.length).toUpperCase()!==t.FileUriPrefix.toUpperCase()&&(i=t.FileUriPrefix+i);return i};t.LoadingDependenciesMap={};t.FileUriPrefix="file:///";return t}();t.DependencyManager=i}(t.Common||(t.Common={}));t.Common}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){!function(e){"use strict";!function(e){e[e.Tab=9]="Tab";e[e.Enter=13]="Enter";e[e.Shift=16]="Shift";e[e.Escape=27]="Escape";e[e.Space=32]="Space";e[e.PageUp=33]="PageUp";e[e.PageDown=34]="PageDown";e[e.End=35]="End";e[e.Home=36]="Home";e[e.ArrowLeft=37]="ArrowLeft";e[e.ArrowFirst=37]="ArrowFirst";e[e.ArrowUp=38]="ArrowUp";e[e.ArrowRight=39]="ArrowRight";e[e.ArrowDown=40]="ArrowDown";e[e.ArrowLast=40]="ArrowLast";e[e.Delete=46]="Delete";e[e.B=66]="B";e[e.C=67]="C";e[e.Plus=107]="Plus";e[e.Minus=109]="Minus";e[e.F1=112]="F1";e[e.F2=113]="F2";e[e.F3=114]="F3";e[e.F4=115]="F4";e[e.F5=116]="F5";e[e.F6=117]="F6";e[e.F7=118]="F7";e[e.F8=119]="F8";e[e.F9=120]="F9";e[e.F10=121]="F10";e[e.F11=122]="F11";e[e.F12=123]="F12"}(e.KeyCodes||(e.KeyCodes={}));e.KeyCodes;!function(e){e[e.Left=1]="Left";e[e.Right=3]="Right";e[e.Middle=2]="Middle"}(e.MouseCodes||(e.MouseCodes={}));e.MouseCodes}(e.Common||(e.Common={}));e.Common}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(n){var o=this;this._command=n;this._command.disabled=this._command.disabled||function(){return!1};this._container=document.createElement("button");this._container.classList.add(i.ButtonDisabledCss);this._container.classList.add(this._command.cssClass);this._container.disabled=this._command.disabled();this._command.tooltip&&this._container.setAttribute("data-plugin-vs-tooltip",JSON.stringify({content:this._command.tooltip}));this._container.setAttribute("role","button");this._container.setAttribute("aria-label",this._command.ariaLabel||this._command.label);if(this._command.iconEnabled){var r=document.createElement("div");r.classList.add(i.ButtonImageCss);r.classList.add(i.SvgEnabled);r.appendChild(t.Utilities.getSVGPlaceHolder(this._command.iconEnabled));this._container.appendChild(r);e.Plugin.Theme.processInjectedSvg(r)}if(this._command.iconDisabled){var s=document.createElement("div");s.classList.add(i.ButtonImageCss);s.classList.add(i.SvgDisabled);s.appendChild(t.Utilities.getSVGPlaceHolder(this._command.iconDisabled));this._container.appendChild(s);e.Plugin.Theme.processInjectedSvg(s)}var a=document.createElement("div");a.innerHTML=this._command.label;a.classList.add(i.ButtonTextCss);a.classList.add(i.ButtonTextDisabledCss);this._container.appendChild(a);this._container.onclick=this.onClick.bind(this);this._container.onkeydown=this.onKeyDown.bind(this);this._command.onDisabledChanged=function(){o.setEnabled(!o._command.disabled())};e.Plugin.Theme.addEventListener("themechanged",function(){o.setEnabled(!o._command.disabled())});this._currentState=this._container.disabled;this.setEnabled(!this._container.disabled)}Object.defineProperty(i.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0});i.prototype.onKeyDown=function(e){this._container.disabled||13!==e.keyCode||this._command.callback()};i.prototype.onClick=function(e){this._container.disabled||this._command.callback()};i.prototype.setEnabled=function(e){if(this._currentState!==e){this._currentState=e;this._container.disabled=!e;var t=this._container.getElementsByClassName(i.ButtonTextCss)[0];if(e){t.classList.remove(i.ButtonTextDisabledCss);this._container.tabIndex=0;this._container.classList.remove(i.ButtonDisabledCss);this._container.classList.add(i.ButtonCss)}else{t.classList.add(i.ButtonTextDisabledCss);this._container.tabIndex=-1;this._container.classList.add(i.ButtonDisabledCss);this._container.classList.remove(i.ButtonCss)}}};i.ButtonCss="toolbar-button";i.ButtonDisabledCss="toolbar-button-disabled";i.ButtonImageCss="button-image";i.ButtonTextCss="button-text";i.ButtonTextDisabledCss="button-text-disabled";i.SvgDisabled="svg-disabled";i.SvgEnabled="svg-enabled";return i}();t.ToolbarButton=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){"use strict";var t=function(){function e(){this._container=document.createElement("div");this._container.classList.add("toolbar-separator");this._container.innerHTML="&nbsp;"}Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0});return e}();e.ToolbarSeparator=t}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){"use strict";var t=function(){function t(){var e=this;this._items=[];this._container=document.createElement("div");this._container.classList.add("toolbar-container");this._collapseCallback=function(t){t.matches?e._container.classList.add("limitedSpace"):e._container.classList.remove("limitedSpace")};this.updateCollapsingWidth()}Object.defineProperty(t.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0});t.prototype.addCommand=function(t){t.displayOnToolbar&&this.addToolbarItem(new e.ToolbarButton(t))};t.prototype.addCommandGroup=function(e){var t=this;this._items.length>0&&e.length>0&&this.addSeparator();e.forEach(function(e){t.addCommand(e)})};t.prototype.addToolbarItem=function(e){this._items.push(e);this._container.appendChild(e.container);this.updateCollapsingWidth()};t.prototype.addSeparator=function(){this.addToolbarItem(new e.ToolbarSeparator)};t.prototype.updateCollapsingWidth=function(){this._collapseMediaQuery&&this._collapseMediaQuery.removeListener(this._collapseCallback);var t=60;this._items.forEach(function(e){t+=e.container.offsetWidth});this._collapseMediaQuery=window.matchMedia(e.Utilities.formatString("(max-width: {0}px)",t.toString()));this._collapseMediaQuery.addListener(this._collapseCallback);this._collapseCallback(this._collapseMediaQuery)};return t}();e.Toolbar=t}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(){}i.findChildById=function(e,t){for(var i=[],n=e;n;){if(n.id===t)return n;for(var o=0;o<n.children.length;++o)i.push(n.children[o]);n=i.shift()}return null};i.findLessThan=function(e,t,n,o,r){void 0===o&&(o=0);void 0===r&&(r=e.length-1);if(r===o)return o;if(r-o<=1)return n(e[r],t)?r:o;var s=Math.floor((r+o)/2);return n(t,e[s])?i.findLessThan(e,t,n,o,s):i.findLessThan(e,t,n,s,r)};i.findGreaterThan=function(e,t,n,o,r){void 0===o&&(o=0);void 0===r&&(r=e.length-1);if(r===o)return r;if(r-o<=1)return n(t,e[o])?o:r;var s=Math.floor((r+o)/2);return n(t,e[s])?i.findGreaterThan(e,t,n,o,s):i.findGreaterThan(e,t,n,s,r)};i.scaleToRange=function(e,t,i,n,o){return i===t?0:(o-n)*(e-t)/(i-t)+n};i.linearInterpolate=function(e,i,n,o,r){return i.equals(o)?n:n+(r-n)*parseInt(t.BigNumber.subtract(e,i).value)/parseInt(t.BigNumber.subtract(o,i).value)};i.convertToPixel=function(e,i,n,o){void 0===o&&(o=!0);if(o&&(i.elapsed.equals(t.BigNumber.zero)||n<=0))return 0;var r,s=1;if(i.begin.greater(e)){s=-1;r=parseInt(t.BigNumber.subtract(i.begin,e).value)}else r=parseInt(t.BigNumber.subtract(e,i.begin).value);return s*(r/parseInt(i.elapsed.value))*n};i.getTimestampAtPixel=function(e,i,n){return i>0?t.BigNumber.addNumber(n.begin,parseInt(n.elapsed.value)/i*e):t.BigNumber.zero};i.translateNumPixelToDuration=function(e,t,i){return t>0?parseInt(i.elapsed.value)/t*e:0};i.formatNumber=function(e,t){var n;n=null===t||void 0===t?e.toString():e.toFixed(t);var o=i.getNumberFormat();return n.replace(".",o.numberDecimalSeparator)};i.formatString=function(e){for(var t=[],i=0;i<arguments.length-1;i++)t[i]=arguments[i+1];var n=e;t.forEach(function(e,t){n=n.replace("{"+t+"}",e)});return n};i.getNumberFormat=function(){var t=e.Plugin.Culture.NumberFormat;t&&0!==t.length||(t={numberDecimalSeparator:"."});return t};i.containsPoint=function(e,t,i){return e.left<=t&&e.right>=t&&e.top<=i&&e.bottom>=i};i.getSVGPlaceHolder=function(e){var t=document.createElement("div");t.setAttribute("data-plugin-svg",e);return t};i.setCapture=function(e){if(e)try{if(e.setCapture){e.setCapture(!0);return}if(e.msSetPointerCapture){e.msSetPointerCapture(i.MousePointerId);return}if(e.setPointerCapture){e.setPointerCapture(i.MousePointerId);return}}catch(e){t.getLogger().error(e.message)}};i.releaseCapture=function(e){if(e)try{if(e.releaseCapture){e.releaseCapture();return}if(e.msReleasePointerCapture){e.msReleasePointerCapture(i.MousePointerId);return}if(e.releasePointerCapture){e.releasePointerCapture(i.MousePointerId);return}}catch(e){t.getLogger().error(e.message)}};i.MousePointerId=1;return i}();t.Utilities=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){!function(t){var i=function(){function t(e,t){this._container=e;this._elementCreator=t;this._index=null;this._elements=[];this._recycledElements=[]}t.forDivWithClass=function(e,i){return new t(e,function(){var e=document.createElement("div");e.className=i;return e})};t.prototype.start=function(){this._index=0};t.prototype.getNext=function(){if(null===this._index)throw new Error(e.Plugin.Resources.getErrorString("JSPerf.1035"));var t=this._elements[this._index];if(!t){t=this._recycledElements.length>0?this._recycledElements.pop():this._elementCreator();this._elements.push(t);this._container.appendChild(t)}this._index++;return t};t.prototype.stop=function(){if(null!==this._index){for(var e=this._elements.length-1;e>=this._index;--e){var t=this._elements.pop();this._recycledElements.push(t);this._container.children.length>0&&t.parentElement&&this._container.removeChild(t)}this._index=null}};t.prototype.recycleAll=function(){for(var e=this._elements.length-1;e>=0;--e){var t=this._elements.pop();this._recycledElements.push(t);this._container.children.length>0&&t.parentElement&&this._container.removeChild(t)}};t.prototype.removeAll=function(){for(var e=this._elements.length-1;e>=0;--e){var t=this._elements.pop();this._container.children.length>0&&t.parentElement&&this._container.removeChild(t)}this._elements=[];this._recycledElements=[]};return t}();t.ElementRecyclerFactory=i}(t.Common||(t.Common={}));t.Common}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){"use strict";var t=function(){function e(e,t){this.time=e;this.tooltip=t}return e}();e.MarkData=t}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(i,n,o,r,s){void 0===s&&(s=!1);var a=this;this._clientWidth=0;this._clientHeight=0;this._rulerMarksImageWidth=9;this._minimumMarkDistance=7;this._timeRange=i;this._container=document.createElement("div");this._container.classList.add("ruler-scale-main");this._container.tabIndex=0;this._container.setAttribute("aria-label",e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/RulerMarkNavigation"));this._container.onkeydown=function(e){return a.onKeyDown(e)};this._seriesList=n;this._imageTokenList=o;this._aggregatedMarkImageToken=r;this._showZero=s;this._rulerMarks=[];this._canvas=document.createElement("canvas");this._canvas.classList.add("fullsizeOverlay");this._context=this._canvas.getContext("2d");this._context.lineWidth=1;this._strokeStyle=e.Plugin.Theme.getValue("diagnostics-host-ruler-tickmark");this._fontSize=e.Plugin.Theme.getValue("plugin-font-size");this._fontColor=e.Plugin.Theme.getValue("plugin-color");this._fontFamily=e.Plugin.Theme.getValue("plugin-font-family");this._container.appendChild(this._canvas);this._scaleMarksDiv=document.createElement("div");this._scaleMarksDiv.id="scaleMarks";this._container.appendChild(this._scaleMarksDiv);this._scaleMarkElementsFactory=new t.Common.ElementRecyclerFactory(this._scaleMarksDiv,function(){return a.createMarkVisual("ruler-scale-mark-image-event")});this._onThemeChangedBoundFunction=this.onThemeChanged.bind(this);e.Plugin.Theme.addEventListener("themechanged",this._onThemeChangedBoundFunction);this.renderTickMarks();this.renderMarks(!0)}Object.defineProperty(i.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0});i.prototype.dispose=function(){e.Plugin.Theme.removeEventListener("themechanged",this._onThemeChangedBoundFunction);this._scaleMarkElementsFactory.recycleAll();this._scaleMarkElementsFactory.removeAll()};i.prototype.resize=function(e){var t=this._container.clientWidth;if(this._clientWidth!==t){this._clientWidth=t;this._clientHeight=this._container.clientHeight;this._canvas.width=this._clientWidth;this._canvas.height=this._clientHeight;this.renderTickMarks();this.renderMarks(!0)}};i.prototype.onViewportChanged=function(e){if(!this._timeRange.equals(e.currentTimespan)){this._timeRange=e.currentTimespan;this.renderTickMarks();this.renderMarks(!0)}};i.prototype.addMark=function(e,t,i){void 0===i&&(i=!0);if(this._seriesList&&t&&t.time){for(var n=0;n<this._seriesList.length;n++)if(this._seriesList[n].id===e){var o=this._seriesList[n];o.data||(o.data=[]);o.data.push(t);this.createAggregatedMark(t,o.id-1);break}this._rulerMarks.sort(function(e,t){return e.time.compareTo(t.time)});(i||this._timeRange.contains(t.time))&&this.renderMarks(!1)}};i.prototype.onThemeChanged=function(){this._strokeStyle=e.Plugin.Theme.getValue("diagnostics-host-ruler-tickmark");this._fontSize=e.Plugin.Theme.getValue("plugin-font-size");this._fontColor=e.Plugin.Theme.getValue("plugin-color");this._fontFamily=e.Plugin.Theme.getValue("plugin-font-family");this.renderTickMarks();this.renderMarks(!0)};i.prototype.renderTickMarks=function(){var e=this;if(!this._timeRange.elapsed.equals(t.BigNumber.zero)){this._context.clearRect(0,0,this._clientWidth,this._clientHeight);this._context.strokeStyle=this._strokeStyle;this._context.fillStyle=this._fontColor;this._context.font=this._fontSize+" "+this._fontFamily;this._context.textBaseline="hanging";var i=this._clientHeight,n=.4*this._clientHeight,o=.2*this._clientHeight;t.RulerUtilities.getTickMarksPosition(this._timeRange,this._clientWidth,this._showZero).forEach(function(r){var s=t.Utilities.convertToPixel(r.value,e._timeRange,e._clientWidth,!1),a=0;switch(r.type){case 0:e._context.fillText(t.RulerUtilities.formatTime(r.value),s+2.5,0);a=i;break;case 1:a=n;break;case 2:a=o}e._context.beginPath();e._context.moveTo(s+.5,e._clientHeight);e._context.lineTo(s+.5,e._clientHeight-a);e._context.stroke()})}};i.prototype.renderMarks=function(t){var i=this;t&&this.createAggregateMarkList();if(this._rulerMarks){this._scaleMarkElementsFactory.start();this._rulerMarks.forEach(function(t){if(t.time&&i._timeRange.contains(t.time)){var n=i._scaleMarkElementsFactory.getNext();null!==t.glyphIndex&&void 0!==t.glyphIndex&&-1!==t.glyphIndex&&i._imageTokenList[t.glyphIndex]?n.style.backgroundImage="url("+e.Plugin.Theme.getValue(i._imageTokenList[t.glyphIndex])+")":n.style.backgroundImage="url("+e.Plugin.Theme.getValue(i._aggregatedMarkImageToken)+")";n.style.left=t.pixelPosition+"px";n.onmouseover=function(){return i.showMarkTooltip(t)};n.onmouseout=e.Plugin.Tooltip.dismiss;n.setAttribute("aria-label",e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/RulerMarkLabel",t.getAriaContent()))}});this._scaleMarkElementsFactory.stop()}};i.prototype.createAggregateMarkList=function(){var e=this;this._rulerMarks=[];if(this._seriesList){this._seriesList.forEach(function(t){t.data&&t.data.forEach(function(i){e._timeRange.contains(i.time)&&e.createAggregatedMark(i,t.id-1)})});this._rulerMarks.sort(function(e,t){return e.time.compareTo(t.time)})}};i.prototype.createAggregatedMark=function(e,i){for(var n=t.Utilities.convertToPixel(e.time,this._timeRange,this._clientWidth)-this._rulerMarksImageWidth/2,o=!0,r=0;r<this._rulerMarks.length;++r){var s=this._rulerMarks[r];if(Math.abs(s.pixelPosition-n)<=this._minimumMarkDistance){s.push(e);s.glyphIndex!==i&&(s.glyphIndex=0!==s.glyphIndex&&1!==s.glyphIndex||0!==i&&1!==i?-1:0);o=!1;break}}if(o){var a=new t.AggregatedMarkData;a.push(e);a.glyphIndex=i;a.pixelPosition=n;this._rulerMarks.push(a)}};i.prototype.showMarkTooltip=function(t){var i=t.getTooltipContent();i&&e.Plugin.Tooltip.show({content:i})};i.prototype.createMarkVisual=function(e){var t=document.createElement("div");t.classList.add(e);t.classList.add("ruler-scale-mark-image-position");return t};i.prototype.onKeyDown=function(e){if(0!==this._scaleMarksDiv.children.length&&(9===e.keyCode||39===e.keyCode||37===e.keyCode))if(9!==e.keyCode){var t;if(this._focusedMark){this._focusedMark.tabIndex=-1;39===e.keyCode?t=this._focusedMark.nextElementSibling||this._scaleMarksDiv.firstElementChild:37===e.keyCode&&(t=this._focusedMark.previousElementSibling||this._scaleMarksDiv.lastElementChild)}else 39===e.keyCode?t=this._scaleMarksDiv.firstElementChild:37===e.keyCode&&(t=this._scaleMarksDiv.lastElementChild);if(t){this._focusedMark=t;t.tabIndex=0;t.focus()}}else if(this._focusedMark){this._focusedMark.blur();this._focusedMark.tabIndex=-1;this._focusedMark=null;this._container.focus()}};return i}();t.RulerScale=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(i){__extends(n,i);function n(o,r){i.call(this,r);this._container=document.createElement("div");this._container.classList.add("ruler-doubleSlider");this._container.classList.add("fullsizeOverlay");this._currentTimeRange=o;this._selectionTimeRange=this._currentTimeRange;this._viewEventManager=e.VisualStudio.DiagnosticsHub.getViewEventManager();this._telemetry=new t.Telemetry.ViewportController;this._container.onmousedown=this.onStartSelection.bind(this);this._container.onmousemove=this.onDragSelection.bind(this);this._container.onmouseup=this.onStopSelection.bind(this);this._lSlider=document.createElement("div");this._lSlider.className="ruler-slider";this._lSlider.style.width=n.SliderWidth+"px";this._lSlider.tabIndex=0;this._lSlider.setAttribute("role","slider");this._lSlider.setAttribute("aria-label",e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/RulerLeftSliderAriaLabel"));this._container.appendChild(this._lSlider);this._lSlider.onmousedown=this.onStartSelection.bind(this);this._lSlider.onkeydown=this.onKeyDown.bind(this);this._lSlider.onkeyup=this.onKeyUp.bind(this);this._lSlider.onfocus=this.sliderFocus.bind(this);this._lUnselectedRegion=document.createElement("div");this._lUnselectedRegion.className="ruler-unselected";this._container.appendChild(this._lUnselectedRegion);this._container.appendChild(r.container);this._rSlider=document.createElement("div");this._rSlider.className="ruler-slider";this._rSlider.style.width=n.SliderWidth+"px";this._rSlider.tabIndex=0;this._rSlider.setAttribute("role","slider");this._rSlider.setAttribute("aria-label",e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/RulerRightSliderAriaLabel"));this._container.appendChild(this._rSlider);this._rSlider.onmousedown=this.onStartSelection.bind(this);this._rSlider.onkeydown=this.onKeyDown.bind(this);this._rSlider.onkeyup=this.onKeyUp.bind(this);this._rSlider.onfocus=this.sliderFocus.bind(this);this._rUnselectedRegion=document.createElement("div");this._rUnselectedRegion.className="ruler-unselected";this._container.appendChild(this._rUnselectedRegion);this.updateAriaLabels()}Object.defineProperty(n.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0});n.prototype.onViewportChanged=function(e){this._currentTimeRange=e.currentTimespan;this._selectionTimeRange=e.selectionTimespan;this.setSliderHandlePosition(e.selectionTimespan||e.currentTimespan);this.updateAriaLabels();i.prototype.onViewportChanged.call(this,e)};n.prototype.resize=function(e){this._clientRect=this._container.getBoundingClientRect();if(this._clientWidth!==this._clientRect.width){this._clientWidth=this._clientRect.width;this.setSliderHandlePosition(this._selectionTimeRange||this._currentTimeRange);i.prototype.resize.call(this,e)}};n.prototype.setSliderHandlePosition=function(e){var i=t.Utilities.convertToPixel(e.begin,this._currentTimeRange,this._clientWidth),o=t.Utilities.convertToPixel(e.end,this._currentTimeRange,this._clientWidth);this._lSlider.style.visibility=i<0||i>this._clientWidth-n.SliderWidth?"hidden":"visible";this._lSlider.style.left=i-n.SliderWidth+"px";this._lUnselectedRegion.style.width=i>this._clientWidth?this._clientWidth+"px":Math.max(i,0)+"px";this._rSlider.style.visibility=o<0||o>this._clientWidth?"hidden":"visible";this._rSlider.style.left=o+"px";var r=this._clientWidth-o;this._rUnselectedRegion.style.width=r>this._clientWidth?this._clientWidth+"px":Math.max(this._clientWidth-o,0)+"px";this._rUnselectedRegion.style.left=r>this._clientWidth?"0px":o+"px"};n.prototype.sliderFocus=function(e){var i=this._selectionTimeRange||this._currentTimeRange;if(e.currentTarget!==this._lSlider||this._currentTimeRange.contains(i.begin)){if(e.currentTarget===this._rSlider&&!this._currentTimeRange.contains(i.end)){o=parseInt(this._currentTimeRange.elapsed.value)/this._clientWidth*(n.SliderWidth+1),r=t.BigNumber.subtract(i.end,this._currentTimeRange.elapsed);r=t.BigNumber.addNumber(r,o);this._viewEventManager.changeViewport.raiseEvent(new t.JsonTimespan(r,t.BigNumber.add(r,this._currentTimeRange.elapsed)))}}else{var o=parseInt(this._currentTimeRange.elapsed.value)/this._clientWidth*(n.SliderWidth+1),r=t.BigNumber.subtractNumber(i.begin,o);this._viewEventManager.changeViewport.raiseEvent(new t.JsonTimespan(r,t.BigNumber.add(r,this._currentTimeRange.elapsed)))}};n.prototype.onKeyDown=function(e){this.handleKeyEvent(e)&&!this._animationFrameHandle&&(this._animationFrameHandle=window.requestAnimationFrame(this.onSelectionAnimation.bind(this)))};n.prototype.onKeyUp=function(e){if(this.handleKeyEvent(e)){window.cancelAnimationFrame(this._animationFrameHandle);this._animationFrameHandle=null;this.raiseSelectionTimeRangeChangedEvent(this._selectionTimeRange,!1);var i=t.Utilities.getTimestampAtPixel(t.SwimlaneViewConstants.MinSelectionInPixels,this._clientWidth,this._currentTimeRange).greaterOrEqual(this._selectionTimeRange.elapsed);this._telemetry.selectionChanged(1,i)}};n.prototype.handleKeyEvent=function(e){if(37!==e.keyCode&&39!==e.keyCode)return!1;this._selectionTimeRange=this._selectionTimeRange||this._currentTimeRange;var i=t.BigNumber.subtract(t.Utilities.getTimestampAtPixel(1,this._clientWidth,this._currentTimeRange),this._currentTimeRange.begin),n=this._selectionTimeRange.begin,o=this._selectionTimeRange.end;if(37===e.keyCode)if(e.srcElement===this._lSlider){n=t.BigNumber.subtract(n,i);n=t.BigNumber.max(n,this._currentTimeRange.begin)}else if(e.srcElement===this._rSlider){o=t.BigNumber.subtract(o,i);o=t.BigNumber.max(n,o)}if(39===e.keyCode)if(e.srcElement===this._lSlider){n=t.BigNumber.add(n,i);n=t.BigNumber.min(n,o)}else if(e.srcElement===this._rSlider){o=t.BigNumber.add(o,i);o=t.BigNumber.min(o,this._currentTimeRange.end)}this._selectionTimeRange=new t.JsonTimespan(n,o);return!0};n.prototype.onStartSelection=function(e){if(1===e.which){this._selectionTimeRange=this._selectionTimeRange||this._currentTimeRange;if(e.target===this._lSlider)this._selectionTimeAnchor=this._selectionTimeRange.end;else if(e.target===this._rSlider)this._selectionTimeAnchor=this._selectionTimeRange.begin;else{this._selectionTimeAnchor=t.Utilities.getTimestampAtPixel(e.clientX-this._clientRect.left,this._clientWidth,this._currentTimeRange);this._selectionTimeRange=new t.JsonTimespan(this._selectionTimeAnchor,t.BigNumber.addNumber(this._selectionTimeAnchor,t.Utilities.translateNumPixelToDuration(t.SwimlaneViewConstants.MinSelectionInPixels,this._clientWidth,this._currentTimeRange)))}t.Utilities.setCapture(this._container);this._animationFrameHandle&&window.cancelAnimationFrame(this._animationFrameHandle);this._animationFrameHandle=window.requestAnimationFrame(this.onSelectionAnimation.bind(this));e.stopPropagation()}};n.prototype.onDragSelection=function(e){if((e.target===this._lSlider||e.target===this._rSlider||e.target===this._container)&&1===e.which&&this._animationFrameHandle){var i=Math.max(e.clientX-this._clientRect.left,0);i=Math.min(this._clientWidth,i);var n=t.Utilities.getTimestampAtPixel(i,this._clientWidth,this._currentTimeRange);this._selectionTimeAnchor.greater(n)?this._selectionTimeRange=new t.JsonTimespan(n,this._selectionTimeAnchor):this._selectionTimeRange=new t.JsonTimespan(this._selectionTimeAnchor,n);e.stopPropagation()}};n.prototype.onStopSelection=function(e){if(1===e.which&&this._lSlider&&this._rSlider&&this._animationFrameHandle){t.Utilities.releaseCapture(this._container);window.cancelAnimationFrame(this._animationFrameHandle);this._animationFrameHandle=null;this._lSlider.blur();this._rSlider.blur();t.Utilities.containsPoint(this._lSlider.getBoundingClientRect(),e.clientX,e.clientY)?this._lSlider.focus():t.Utilities.containsPoint(this._rSlider.getBoundingClientRect(),e.clientX,e.clientY)&&this._rSlider.focus();this.raiseSelectionTimeRangeChangedEvent(this._selectionTimeRange,!1);var i=t.Utilities.getTimestampAtPixel(t.SwimlaneViewConstants.MinSelectionInPixels,this._clientWidth,this._currentTimeRange).greaterOrEqual(this._selectionTimeRange.elapsed);this._telemetry.selectionChanged(1,i);e.stopPropagation()}};n.prototype.onSelectionAnimation=function(){this._animationFrameHandle=window.requestAnimationFrame(this.onSelectionAnimation.bind(this));this.raiseSelectionTimeRangeChangedEvent(this._selectionTimeRange,!0)};n.prototype.raiseSelectionTimeRangeChangedEvent=function(e,t){void 0===t&&(t=!1);this._viewEventManager.selectionChanged.raiseEvent({position:e,isIntermittent:t})};n.prototype.updateAriaLabels=function(){var i=t.RulerUtilities.formatTime(this._currentTimeRange.begin,1),n=t.RulerUtilities.formatTime(this._currentTimeRange.end,1);if(this._selectionTimeRange){var o=t.RulerUtilities.formatTime(this._selectionTimeRange.begin),r=t.RulerUtilities.formatTime(this._selectionTimeRange.end),s=t.RulerUtilities.formatTime(this._currentTimeRange.begin),a=t.RulerUtilities.formatTime(this._currentTimeRange.end),u=t.RulerUtilities.formatTime(this._selectionTimeRange.begin,1),l=t.RulerUtilities.formatTime(this._selectionTimeRange.end,1),c=e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/RulerSliderAriaValueText",u,i,l);this._lSlider.setAttribute("aria-valuetext",c);this._lSlider.setAttribute("aria-valuenow",o);this._lSlider.setAttribute("aria-valuemin",s);this._lSlider.setAttribute("aria-valuemax",r);var h=e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/RulerSliderAriaValueText",l,u,n);this._rSlider.setAttribute("aria-valuetext",h);this._rSlider.setAttribute("aria-valuenow",r);this._rSlider.setAttribute("aria-valuemin",o);this._rSlider.setAttribute("aria-valuemax",a)}};n.SliderWidth=5;return n}(t.ControlDecorator);t.DoubleSlider=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function t(t){var i=this;this._colorDivs=[];this._container=document.createElement("div");this._container.id="rulerLegendContainer";this._container.className="ruler-legend-container";this._onThemeChangedBoundFunction=this.onThemeChange.bind(this);e.Plugin.Theme.addEventListener("themechanged",this._onThemeChangedBoundFunction);t.forEach(function(t){var n=document.createElement("div");n.className="ruler-label-mark-image";n.setAttribute("data-imageToken",t.imageToken);n.style.backgroundImage="url("+e.Plugin.Theme.getValue(t.imageToken)+")";i._colorDivs.push(n);var o=document.createElement("div");o.className="ruler-legend-text-div";o.innerHTML=t.text;var r=document.createElement("div");r.className="ruler-legend-div";r.appendChild(n);r.appendChild(o);t.tooltip&&r.setAttribute("data-plugin-vs-tooltip",t.tooltip);i._container.appendChild(r)})}Object.defineProperty(t.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0});t.prototype.dispose=function(){e.Plugin.Theme.removeEventListener("themechanged",this._onThemeChangedBoundFunction)};t.prototype.onThemeChange=function(){this._colorDivs.forEach(function(t){var i=t.getAttribute("data-imageToken");t.style.backgroundImage="url("+e.Plugin.Theme.getValue(i)+")"})};return t}();t.RulerLegend=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(){}i.getUniqueId=function(){return i.Counter++};i.getTickMarksPosition=function(e,n,o){void 0===o&&(o=!1);var r=e.elapsed,s=parseInt(r.value),a=e.begin,u=[],l=Math.pow(10,Math.floor(Math.log(s)/Math.LN10)),c=n/s*l;c<100?c<25?l*=8:c<50?l*=4:c<100&&(l*=2):c>250&&(l/=c<400?2:c<800?4:c<1600?8:10);if(l>0){var h=l/10,d=l/2;(c=n/s*l)<130&&(h=l/5);u=i.generateTickMarks(e,t.BigNumber.subtract(a,t.BigNumber.moduloNumber(a,l)),t.BigNumber.convertFromNumber(l),t.BigNumber.convertFromNumber(d),t.BigNumber.convertFromNumber(h),o)}return u};i.getVerticalLinePositions=function(e,n){for(var o=[],r=i.getTickMarksPosition(e,n),s=0;s<r.length;++s){var a=r[s];if(0===a.type){var u=parseInt(t.BigNumber.subtract(a.value,e.begin).value)/parseInt(e.elapsed.value)*100;o.push(u)}}return o};i.formatTime=function(e,n){void 0===n&&(n=0);var o="0",r=t.Utilities.getNumberFormat();if(e.greaterOrEqual(t.BigNumber.convertFromNumber(i.OneSecond-i.NanosecondsSignificanceThreshold))){var s=i.getSplittedTime(e,i.OneMillisecond/2),a=!!parseInt(s.minString),u=!!parseInt(s.secString),l=!!parseInt(s.msString);o=a?s.minString+":":"";o+=u?s.secString:a?"00":"0";l&&(o+=r.numberDecimalSeparator+this.removeTrailingZeros(s.msString))}else{s=i.getSplittedTime(e),l=!!parseInt(s.msString);var c=!!parseInt(s.nsString);o=l?s.msString:"0";c&&(o+=r.numberDecimalSeparator+this.removeTrailingZeros(s.nsString))}return o+i.getUnit(parseInt(e.value),n)};i.formatTitleTime=function(e,n,o,r){void 0===n&&(n=1);void 0===o&&(o=!1);void 0===r&&(r=!1);var s=r?i.OneMillisecond:i.NanosecondsSignificanceThreshold,a=i.getSplittedTime(e,s),u="0",l=t.Utilities.getNumberFormat(),c=!!parseInt(a.minString),h=!!parseInt(a.secString),d=!o&&!!parseInt(a.msString),g=!o&&!!parseInt(a.nsString);if(c){var m=h?a.secString:"00";u=a.minString+":"+m}else if(h){u=a.secString;d&&(u+=l.numberDecimalSeparator+this.removeTrailingZeros(a.msString))}else if(d||g){u=d?a.msString:g?"0":"";g&&(u+=l.numberDecimalSeparator+this.removeTrailingZeros(a.nsString))}return u};i.formatSelectionTime=function(t,n,o){void 0===n&&(n=1);void 0===o&&(o=!1);var r=i.formatTitleTime(t,n,!1,o),s=i.getUnit(parseInt(t.value),n);return e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/RulerTimeSelected",r,s)};i.formatTotalTime=function(e,t,n){void 0===t&&(t=1);void 0===n&&(n=!1);return i.formatTitleTime(e,t,n)+i.getUnit(parseInt(e.value),t,n)};i.generateTickMarks=function(e,i,n,o,r,s){var a=[],u=e.begin,l=e.end;s&&a.push({type:0,value:new t.BigNumber(0,0),label:"0"});r.equals(t.BigNumber.zero)&&(r=new t.BigNumber(0,1));for(var c=i;l.greater(c);c=t.BigNumber.add(c,r))if(c.greater(u)){var h=c;t.BigNumber.modulo(c,n).equals(t.BigNumber.zero)?a.push({type:0,value:h}):t.BigNumber.modulo(c,o).equals(t.BigNumber.zero)?a.push({type:1,value:h}):a.push({type:2,value:h})}return a};i.getUnit=function(e,t,n){void 0===n&&(n=!1);var o=i.getUnits(t);return e<i.OneSecond-i.NanosecondsSignificanceThreshold&&!n?o.milliseconds:e<i.OneMinute-i.NanosecondsSignificanceThreshold?o.seconds:o.minutes};i.getUnits=function(t){return 1===t?{milliseconds:" "+e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/MillisecondsLabel"),seconds:" "+e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/SecondsLabel"),minutes:" "+e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/MinutesLabel")}:{milliseconds:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/MillisecondsAbbreviation"),seconds:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/SecondsAbbreviation"),minutes:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/MinutesAbbreviation")}};i.getSplittedTime=function(e,n){void 0===n&&(n=i.NanosecondsSignificanceThreshold);var o=t.BigNumber.moduloNumber(e,i.OneMillisecond),r=t.BigNumber.subtract(e,o),s=parseInt(o.value),a="";if(s<i.OneMillisecond-n){a=Math.round(s/1e3).toString();a=this.padLeadingZeros(a,3)}else r=t.BigNumber.addNumber(r,i.OneMillisecond);var u=t.BigNumber.moduloNumber(r,i.OneSecond);r=t.BigNumber.subtract(r,u);var l=parseInt(u.value)/i.OneMillisecond,c=t.BigNumber.moduloNumber(r,i.OneMinute);r=t.BigNumber.subtract(r,c);var h=parseInt(c.value)/i.OneSecond,d=parseInt(r.value)/i.OneMinute,g="";if(a||l){g=l.toString();(h||d)&&(g=this.padLeadingZeros(g,3))}var m="";if(a||g||h){m=h.toString();d&&(m=this.padLeadingZeros(m,2))}var p="";d&&(p=d.toString());return{nsString:a,msString:g,secString:m,minString:p}};i.removeTrailingZeros=function(e){return e.replace(/0*$/,"")};i.padLeadingZeros=function(e,t){var i=e,n="00000000";if(i&&t&&t>0){for(;t-i.length>=8;)i=n+i;i=n.substr(0,t-i.length)+i}return i};i.OneMillisecond=1e6;i.OneSecond=1e9;i.OneMinute=6e10;i.Counter=0;i.NanosecondsSignificanceThreshold=500;return i}();t.RulerUtilities=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function e(){this.isLive=!1;this.isPerformanceDebugger=!1;this.isSelectionEnabled=!0;this.showLegend=!0;this.markSeries=[]}return e}();t.RulerConfig=i;var n=function(){function i(i){this._controls=[];this._logger=e.VisualStudio.DiagnosticsHub.getLogger();this._totalTimespan=null;this._selectionTimespan=null;this._aggregatedMarkImageToken="vs-image-graph-aggregated-event";this._imageTokenList=["vs-image-graph-app-event","vs-image-graph-user-mark","vs-image-graph-third-event","vs-image-graph-fourth-event","vs-image-graph-fifth-event","vs-image-graph-sixth-event"];if(!i)throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.1002"));this._config=i;this._totalTimespan=this._config.timeRange;this._container=document.createElement("div");this._container.classList.add("ruler-container");var n=document.createElement("div");n.className="ruler-header";this._container.appendChild(n);var o=document.createElement("div");o.className="ruler-body";this._container.appendChild(o);for(;this._config.markSeries.length>this._imageTokenList.length;)this._logger.error("Series removed due to excess count: "+JSON.stringify(this._config.markSeries.pop()));if(this._config.showLegend){for(var r=[],s=0;s<this._imageTokenList.length&&s<this._config.markSeries.length;s++){var a=this._config.markSeries[s];a.index=s;r.push({text:a.label,imageToken:this._imageTokenList[a.id-1],tooltip:a.tooltip})}for(s=0;s<this._config.markSeries.length;s++)if(3===this._config.markSeries[s].id){r.push({text:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/RulerAggregatedMarks"),imageToken:this._aggregatedMarkImageToken,tooltip:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/MergedMarkTooltip")});break}var u=new t.RulerLegend(r);n.appendChild(u.container);this._controls.push(u)}this._title=document.createElement("div");this._title.className="ruler-title-text";this._title.setAttribute("aria-live","off");this._title.innerHTML=e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/RulerTitle",t.RulerUtilities.formatTotalTime(this._totalTimespan.elapsed,1));n.appendChild(this._title);this._scale=new t.RulerScale(this._totalTimespan,this._config.markSeries,this._imageTokenList,this._aggregatedMarkImageToken);var l=this._config.isSelectionEnabled?new t.DoubleSlider(this._totalTimespan,this._scale):this._scale;o.appendChild(l.container);this._controls.push(l)}Object.defineProperty(i.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0});i.prototype.dispose=function(){this._controls.forEach(function(e){e.dispose&&e.dispose()})};i.prototype.onViewportChanged=function(i){this._selectionTimespan=i.selectionTimespan;this._selectionTimespan?this._title.innerHTML=e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/RulerTitleWithSelection",t.RulerUtilities.formatTotalTime(this._totalTimespan.elapsed,1,this._config.isLive||i.isIntermittent),t.RulerUtilities.formatSelectionTime(i.selectionTimespan.elapsed,0,this._config.isPerformanceDebugger)):this._title.innerHTML=e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/RulerTitle",t.RulerUtilities.formatTotalTime(this._totalTimespan.elapsed,1,this._config.isLive||i.isIntermittent));this._controls.forEach(function(e){e.onViewportChanged&&e.onViewportChanged(i)})};i.prototype.onDataUpdate=function(i){this._totalTimespan=new t.JsonTimespan(this._totalTimespan.begin,i);this._markLoaders&&this._markLoaders.forEach(function(e){return e.onDataUpdate(i)});this._selectionTimespan?this._title.innerHTML=e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/RulerTitleWithSelection",t.RulerUtilities.formatTotalTime(i,1,!0),t.RulerUtilities.formatSelectionTime(this._selectionTimespan.elapsed,0,this._config.isPerformanceDebugger)):this._title.innerHTML=e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/RulerTitle",t.RulerUtilities.formatTotalTime(i,1,!0))};i.prototype.resize=function(e){this._controls.forEach(function(t){t.resize&&t.resize(e)})};i.prototype.addMark=function(e,i,n,o){void 0===o&&(o=!0);var r=new t.MarkData(i,n);this._scale.addMark(e,r,o)};i.prototype.loadMarks=function(e){var i=this;this._markLoaders=e.map(function(e){var n=e.DataSource;return n&&n.CounterId&&n.AnalyzerId?new t.MarkDataFetcher(e,i._scale):null}).filter(function(e){return null!==e})};return i}();t.Ruler=n}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=null,n=function(){function t(){this._swimlaneViewStateMarshaler=e.Plugin.Utilities.JSONMarshaler.attachToPublishedObject(t.SwimlaneViewStateServiceMarshalerName,{},!0)}t.prototype.getSwimlaneVisibility=function(e){return Promise.resolve(!0)};t.prototype.setSwimlaneVisibility=function(e,t){};t.SwimlaneViewStateServiceMarshalerName="Microsoft.DiagnosticsHub.VisualStudio.Presentation.JavaScriptModels.SwimLaneViewStateServiceMarshaler";return t}();function o(){null===i&&(i=new n);return i}t.getSwimlaneViewStateService=o}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(e,i,n,o){void 0===o&&(o=null);var r=this;this._clientWidth=0;this._clientHeight=0;this._isVisible=!0;this._controls=[];this._swimlaneVisibilityChangedEvent=new t.AggregatedEvent;this._container=document.createElement("div");this._container.classList.add("swimlaneBase");this._currentTimespan=n;this._selectionTimespan=o;this._isVisible=e.isBodyExpanded;this._titleRegion=document.createElement("div");this._contentRegion=document.createElement("div");this._leftRegion=document.createElement("div");this._mainRegion=document.createElement("div");this._rightRegion=document.createElement("div");this._titleRegion.classList.add("titleRegion");this._contentRegion.classList.add("contentRegion");this._leftRegion.classList.add("leftRegion");this._mainRegion.classList.add("mainRegion");this._rightRegion.classList.add("rightRegion");this._contentRegion.style.height=i+"px";this._contentRegion.appendChild(this._leftRegion);this._contentRegion.appendChild(this._mainRegion);this._contentRegion.appendChild(this._rightRegion);this._titleText=e.titleText;this._unit=e.unit;this._titleContainer=document.createElement("div");this._titleContainer.className="title-container";this._titleCollapseExpandButton=document.createElement("div");this._titleCollapseExpandButton.setAttribute("role","button");this._titleCollapseExpandButton.tabIndex=0;this._titleCollapseExpandButton.onclick=this.toggleVisibility.bind(this);this._titleCollapseExpandButton.onkeydown=this.onKeyDown.bind(this);this._titleContainer.appendChild(this._titleCollapseExpandButton);this._titleTextElement=document.createElement("div");this._titleTextElement.className="title-text";this._titleContainer.appendChild(this._titleTextElement);this._container.appendChild(this._titleContainer);this._container.appendChild(this._titleRegion);this._container.appendChild(this._contentRegion);this.updateTitle();this.updateContentVisibility();this._collapseCallback=function(e){e.matches?r._titleRegion.classList.add("limitedSpace"):r._titleRegion.classList.remove("limitedSpace")};this.updateCollapsingWidth()}Object.defineProperty(i.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"swimlaneVisibilityChangedEvent",{get:function(){return this._swimlaneVisibilityChangedEvent},enumerable:!0,configurable:!0});i.prototype.dispose=function(){this._swimlaneVisibilityChangedEvent.dispose();this._titleCollapseExpandButton.onclick=null;this._titleCollapseExpandButton.onkeydown=null;this._controls.forEach(function(e){e.dispose&&e.dispose()})};i.prototype.resize=function(e){this._clientWidth||this._clientHeight||this.updateCollapsingWidth();if(this._clientWidth!==this._container.clientWidth||this._clientHeight!==this._container.clientHeight){this._clientHeight=this._container.clientHeight;this._clientWidth=this._container.clientWidth;this._isVisible&&this._controls.forEach(function(t){t.resize&&t.resize(e)})}};i.prototype.onViewportChanged=function(e){this._currentTimespan=e.currentTimespan;this._selectionTimespan=e.selectionTimespan;this._isVisible&&this._controls.forEach(function(t){t.onViewportChanged&&t.onViewportChanged(e)})};i.prototype.onDataUpdate=function(e){this._controls.forEach(function(t){t.onDataUpdate&&t.onDataUpdate(e)})};i.prototype.onScaleChanged=function(e){this._unit=e.unit||this._unit;this.updateTitle()};i.prototype.addTitleControl=function(e){this._titleRegion.appendChild(e.container);this._controls.push(e);this.updateCollapsingWidth()};i.prototype.addLeftRegionControl=function(e){this._leftRegion.appendChild(e.container);this._controls.push(e)};i.prototype.addRightRegionControl=function(e){this._rightRegion.appendChild(e.container);this._controls.push(e)};i.prototype.addMainRegionControl=function(e){this._mainRegion.appendChild(e.container);this._controls.push(e)};i.prototype.onKeyDown=function(e){13===e.keyCode&&this.toggleVisibility()};i.prototype.toggleVisibility=function(){this._isVisible=!this._isVisible;this.updateContentVisibility();if(this._isVisible){this.resize(null);this.onViewportChanged({currentTimespan:this._currentTimespan,selectionTimespan:this._selectionTimespan,isIntermittent:!1})}this._swimlaneVisibilityChangedEvent.invokeEvent(this._isVisible)};i.prototype.updateTitle=function(){var e=this._titleText;this._unit&&(e+=" ("+this._unit+")");this._titleTextElement.innerHTML=e};i.prototype.updateContentVisibility=function(){if(this._isVisible){this._titleCollapseExpandButton.className="title-expanded-button";this._titleCollapseExpandButton.setAttribute("aria-label",e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/SwimlaneCollapseAriaLabel",this._titleText));this._titleCollapseExpandButton.setAttribute("aria-expanded","true");this._contentRegion.style.display="-ms-grid"}else{this._titleCollapseExpandButton.className="title-collapsed-button";this._titleCollapseExpandButton.setAttribute("aria-label",e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/SwimlaneExpandAriaLabel",this._titleText));this._titleCollapseExpandButton.setAttribute("aria-expanded","false");this._contentRegion.style.display="none"}};i.prototype.updateCollapsingWidth=function(){this._collapseMediaQuery&&this._collapseMediaQuery.removeListener(this._collapseCallback);var e=this._titleContainer.offsetWidth+this._titleRegion.offsetWidth;this._collapseMediaQuery=window.matchMedia(t.Utilities.formatString("(max-width: {0}px)",e.toString()));this._collapseMediaQuery.addListener(this._collapseCallback)};return i}();t.SwimlaneBase=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(i){__extends(n,i);function n(n,o,r,s){i.call(this,n);this._selectionTimeAnchor=null;this._animationFrameHandle=null;this._currentTimespan=o;this._currentSelection=r;this._sourceId=s;this._container=document.createElement("div");this._container.className="selectionOverlay";this._container.style.zIndex=t.Constants.SelectionOverlayZIndex.toString();this._leftUnselectedRegion=document.createElement("div");this._rightUnselectedRegion=document.createElement("div");this._leftUnselectedRegion.className="unselected";this._leftUnselectedRegion.style.top="0px";this._rightUnselectedRegion.className="unselected";this._rightUnselectedRegion.style.top="0px";this._container.appendChild(this._leftUnselectedRegion);this._container.appendChild(n.container);this._container.appendChild(this._rightUnselectedRegion);this._container.onmousedown=this.onStartSelection.bind(this);this._container.onmousemove=this.onDragSelection.bind(this);this._container.onmouseup=this.onStopSelection.bind(this);this._telemetry=new t.Telemetry.ViewportController;this._viewEventManager=e.VisualStudio.DiagnosticsHub.getViewEventManager()}Object.defineProperty(n.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0});n.prototype.dispose=function(){this._container.onmousedown=null;this._container.onmousemove=null;this._container.onmouseup=null;i.prototype.dispose.call(this)};n.prototype.resize=function(e){this._clientWidth=this._container.clientWidth;this._clientRect=this._container.getBoundingClientRect();this.updateDom();i.prototype.resize.call(this,e)};n.prototype.onViewportChanged=function(e){this._currentTimespan=e.currentTimespan;this._currentSelection=e.selectionTimespan;this.updateDom();i.prototype.onViewportChanged.call(this,e)};n.prototype.onStartSelection=function(e){if(1===e.which){this._selectionTimeAnchor=t.Utilities.getTimestampAtPixel(e.clientX-this._clientRect.left,this._clientWidth,this._currentTimespan);this._currentSelection=new t.JsonTimespan(this._selectionTimeAnchor,t.BigNumber.addNumber(this._selectionTimeAnchor,t.Utilities.translateNumPixelToDuration(t.SwimlaneViewConstants.MinSelectionInPixels,this._clientWidth,this._currentTimespan)));t.Utilities.setCapture(this._container);this._animationFrameHandle&&window.cancelAnimationFrame(this._animationFrameHandle);this._animationFrameHandle=window.requestAnimationFrame(this.onSelectionAnimation.bind(this));e.stopPropagation()}};n.prototype.onDragSelection=function(e){if(e.target===this._container&&1===e.which&&this._animationFrameHandle){var i=Math.max(e.clientX-this._clientRect.left,0);i=Math.min(i,this._clientWidth);var n=t.Utilities.getTimestampAtPixel(i,this._clientWidth,this._currentTimespan);this._selectionTimeAnchor.greater(n)?this._currentSelection=new t.JsonTimespan(n,this._selectionTimeAnchor):this._currentSelection=new t.JsonTimespan(this._selectionTimeAnchor,n);e.stopPropagation()}};n.prototype.onStopSelection=function(e){if(1===e.which){t.Utilities.releaseCapture(this._container);window.cancelAnimationFrame(this._animationFrameHandle);this._animationFrameHandle=null;this.raiseSelectionChanged(!1);var i=!1;this._currentSelection&&(i=t.Utilities.getTimestampAtPixel(t.SwimlaneViewConstants.MinSelectionInPixels,this._clientWidth,this._currentTimespan).greaterOrEqual(this._currentSelection.elapsed));this._telemetry.selectionChanged(0,i,this._sourceId)}};n.prototype.onSelectionAnimation=function(){this.raiseSelectionChanged(!0);this._animationFrameHandle=window.requestAnimationFrame(this.onSelectionAnimation.bind(this))};n.prototype.raiseSelectionChanged=function(e){void 0===e&&(e=!1);this._viewEventManager.selectionChanged.raiseEvent({position:this._currentSelection,isIntermittent:e})};n.prototype.updateDom=function(){if(this._currentSelection){var e=t.Utilities.convertToPixel(this._currentSelection.begin,this._currentTimespan,this._clientWidth);e=Math.max(e,0);var i=t.Utilities.convertToPixel(this._currentSelection.end,this._currentTimespan,this._clientWidth),n=this._clientWidth-i;n=Math.max(n,0);this._leftUnselectedRegion.style.width=e+"px";this._rightUnselectedRegion.style.left=i+"px";this._rightUnselectedRegion.style.width=n+"px"}else{this._leftUnselectedRegion.style.width="0px";this._rightUnselectedRegion.style.left=this._clientWidth+"px";this._rightUnselectedRegion.style.width="0px"}};return n}(t.ControlDecorator);t.SelectionOverlay=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){"use strict";var t=function(){function t(t,i,n){void 0===n&&(n=1);this._swimlaneId="00000000-0000-0000-0000-000000000000";this.header={isBodyExpanded:!0,titleText:"Graph",description:"Graph"};this.graph={height:e.Constants.DefaultSwimlaneGraphHeight,registeredClass:null,loadCss:e.Common.DependencyManager.loadCss,jsonConfig:{},description:null,scale:{minimum:0,maximum:100,axes:[]},legend:[],unit:"",swimlaneId:this._swimlaneId};t.JavaScriptClassName?this.graph.registeredClass=e.RegisterNamespace.getRegisteredClass(t.JavaScriptClassName):this.graph.registeredClass=e.RegisterNamespace.getRegisteredClass("Microsoft.VisualStudio.DiagnosticsHub.MultiSeriesGraph");this._swimlaneId=t.Id;this.graph.swimlaneId=t.Id;this.graph.jsonConfig=t.JsonObject;this.graph.jsonConfig.GraphBehaviour=n;this.graph.scale.minimum=t.JsonObject.MinValue||this.graph.scale.minimum;this.graph.scale.maximum=t.JsonObject.MaxValue||this.graph.scale.minimum;this.graph.scale.isFixed=t.JsonObject.IsScaleFixed;this.graph.scale.axes=t.JsonObject.Axes||[];this.graph.resources=t.Resources;this.graph.description=t.Description;this.graph.pathToScriptFolder=t.PathToScriptFolder;t.JsonObject.RefreshDataOnResizeAndZoom=t.JsonObject.RefreshDataOnResizeAndZoom||!1;var o=t.JsonObject.Height||this.graph.height;o=Math.max(o,e.Constants.MinimumSwimlaneGraphHeight);this.graph.height=Math.min(o,e.Constants.MaximumSwimlaneGraphHeight);this.timeRange=i;this.graph.timeRange=i;this.header.titleText=t.Title}Object.defineProperty(t.prototype,"id",{get:function(){return this._swimlaneId},enumerable:!0,configurable:!0});return t}();e.SwimlaneConfiguration=t}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){"use strict";function t(t,i,n,o,r,s){var a=new e.SwimlaneConfiguration(t,r,o);a.graph.registeredClass===e.RegisterNamespace.getRegisteredClass("Microsoft.VisualStudio.DiagnosticsHub.MultiLineGraph")&&(a.graph.registeredClass=e.RegisterNamespace.getRegisteredClass("Microsoft.VisualStudio.DiagnosticsHub.MultiSeriesGraph"));var u=new a.graph.registeredClass(a.graph),l=new e.LocalizedUnitConverter(a.graph.jsonConfig.Units,a.graph.resources);a.header.isBodyExpanded=i;a.header.unit=a.graph.unit;var c=u;n&&(c=new e.SelectionOverlay(u,r,s,a.id));var h=new e.SwimlaneBase(a.header,a.graph.height,r,s);u.scaleChangedEvent.addEventListener(h.onScaleChanged.bind(h));var d=new e.Scale(a.graph.scale,0,l),g=new e.Scale(a.graph.scale,1,l);u.scaleChangedEvent.addEventListener(d.onScaleChanged.bind(d));u.scaleChangedEvent.addEventListener(g.onScaleChanged.bind(g));a.graph.scale.axes&&a.graph.scale.axes.forEach(function(t){var i=new e.Axes(t,a.graph.scale.minimum,a.graph.scale.maximum);u.scaleChangedEvent.addEventListener(i.onScaleChangedEvent.bind(i));h.addMainRegionControl(i)});h.addTitleControl(new e.Legend(a.graph.legend));h.addMainRegionControl(c);h.addMainRegionControl(new e.GridLineRenderer(r));h.addLeftRegionControl(d);h.addRightRegionControl(g);return h}e.defaultSwimlaneFactory=t}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(i){this._logger=e.VisualStudio.DiagnosticsHub.getLogger();this._controls=[];this._ruler=null;this._maxHeight=600;this._previousHeight=0;this._dataWarehouse=null;this._defaultAnalyzerId="89fb2d7a-1239-4952-811b-d77e2ee6f2aa";this._countersAnalyzerId="66EDDDF1-2277-40F3-983A-6FF57A433ECB";this._isResizeRegistered=!1;if(!i)throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.1002"));i.dataManager||(i.dataManager=new t.DiagnosticsHubDataManager);this._onResizeBoundFunction=t.eventThrottler(this.onResize.bind(this),t.Constants.WindowResizeThrottle);this._onThemeChangedBoundFunction=this.resizeHost.bind(this);this._config=i;this._config.isSelectionEnabled=void 0===this._config.isSelectionEnabled||this._config.isSelectionEnabled;this._eventAggregator=e.VisualStudio.DiagnosticsHub.getEventAggregator();var n=this._config.containerId||"mainContainer",o=document.getElementById(n);o.classList.add("base-container");this._headerContainer=document.createElement("div");this._headerContainer.id="header-float";this._headerContainer.classList.add("header-float");this._config.isToolbarFloating&&(this._headerContainer.style.position="fixed");o.appendChild(this._headerContainer);this._swimlaneContainer=document.createElement("div");this._swimlaneContainer.id="mainSwimlaneContainer";this._swimlaneContainer.classList.add("main-swimlane-container");o.appendChild(this._swimlaneContainer);this._footerContainer=document.createElement("div");this._footerContainer.id="footer";this._footerContainer.classList.add("footer-container");o.appendChild(this._footerContainer);this._config.dataManager.getConfigurations(this.initialize.bind(this))}Object.defineProperty(i,"headerSwimlanePriority",{get:function(){return 128},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"viewportController",{get:function(){return n},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"ruler",{get:function(){return this._ruler},enumerable:!0,configurable:!0});i.prototype.dispose=function(){this._controls.forEach(function(e){e.dispose&&e.dispose()});this._ruler=null;window.removeEventListener("resize",this._onResizeBoundFunction);e.Plugin.Theme.removeEventListener("themechanged",this._onThemeChangedBoundFunction)};i.prototype.addToolbarItem=function(e){this._toolbar&&this._toolbar.addToolbarItem(e)};i.prototype.addControl=function(e,t){if(!(isNaN(t)||t<0)){e.container.setAttribute("data-stackPriority",t.toFixed());for(var n,o=(n=t>=i.headerSwimlanePriority?this._swimlaneContainer:this._headerContainer).firstChild;o&&parseInt(o.getAttribute("data-stackPriority"))<t;)o=o.nextSibling;n.insertBefore(e.container,o);this._controls.push(e);if(this._isResizeRegistered){e.resize&&e.resize(null);this.resizeHost()}}};i.prototype.removeControl=function(e){if(e.container.parentElement===this._headerContainer||e.container.parentElement===this._swimlaneContainer){e.dispose&&e.dispose();e.container.parentElement.removeChild(e.container);var t=this._controls.indexOf(e);-1!==t&&this._controls.splice(t,1);this.resizeHost()}};i.prototype.onResize=function(e){this._config.isToolbarFloating?this._swimlaneContainer.style.marginTop=this._headerContainer.clientHeight+"px":this._swimlaneContainer.style.marginTop="0px";window&&(window.innerHeight<=2*this._footerContainer.clientHeight?this._footerContainer.style.visibility="collapse":this._footerContainer.style.visibility="visible");this._controls.forEach(function(t){t.resize&&t.resize(e)});this._swimlaneContainer.style.marginBottom=this._footerContainer.clientHeight+"px"};i.prototype.initialize=function(i,n){var o=this;void 0===n&&(n=null);var r=this._config.isPerformanceDebugger;this._config.isLive&&this._toolbar&&!r&&this._toolbar.addCommand(new t.StopCollectionCommand);var s=Promise.resolve(null);if(i.length>0){i.forEach(function(e){e.JsonObject=JSON.parse(e.JsonConfiguration)});s=e.VisualStudio.DiagnosticsHub.DataWarehouse.loadDataWarehouse(n).then(function(e){o._dataWarehouse=e;return r?Promise.resolve(new t.JsonTimespan(t.BigNumber.zero,t.BigNumber.zero)):e.getContextService().getGlobalContext().then(function(e){return e.getTimeDomain()},function(){return new t.JsonTimespan(t.BigNumber.zero,t.BigNumber.zero)})}).then(function(e){return o.initializeViewportController(e)}).then(function(){return o._config.isLive?null:o.getLostEvents()}).then(function(){return o.loadScripts(i)}).then(function(){return o.adjustConfigForNewArchitecture(i)}).then(function(e){o.addRuler(e);return o.addSwimlanes(e)})}s.then(function(){window.addEventListener("resize",o._onResizeBoundFunction);o._isResizeRegistered=!0;o._controls.forEach(function(e){e.resize&&e.resize(null)});o.resizeHost();e.Plugin.Theme.addEventListener("themechanged",o._onThemeChangedBoundFunction)}).then(function(){o._config.dataManager.dataUpdate(o.onDataUpdate.bind(o))}).then(function(){return o._eventAggregator.raiseEvent("Microsoft.DiagnosticsHub.RendererReadyEvent",null)},this.logExecuteError.bind(this))};i.prototype.logExecuteError=function(e){this._logger.error("executeCallback failed: "+JSON.stringify(e));return Promise.reject(JSON.stringify(e))};i.prototype.onDataUpdate=function(e){var i=new t.BigNumber(e.h,e.l);this._controls.forEach(function(e){e.onDataUpdate&&e.onDataUpdate(i)})};i.prototype.initializeViewportController=function(e){this._logger.info("Got timespan, elapsed="+e.elapsed.value);n=this._config.isLive?new t.RollingViewportController(this._config.timeInNsPerPixel):new t.ViewportController(e);this._footerContainer.appendChild(this.viewportController.container);this._controls.push(this.viewportController);this._toolbar&&this._toolbar.addCommandGroup(this.viewportController.commands)};i.prototype.getLostEvents=function(){var i=this,n={customDomain:{task:"get-total-lost-events"}};return this._dataWarehouse.getFilteredData(n,this._defaultAnalyzerId).then(function(n){if(n&&"number"==typeof n.lostEvents&&n.lostEvents>0){var o=new t.InformationBarControl(e.Plugin.Resources.getString("/DiagnosticsHubResources/InformationDroppedEvents",n.lostEvents),"http://go.microsoft.com/fwlink/p/?LinkId=391662");o.onClose=function(){return i.removeControl(o)};i.addControl(o,t.SwimlaneViewConstants.InfobarRendererPriority);(new t.Telemetry.CollectedData).lostEvents(n.lostEvents)}},function(e){i._logger.error("Could not get lost events, error: "+JSON.stringify(e))})};i.prototype.loadScripts=function(e){var i=[];e.forEach(function(e){if(e.PathToScript){var n=e.PathToScript.lastIndexOf("\\");-1!==n&&(e.PathToScriptFolder=e.PathToScript.substring(0,n));i.push(t.Common.DependencyManager.loadDependency({objType:e.JavaScriptClassName,functionName:e.JavaScriptFactoryFunction,url:e.PathToScript}))}});return Promise.all(i)};i.prototype.resizeHost=function(){var e=0;this._controls.forEach(function(t){e+=t.container.offsetHeight});var t=Math.ceil(e),i=t-this._previousHeight;this._previousHeight=t;this._eventAggregator.raiseEvent("Microsoft.DiagnosticsHub.SwimlaneResizeHeight",{Delta:i,MinValue:this._toolbar?this._toolbar.container.offsetHeight:0,MaxValue:Math.min(this._maxHeight,t),Value:Math.min(this._maxHeight,t)})};i.prototype.adjustConfigForNewArchitecture=function(e){var t=this,i=function(e){if(t._config.isLive){e.DataSource.AnalyzerId=t._countersAnalyzerId;return Promise.resolve(e)}var i={customDomain:{Task:"HasCounter",CounterId:e.DataSource.CounterId}};return t._dataWarehouse.getFilteredData(i,t._countersAnalyzerId).then(function(i){i.isPresent&&(e.DataSource.AnalyzerId=t._countersAnalyzerId);return e})};return Common.Async.thenEach(e,function(e){return 3===e.Type||e.JavaScriptClassName&&"Microsoft.VisualStudio.DiagnosticsHub.MultiLineGraph"!==e.JavaScriptClassName?Promise.resolve(e):Common.Async.thenEach(e.JsonObject.Series,i).then(function(t){e.JsonObject.Series=t;return e})})};i.prototype.addSwimlanes=function(n){var o=this,r=0,s=t.getSwimlaneViewStateService(),a=this._config.isLive?1:2,u=[];n.forEach(function(n){if(!n.JsonObject.View||n.JsonObject.View===t.ViewType.Graph){var l=++r,c=s.getSwimlaneVisibility(n.Id).then(function(r){var u=(3===n.Type?t.RegisterNamespace.getRegisteredFunction(n.JavaScriptFactoryFunction):e.VisualStudio.DiagnosticsHub.defaultSwimlaneFactory)(n,r,o._config.isSelectionEnabled,a,o.viewportController.visible,o.viewportController.selection);u.swimlaneVisibilityChangedEvent.addEventListener(function(e){s.setSwimlaneVisibility(n.Id,e);o.resizeHost()});o.viewportController.viewportStateChanged.addEventListener(u.onViewportChanged.bind(u));o.addControl(u,i.headerSwimlanePriority+l);u.onViewportChanged({currentTimespan:o.viewportController.visible,selectionTimespan:o.viewportController.selection,isIntermittent:!1})});u.push(c)}});return Promise.all(u)};i.prototype.addRuler=function(i){var n=new t.RulerConfig;n.showLegend=!this._config.isPerformanceDebugger;n.isLive=this._config.isLive;n.isSelectionEnabled=this._config.isSelectionEnabled;n.timeRange=this.viewportController.visible;n.isPerformanceDebugger=this._config.isPerformanceDebugger;var o=[],r=3,s={},a={};i.forEach(function(i){i.JsonObject.View&&i.JsonObject.View===t.ViewType.Ruler&&i.JsonObject.Series.forEach(function(t){var u=t.DataSource.CounterId||typeof t.DataSource.CounterId,l=t.DataSource.AnalyzerId||typeof t.DataSource.AnalyzerId;if(!s[u.toLowerCase()+","+l.toLowerCase()]){s[u.toLowerCase()+","+l.toLowerCase()]=!0;var c=0;if(1===(c="number"!=typeof t.MarkType||1!==t.MarkType&&2!==t.MarkType?r:t.MarkType)){var h=e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/RulerLifecycleMarkLabel");if(a[h])c=a[g];else{a[h]=c;n.markSeries.push({id:c,label:h,tooltip:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/LifecycleMarkTooltip")})}}else if(2===c){h=e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/RulerUserMarkLabel");if(a[h])c=a[g];else{a[h]=c;n.markSeries.push({id:c,label:h,tooltip:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/UserMarkTooltip")})}}else{var d=t.LegendTooltip;i.Resources&&i.Resources[d]&&(d=i.Resources[d]);var g=t.Legend;i.Resources&&i.Resources[g]&&(g=i.Resources[g]);if(a[g])c=a[g];else{a[g]=c;n.markSeries.push({id:c,label:g,tooltip:d||""});r++}}t.MarkTypeId=c;o.push(t)}})});this._ruler=new t.Ruler(n);this.addControl(this._ruler,t.SwimlaneViewConstants.RulerRendererPriority);this.viewportController.viewportStateChanged.addEventListener(this._ruler.onViewportChanged.bind(this._ruler));this._ruler.loadMarks(o)};return i}();t.Renderer=i;var n=null;function o(){return n}t.getViewportController=o;var r=null;function s(t){if(!r&&!t)throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.1002"));r||(r=new i(t));return r}t.getRenderer=s}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(){var i=this;this._isDisabled=!1;this.id="stopCollection";this.label=e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarStopCollectionButton");this.ariaLabel=e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarStopCollectionAriaLabel");this.tooltip=e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolbarStopCollectionTooltip");this.type=1;this.iconEnabled="vs-image-toolbar-stopcollection";this.iconDisabled="vs-image-toolbar-stopcollection-disabled";this.displayOnToolbar=!0;this.displayOnContextMenu=!1;this.checkStopCollection();t.getCurrentSession().addStateChangedEventListener(function(){return i.checkStopCollection()})}i.prototype.callback=function(){t.getCurrentSession().stopCollection()};i.prototype.hidden=function(){return!1};i.prototype.disabled=function(){return this._isDisabled};i.prototype.checkStopCollection=function(){var e=this;t.getCurrentSession().canStopCollection().then(function(t){e._isDisabled=!t;e.onDisabledChanged&&e.onDisabledChanged()})};return i}();t.StopCollectionCommand=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){"use strict";var t=function(){function t(){}t.OneHourInNs=e.BigNumber.convertFromNumber(36e11);t.MinSelectionInPixels=10;t.InfobarRendererPriority=0;t.ToolbarRendererPriority=5;t.RulerRendererPriority=10;return t}();e.SwimlaneViewConstants=t}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(n,o,r,s,a,u){var l=this;this._cachedPoints=[];this._drawFill=!1;this._dataWarehouseRequestHandle=1;this._droppedRequest=!1;this._currentTimespan=new t.JsonTimespan(t.BigNumber.zero,t.BigNumber.zero);this._seriesMin=0;this._seriesMax=0;this._newDataEvent=new t.AggregatedEvent;this._samples=250;this._currentTimespan=o;this._title=a;this._tooltip=u;this._unitConverter=r;this._colorScheme=s;this._drawFill="string"==typeof s.lineFillColor&&""!==s.lineFillColor;this._marker=document.createElement("div");this._marker.classList.add("countersDataSeries-marker");this._marker.style.backgroundColor=this._colorScheme.lineColor;this._marker.style.width=2*i.PointRadiusInPixels+"px";this._marker.style.height=2*i.PointRadiusInPixels+"px";e.VisualStudio.DiagnosticsHub.DataWarehouse.loadDataWarehouse().then(function(e){var t={customDomain:{Task:"GetCounter",CounterId:n}};return e.getFilteredData(t,i.analyzerId)}).then(function(e){l._countersResult=e}).then(function(){l._dataWarehouseRequestHandle=null;l._droppedRequest=!1;l.requestUpdate()})}Object.defineProperty(i,"analyzerId",{get:function(){return"66EDDDF1-2277-40F3-983A-6FF57A433ECB"},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"minValue",{get:function(){return this._seriesMin},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"maxValue",{get:function(){return this._seriesMax},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"marker",{get:function(){return this._marker},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"title",{get:function(){return this._title},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"tooltip",{get:function(){return this._tooltip},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"newDataEvent",{get:function(){return this._newDataEvent},enumerable:!0,configurable:!0});i.prototype.dispose=function(){this._countersResult.dispose();this._newDataEvent.dispose()};i.prototype.onViewportChanged=function(e){this._currentTimespan=e;this.requestUpdate()};i.prototype.onDataUpdate=function(e){var t=this._cachedPoints.length;this._currentTimespan.contains(e)||0===t?this.requestUpdate():t>0&&this._currentTimespan.end.greater(this._cachedPoints[t-1].Timestamp)&&this.requestUpdate()};i.prototype.getPointAtTimestamp=function(i,n){void 0===n&&(n=1);if(0===this._cachedPoints.length)return null;var o={Timestamp:i,Value:0},r=function(e,t){return t.Timestamp.greater(e.Timestamp)};switch(n){case 0:var s=t.Utilities.findLessThan(this._cachedPoints,o,r);o=this._cachedPoints[s];break;case 2:s=t.Utilities.findGreaterThan(this._cachedPoints,o,r);o=this._cachedPoints[s];break;case 1:default:var a=t.Utilities.findLessThan(this._cachedPoints,o,r),u=Math.min(a+1,this._cachedPoints.length-1),l=t.BigNumber.subtract(i,this._cachedPoints[a].Timestamp),c=t.BigNumber.subtract(this._cachedPoints[u].Timestamp,i);s=l.greater(c)?u:a;o=this._cachedPoints[s]}return{timestamp:o.Timestamp,tooltip:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ChartSeriesFormattableTooltipLabel",this._unitConverter.formatNumber(o.Value)),value:o.Value,color:this._colorScheme}};i.prototype.draw=function(e,n){if(!(0===this._cachedPoints.length||n.gridX.elapsed.equals(t.BigNumber.zero)||n.chartRect.width<=0)){if(n.chartRect.width!==this._samples){this._samples=n.chartRect.width;this.requestUpdate()}var o=function(e){return n.chartRect.height-t.Utilities.scaleToRange(e,n.gridY.min,n.gridY.max,0,n.chartRect.height)},r=function(e){return t.Utilities.convertToPixel(e,n.gridX,n.chartRect.width,!1)};e.save();e.lineWidth=n.chartRect.height<100?1:2;e.fillStyle=this._colorScheme.lineFillColor;e.strokeStyle=this._colorScheme.lineColor;var s=0;e.beginPath();e.moveTo(s,o(this._cachedPoints[0].Value));this._cachedPoints.forEach(function(t){return e.lineTo(r(t.Timestamp),o(t.Value))});e.stroke();if(this._drawFill){e.lineTo(r(this._cachedPoints[this._cachedPoints.length-1].Timestamp),o(n.gridY.min));e.lineTo(s,n.chartRect.height);e.closePath();e.fill()}var a=t.BigNumber.divideNumber(n.gridX.elapsed,n.chartRect.width);t.BigNumber.convertFromNumber(i.CounterFrequencyPerPixel).greater(a)&&this._cachedPoints.forEach(function(t){e.beginPath();e.arc(r(t.Timestamp),o(t.Value),i.PointRadiusInPixels,0,2*Math.PI);e.fill()});e.restore()}};i.prototype.requestUpdate=function(){var e=this;this._dataWarehouseRequestHandle?this._droppedRequest=!0:this._dataWarehouseRequestHandle=window.setTimeout(function(){if(e._currentTimespan.elapsed.equals(t.BigNumber.zero))e._dataWarehouseRequestHandle=null;else{var i=t.BigNumber.divideNumber(e._currentTimespan.elapsed,2),n=t.BigNumber.subtract(e._currentTimespan.begin,t.BigNumber.min(i,e._currentTimespan.begin)),o=t.BigNumber.multiply(t.BigNumber.divide(n,e._currentTimespan.elapsed),e._currentTimespan.elapsed),r=t.BigNumber.add(o,t.BigNumber.multiplyNumber(e._currentTimespan.elapsed,3)),s={type:"SamplePoints",begin:o.jsonValue,end:r.jsonValue,samples:Math.max(e._samples,2)};e._countersResult.getResult(s).then(function(t){return e.cachePoints(t)}).then(function(){e._dataWarehouseRequestHandle=null;if(e._droppedRequest){window.setTimeout(e.requestUpdate.bind(e),t.Constants.TimeoutImmediate);e._droppedRequest=!1}})}},t.Constants.TimeoutImmediate)};i.prototype.cachePoints=function(e){var i=this;this._cachedPoints=e.p.map(function(e){var n=new t.BigNumber(e.t.h,e.t.l);i._seriesMin=Math.min(i._seriesMin,e.v);i._seriesMax=Math.max(i._seriesMax,e.v);return{Timestamp:n,Value:e.v,ToolTip:e.tt}});this._newDataEvent.invokeEvent(this)};i.PointRadiusInPixels=2.5;i.CounterFrequencyPerPixel=1e8/(2*i.PointRadiusInPixels+4);return i}();t.CountersDataSeries=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(i,n,o,r,s,a,u){var l=this;this._context={};this._dataWarehouseRequestHandle=1;this._droppedRequest=!1;this._minValue=Number.MAX_VALUE;this._maxValue=Number.MIN_VALUE;this._sampledPoints=[];this._data=[];this._width=250;this._newDataEvent=new t.AggregatedEvent;this._analyzerId=i.AnalyzerId;this._viewport=n;this._title=r;this._formattableTooltipText=s||e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ChartSeriesFormattableTooltipLabel");this._unitConverter=u;this._color=a;this._drawFill="string"==typeof a.lineFillColor&&""!==a.lineFillColor;this._marker=document.createElement("div");this._marker.classList.add("countersDataSeries-marker");this._marker.style.backgroundColor=a.lineColor;this._marker.style.width="5px";this._marker.style.height="5px";this._bufferAllData=o;this._context.timeDomain=this._viewport;this._context.customDomain=i.CustomDomain||{};this._context.customDomain.Task="GetCounter";this._context.customDomain.CounterId=i.CounterId;this._context.customDomain.Width=this._width.toString();e.VisualStudio.DiagnosticsHub.DataWarehouse.loadDataWarehouse().then(function(e){l._dataWarehouseHandle=e;l._dataWarehouseRequestHandle=null;l._droppedRequest=!1;l.requestUpdate()})}Object.defineProperty(i.prototype,"minValue",{get:function(){return this._minValue},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"maxValue",{get:function(){return this._maxValue},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"marker",{get:function(){return this._marker},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"title",{get:function(){return this._title},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"newDataEvent",{get:function(){return this._newDataEvent},enumerable:!0,configurable:!0});i.prototype.dispose=function(){this._newDataEvent.dispose()};i.prototype.onDataUpdate=function(e){t.Debug.Assert.isFalse(this._bufferAllData,"Perf: Should not buffer all data in live scenarios");this.requestUpdate()};i.prototype.onViewportChanged=function(e){this._viewport=e;this._bufferAllData?this.updatePointSampling(this._viewport):this.requestUpdate()};i.prototype.draw=function(e,i){if(0!==this._sampledPoints.length){if(i.chartRect.width!==this._width){this._width=i.chartRect.width||1;this._bufferAllData?this.updatePointSampling(this._viewport):this.requestUpdate()}var n=function(e){return t.Utilities.convertToPixel(e.Timestamp,i.gridX,i.chartRect.width,!1)},o=function(e){return i.chartRect.height-t.Utilities.scaleToRange(e.Value,i.gridY.min,i.gridY.max,0,i.chartRect.height)};e.save();e.lineWidth=i.chartRect.height<100?1:2;e.fillStyle=this._color.lineFillColor;e.strokeStyle=this._color.lineColor;var r=0;e.beginPath();e.moveTo(r,o(this._sampledPoints[0]));this._sampledPoints.forEach(function(t){return e.lineTo(n(t),o(t))});e.stroke();if(this._drawFill){var s=i.chartRect.height-t.Utilities.scaleToRange(0,i.gridY.min,i.gridY.max,0,i.chartRect.height);e.lineTo(n(this._sampledPoints[this._sampledPoints.length-1]),s);e.lineTo(r,s);e.closePath();e.fill()}e.restore()}};i.prototype.getPointAtTimestamp=function(e,i){void 0===i&&(i=1);if(0===this._sampledPoints.length)return null;var n={Timestamp:e,Value:0},o=function(e,t){return t.Timestamp.greater(e.Timestamp)};switch(i){case 0:var r=t.Utilities.findLessThan(this._sampledPoints,n,o);n=this._sampledPoints[r];break;case 2:r=t.Utilities.findGreaterThan(this._sampledPoints,n,o);n=this._sampledPoints[r];break;case 1:var s=t.Utilities.findLessThan(this._sampledPoints,n,o),a=this._sampledPoints[s];if(s===this._sampledPoints.length-1||this._sampledPoints[0].Timestamp.greater(e)){n.Value=a.Value;n.Timestamp=a.Timestamp}else{var u=this._sampledPoints[Math.min(s+1,this._sampledPoints.length-1)];n.Value=t.Utilities.linearInterpolate(e,a.Timestamp,a.Value,u.Timestamp,u.Value)}}return{timestamp:n.Timestamp,tooltip:t.Utilities.formatString(this._formattableTooltipText,this._unitConverter.formatNumber(n.Value)),color:this._color,value:n.Value}};i.prototype.updatePointSampling=function(e){var i=this;if(0!==this._data.length){this._sampledPoints=[];var n=new t.JsonTimespan(this._data[0].Timestamp,this._data[this._data.length-1].Timestamp),o=t.BigNumber.divideNumber(e.elapsed,this._width),r=function(e,t){return t.Timestamp.greater(e.Timestamp)},s={Timestamp:t.BigNumber.zero,Value:0},a=Math.floor(parseInt(t.BigNumber.subtract(e.begin,n.begin).value)/parseInt(o.value)),u=t.BigNumber.add(t.BigNumber.multiplyNumber(o,a),n.begin),l=t.BigNumber.add(t.BigNumber.add(u,e.elapsed),o);s.Timestamp=u;var c=t.Utilities.findLessThan(this._data,s,r);s.Timestamp=l;var h=t.Utilities.findGreaterThan(this._data,s,r),d=function(e,t){for(var n=i._data[e],o=0,r=e;r<=t;++r)o=Math.max(o,i._data[r].Value);return{Timestamp:n.Timestamp,ToolTip:n.ToolTip,Value:o}},g=function(e,n,a,u){if(u>=a-n)for(var l=n;l<=a;++l)i._sampledPoints.push(d(l,l));else if(1===u)i._sampledPoints.push(d(n,a));else{var c=Math.floor(u/2),h=u-c,m=t.BigNumber.add(e,t.BigNumber.multiplyNumber(o,c));s.Timestamp=m;var p=t.Utilities.findLessThan(i._data,s,r,n,a);g(e,n,p,c);g(m,p,a,h)}};g(u,c,h,this._width)}};i.prototype.requestUpdate=function(){var e=this;this._dataWarehouseRequestHandle?this._droppedRequest=!0:this._dataWarehouseRequestHandle=window.setTimeout(function(){e._context.timeDomain=e._viewport;e._context.customDomain.Width=e._width.toString();e._dataWarehouseHandle.getFilteredData(e._context,e._analyzerId).then(function(e){return"function"==typeof e.getResult?e.getResult(null).then(function(t){e.dispose();return t}):e}).then(function(e){return e.p}).then(function(t){return e.convertDtoToIPointArray(t)}).then(function(t){return e.cachePoints(t)}).then(function(){e._newDataEvent.invokeEvent(e);e._dataWarehouseRequestHandle=null;if(e._droppedRequest){window.setTimeout(e.requestUpdate.bind(e),t.Constants.TimeoutImmediate);e._droppedRequest=!1}})},t.Constants.TimeoutImmediate)};i.prototype.convertDtoToIPointArray=function(e){return e.map(function(e){return{Timestamp:new t.BigNumber(e.t.h,e.t.l),Value:e.v,ToolTip:e.tt,CustomData:e.d}})};i.prototype.cachePoints=function(e){var t=this;this._data=[];this._maxValue=Number.MIN_VALUE;this._minValue=Number.MAX_VALUE;if(e&&0!==e.length){var i=e[0];this._data=e.filter(function(e){if(!e.Timestamp||!e.Timestamp.greaterOrEqual(i.Timestamp))return!1;t._maxValue=Math.max(t._maxValue,e.Value);t._minValue=Math.min(t._minValue,e.Value);i=e;return!0});this._bufferAllData?this.updatePointSampling(this._viewport):this._sampledPoints=this._data}};return i}();t.CustomCounterDataSeries=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(i,n){var o=this;this._logger=e.VisualStudio.DiagnosticsHub.getLogger();this._defaultColorScheme=new t.ChartColorScheme("rgb(118, 174, 200)","rgba(118, 174, 200, 0.65)");this._currentTimespan=new t.JsonTimespan(t.BigNumber.zero,t.BigNumber.zero);this._dataSeries=[];this._clientWidth=0;this._clientHeight=0;this._scaleIncreaseRatio=1.1;this._scaleChangedEvent=new t.AggregatedEvent;this._container=document.createElement("div");this._container.classList.add("graphContainer");this._container.tabIndex=0;this._canvas=document.createElement("canvas");this._canvas.classList.add("graph-canvas");this._context=this._canvas.getContext("2d");this._unitConverter=new t.LocalizedUnitConverter(i.jsonConfig.Units,i.resources);this._currentTimespan=i.timeRange;this._scaleMin=i.scale.minimum;this._scaleMax=i.scale.maximum;this._isScaleFixed=i.scale.isFixed;this._onNewSeriesDataBoundFunction=this.onNewSeriesData.bind(this);i.jsonConfig.Unit&&(i.unit=i.resources[i.jsonConfig.Unit]);this._container.appendChild(this._canvas);i.jsonConfig.Series.forEach(function(e){var n,r=e.Color?new t.ChartColorScheme(e.Color.Line,e.Color.Fill):o._defaultColorScheme;if(e.DataSource.AnalyzerId.toLowerCase()===t.CountersDataSeries.analyzerId.toLowerCase())n=new t.CountersDataSeries(e.DataSource.CounterId,o._currentTimespan,o._unitConverter,r,i.resources[e.Legend],i.resources[e.LegendTooltip]);else{var s=!i.jsonConfig.RefreshDataOnResizeAndZoom;n=new t.CustomCounterDataSeries(e.DataSource,o._currentTimespan,s,i.resources[e.Legend],i.resources[e.LegendTooltip],r,o._unitConverter)}i.legend.push({legendText:n.title,legendTooltip:n.tooltip,marker:n.marker});n.newDataEvent.addEventListener(o._onNewSeriesDataBoundFunction);o._dataSeries.push(n)});n&&n.forEach(function(e){e.newDataEvent.addEventListener(o._onNewSeriesDataBoundFunction);o._dataSeries.push(e)});this._dataCursor=new t.DataCursor(this._container,this._dataSeries,this._currentTimespan,i.swimlaneId,this._scaleMin,this._scaleMax);this._scaleChangedEvent.addEventListener(this._dataCursor.onScaleChanged.bind(this._dataCursor));this._container.appendChild(this._dataCursor.container)}Object.defineProperty(i.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"scaleChangedEvent",{get:function(){return this._scaleChangedEvent},enumerable:!0,configurable:!0});i.prototype.dispose=function(){var e=this;this._dataCursor.dispose();this._dataSeries.forEach(function(t){t.newDataEvent.removeEventListener(e._onNewSeriesDataBoundFunction);t.dispose&&t.dispose()});this._scaleChangedEvent.dispose()};i.prototype.resize=function(e){var t=this._container.clientWidth||1,i=this._container.clientHeight;if(this._clientWidth!==t||this._clientHeight!==i){this._clientWidth=t;this._clientHeight=i;this._canvas.width=this._clientWidth;this._canvas.height=this._clientHeight;this._dataCursor.resize(e);this.draw()}};i.prototype.onDataUpdate=function(e){this._dataSeries.forEach(function(t){t.onDataUpdate&&t.onDataUpdate(e)})};i.prototype.addSeriesData=function(e,t,i,n){};i.prototype.removeInvalidPoints=function(e){};i.prototype.render=function(e,t){};i.prototype.onViewportChanged=function(e){var t=this;if(!e.isIntermittent&&!this._currentTimespan.equals(e.currentTimespan)){this._currentTimespan=e.currentTimespan;this._dataCursor.onViewportChanged(e);this._dataSeries.forEach(function(e){e.onViewportChanged(t._currentTimespan)});this.draw()}};i.prototype.onNewSeriesData=function(e){var t=!1;if(!this._isScaleFixed&&!isNaN(e.minValue)&&e.minValue<this._scaleMin){this._scaleMin=e.minValue;t=!0}if(!this._isScaleFixed&&!isNaN(e.maxValue)&&e.maxValue*this._scaleIncreaseRatio>this._scaleMax){this._scaleMax=e.maxValue*this._scaleIncreaseRatio;t=!0}this.draw();if(t){var i=this._unitConverter.scaleValue(this._scaleMax);this._scaleChangedEvent.invokeEvent({minimum:this._scaleMin,maximum:this._scaleMax,unit:i.unit})}};i.prototype.draw=function(){var e=this;this._context.clearRect(0,0,this._clientWidth,this._clientHeight);this._context.save();var i={gridX:this._currentTimespan,gridY:new t.MinMaxNumber(this._scaleMin,this._scaleMax),chartRect:new t.RectangleDimension(0,0,this._clientWidth,this._clientHeight)};this._dataSeries.forEach(function(t){t.draw(e._context,i)});this._context.restore()};return i}();t.MultiSeriesGraph=i;e.VisualStudio.DiagnosticsHub.RegisterNamespace.registerClass("Microsoft.VisualStudio.DiagnosticsHub.MultiSeriesGraph")}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(e,i,n,o,r,s){var a=this;this._parentClientWidth=0;this._parentClientHeight=0;this._timePerPixel=t.BigNumber.one;this._cursors=[];this._showingTooltip=!1;this._tooltipTimer=null;this._telemetry=new t.Telemetry.ViewportController;this._parent=e;this._series=i;this._viewport=n;this._previousTime=this._viewport.begin;this._scaleMin=r;this._scaleMax=s;this._container=document.createElement("div");this._container.classList.add("dataCursor");this._container.classList.add("hidden");this._cursors=i.map(function(e){var t=e.marker.cloneNode(!0);t.classList.add("dataCursorPoint");document.body.appendChild(t);var i=t.clientWidth+2,n=t.clientHeight+2;document.body.removeChild(t);t.style.left=-i/2+"px";t.style.width=i+"px";t.style.height=n+"px";a._container.appendChild(t);return{domElement:t,width:i,height:n}});this._swimlaneId=o;this._onMouseEnterBoundFunction=this.onMouseEnter.bind(this);this._onMouseMoveBoundFunction=this.onMouseMove.bind(this);this._onMouseLeaveBoundFunction=this.onMouseLeave.bind(this);this._onKeyDownBoundFunction=this.onKeyDown.bind(this);this._parent.setAttribute("role","slider");this._parent.setAttribute("aria-live","polite");this._parent.addEventListener("mouseenter",this._onMouseEnterBoundFunction);this._parent.addEventListener("mousemove",this._onMouseMoveBoundFunction);this._parent.addEventListener("mouseleave",this._onMouseLeaveBoundFunction);this._parent.addEventListener("keydown",this._onKeyDownBoundFunction)}Object.defineProperty(i.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0});i.prototype.dispose=function(){this._parent.removeEventListener("mouseenter",this._onMouseEnterBoundFunction);this._parent.removeEventListener("mousemove",this._onMouseMoveBoundFunction);this._parent.removeEventListener("mouseleave",this._onMouseLeaveBoundFunction);this._parent.removeEventListener("keydown",this._onKeyDownBoundFunction)};i.prototype.resize=function(e){this._parentClientWidth=this._parent.clientWidth;this._parentClientHeight=this._parent.clientHeight;this._timePerPixel=0!==this._parentClientWidth?t.BigNumber.divideNumber(this._viewport.elapsed,this._parentClientWidth):t.BigNumber.one};i.prototype.onViewportChanged=function(e){if(!this._viewport.equals(e.currentTimespan)){this._viewport=e.currentTimespan;this._previousTime=this._viewport.begin;this._timePerPixel=0!==this._parentClientWidth?t.BigNumber.divideNumber(this._viewport.elapsed,this._parentClientWidth):t.BigNumber.one;this.dismissTooltip();this._container.classList.add("hidden")}};i.prototype.onScaleChanged=function(e){this._scaleMax=e.maximum;this._scaleMax=e.maximum};i.prototype.onKeyDown=function(e){if(37===e.keyCode||39===e.keyCode){e.preventDefault();var i,n=e.currentTarget.getBoundingClientRect(),o=this._previousTime;if(39===e.keyCode){this._previousTime=t.BigNumber.add(this._previousTime,this._timePerPixel);i=2}else{this._previousTime=this._previousTime.greater(this._timePerPixel)?t.BigNumber.subtract(this._previousTime,this._timePerPixel):t.BigNumber.zero;i=0}var r=this.getPointsAt(this._previousTime,i);if(0!==r.length){var s=r[0].seriesElement.timestamp;if(s.equals(o)||s.greater(this._viewport.end)||this._viewport.begin.greater(s)){this._previousTime=39===e.keyCode?this._viewport.begin:this._viewport.end;s=(r=this.getPointsAt(this._previousTime,i))[0].seriesElement.timestamp}this._previousTime=s;this.updateCursorLocation(s,r);this.dismissTooltip();this.displayTooltip(n,s,r)}}};i.prototype.onMouseEnter=function(e){this._container.classList.remove("hidden")};i.prototype.onMouseMove=function(e){var n=e.currentTarget.getBoundingClientRect(),o=t.Utilities.getTimestampAtPixel(e.clientX-n.left,this._parentClientWidth,this._viewport);if(!o.equals(this._previousTime)){this._previousTime=o;n=e.currentTarget.getBoundingClientRect();var r=this.getPointsAt(o);if(0!==r.length){var s=r[0].seriesElement.timestamp,a=t.BigNumber.subtract(t.BigNumber.max(s,o),t.BigNumber.min(s,o)),u=t.BigNumber.multiplyNumber(this._timePerPixel,i.SnapThresholdInPixels),l=a.greater(u);if(l){this._container.classList.add("interpolating");this.updateCursorLocation(o,r)}else{this._container.classList.remove("interpolating");this.updateCursorLocation(s,r)}this.dismissTooltip();this.displayTooltip(n,o,r,l)}else this._container.classList.add("hidden")}};i.prototype.onMouseLeave=function(e){var i=t.Utilities.getTimestampAtPixel(e.x,this._parentClientWidth,this._viewport);if(!this._showingTooltip||!i.equals(this._previousTime)){this.dismissTooltip();this._container.classList.add("hidden");this._previousTime=this._viewport.begin}};i.prototype.getPointsAt=function(e,i){var n=this;void 0===i&&(i=1);return this._series.map(function(t,o){return{seriesElement:t.getPointAtTimestamp(e,i),cursor:n._cursors[o]}}).filter(function(e){return null!==e.seriesElement}).sort(function(i,n){var o=t.BigNumber.subtract(t.BigNumber.max(e,i.seriesElement.timestamp),t.BigNumber.min(e,i.seriesElement.timestamp)),r=t.BigNumber.subtract(t.BigNumber.max(e,n.seriesElement.timestamp),t.BigNumber.min(e,n.seriesElement.timestamp));return o.compareTo(r)}).filter(function(e,i,o){var r=t.BigNumber.subtract(t.BigNumber.max(o[0].seriesElement.timestamp,e.seriesElement.timestamp),t.BigNumber.min(o[0].seriesElement.timestamp,e.seriesElement.timestamp));return n._timePerPixel.greater(r)})};i.prototype.updateCursorLocation=function(e,i){var n=this,o=t.Utilities.convertToPixel(e,this._viewport,this._parentClientWidth);this._container.style.left=Math.floor(o)+"px";this._cursors.forEach(function(e){return e.domElement.style.visibility="hidden"});i.forEach(function(e){if("number"==typeof e.seriesElement.value){var i=t.Utilities.scaleToRange(e.seriesElement.value,n._scaleMin,n._scaleMax,0,n._parentClientHeight);e.cursor.domElement.style.bottom=i-e.cursor.height/2+"px";e.cursor.domElement.style.visibility="visible"}else e.cursor.domElement.style.visibility="visible"});this._container.classList.remove("hidden")};i.prototype.displayTooltip=function(i,n,o,r){var s=this;void 0===r&&(r=!1);this._tooltipTimer=null;this._showingTooltip=!0;var a=t.Utilities.convertToPixel(n,this._viewport,this._parentClientWidth),u=o.map(function(e){return e.seriesElement.tooltip});r&&u.unshift(e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/DataCursorInterpolatingTooltip"));if(u.length>0){var l=u.join("\n"),c=e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ChartSeriesFormattableTimeLabel",t.RulerUtilities.formatTime(n,1))+"\n"+l;this._parent.setAttribute("aria-valuenow",c);this._parent.setAttribute("aria-valuetext",c);this._tooltipTimer=setTimeout(function(){var o={content:e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ChartSeriesFormattableTimeLabel",t.RulerUtilities.formatTime(n))+"\n"+l,delay:0,x:a+i.left+10,y:i.top};e.Plugin.Tooltip.show(o);s._telemetry.showGraphTooltip(s._swimlaneId)},t.Constants.TooltipTimeoutMs)}};i.prototype.dismissTooltip=function(){clearTimeout(this._tooltipTimer);this._tooltipTimer=null;this._showingTooltip=!1;e.Plugin.Tooltip.dismiss()};i.SnapThresholdInPixels=10;return i}();t.DataCursor=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(i){this._clientWidth=0;this._clientHeight=0;this._container=document.createElement("canvas");this._container.className="gridLines";this._container.style.zIndex=t.Constants.GridLineZIndex.toString();this._context=this._container.getContext("2d");this._context.lineWidth=1;this._strokeStyle=e.Plugin.Theme.getValue("diagnostics-host-graph-line");this._currentTimespan=i;this._onThemeChangeBoundFunction=this.onThemeChange.bind(this);e.Plugin.Theme.addEventListener("themechanged",this._onThemeChangeBoundFunction)}Object.defineProperty(i.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0});i.prototype.dispose=function(){e.Plugin.Theme.removeEventListener("themechanged",this._onThemeChangeBoundFunction)};i.prototype.resize=function(e){this._clientWidth=this._container.clientWidth;this._clientHeight=this._container.clientHeight;this._container.width=this._clientWidth;this._container.height=this._clientHeight;this.render()};i.prototype.onViewportChanged=function(e){if(!this._currentTimespan.equals(e.currentTimespan)){this._currentTimespan=e.currentTimespan;this.render()}};i.prototype.onThemeChange=function(){this._strokeStyle=e.Plugin.Theme.getValue("diagnostics-host-graph-line");this.render()};i.prototype.render=function(){var e=this,i=t.RulerUtilities.getTickMarksPosition(this._currentTimespan,this._clientWidth),n=parseInt(this._currentTimespan.elapsed.value);this._context.clearRect(0,0,this._clientWidth,this._clientHeight);this._context.strokeStyle=this._strokeStyle;i.forEach(function(i){if(0===i.type){var o=Math.round(e._clientWidth*parseInt(t.BigNumber.subtract(i.value,e._currentTimespan.begin).value)/n);e._context.beginPath();e._context.moveTo(o+.5,0);e._context.lineTo(o+.5,e._clientHeight);e._context.stroke()}})};return i}();t.GridLineRenderer=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function e(e,t){var i=this;this._subscriptions=[];this._toolName=e.toolName;this._toolId=e.toolId;this._isActive=ko.observable(1==(1&e.toolState));this._isSupported=ko.observable(2==(2&e.toolState));this._hasFocus=ko.observable(!1);this._subscriptions.push(this._isActive.subscribe(function(e){t.setToolEnabled(i._toolId,e)}))}Object.defineProperty(e.prototype,"toolName",{get:function(){return this._toolName},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"toolId",{get:function(){return this._toolId},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isActive",{get:function(){return this._isActive},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isSupported",{get:function(){return this._isSupported},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"hasFocus",{get:function(){return this._hasFocus},enumerable:!0,configurable:!0});e.prototype.dispose=function(){this._subscriptions.forEach(function(e){e.dispose()})};return e}(),n=function(){function n(){var e=this;this._toolsChangedInfoBarVisible=!1;this._previousActiveStates={};this._flyoutVisible=ko.observable(!1);this._tools=ko.observableArray();this._onToolStateChangedBoundFunction=this.onToolStateChanged.bind(this);this._settingsViewModel=new o(function(){return e.onSettingsClicked()});this._toolsService=new t.PerformanceDebuggerToolsService;this._infoBarService=t.getInfoBarService();this._subscription=this._flyoutVisible.subscribe(function(t){return e.onFlyoutVisibilityChanged(t)});this._telemetry=new t.Telemetry.PerformanceDebugger;this._toolsService.getAvailableToolsInformationAndState().then(function(t){t.forEach(function(t){var n=new i(t,e._toolsService);e._tools.push(n)});e._toolsService.toolStateChangedEvent.addEventListener(e._onToolStateChangedBoundFunction)})}Object.defineProperty(n.prototype,"flyoutVisible",{get:function(){return this._flyoutVisible},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"tools",{get:function(){return this._tools},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"toolSettingsItem",{get:function(){return this._settingsViewModel},enumerable:!0,configurable:!0});n.prototype.dispose=function(){this._toolsService.toolStateChangedEvent.removeEventListener(this._onToolStateChangedBoundFunction);this._subscription.dispose();this._tools().forEach(function(e){return e.dispose()})};n.prototype.onFlyoutVisibilityChanged=function(t){var i=this;if(t){this.saveToolState();this._telemetry.selectToolsDropdown()}else if(!this._toolsChangedInfoBarVisible&&this.isToolStateDirty()){this._toolsChangedInfoBarVisible=!0;this._infoBarService.addInfoMessage(e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolSelectionChangesNextDebugSession"),null,function(){i._toolsChangedInfoBarVisible=!1})}};n.prototype.onToolStateChanged=function(e){var t=this;e.toolsState.forEach(function(e){for(var i=0;i<t._tools().length;++i)if(e.toolId===t._tools()[i].toolId){t._tools()[i].isActive(1==(1&e.toolState));t._tools()[i].isSupported(2==(2&e.toolState));break}t.saveToolState()})};n.prototype.saveToolState=function(){var e=this;this._tools().forEach(function(t){e._previousActiveStates[t.toolId]=t.isActive()})};n.prototype.isToolStateDirty=function(){var e=this;return this._tools().some(function(t){return e._previousActiveStates[t.toolId]!==t.isActive()})};n.prototype.onSettingsClicked=function(){this.flyoutVisible(!1);this._toolsService.invokeSettingsDialog()};return n}(),o=function(){function t(e){this._clickHandler=e;this._hasFocus=ko.observable(!1)}Object.defineProperty(t.prototype,"label",{get:function(){return e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolSelectionSettingsText")},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"ariaLabel",{get:function(){return e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/ToolSelectionSettingsAriaLabel")},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"hasFocus",{get:function(){return this._hasFocus},enumerable:!0,configurable:!0});t.prototype.clickCommand=function(){this._clickHandler()};return t}(),r=function(){function i(){var i=this;this.registerKnockoutBindings();this._container=document.createElement("div");this._container.id="toolSelectionControl";this._container.innerHTML=document.getElementById("toolSelectionView").innerHTML;this._viewModel=new n;this._flyout=t.Utilities.findChildById(this._container,"toolSelectionFlyout");this._flyout.style.zIndex=t.Constants.DropDownMenuZIndex.toString();var o=function(){var e=window.innerHeight-i._dropDownButton.offsetHeight;i._flyout.style.maxHeight=Math.min(e,120)+"px"};this._onWindowResizeBoundFunction=t.eventThrottler(o,t.Constants.WindowResizeThrottle);window.addEventListener("resize",this._onWindowResizeBoundFunction);this._dropDownButton=t.Utilities.findChildById(this._container,"toolSelectionDropdown");this._dropDownButton.style.zIndex=(t.Constants.DropDownMenuZIndex+1).toString();this._dropDownButton.onclick=this.toggleFlyout.bind(this);this._dropDownButton.onkeydown=this.onKeyDown.bind(this);var r=t.Utilities.findChildById(this._dropDownButton,"toolSelectionDropdownImage");r.appendChild(t.Utilities.getSVGPlaceHolder("vs-image-tools-settings"));e.Plugin.Theme.processInjectedSvg(r);var s=t.Utilities.findChildById(this._flyout,"settingsItemImage");s.appendChild(t.Utilities.getSVGPlaceHolder("vs-image-tools-settings"));e.Plugin.Theme.processInjectedSvg(s);this._onMouseDownBoundFunction=this.onMouseDown.bind(this);window.addEventListener("mousedown",this._onMouseDownBoundFunction);ko.applyBindings(this._viewModel,this.container)}Object.defineProperty(i.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0});i.prototype.dispose=function(){this._dropDownButton.onclick=null;this._dropDownButton.onkeydown=null;window.removeEventListener("mousedown",this._onMouseDownBoundFunction);window.removeEventListener("resize",this._onWindowResizeBoundFunction);this._viewModel.dispose()};i.prototype.onKeyDown=function(e){40===e.keyCode?this._viewModel.flyoutVisible(!0):13===e.keyCode&&this.toggleFlyout()};i.prototype.toggleFlyout=function(){var e=this._viewModel.flyoutVisible();this._viewModel.flyoutVisible(!e)};i.prototype.onMouseDown=function(e){if(this._viewModel.flyoutVisible()){var i=this._flyout.getBoundingClientRect(),n=this._dropDownButton.getBoundingClientRect();t.Utilities.containsPoint(i,e.clientX,e.clientY)||t.Utilities.containsPoint(n,e.clientX,e.clientY)||this._viewModel.flyoutVisible(!1)}};i.prototype.registerKnockoutBindings=function(){ko.bindingHandlers.focus||(ko.bindingHandlers.focus={previousElement:null,init:function(e,t,i,n,o){var r=function(){var i=t();if(ko.bindingHandlers.focus.previousElement&&ko.bindingHandlers.focus.previousElement!==e){var n=document.createEvent("Event");n.initEvent("blur",!1,!1);ko.bindingHandlers.focus.previousElement.dispatchEvent(n)}i()||i(!0);ko.bindingHandlers.focus.previousElement=e},s=function(){var e=t();e()&&e(!1)};e.addEventListener("focus",r);e.addEventListener("blur",s)},update:function(e,t,i,n,o){ko.unwrap(t())?e.focus():e.blur()}})};return i}();t.ToolSelectionDropDownControl=r}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){"use strict";var t=function(){function e(e){this._container=document.createElement("div");this._container.classList.add("main-usermessage-container");var t=document.createElement("span");t.classList.add("usermessage-message");t.innerHTML=e;this._container.appendChild(t)}Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0});return e}();e.UserMessageControl=t}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){"use strict";var t=function(){function e(e,t,i){this._container=document.createElement("div");this._container.classList.add("graph-axis-line");e.isThresholdAxis&&this._container.classList.add("threshold-axis");this._value=e.value;this.updatePosition(t,i)}Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0});e.prototype.onScaleChangedEvent=function(e){this.updatePosition(e.minimum,e.maximum)};e.prototype.updatePosition=function(e,t){if(this._value<e||this._value>t)this._container.style.display="none";else{this._container.style.display="block";var i=(this._value-e)/(t-e)*100;this._container.style.top=100-i+"%"}};return e}();e.Axes=t}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(i){var n=this;if(!i)throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.1002"));this._container=document.createElement("div");this._container.className="legend-container";i.forEach(function(e){var i;e.marker?i=e.marker.cloneNode(!0):(i=document.createElement("div")).style.backgroundColor=e.color;i.classList.add("legend-marker");i.style.width="1em";i.style.height="1em";var o=document.createElement("div");o.classList.add("legend-text-div");o.innerText=e.legendText;var r=document.createElement("div");r.classList.add("legend-div");r.appendChild(i);r.appendChild(o);e.legendTooltip&&r.setAttribute("data-plugin-vs-tooltip",JSON.stringify({content:e.legendTooltip,delay:t.Constants.TimeoutImmediate}));n._container.appendChild(r)})}Object.defineProperty(i.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0});return i}();t.Legend=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(t,i,n){if(!t)throw new Error(e.Plugin.Resources.getErrorString("JSProfiler.1002"));this._minimum=t.minimum;this._maximum=t.maximum;this._axes=t.axes;this._unitConverter=n;this._scaleType=i;this._container=document.createElement("div");this._container.className=0===this._scaleType?"graph-scale-left":"graph-scale-right"}Object.defineProperty(i.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0});i.prototype.resize=function(e){var t=this._container.clientHeight;if(this._clientHeight!==t){this._clientHeight=t;this.render()}};i.prototype.onScaleChanged=function(e){this._minimum=e.minimum;this._maximum=e.maximum;this.render()};i.prototype.render=function(){for(;this._container.childNodes.length>0;)this._container.removeChild(this._container.firstChild);var e=!1;if(this._axes&&this._axes.length>0)for(var t=0;t<this._axes.length;t++){var i=this._axes[t];this.drawAxisValue(i.value);i.isThresholdAxis&&(e=!0)}else{this.drawAxisValue(this._maximum);this.drawAxisValue(this._minimum)}e&&this.drawAxisValue(this._maximum)};i.prototype.drawAxisValue=function(e){if(!(e>this._maximum||e<this._minimum)){var i=document.createElement("div");i.className=0===this._scaleType?"graph-axis-left":"graph-axis-right";var n=this._unitConverter.scaleValue(e);i.innerHTML=t.Utilities.formatNumber(n.value,0);this._container.appendChild(i);var o=Math.floor((this._maximum-e)/(this._maximum-this._minimum)*this._clientHeight)-i.offsetHeight/2;o=Math.max(0,o);o=Math.min(o,this._clientHeight-i.offsetHeight);i.style.top=o+"px"}};return i}();t.Scale=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(e){!function(e){"use strict";var t=function(){function e(e,t){this._lineColorString="#FF0000";this._lineFillColorString="#FF0000";this._lineColorString=e;this._lineFillColorString=t}Object.defineProperty(e.prototype,"lineColor",{get:function(){return this._lineColorString},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"lineFillColor",{get:function(){return this._lineFillColorString},enumerable:!0,configurable:!0});return e}();e.ChartColorScheme=t}(e.DiagnosticsHub||(e.DiagnosticsHub={}));e.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(){var i=this;e.Plugin.Tooltip.defaultTooltipContentToHTML=!1;var n={dataManager:null,containerId:null,isToolbarFloating:!0,isPerformanceDebugger:!0,isSelectionEnabled:!0,isLive:!0,timeInNsPerPixel:6e7};this._onSessionTargetAddFailedBoundFunction=this.onSessionTargetAddFailed.bind(this);this._onStatusMessageUpdateBoundFunction=this.onStatusMessageChanged.bind(this);this._eventAggregator=t.getEventAggregator();this._renderer=e.VisualStudio.DiagnosticsHub.getRenderer(n);t.getPerformanceDebuggerStateService().isDocumentActiveSession().then(function(e){return i.setupInitialWindow(e)})}i.prototype.addInfoMessage=function(e,i,n){var o=this,r=new t.InformationBarControl(e,i);r.onClose=function(){o._renderer.removeControl(r);n&&n()};this._renderer.addControl(r,t.SwimlaneViewConstants.InfobarRendererPriority)};i.prototype.setupInitialWindow=function(i){var n=this;this._renderer.addToolbarItem(new e.VisualStudio.DiagnosticsHub.ToolSelectionDropDownControl);if(i){this._currentSession=e.VisualStudio.DiagnosticsHub.getCurrentSession();this._eventAggregator.addEventListener("DiagnosticsHub.EventAggregator.SessionTargetAddFailedEvent",this._onSessionTargetAddFailedBoundFunction);this._currentSession.getPerformanceDebuggerSessionTargetProcessInformation().then(function(e){e.addTargetFailureCount>0&&n.onSessionTargetAddFailed()})}else{var o=t.getPerformanceDebuggerStateService();o.statusMessageChangedEvent.addEventListener(this._onStatusMessageUpdateBoundFunction);o.getLastNonActiveStatusMessage().then(function(e){return n.showMessage(e)})}};i.prototype.onSessionTargetAddFailed=function(){var t=this;this._eventAggregator.removeEventListener("DiagnosticsHub.EventAggregator.SessionTargetAddFailedEvent",this._onSessionTargetAddFailedBoundFunction);this._currentSession.getPerformanceDebuggerSessionTargetProcessInformation().then(function(i){t.addInfoMessage(e.Plugin.Resources.getString("/DiagnosticsHubResources/InformationPerfDebuggerSingleTarget",i.processName,i.processId))})};i.prototype.onStatusMessageChanged=function(e){this.showMessage(e.statusMessage)};i.prototype.showMessage=function(e){null!==this._userMessage&&void 0!==this._userMessage&&this._renderer.removeControl(this._userMessage);this._userMessage=new t.UserMessageControl(e);this._renderer.addControl(this._userMessage,t.Renderer.headerSwimlanePriority)};return i}(),n=null;function o(){if(!n)throw new Error("Not initialized correctly");return n}t.getInfoBarService=o;function r(){n||(n=new i);return n}t.getPerformanceDebuggerSwimlanesView=r}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(){this._content=[];this._ariaContent=[];this.marks=[]}i.prototype.getTooltipContent=function(){this.updateData();return this._content.join("\r\n")};i.prototype.getAriaContent=function(){this.updateData();return this._ariaContent.join(", ")};i.prototype.push=function(e){(!this.time||this.time>e.time)&&(this.time=e.time);this.marks.push(e)};i.prototype.updateData=function(){if(this._content.length!==this.marks.length){this._content=[];this._ariaContent=[];for(var i=0;i<this.marks.length;i++)if(null!==this.marks[i].tooltip&&void 0!==this.marks[i].tooltip){var n=this.marks[i],o=n.tooltip,r=n.tooltip;o+=e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/RulerMarkTooltipLabel",t.RulerUtilities.formatTime(n.time));r+=e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/RulerMarkTooltipLabel",t.RulerUtilities.formatTime(n.time,1));this._content.push(o);this._ariaContent.push(r)}}};return i}();t.AggregatedMarkData=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));!function(e){!function(t){!function(t){"use strict";var i=function(){function i(t,i){var n=this;this._droppedRequest=!1;this._dataWarehouseRequestHandle=1;this._logger=e.VisualStudio.DiagnosticsHub.getLogger();this._scale=i;this._markId=t.MarkTypeId;this._analyzerId=t.DataSource.AnalyzerId;e.VisualStudio.DiagnosticsHub.DataWarehouse.loadDataWarehouse().then(function(e){n._dataWarehouse=e;var i=t.DataSource;n._dataWarehouseContext={customDomain:{CounterId:i.CounterId}};if(i.CustomDomain)for(var o in i.CustomDomain)if(i.CustomDomain.hasOwnProperty(o)){var r=i.CustomDomain[o];if(null!==r&&"string"!=typeof r){n._logger.warning("Custom domain property '"+o+"' is not a string, it will be converted to string");r=r.toString()}n._dataWarehouseContext.customDomain[o]=r}n._dataWarehouseRequestHandle=null;n._droppedRequest=!1;n.requestUpdate()})}i.prototype.onDataUpdate=function(e){this.requestUpdate()};i.prototype.dispose=function(){this._countersResult&&this._countersResult.dispose()};i.prototype.requestUpdate=function(){var e=this;this._dataWarehouseRequestHandle?this._droppedRequest=!0:this._dataWarehouseRequestHandle=window.setTimeout(function(){(e._countersResult?e._countersResult.getResult(null):e._dataWarehouse.getFilteredData(e._dataWarehouseContext,e._analyzerId).then(function(t){if("function"==typeof t.getResult){e._countersResult=t;return e._countersResult.getResult(null)}return t})).then(function(i){i&&i.p&&i.p.forEach(function(i){var n=new t.BigNumber(i.t.h,i.t.l),o=i.tt||e.formatMarkTooltip(n),r=new t.MarkData(n,o);e._scale.addMark(e._markId,r,!1)})}).then(function(){e._dataWarehouseRequestHandle=null;if(e._droppedRequest){window.setTimeout(e.requestUpdate.bind(e),t.Constants.TimeoutImmediate);e._droppedRequest=!1}})},t.Constants.TimeoutImmediate)};i.prototype.formatMarkTooltip=function(i){return e.Plugin.Resources.getString("/DiagnosticsHubControlsResources/TooltipTimeLabel")+": "+t.RulerUtilities.formatTime(i,0)};return i}();t.MarkDataFetcher=i}(t.DiagnosticsHub||(t.DiagnosticsHub={}));t.DiagnosticsHub}(e.VisualStudio||(e.VisualStudio={}));e.VisualStudio}(Microsoft||(Microsoft={}));
