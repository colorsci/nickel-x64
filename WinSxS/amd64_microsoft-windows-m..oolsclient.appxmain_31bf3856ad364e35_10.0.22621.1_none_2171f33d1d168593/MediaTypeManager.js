var Common;!function(e){"use strict";class t{static reinitialize(){this._initialized=!1;this.initialize()}static getCanonicalMediaType(e){this.initialize();if(!e)return e;e=this.normalizeMediaType(e);return this.getCanonicalMediaTypeCommon(e)}static isEditableMediaType(e){this.initialize();if(!e)return!1;e=this.normalizeMediaType(e);return this.isEditableMediaTypeCommon(e)}static mediaTypeSupportsFindRefs(e){this.initialize();if(!e)return!1;e=this.normalizeMediaType(e);return this.mediaTypeSupportsFindRefsCommon(e)}static isJMCEnabledForMediaType(e){this.initialize();if(!e)return!1;e=this.normalizeMediaType(e);return this.isJMCEnabledForMediaTypeCommon(e)}static getMediaTypeForFileExtension(e,t){this.initialize();if(e){e=this.normalizeFileExtension(e);return this.getMediaTypeForFileExtensionCommon(e,t)}return this.getCanonicalFallbackMediaType(t)}static getSortedMediaTypes(e){this.initialize();if(!e)return[];var t=new Set,i=(e=e.filter(e=>{if(!e||t.has(e))return!1;t.add(e);return!0})).length;if(i<=0)return[];for(var a=new Array(i),s=new Array(i),n=0;n<i;n++){a[n]=n;var r=this.normalizeMediaType(e[n]);s[n]=this.getCanonicalMediaTypeCommon(r)}a.sort((e,t)=>{var i=this.getRank(s[e]),a=this.getRank(s[t]);return i<a?-1:i>a?1:e-t});var o=new Array(i);for(n=0;n<i;n++)o[n]=e[a[n]];return o}static registerMediaTypes(e){if(e)for(var t in e)this.registerMediaType(t,e[t])}static registerMediaType(e,t){if(e){e=this.normalizeMediaType(e);this.registerMediaTypeCommon(e,t)}}static setEditableMediaType(e,t){if(e){e=this.normalizeMediaType(e);this.setEditableMediaTypeCommon(e,t)}}static setJMCEnabledMediaType(e,t){if(e){e=this.normalizeMediaType(e);this.setJMCEnabledMediaTypeCommon(e,t)}}static registerAlternateMediaTypes(e,t){if(e&&t&&!(t.length<=0)){e=this.normalizeMediaType(e);this.registerAlternateMediaTypesCommon(e,t)}}static registerAlternateMediaType(e,t){if(e&&t){e=this.normalizeMediaType(e);t=this.normalizeMediaType(t);this.registerAlternateMediaTypeCommon(e,t)}}static registerMediaTypeFileExtensions(e,t){if(e&&t&&!(t.length<=0)){e=this.normalizeMediaType(e);this.registerMediaTypeFileExtensionsCommon(e,t)}}static registerMediaTypeFileExtension(e,t){if(t&&e){e=this.normalizeMediaType(e);t=this.normalizeFileExtension(t);this.registerMediaTypeFileExtensionCommon(e,t)}}static initialize(){if(!this._initialized){this.registerMediaTypes(this._defaultMediaTypes);this.setEditableMediaType("text/css",!0);this.setEditableMediaType("text/javascript",!0);this._initialized=!0}}static getCanonicalMediaTypeCommon(e){for(;;){var t=this._canonicalMap.get(e);if(!t)break;e=t}return e}static getMediaTypeForFileExtensionCommon(e,t){var i=this._extensionMap.get(e);return i?this.getCanonicalMediaTypeCommon(i):this.getCanonicalFallbackMediaType(t)}static isEditableMediaTypeCommon(e){for(;e;){if(this._editableMediaTypes.has(e))return!0;e=this._canonicalMap.get(e)}return!1}static isJMCEnabledForMediaTypeCommon(e){for(;e;){if(this._jmcMediaTypes.has(e))return!0;e=this._canonicalMap.get(e)}return!1}static mediaTypeSupportsFindRefsCommon(e){for(;e;){if(this._findRefsMediaTypes.has(e))return!0;e=this._canonicalMap.get(e)}return!1}static registerMediaTypeCommon(e,t){if(t){t.alternates&&t.alternates.length>0&&this.registerAlternateMediaTypesCommon(e,t.alternates);t.extensions&&t.extensions.length>0&&this.registerMediaTypeFileExtensionsCommon(e,t.extensions);"editable"in t&&this.setEditableMediaTypeCommon(e,t.editable);"canFindRefs"in t&&this.setMediaTypeCanFindRefsCommon(e,t.canFindRefs);"jmcEnabled"in t&&this.setJMCEnabledMediaTypeCommon(e,t.jmcEnabled)}}static registerAlternateMediaTypesCommon(e,t){t.forEach(t=>{if(t){t=this.normalizeMediaType(t);this.registerAlternateMediaTypeCommon(e,t)}})}static registerAlternateMediaTypeCommon(e,t){if(e!==t){for(var i=this._canonicalMap.get(e);i;){F12.Tools.Utility.Assert.areNotEqual(i,t,"Invalid attempt to add a cyclical reference to a media type.");i=this._canonicalMap.get(i)}this._canonicalMap.set(t,e)}}static registerMediaTypeFileExtensionsCommon(e,t){t.forEach(t=>{if(t){t=this.normalizeFileExtension(t);this.registerMediaTypeFileExtensionCommon(e,t)}})}static registerMediaTypeFileExtensionCommon(e,t){this._extensionMap.set(t,e)}static setEditableMediaTypeCommon(e,t){t?this._editableMediaTypes.add(e):this._editableMediaTypes.delete(e)}static setMediaTypeCanFindRefsCommon(e,t){t?this._findRefsMediaTypes.add(e):this._findRefsMediaTypes.delete(e)}static setJMCEnabledMediaTypeCommon(e,t){t?this._jmcMediaTypes.add(e):this._jmcMediaTypes.delete(e)}static normalizeMediaType(e){var t=(e=(e=e.trim()).toLowerCase()).indexOf(";");t>-1&&(e=e.substr(0,t));return e}static normalizeFileExtension(e){"."!==(e=(e=e.trim()).toLowerCase()).charAt(0)&&(e="."+e);return e}static getRank(e){switch(e){case"text/plain":return 3;case"text/javascript":case"text/html":case"text/css":case"text/xml":return 2;case"text/typescript":case"text/coffeescript":case"text/x-csharp":case"text/less":case"text/scss":return 1;default:return 0}}static getCanonicalFallbackMediaType(e){if(e){e=this.normalizeMediaType(e);return this.getCanonicalMediaTypeCommon(e)}return"text/plain"}}t._initialized=!1;t._defaultMediaTypes={"text/html":{alternates:["text/x-jshtm","text/x.jshtm"],extensions:[".html",".htm"],jmcEnabled:!0},"text/xml":{alternates:["application/xml"],extensions:[".xml",".xsl",".svg"]},"text/javascript":{alternates:["text/javascript1.0","text/javascript1.1","text/javascript1.2","text/javascript1.3","text/javascript1.4","text/javascript1.5","text/jscript","text/livescript","text/x-javascript","text/x-ecmascript","text/x.javascript","text/x.ecmascript","application/javascript","application/ecmascript","application/x-javascript","application/x-ecmascript","application/x.javascript","application/x.ecmascript"],extensions:[".js"],jmcEnabled:!0,canFindRefs:!0},"text/typescript":{alternates:["video/vnd.dlna.mpeg-tts","text/x.typescript","text/vnd.ms.typescript","application/typescript","application/x.typescript","application/vnd.ms.typescript"],extensions:[".ts",".str"],jmcEnabled:!0,canFindRefs:!0},"text/coffeescript":{alternates:["text/x-coffeescript","text/x.coffeescript","application/coffeescript","application/x-coffeescript","application/x.coffeescript"],extensions:[".coffee"],jmcEnabled:!0},"text/x-csharp":{alternates:[],extensions:[".cs"],jmcEnabled:!0},"text/css":{alternates:[],extensions:[".css"]},"text/less":{alternates:["text/x-less","text/x.less"],extensions:[".less"]},"text/scss":{alternates:["text/x-scss","text/x.scss"],extensions:[".sass",".scss"]}};t._extensionMap=new Map;t._canonicalMap=new Map;t._editableMediaTypes=new Set;t._findRefsMediaTypes=new Set;t._jmcMediaTypes=new Set;e.MediaTypeManager=t}(Common||(Common={}));
