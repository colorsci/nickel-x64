!function(e){function t(t){for(var s,a,n=t[0],l=t[1],d=t[2],h=0,u=[];h<n.length;h++){a=n[h];r[a]&&u.push(r[a][0]);r[a]=0}for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);c&&c(t);for(;u.length;)u.shift()();o.push.apply(o,d||[]);return i()}function i(){for(var e,t=0;t<o.length;t++){for(var i=o[t],s=!0,a=1;a<i.length;a++){var l=i[a];0!==r[l]&&(s=!1)}if(s){o.splice(t--,1);e=n(n.s=i[0])}}return e}var s={},r={6:0},o=[];function a(e){return n.p+""+({3:"storageSelfTest"}[e]||e)+".bundle.js"}function n(t){if(s[t])return s[t].exports;var i=s[t]={i:t,l:!1,exports:{}};e[t].call(i.exports,i,i.exports,n);i.l=!0;return i.exports}n.e=function(e){var t=[],i=r[e];if(0!==i)if(i)t.push(i[2]);else{var s=new Promise(function(t,s){i=r[e]=[t,s]});t.push(i[2]=s);var o=document.getElementsByTagName("head")[0],l=document.createElement("script");l.charset="utf-8";l.timeout=120;n.nc&&l.setAttribute("nonce",n.nc);l.src=a(e);var d=setTimeout(function(){h({type:"timeout",target:l})},12e4);l.onerror=l.onload=h;function h(t){l.onerror=l.onload=null;clearTimeout(d);var i=r[e];if(0!==i){if(i){var s=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src,a=new Error("Loading chunk "+e+" failed.\n("+s+": "+o+")");a.type=s;a.request=o;i[1](a)}r[e]=void 0}}o.appendChild(l)}return Promise.all(t)};n.m=e;n.c=s;n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})};n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})};n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};n.d(t,"a",t);return t};n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};n.p="";n.oe=function(e){console.error(e);throw e};var l=window.webpackJsonp=window.webpackJsonp||[],d=l.push.bind(l);l.push=t;l=l.slice();for(var h=0;h<l.length;h++)t(l[h]);var c=d;o.push([201,4]);i()}({105:function(e,t,i){"use strict";i.d(t,"a",function(){return o});var s=i(38),r=i(12);class o{constructor(e,t,i){this.toolbarPanelTemplate="Storage.webStoragePanel";this._type=e;this._origin=t;this._storageManager=i;this._simulateCap=!1;this._id=s.a.NextModelId++}get persistenceKey(){return this.modelName+"/"+this._origin}get shouldBePersisted(){return!0}get modelName(){return 0===this._type?o.LocalStorageModelName:o.SessionStorageModelName}get displayName(){return r.a.createShortenedUrlText(this._origin)}get fullDisplayName(){return this._origin}get id(){return this._id}get simulateCap(){return this._simulateCap}set simulateCap(e){this._simulateCap=e;this.setSimulateCap(e)}setSimulateCap(e){this._storageManager.setSimulateCap(this._type,e)}refresh(){return this._storageManager.retrieveWebStorage(this._type,this._origin)}removeItems(e){return this._storageManager.webStorageDeleteItems(this._type,e,this._origin)}setItem(e,t){return this._storageManager.webStorageSetItem(this._type,e,t,this._origin)}}o.LocalStorageModelName="localStorage";o.SessionStorageModelName="sessionStorage"},201:function(e,t,i){"use strict";i.r(t);var s=i(70),r=i(84),o=i(2),a=i(85),n=i(5),l=i(15),d=i(61),h=i(18),c=i(45),u=i(38),m=i(159),_=i(76),g=i(13),p=i(51),C=i(0),f=i(10),w=i(42),I=i(6),y=i(27),S=i(59),v=i(114);class E{static setAlertMessage(e){if(!E.announcer){const e=document.getElementById(E.ARIA_ALERT_ZONE_ID);e&&(E.announcer=new v.a(e))}E.announcer&&E.announcer.setAlertMessage(e)}}E.ARIA_ALERT_ZONE_ID="storageAriaAlertZone";var b=i(4),M=i(11);class R{static addClasses(e,t){for(var i=e?e.split(" "):[],s=t?t.split(" "):[],r=0;r<s.length;r++)-1===i.indexOf(s[r])&&i.push(s[r]);return i.join(" ")}static removeClasses(e,t){for(var i=e?e.split(" "):[],s=t?t.split(" "):[],r=[],o=0;o<i.length;o++)-1===s.indexOf(i[o])&&r.push(i[o]);return r.join(" ")}}var D=i(108),O=i(69),N=i(35),k=i(12);class P{constructor(e,t,i){this._origin=e;this._name=t;this._storageManager=i;this._id=u.a.NextModelId++}get persistenceKey(){return this.modelName+"/"+this._origin}get shouldBePersisted(){return!0}get modelName(){return P.ModelName}get displayName(){return this._name+"("+k.a.createShortenedUrlText(this._origin)+")"}get fullDisplayName(){return this._origin}get id(){return this._id}refresh(){return this._storageManager.retrieveCache(this._origin,this._name)}removeItems(e){return this._storageManager.deleteCacheItems(this._name,e,this._origin)}setItem(e,t){return Promise.resolve(null)}}P.ModelName="cache";var x=i(95),V=i(60);class L{}L.GO_TO_RESOURCE="GoToResource";L.CLOSE_RESOURCE_VIEW="CloseResourceView";L.CLOSE_ALL_TABS="CloseAllTabs";L.CLOSE_OTHER_TABS="CloseAllTabsButThis";L.OPEN_RESOURCE_VIEW="OpenResourceView";L.SELECT_PREVIOUS_TAB="SelectPreviousTab";L.SELECT_NEXT_TAB="SelectNextTab";L.RESOURCEPICKER_MENU_CLOSE="ResourcePickerMenuClose";L.RESOURCEPICKER_MENU_OPEN="ResourcePickerMenuOpen";L.CACHE_OPENED="CacheOpened";L.COOKIES_OPENED="CookiesOpened";L.INDEXEDDB_OPENED="IndexedDBOpened";L.WEBSTORAGE_OPENED="WebStorageOpened";const A=new V.a("Storage");var T=i(64),K=i(162);class j extends K.a{static createWithoutModel(e,t="filesNode"){const i=new j(null);i._modelId=u.a.NextModelId++;i._staticDisplayName=e;i._previousDisplayName=e;i.iconCssClass=t;i.toolTip=e;return i}static tooltipForModel(e){return void 0===e.tooltip?e.displayName:e.tooltip}constructor(e){super(null,!1,!1,!1,null,"listview-grid-cell-clicksection");if(e){this._model=e;this._modelId=e.id;this._previousDisplayName=this._model.displayName;this.toolTip=j.tooltipForModel(e);this.iconCssClass=e.modelName}this._sortedChildren=[]}get model(){return this._model}get displayName(){return this.model?this._previousDisplayName:this._staticDisplayName}get modelId(){return this._modelId}get hasChildren(){return this.childCount>0}get htmlLines(){this._htmlLines||(this._htmlLines=this.generateHtmlLines());return this._htmlLines}get children(){return this.dynamicDocumentsNode&&this.dynamicDocumentsNode.hasChildren?this._sortedChildren.concat([this.dynamicDocumentsNode]):this._sortedChildren}get childCount(){return this.dynamicDocumentsNode&&this.dynamicDocumentsNode.hasChildren?this._sortedChildren.length+1:this._sortedChildren.length}overrideIconCssClass(e){this.iconCssClass=e}addChild(e){if(k.a.isNumber(e.modelId)){const t=this.getIndexOfChild(e);t<this._sortedChildren.length&&e===this._sortedChildren[t]?b.a.fail("Adding a child ResourcePickerItem that is already in the parent"):this._sortedChildren.splice(t,0,e)}}removeChild(e){if(k.a.isNumber(e.modelId)){const t=this.getIndexOfChild(e);t<this._sortedChildren.length&&e===this._sortedChildren[t]&&this._sortedChildren.splice(t,1)}}generateHtmlLines(){const e=T.a.escapeHtml(T.a.replaceSpacesWithNonBreakingSpaceEntities(this.toolTip));return[`<div role='menuitem'>\n                <div class='listview-grid-cell-clicksection resourcePickerItem ${this.iconCssClass}'></div>\n                <span\n                    class='listview-grid-cell-clicksection\n                    fileItem' data-frontendId='${this.modelId}'\n                    data-plugin-vs-tooltip='${e}'\n                >${T.a.replaceLineBreaksWithNonBreakingSpaceEntities(T.a.escapeHtml(this.displayName))}</span>\n            </div>\n            <span style='display: none'></span>`]}getIndexOfChild(e){if(0===this._sortedChildren.length)return 0;let t,i,s=0,r=this._sortedChildren.length-1;for(;s<=r;){t=Math.floor((s+r)/2);const o=this._sortedChildren[t];0===(i=k.a.naturalSort(e.displayName,o.displayName))&&(i=e.modelId-o.modelId);if(0===i)return t;i>0?s=t+1:r=t-1}return i>0?t+1:t}}class G{constructor(e,t,i){this._buttonElement=t;this._container=e;this._container.setAttribute("disabled","true");this._testEventObject=new O.a;this._storageShell=i;const s=this._storageShell.storageManager&&this._storageShell.storageManager.resourceViewController;s&&(this._onSelectCallback=((e,t)=>{s.open(e,{activation:t})}));t.setAttribute("data-plugin-vs-tooltip",Object(C.b)("FilePickerTooltip"));t.setAttribute("aria-label",Object(C.b)("FilePickerTooltip"));t.setAttribute("aria-expanded","false");t.setAttribute("aria-controls","resourcePickerMenu");this._resourceItemsMap=new Map;this._rootNodesMap=new Map;this._resourceRootNodes=new Map;this._expandedItemMap=new Map;this._scalingFactor=screen.deviceXDPI/screen.logicalXDPI;this._splitter=document.createElement("div");this._splitter.classList.add("splitter");this._splitter.style.display="none";this._fileListContainer=document.createElement("div");this._fileListContainer.classList.add("fileListContainer");this._fileListContainer.id="fileListContainer";e.appendChild(this._fileListContainer);e.appendChild(this._splitter);this._treeView=new D.a(this._fileListContainer,e=>this.onListViewToggle(e),void 0,void 0,(e,t,i,s)=>{if(0===s){if(!e.model||e.model.preventOpen)return;A.logExecuteCommand(L.OPEN_RESOURCE_VIEW,o.c.Ui);this._onSelectCallback(e.model,1);window.setImmediate(()=>{this.hidePicker()})}});this._treeView.scrollPadding=100;this._treeView.notifyToggleCallback=(()=>{this._finalWidth=0});this._treeView.postRenderCallback=(()=>{this._fileListContainer.classList.remove("refresh")});document.addEventListener("keydown",e=>this.onKeyDown(e));this._buttonElement.addEventListener("click",e=>{if(this._buttonElement.classList.contains("activated")){A.logExecuteCommand(L.RESOURCEPICKER_MENU_CLOSE,o.c.Ui);this.hidePicker(!0)}else{A.logExecuteCommand(L.RESOURCEPICKER_MENU_OPEN,o.c.Ui);window.setImmediate(()=>this.showPicker())}e.stopImmediatePropagation();return!0});this._buttonElement.addEventListener("keydown",e=>{const t=()=>{A.logExecuteCommand(L.RESOURCEPICKER_MENU_OPEN,o.c.KeyboardShortcut);window.setImmediate(()=>this.showPicker())},i=()=>{A.logExecuteCommand(L.RESOURCEPICKER_MENU_CLOSE,o.c.KeyboardShortcut);window.setImmediate(()=>this.hidePicker(!0))};if(13===e.keyCode||32===e.keyCode){this._isOpen?i():t();e.preventDefault();return!1}if((40===e.keyCode&&e.ctrlKey&&!e.altKey||40===e.keyCode&&!e.ctrlKey&&e.altKey)&&!this._isOpen){t();e.preventDefault();return!1}if((38===e.keyCode&&e.ctrlKey&&!e.altKey||38===e.keyCode&&!e.ctrlKey&&e.altKey)&&this._isOpen){i();e.preventDefault();return!1}return!0});this._focusOutListener=(e=>{e.target!==document.activeElement||this._contextMenu||this.hidePicker();return!1});this._documentClickListener=(e=>{e.target===this._container||this._container.contains(e.target)||e.target===this._buttonElement||window.setImmediate(()=>{this.hidePicker()});return!1});this._container.addEventListener("contextmenu",e=>{this.showContextMenu(e)});this._buttonElement.addEventListener("focusout",e=>{e.stopPropagation();return!1});window.addEventListener("resize",e=>{this.isOpen&&this.calcFilePickerSize(e)});this.setupSplitter()}get testEventObject(){return this._testEventObject}get isOpen(){return this._isOpen}get rootNodes(){return this._rootNodesMap}get resourceNodes(){return this._resourceRootNodes}get scaledInnerPadding(){return this._scalingFactor*G.INNER_PADDING}resourceAdded(e,t){if(e.modelName===x.a.ModelName)this.indexedDBResourceAdded(e);else{const t=this._resourceRootNodes.get(e.modelName);if(t){const i=new j(e);e.modelName===P.ModelName&&i.overrideIconCssClass("storageChild");t.addChild(i);this.insertAtSortedPosition(i,t)}}this._testEventObject.fireEvent("resourcePickerResourceAdded",{model:e,couldHaveExistingChildren:t})}resourceRemoved(e){if(this._resourceItemsMap.has(e.id)){const t=this._resourceItemsMap.get(e.id);this._resourceItemsMap.delete(e.id);this._rootNodesMap.delete(e.id);const i=this._resourceRootNodes.get(e.modelName);i&&i.removeChild(t);this._treeView.removeItem(t,!1,!1)}else if(e.modelName===x.a.ModelName){const t=this._resourceRootNodes.get(x.a.ModelName),i=t.children.find(t=>t.displayName===e.displayDBNameAndOrigin);if(i){t.removeChild(i);this._treeView.removeItem(i,!1,!1)}}this._testEventObject.fireEvent("filePickerResourceRemoved",{model:e})}resourceOpened(e,t){const i=this._resourceItemsMap.get(e.id);i&&(i.additionalClass=R.addClasses(i.additionalClass,G.OPENED_DOCUMENT_CLASS))}resourceClosed(e){const t=this._resourceItemsMap.get(e.id);t&&(t.additionalClass=R.removeClasses(t.additionalClass,G.OPENED_DOCUMENT_CLASS));this._treeView.refresh()}showPicker(){if(this._isOpen)return;this.drawResourcePicker();this._container.removeAttribute("disabled");this._container.style.display="block";this._container.style.zIndex="1000";this._buttonElement.classList.add("activated");this._buttonElement.setAttribute("aria-expanded","true");this._isOpen=!0;this.repopulateTree();this.refreshViewWithCallback();const e=this._treeView.getItemAt(0);this._lastSelectedItem?this._treeView.selectItem(this._lastSelectedItem,!1):e&&this._treeView.selectItem(e,!1);document.addEventListener("focusout",this._focusOutListener,!0);document.addEventListener("click",this._documentClickListener,!0);document.addEventListener("keydown",this._documentKeydownListener,!0)}hidePicker(e=!1,t=!1){this.hideContextMenu();if(e){this.invokeShellLayouts();this._storageShell.storageContentContainer.style.paddingLeft="0";this._lastSelectedItem=this._treeView.getSelectedItem()||this._treeView.getItemAt(0);this.saveExpandState();this._treeView.clear();this._buttonElement.classList.remove("activated");this._buttonElement.setAttribute("aria-expanded","false");this._container.style.display="none";this._container.style.zIndex="-1000";this._container.setAttribute("disabled","true");this._isOpen=!1;Object(g.E)(G.STORAGE_RESOURCEPICKER_OPEN_REG_KEY,"false");document.removeEventListener("focusout",this._focusOutListener,!0);document.removeEventListener("mousedown",this._documentClickListener,!0);document.removeEventListener("keydown",this._documentKeydownListener,!0)}else t||this._treeView.refresh()}drawResourcePicker(){""!==this._container.style.width&&""!==this._fileListContainer.style.width||this.calcFilePickerSize(null);this._storageShell.storageContentContainer.style.paddingLeft="calc("+this._container.style.width+" + 3px)";this._container.classList.add("pinnedResourcePicker");this._splitter.style.display="block";this._splitter.classList.add("splitter");this._splitter.style.marginLeft="calc("+this._fileListContainer.style.width+" + 1px)";this.invokeShellLayouts()}getAllItems(){const e=[];for(const t of this._resourceItemsMap.values())e.push(t);return e}remeasureTreeView(){this._treeView.remeasure()}getSelectedItem(){return this._treeView.getSelectedItem()}setSelectedItem(e){const t=this._resourceItemsMap.get(e.id);if(t){this._treeView.selectItem(t,!0);return!0}return!1}isExpanded(e){const t=this._resourceItemsMap.get(e.id);return!!t&&(-1!==this._treeView.getIndex(t)&&this._treeView.isItemExpanded(t))}setExpandState(e,t=!0){const i=this._resourceItemsMap.get(e.id);if(i){const e=this._treeView.getIndex(i);-1!==e&&this._treeView.setRowState(e,t?D.a.EXPAND_ROW:D.a.COLLAPSE_ROW)}}addResourceRoot(e,t,i){const s=j.createWithoutModel(t,i);this._rootNodesMap.set(s.modelId,s);this.insertAtSortedPosition(s);this._resourceRootNodes.set(e,s);return s}addRootResourceNode(e){const t=new j(e);this._rootNodesMap.set(t.modelId,t);this.insertAtSortedPosition(t)}getResourceItemCount(){return this._resourceItemsMap.size}indexedDBResourceAdded(e){const t=this._resourceRootNodes.get(x.a.ModelName);let i=t.children.find(t=>t.displayName===e.displayDBNameAndOrigin);if(!i){i=j.createWithoutModel(e.displayDBNameAndOrigin,"indexedDB");t.addChild(i);this.insertAtSortedPosition(i,t)}let s=i.children.find(t=>t.displayName===e.displayObjectStoreName);if(!s){(s=new j(e)).overrideIconCssClass("storageChild");i.addChild(s);this.insertAtSortedPosition(s,i)}if(e.displayIndexName){const t=new j(e);t.overrideIconCssClass("storageChild");s.addChild(t);this.insertAtSortedPosition(t,s)}}onKeyDown(e){const t=e.target;let i=!1,s=0;const r=!e.shiftKey&&!e.ctrlKey&&!e.altKey;let a=!0,n=!0;if(e.ctrlKey&&!e.altKey&&!e.shiftKey&&79===e.keyCode){A.logExecuteCommand(L.RESOURCEPICKER_MENU_OPEN,o.c.KeyboardShortcut);window.setImmediate(()=>this.showPicker());e.preventDefault();return!1}if(e.ctrlKey&&!e.altKey&&e.shiftKey&&79===e.keyCode){if(this.isOpen){A.logExecuteCommand(L.RESOURCEPICKER_MENU_CLOSE,o.c.KeyboardShortcut);this.hidePicker(!0);e.preventDefault()}}else if(t&&t.classList.contains("listview-grid-row-selected"))if(13!==e.keyCode&&32!==e.keyCode||!r)38===e.keyCode&&r&&(i=!0);else{const e=this._treeView.getSelectedItem()||this._treeView.getItemAt(0);a=!1;n=!1;e&&(s=e.modelId);i=!0}if(i){if(s){const e=this._resourceItemsMap.get(s),t=this._treeView.getSelectedItem().model;if(e&&e.model&&!e.model.preventOpen){n&&this._treeView.selectItem(e,a);const t=a?1:2;this._onSelectCallback(e.model,t)}else if(t&&!e.model.preventOpen){A.logExecuteCommand(L.OPEN_RESOURCE_VIEW,o.c.Ui);this._onSelectCallback(t,1)}this.hidePicker(!1,!a)}e.stopImmediatePropagation();e.preventDefault();return!1}return!0}onListViewToggle(e){e.hasChildren&&this._treeView.addItems(e.children,e,!1,!1)}refreshViewWithCallback(){this._fileListContainer.classList.add("refresh");this._treeView.refresh()}insertAtSortedPosition(e,t){let i=!1;const s=e.modelId;this._resourceItemsMap.get(s)&&this._treeView.removeItem(this._resourceItemsMap.get(s),!1,!1);this._resourceItemsMap.set(s,e);if(this.isOpen)if(t){if(this._treeView.getIndex(t)>=0)if(this._treeView.isItemExpanded(t)){const s=t.children,r=s.length;let o=t.getIndexOfChild(e);if(o<r&&e===s[o]){o++;for(;o<r&&!(this._treeView.getIndex(s[o])>=0);)o++;if(o<r){this._treeView.addItems([e],s[o],!0,!0,!0);i=!0}}else b.a.fail("Expected to find the given fileItem in it's parent");i||this._treeView.addItems([e],t,!1,!0)}else if(1===t.childCount){this._treeView.addItems([e],t,!1,!0);t.model||this._treeView.setRowState(this._treeView.getIndex(t),D.a.COLLAPSE_ROW)}}else this._treeView.addItems([e],null,!1,!0)}saveExpandState(){const e=[];this._expandedItemMap.clear();for(const t of this._rootNodesMap.values()){this._expandedItemMap.set(t.modelId,this._treeView.isItemExpanded(t));e.push(t)}let t=e.concat();for(;t.length>0;){const e=t.pop();if(this._treeView.isItemExpanded(e)){this._expandedItemMap.set(e.modelId,this._treeView.isItemExpanded(e));t=t.concat(e.children)}}}repopulateTree(){const e=[];for(const t of this._rootNodesMap.values())e.push(t);this._treeView.addItems(e,null,!1,!0);for(const t of e)this.repopulateChildren(t)}repopulateChildren(e){if(e.hasChildren){this._treeView.addItems(e.children,e,!1,!0);if(this._expandedItemMap.get(e.modelId))for(const t of e.children)this.repopulateChildren(t);else this._treeView.setRowState(this._treeView.getIndex(e),D.a.COLLAPSE_ROW)}}calcFilePickerSize(e){const t=document.getElementById("leftBlock").getBoundingClientRect(),i=this._fileListContainer.getBoundingClientRect(),s=t.right-G.MIN_WIDTH;let r=e&&e.clientX?e.clientX:G.MIN_WIDTH;0===r?G.MIN_WIDTH>=s?r=G.MIN_WIDTH:G.MIN_WIDTH<s&&(r=Math.max(G.MIN_WIDTH,Math.min(i.right,s))):r<G.MIN_WIDTH?r=G.MIN_WIDTH:r>s&&(r=Math.max(s,G.MIN_WIDTH));this._storageShell.storageContentContainer.style.paddingLeft=`calc(${r}px + 3px)`;this._fileListContainer.style.width=`${r-this.scaledInnerPadding}px`;this._container.style.width=`${r}px`;this._finalWidth=r;this._splitter.style.marginLeft=`calc(${this._fileListContainer.style.width} + 1px)`;this.invokeShellLayouts()}setupSplitter(){let e=!1;const t=document.getElementById("resizePane");this._splitter.addEventListener("mousedown",()=>{if(!e){document.body.classList.add("splitterEW");const i=()=>{Object(g.E)(G.STORAGE_RESOURCEPICKER_WIDTH_REG_KEY,this._fileListContainer.style.width);document.removeEventListener("mousemove",s,!0);document.removeEventListener("mouseup",i,!0);t.classList.remove("showResizePane");document.body.classList.remove("splitterEW");e=!1},s=Object(N.b)(e=>{e.buttons?this.calcFilePickerSize(e):i()});this._splitter.focus();document.addEventListener("mousemove",s,!0);document.addEventListener("mouseup",i,!0);t.classList.add("showResizePane");e=!0}});const i=Object(g.r)(G.STORAGE_RESOURCEPICKER_WIDTH_REG_KEY);if(i){this._finalWidth=parseFloat(i);!isNaN(this._finalWidth)&&this._finalWidth>=G.MIN_WIDTH?this._fileListContainer.style.width=i:this._fileListContainer.style.width=G.MIN_WIDTH+"px"}}invokeShellLayouts(){this._storageShell.layoutDocumentWindows()}focusSelectedItem(){const e=this.getSelectedItem()||this._treeView.getItemAt(0);e&&this._treeView.selectItem(e,!0)}hideContextMenu(){if(this._contextMenu){this._contextMenu.dismiss();this._contextMenu.dispose();this._contextMenu=null}}showContextMenu(e){this.hideContextMenu();this._treeView.refresh();this._contextMenu=M.create(this.createMenuItems(),"resourcePickerContextMenu");let t=0,i=0;if(e instanceof MouseEvent){t=e.pageX;i=e.pageY}t<0&&(t=0);i<0&&(i=0);this._contextMenu.show(t,i);e.preventDefault();e.stopImmediatePropagation()}createMenuItems(){const e=[];e.push({id:"menuItemSep1FilePicker",type:M.MenuItemType.separator});e.push({callback:()=>{for(const e of this._rootNodesMap.values())this._treeView.expandAllItems(this._treeView.getIndex(e));this.focusSelectedItem()},id:"menuItemExpandAll",label:Object(C.b)("ExpandAll"),type:M.MenuItemType.command});e.push({callback:()=>{for(const e of this._rootNodesMap.values())this._treeView.collapseAllItems(this._treeView.getIndex(e));this.focusSelectedItem()},id:"menuItemCollapseAll",label:Object(C.b)("CollapseAll"),type:M.MenuItemType.command});e.push({id:"menuItemSep2FilePicker",type:M.MenuItemType.separator});e.push({callback:()=>{const e=this._treeView.getSelectedItem();if(e){this._treeView.expandAllItems(this._treeView.getIndex(e));this.focusSelectedItem()}},disabled:()=>this._treeView.getSelectedItem()&&!this._treeView.getSelectedItem().hasChildren,id:"menuItemExpandChildren",label:Object(C.b)("ExpandChildren"),type:M.MenuItemType.command});e.push({callback:()=>{const e=this._treeView.getSelectedItem();if(e){this._treeView.collapseAllItems(this._treeView.getIndex(e));this.focusSelectedItem()}},disabled:()=>this._treeView.getSelectedItem()&&!this._treeView.getSelectedItem().hasChildren,id:"menuItemCollapseChildren",label:Object(C.b)("CollapseChildren"),type:M.MenuItemType.command});return e}}G.MIN_WIDTH=250;G.STORAGE_RESOURCEPICKER_OPEN_REG_KEY="StorageFilePickerOpen";G.OPENED_DOCUMENT_CLASS="openedDocument";G.INNER_PADDING=2;G.STORAGE_RESOURCEPICKER_WIDTH_REG_KEY="StorageFilePickerWidth";class W{constructor(){this._rpcMapPorts=new Map;this._eventQueue=[];this._storageManagerReady=new Promise(e=>{this._setstorageManagerReady=e});this.jsonDiagOMRpcMethodCall=this.jsonDiagOMRpcMethodCallImpl;n.b.addEventListener("attach",this.onAttach.bind(this));n.b.addEventListener("detach",this.onDetach.bind(this))}get isConnected(){return!!this._rpc}onStorageLoadComplete(e){this._setstorageManagerReady&&this._setstorageManagerReady(e);n.b.isAttached&&this.onAttach()}jsonDiagOMRpcMethodCallImpl(e,t){return y.callRemote(W.PORT_NAME,e,t)}retrieveCache(e,t){return this.jsonDiagOMRpcMethodCall("retrieveCache",[e,t])}retrieveCacheNames(e){return this.jsonDiagOMRpcMethodCall("retrieveCacheNames",[e])}deleteCacheItems(e,t,i){return this.jsonDiagOMRpcMethodCall("deleteCacheItems",[e,t,i])}retrieveCookies(e){return this.jsonDiagOMRpcMethodCall("retrieveCookies",[e])}deleteCookies(e,t){return this.jsonDiagOMRpcMethodCall("deleteCookies",[e,t])}deleteAllCookies(e){return this.jsonDiagOMRpcMethodCall("deleteAllCookies",[e])}deleteSessionCookies(e){return this.jsonDiagOMRpcMethodCall("deleteSessionCookies",[e])}setCookie(e,t){return this.jsonDiagOMRpcMethodCall("setCookie",[e,t])}retrieveIndexedDBKeyValuePairs(e,t,i,s){return this.jsonDiagOMRpcMethodCall("retrieveIndexedDBKeyValuePairs",[e,t,i,s])}getIdbDatabaseAndObjectStoreNames(e){return this.jsonDiagOMRpcMethodCall("getIdbDatabaseAndObjectStoreNames",[e])}idbRemoveKeyValuePairs(e,t,i,s){return this.jsonDiagOMRpcMethodCall("idbRemoveKeyValuePairs",[e,t,i,s])}retrieveLocalStorage(e){return this.jsonDiagOMRpcMethodCall("retrieveLocalStorage",[e])}retrieveSessionStorage(e){return this.jsonDiagOMRpcMethodCall("retrieveSessionStorage",[e])}localStorageSetItem(e,t,i){return this.jsonDiagOMRpcMethodCall("localStorageSetItem",[e,t,i])}sessionStorageSetItem(e,t,i){return this.jsonDiagOMRpcMethodCall("sessionStorageSetItem",[e,t,i])}localStorageDeleteItems(e,t){return this.jsonDiagOMRpcMethodCall("localStorageDeleteItems",[e,t])}sessionStorageDeleteItems(e,t){return this.jsonDiagOMRpcMethodCall("sessionStorageDeleteItems",[e,t])}localStorageSetSimulateCap(e){return this.jsonDiagOMRpcMethodCall("localStorageSetSimulateCap",[e])}sessionStorageSetSimulateCap(e){return this.jsonDiagOMRpcMethodCall("sessionStorageSetSimulateCap",[e])}jsonDiagOMRpcNotificationReceive(e,t){this.queueEvent(e,t)}queueEvent(e,t){this._eventQueue.push({event:e,params:t});this.processQueue()}processQueue(){if(!this._eventQueueCurrentItem&&this._eventQueue.length){this._eventQueueCurrentItem=this._eventQueue.shift();if(this._eventQueueCurrentItem){let e;const t=()=>{this._eventQueueCurrentItem=void 0;this.processQueue()};(e=this.jsonDiagOMRpcNotificationReceiveImpl(this._eventQueueCurrentItem.event,this._eventQueueCurrentItem.params)).then(t,t)}}}jsonDiagOMRpcNotificationReceiveImpl(e,t){b.a.failDebugOnly(`Unknown storage message ${e}`);return Promise.resolve()}onAttach(){this._storageManagerReady.then(e=>e.onConnect());y.loadScripts(W.SCRIPTS,W.PORT_NAME)}onDetach(){this._rpc=void 0;this._rpcMapPorts.clear();this._storageManagerReady.then(e=>e.onDetached())}}W.SCRIPTS=["../storage/remote/storageRemote.bundle.js"];W.PORT_NAME="storageDiagPort";var U=i(17),B=i(25);class F{static toCSV(e,t){var i=[];i.push(F.writeRecord(e));var s=t.map(t=>F.writeRecord(e.map(e=>t[e])));return(i=i.concat(s)).join("\r\n")}static writeRecord(e){return e.map(e=>F.writeValue(e)).join(",")}static writeValue(e){return null===e||void 0===e?"":(e=String(e)).indexOf('"')>=0||e.indexOf(",")>=0?'"'+e.replace('"','""')+'"':e}}class H{constructor(e){this._viewModel=e;this._rootElement=document.createElement("div");this._rootElement.classList.add("resourceGrid");this._rootElement.tabIndex=0;this._gridRootElement=document.createElement("div");this._gridRootElement.classList.add("resourceGrid-grid");this._titleElement=document.createElement("div");this._titleElement.classList.add("resourceGrid-title");this._viewModel.title.addHandler(this.onTitleChange.bind(this));this._wasEditorRecentlyDismissed=!1;this._rootElement.appendChild(this._titleElement);this._rootElement.appendChild(this._gridRootElement);var t={enableColumnReorder:!1,forceFitColumns:!0,editable:!0,enableAddRow:!0,autoEdit:!1,explicitInitialization:!0,editCommandHandler:this._viewModel.editItem.bind(this._viewModel),enableAsyncPostRender:!0,asyncPostRenderDelay:0,rowHeight:20,syncColumnCellResize:!0};H.initColumns(this._viewModel.columns);var i=this._viewModel.dataView;this._grid=new Slick.Grid(this._gridRootElement,i,this._viewModel.columns,t);this._grid.setSelectionModel(new Slick.RowSelectionModel);this._grid.onBeforeCellEditorDestroy.subscribe(e=>{this._wasEditorRecentlyDismissed=!0});this._grid.onBeforeEditCell.subscribe(e=>{this._wasEditorRecentlyDismissed=!1});var s=this._viewModel.columns[0];this._grid.setSortColumn(s.id,!0);this._viewModel.sort({sortColName:s.field,ascending:!0});$(this._rootElement).on("focus",()=>{this.doLayout(!0)});$(this._gridRootElement).on("blur","input.editor-text",()=>Slick.GlobalEditorLock.commitCurrentEdit());this._contextMenuId=H.NextId++;this._gridRootElement.addEventListener("contextmenu",e=>this.showContextMenu(e));window.addEventListener("resize",this.doLayout.bind(this));this.setupGridDataEvents()}get rootElement(){return this._rootElement}get wasRecentlyEditing(){return this._wasEditorRecentlyDismissed}clearRecentlyEditingState(){this._wasEditorRecentlyDismissed=!1}setupGridDataEvents(){var e=this._viewModel.dataView;e.onRowCountChanged.subscribe(()=>{this.preserveActiveRowState(()=>{this._grid.updateRowCount();this._grid.render()})});e.onRowsChanged.subscribe((e,t)=>{this.preserveActiveRowState(()=>{this._grid.invalidateRows(t.rows);this._grid.render()})});this._grid.onAddNewRow.subscribe((e,t)=>{this._viewModel.addItem(t.item)});this._grid.onSort.subscribe((e,t)=>{this._viewModel.sort({sortColName:t.sortCol.field,ascending:t.sortAsc})});this._grid.onBeforeEditCell.subscribe((t,i)=>{var s=!0;if(i.row===e.getLength()&&i.column!==this._viewModel.columns[0]){s=!1;this.forceEditInAddNewRow()}return s});this._grid.onKeyDown.subscribe(e=>{if(46!==e.which||e.ctrlKey||e.shiftKey||e.altKey||!this._grid.getActiveCell()||this.isEditing())if(9===e.which)this.isEditing()&&window.setImmediate(()=>this._grid.editActiveCell());else if(116!==e.which||!e.ctrlKey||e.shiftKey||e.altKey||this.isEditing()){if(65===e.which&&e.ctrlKey&&!e.shiftKey&&!e.altKey&&!this.isEditing()){this.selectAll();e.preventDefault();e.stopPropagation()}}else{this._viewModel.refresh();e.preventDefault();e.stopPropagation()}else{var t=this._grid.getDataLength(),i=this._grid.getSelectedRows().filter(e=>e!==t);this._grid.setSelectedRows([]);this._viewModel.removeItems(i)}});this._grid.onActiveCellChanged.subscribe((t,i)=>{if(void 0!==i.row){this._activeRowNum=i.row;this._activeRowId=this._viewModel.dataView.mapRowsToIds([i.row])[0];this._activeCell=i.cell;i.row===e.getLength()&&this.forceEditInAddNewRow()}else this._activeRowNum=this._activeRowId=this._activeCell=null});this._viewModel.setupGridDataEvents(this._grid)}doLayout(e){this._grid.resizeCanvas();if(e){null===this._grid.getActiveCellNode()&&this._grid.setActiveCell(0,0);this._grid.focus()}}init(){this._grid.init();this.initHeaderTooltips()}static initColumns(e){var t=(e,t,i,s)=>{var r=""+i[s.field];e.setAttribute("aria-label",s.name+", "+r);var o=JSON.stringify({content:r});e.setAttribute("data-plugin-vs-tooltip",o)};e.forEach(e=>e.asyncPostRender=t)}forceEditInAddNewRow(){setTimeout(()=>{this._rootElement.parentElement&&this._grid.gotoCell(this._viewModel.dataView.getLength(),0,!0)},0)}initHeaderTooltips(){this._viewModel.columns.filter(e=>e.headerCssClass&&e.showF12Tooltip).forEach(e=>{var t=this._gridRootElement.querySelector(".slick-header-column."+e.headerCssClass);t&&t.setAttribute("data-plugin-vs-tooltip",e.name)})}onCopy(){var e=this._viewModel.columns.map(e=>e.field).filter(e=>"id"!==e),t=this._viewModel.dataView.getItems()||[],i=this._grid.getSelectedRows().sort((e,t)=>e-t).map(e=>t[e]);const s=F.toCSV(e,i);Object(B.copyPlainText)(s)}onCopyMenuItemClicked(){this.onCopy()}selectAll(){var e=this._viewModel.dataView.getItems();if(e){var t=0,i=e.map(()=>t++);this._grid.setSelectedRows(i)}}onTitleChange(e){this._titleElement.innerText=e;this._titleElement.setAttribute("data-plugin-vs-tooltip",e)}isEditing(){return!!this._grid.getCellEditor()}showContextMenu(e){if(this._contextMenu){this._contextMenu.dispose();this._contextMenu=null}var t=this._grid.getCellFromEvent(e),i=t?t.row:null;this._contextMenu=M.create(this.createContextMenuItems(i),"resourceContextMenu"+this._contextMenuId);var s=0,r=0;if(e instanceof MouseEvent){s=e.pageX;r=e.pageY}if(s<=0&&r<=0){var o=this._grid.getCellNode(t.row,t.cell).getBoundingClientRect();s=o.left;r=o.top}this._contextMenu.show(s,r);e.preventDefault();e.stopImmediatePropagation()}createContextMenuItems(e){var t=[];t.push({id:"menuItemRefreshResourceItems"+this._contextMenuId,callback:()=>this._viewModel.refresh(),label:Object(C.b)("/Common/ResourceGridRefresh"),type:M.MenuItemType.command,disabled:()=>!1,accessKey:Object(C.b)("/Common/AccessKeyCtrlF5")});(t=t.concat(this._viewModel.createContextMenuItems(e))).push({id:"menuItemCopySelected"+this._contextMenuId,callback:this.onCopyMenuItemClicked.bind(this),label:Object(C.b)("CopySelectedItems"),type:M.MenuItemType.command,disabled:()=>!1,accessKey:Object(C.b)("/Common/AccessKeyCtrlC")});t.push({id:"menuItemSelectAll"+this._contextMenuId,callback:this.selectAll.bind(this),label:Object(C.b)("SelectAll"),type:M.MenuItemType.command,disabled:()=>!1,accessKey:Object(C.b)("/Common/AccessKeyCtrlA")});return t}preserveActiveRowState(e){var t,i=this._activeRowId,s=this._activeRowNum,r=this._activeCell,o=this._grid.getCellEditor();o&&(t=o.serializeValue());var a=document.activeElement===this._grid.getActiveCellNode();e();if(i){var n=this._viewModel.dataView.mapIdsToRows([i])[0];n="number"==typeof n?n:s;var l=this._grid.getDataLength();n=Math.min(n,l);this._grid.setActiveCell(n,r);this._grid.getSelectedRows().length||this._grid.setSelectedRows([n]);var d=this._grid.getActiveCellNode();d&&a&&d.focus();if((o||n===l)&&this._rootElement.parentElement){this._grid.editActiveCell();var h=this._viewModel.columns[r].field;if(o){var c={};c[h]=t;o.loadValue(c)}}}}}H.NextId=0;class z{constructor(){this.columns=[z.makeColumnInfo("request",Object(C.b)("CacheGridRequestLabel")),z.makeColumnInfo("response",Object(C.b)("CacheGridResponseLabel"))];const e={inlineFilters:!0};this.dataView=new Slick.Data.DataView(e);this._currentSortInfo={sortColName:"request",ascending:!0};this._titleProperty=new l.a}static makeGridDataItem(e,t){return{request:e,response:t,id:`${z.NextId++}`}}static makeColumnInfo(e,t){return{id:e,name:t,field:e,editor:Slick.Editors.Text,sortable:!0}}get title(){return this._titleProperty}loadModel(e){if(e!==this._model){this._model=e;this.dataView.beginUpdate();this.dataView.setItems([]);this.dataView.endUpdate();this._titleProperty.invoke(this._model.displayName)}return this.refresh()}addItem(e){if(!this._model)return U.a;const t=e.request,i=e.response||"";this.dataView.addItem(z.makeGridDataItem(t,i));return this.setItem(e.request,i).then(()=>this.refresh())}editItem(e,t,i){if(!this._model)return U.a;const s=t.field,r=e[s];i.execute();const o=()=>this.setItem(e.request,e.response).then(()=>this.refresh());return"request"===s?this._model.removeItems([r]).then(()=>o()):o()}removeItems(e){if(!this._model)return U.a;const t=e.map(e=>{const t=this.dataView.getItem(e);b.a.hasValue(t,"Can't delete an item for which the dataView has no responseUrl");return t.request});return this._model.removeItems(t).then(()=>this.refresh())}refresh(){return this._model?this._model.refresh().then(e=>{this.dataView.beginUpdate();this.syncStorageAndGrid(e);this.internalSort();this.dataView.endUpdate()}):U.a}sort(e){this._currentSortInfo=e;this.internalSort()}createContextMenuItems(e){const t=[];t.push({id:"menuItemDeleteResourceItem",callback:()=>this.removeItems([e]),label:Object(C.b)("/Common/DeleteItem"),type:M.MenuItemType.command,disabled:()=>e<0||null===e||e>=this.dataView.getLength(),accessKey:Object(C.b)("AccessKeyDel")});return t}setupGridDataEvents(e){}setItem(e,t){return this._model.setItem(e,t).then(e=>{"string"==typeof e&&e.length>0&&_e.showErrorDisplay("CacheSetItemErrorMessage",[e])})}internalSort(){const e=this._currentSortInfo.sortColName,t=this._currentSortInfo.ascending;this.dataView.sort((t,i)=>k.a.naturalSort(t[e],i[e]),t)}syncStorageAndGrid(e){const t=this.dataView.getItems().slice();for(let i=t.length-1;i>=0;i--){const s=t[i],r=e[s.request];if(void 0!==r){if(r!==s.response){s.response=r;this.dataView.updateItem(s.id,s)}delete e[s.request]}else this.dataView.deleteItem(s.id)}const i=Object.keys(e);for(const t of i)this.dataView.addItem(z.makeGridDataItem(t,e[t]))}}z.NextId=0;class q{constructor(e){if(e){this._gridViewModel=e;this._columnNames=this._gridViewModel.columns.map(e=>e.field);this.setSearchText("");this._gridViewModel.dataView.setFilter(q.testItem)}}static testItem(e,t){const i=t.searchText||"",s=t.escapeRegExp(i),r=new RegExp(s,"gi");for(const i of t.columns)if(r.test(e[i]))return!0;return!1}get disableButtons(){return!0}get searchText(){return this._searchText}findNextMatch(e,t,i){this.setSearchText(e);this._gridViewModel.dataView.refresh();return Promise.resolve(!0)}findAndHighlightMatches(e=this.searchText){this.setSearchText(e);this._gridViewModel.dataView.refresh()}getSearchTextFromSelection(e){return e}setSearchText(e){this._searchText=e;this._gridViewModel.dataView.setFilterArgs({searchText:e,columns:this._columnNames,escapeRegExp:T.a.escapeRegExp})}}class Y{get viewModel(){return this._viewModel}open(e,t,i){this.init();e.viewModel=this._viewModel;A.logExecuteCommand(L.CACHE_OPENED,o.c.NotSpecified);return this._viewModel.loadModel(e).then(()=>{window.setImmediate(()=>this.doLayout(2===t));return this._resourceGrid})}close(e,t){}doLayout(e){this._resourceGrid.doLayout(e)}onAttach(){this._resourceGrid.init()}get wasRecentlyEditing(){return this._resourceGrid&&this._resourceGrid.wasRecentlyEditing}clearRecentlyEditingState(){this._resourceGrid&&this._resourceGrid.clearRecentlyEditingState()}init(){if(!this._initialized){this._viewModel=new z;this._resourceGrid=new H(this._viewModel);this._resourceGrid.rootElement.classList.add("resourceHandler");this.searchProvider=new q(this._viewModel);this._initialized=!0}}}class Q{constructor(){this.columns=[Q.makeColumnInfo("name",Object(C.b)("CookiesGridNameLabel")),Q.makeColumnInfo("value",Object(C.b)("CookiesGridValueLabel")),Q.makeColumnInfo("domain",Object(C.b)("CookiesGridDomainLabel"),!1),Q.makeColumnInfo("path",Object(C.b)("CookiesGridPathLabel"),!1),Q.makeColumnInfo("expires",Object(C.b)("CookiesGridExpiresLabel"),!1),Q.makeColumnInfo("sameSite",Object(C.b)("CookiesGridSameSiteLabel"),!1),Q.makeBoolColumnInfo("httpOnly",Object(C.b)("CookiesGridHTTPLabel")),Q.makeBoolColumnInfo("secure",Object(C.b)("CookiesGridSecureLabel"))];const e={inlineFilters:!0};this.dataView=new Slick.Data.DataView(e);this._currentSortInfo={sortColName:"key",ascending:!0};this._titleProperty=new l.a}static makeGridItem(e,t){return{domain:"",expires:"",httpOnly:!1,id:Q.NextId+++"",name:e,path:"",sameSite:"",secure:!1,session:void 0,value:t}}static expiresFieldFromStorageEntry(e){return e.session?Object(C.b)("CookiesGridSessionCellLabel"):new Date(e.expires).toUTCString()}static gridItemFromStorageEntry(e){return{domain:e.domain,expires:Q.expiresFieldFromStorageEntry(e),httpOnly:e.httpOnly,id:Q.NextId+++"",name:e.name,path:e.path,sameSite:e.sameSite,secure:e.secure,session:e.session,value:e.value}}static storageEntryFromGridItem(e){return{domain:e.domain,expires:null,httpOnly:e.httpOnly,name:e.name,path:e.path,sameSite:e.sameSite,secure:e.secure,session:e.session,value:e.value}}static keyFromCookie(e){return[e.name,e.domain,e.path].join("/")}static cookieMapFromStorageData(e){const t=new Map;for(const i of e){const e=Q.keyFromCookie(i);t.set(e,i)}return t}static makeBoolColumnInfo(e,t){const i=Q.makeColumnInfo(e,t,!1);i.formatter=((e,t,i)=>i?"✓":"");i.cssClass="cookiesGrid-bool";i.headerCssClass="cookiesGrid-header-"+e;i.maxWidth=25;i.resizable=!1;i.showF12Tooltip=!0;return i}static makeColumnInfo(e,t,i=!0){const s={id:e,name:t,field:e,sortable:!0};i&&(s.editor=Slick.Editors.Text);return s}get title(){return this._titleProperty}loadModel(e){if(e!==this._model){this._model=e;this.dataView.beginUpdate();this.dataView.setItems([]);this.dataView.endUpdate();this._titleProperty.invoke(this._model.tooltip)}return this.refresh()}addItem(e){if(this._model){e.value=e.value||"";this.dataView.addItem(Q.makeGridItem(e.name,e.value));this._model.setItem(Q.storageEntryFromGridItem(e)).then(()=>this.refresh())}}editItem(e,t,i){if(!this._model)return;const s=t.field,r=i.serializedValue,o=e[s];if("name"===s&&/^\s*$/.test(r))return;i.execute();const a=()=>this._model.setItem(Q.storageEntryFromGridItem(e)).then(()=>this.refresh());"name"===s?this._model.removeItems([{name:o,domain:e.domain}]).then(()=>a()):a()}removeItems(e){const t=e.map(e=>{const t=this.dataView.getItem(e);t||b.a.failDebugOnly("The view tried to delete a cookie that doesn't exist in the view model");return t});this._model.removeItems(t).then(()=>this.refresh())}refresh(){return this._model.refresh().then(e=>{this.dataView.beginUpdate();this.syncStorageAndGrid(e);this.internalSort();this.dataView.endUpdate()})}sort(e){this._currentSortInfo=e;this.internalSort()}createContextMenuItems(e){const t=[];t.push({accessKey:Object(C.b)("AccessKeyDel"),callback:()=>this.removeItems([e]),disabled:()=>e<0||null===e||e>=this.dataView.getLength(),id:"menuItemDeleteCookie",label:Object(C.b)("CookiesGridDelete"),type:M.MenuItemType.command});t.push({accessKey:Object(C.b)("/Common/AccessKeyCtrlShiftDel"),callback:this.deleteAll.bind(this),disabled:()=>!1,id:"menuItemDeleteAllCookies",label:Object(C.b)("CookiesGridDeleteAll"),type:M.MenuItemType.command});t.push({accessKey:Object(C.b)("/Common/AccessKeyCtrlDel"),callback:()=>this._model.deleteSessionCookies().then(()=>this.refresh()),disabled:()=>!1,id:"menuItemDeleteAllSessionCookies",label:Object(C.b)("CookiesGridDeleteAllSession"),type:M.MenuItemType.command});return t}setupGridDataEvents(e){e.onKeyDown.subscribe(t=>{if(46===t.which&&t.ctrlKey&&t.shiftKey&&!t.altKey&&!e.getCellEditor()){this._model.deleteAll().then(()=>this.refresh());t.preventDefault()}else if(46===t.which&&t.ctrlKey&&!t.altKey&&!e.getCellEditor()){this._model.deleteSessionCookies().then(()=>this.refresh());t.preventDefault()}})}deleteAllSession(){this._model.deleteSessionCookies().then(()=>this.refresh())}deleteAll(){this._model.deleteAll().then(()=>this.refresh())}updateGridItemFromStorageEntry(e,t){let i=!1;for(const s of this.columns){const r=s.field;if("expires"===r){const s=Q.expiresFieldFromStorageEntry(e);if(s!==t.expires){t.expires=s;i=!0}}else if(t[r]!==e[r]){t[r]=e[r];i=!0}}return i}internalSort(){const e=this._currentSortInfo.sortColName,t=this._currentSortInfo.ascending;"expires"===e?this.dataView.sort((e,t)=>e.expires===t.expires?0:e.session?-1:t.session?1:Date.parse(e.expires)-Date.parse(t.expires),t):this.dataView.sort((t,i)=>k.a.naturalSort(t[e],i[e]),t)}syncStorageAndGrid(e){const t=Q.cookieMapFromStorageData(e);let i;const s=this.dataView.getItems().slice();for(let e=s.length-1;e>=0;e--){const r=s[e],o=Q.keyFromCookie(r),a=t.get(o);if(a){this.updateGridItemFromStorageEntry(a,r)&&this.dataView.updateItem(r.id,r);t.delete(o)}else""===r.domain&&""===r.path?i=r:this.dataView.deleteItem(r.id)}t.forEach(e=>{if(i&&e.name===i.name){this.updateGridItemFromStorageEntry(e,i)&&this.dataView.updateItem(i.id,i);i=null}else this.dataView.addItem(Q.gridItemFromStorageEntry(e))});i&&this.dataView.deleteItem(i.id)}}Q.NextId=0;class X{open(e,t,i){this._initialized||this.init();A.logExecuteCommand(L.COOKIES_OPENED,o.c.NotSpecified);e.viewModel=this._viewModel;return this._viewModel.loadModel(e).then(()=>{window.setImmediate(()=>this.doLayout(2===t));return this._resourceGrid})}close(e,t){}doLayout(e){this._resourceGrid.doLayout(e)}onAttach(){this._resourceGrid.init()}get wasRecentlyEditing(){return this._resourceGrid&&this._resourceGrid.wasRecentlyEditing}clearRecentlyEditingState(){this._resourceGrid&&this._resourceGrid.clearRecentlyEditingState()}init(){this._viewModel=new Q;this._resourceGrid=new H(this._viewModel);this._resourceGrid.rootElement.classList.add("resourceHandler");this.searchProvider=new q(this._viewModel)}}class J{constructor(e,t){this.toolbarPanelTemplate="Storage.cookiesPanel";this._storageManager=e;this._href=t;this._id=u.a.NextModelId++}get persistenceKey(){return`${J.ModelName}/${this._href}`}get shouldBePersisted(){return!0}get modelName(){return J.ModelName}get displayName(){return k.a.createShortenedUrlText(this._href)}get tooltip(){return this._href}get id(){return this._id}refresh(){return this._storageManager.retrieveCookies(this._href)}removeItems(e){return this._storageManager.deleteCookies(e,this._href)}deleteAll(){return this._storageManager.deleteAllCookies(this._href)}deleteSessionCookies(){return this._storageManager.deleteSessionCookies(this._href)}setItem(e){return this._storageManager.setCookie(e,this._href)}}J.ModelName="cookies";class Z{constructor(){this.columns=[Z.makeColumnInfo("key",Object(C.b)("IndexedDBGridKeyLabel")),Z.makeColumnInfo("primaryKey",Object(C.b)("IndexedDBGridPrimaryKeyLabel")),Z.makeColumnInfo("value",Object(C.b)("IndexedDBGridValueLabel"))];const e={inlineFilters:!0};this.dataView=new Slick.Data.DataView(e);this._currentSortInfo={sortColName:"key",ascending:!0};this._titleProperty=new l.a;this._keyMap=new Map}static makeGridDataItem(e,t,i){return{key:e,primaryKey:t,value:i,id:""+Z.NextId++}}static makeColumnInfo(e,t){return{id:e,name:t,field:e,editor:Slick.Editors.Text,sortable:!0}}get title(){return this._titleProperty}loadModel(e){if(e!==this._model){this._model=e;this.dataView.beginUpdate();this.dataView.setItems([]);this.dataView.endUpdate();this._titleProperty.invoke(this._model.displayName)}return this.refresh()}addItem(e){return Promise.resolve()}editItem(e,t,i){return Promise.resolve()}removeItems(e){if(!this._model)return U.a;const t=e.map(e=>{const t=this.dataView.getItem(e);b.a.hasValue(t,"Can't delete an item for which the dataView has no value");return t.primaryKey}),i=Array(t.length);for(let e=0;e<t.length;e++)i[e]=this._keyMap.get(t[e]);return this._model.removeItems(i).then(()=>this.refresh())}refresh(){return this._model?this._model.refresh().then(e=>{this.dataView.beginUpdate();this.syncStorageAndGrid(e);this.internalSort();this.dataView.endUpdate()}):Promise.resolve()}sort(e){this._currentSortInfo=e;this.internalSort()}createContextMenuItems(e){const t=[];t.push({id:"menuItemDeleteResourceItem",callback:()=>this.removeItems([e]),label:Object(C.b)("/Common/DeleteItem"),type:M.MenuItemType.command,disabled:()=>e<0||null===e||e>=this.dataView.getLength(),accessKey:Object(C.b)("AccessKeyDel")});return t}setupGridDataEvents(e){}internalSort(){const e=this._currentSortInfo.sortColName,t=this._currentSortInfo.ascending;this.dataView.sort((t,i)=>k.a.naturalSort(t[e],i[e]),t)}syncStorageAndGrid(e){this._keyMap=new Map;const t=new Map;for(const i of e){this._keyMap.set(i.primaryKeyString,i.primaryKey);t.set(i.primaryKeyString,[i.keyString,i.valueString])}const i=this.dataView.getItems().slice();for(let e=i.length-1;e>=0;e--){const s=i[e];if(t.has(s.primaryKey)){const e=t.get(s.primaryKey);if(e[1]!==s.value){s.value=e[1];this.dataView.updateItem(s.id,s)}t.delete(s.primaryKey)}else this.dataView.deleteItem(s.id)}for(const e of t)this.dataView.addItem(Z.makeGridDataItem(e[1][0],e[0],e[1][1]))}}Z.NextId=0;class ee{get viewModel(){return this._viewModel}open(e,t,i){this.init();e.viewModel=this._viewModel;A.logExecuteCommand(L.INDEXEDDB_OPENED,o.c.NotSpecified);return this._viewModel.loadModel(e).then(()=>{window.setImmediate(this.doLayout.bind(this));return this._resourceGrid})}close(e,t){}doLayout(){this._resourceGrid.doLayout()}onAttach(){this._resourceGrid.init()}get wasRecentlyEditing(){return this._resourceGrid&&this._resourceGrid.wasRecentlyEditing}clearRecentlyEditingState(){this._resourceGrid&&this._resourceGrid.clearRecentlyEditingState()}init(){if(!this._initialized){this._viewModel=new Z;this._resourceGrid=new H(this._viewModel);this._resourceGrid.rootElement.classList.add("resourceHandler");this.searchProvider=new q(this._viewModel);this._initialized=!0}}}var te=i(148),ie=i(105);class se{constructor(e){this._targets=new Map;this._resourceViewController=e.resourceViewController;this._storageManager=e;this._originCount=new te.a(e=>{const t=[new ie.a(0,e,this._storageManager),new ie.a(1,e,this._storageManager)];for(const e of t)this._resourceViewController.resourceAdded(e);return t},e=>{for(const t of e)this._resourceViewController.resourceRemoved(t)});this._hrefCount=new te.a(e=>{const t=new J(this._storageManager,e);this._resourceViewController.resourceAdded(t);return t},e=>{this._resourceViewController.resourceRemoved(e)});this._cacheOriginCount=new Map;this._idbNameOriginMap=new Map}onMessage(e,t){const i=t[0];switch(e){case"Handshake":const t={href:i.contextInfo,origin:i.origin,targetId:"0",targetType:"_top"};this.onClearTargets();this.onTargetCreated(t);break;case"ClearTargets":this.onClearTargets();break;case"TargetCreated":this.onTargetCreated(i);break;case"TargetClosed":this.onTargetClosed(i);break;case"TargetUpdated":this.onTargetUpdated(i)}}onTargetCreated(e){this._targets.set(e.targetId,e);this.targetAdded(e)}onTargetClosed(e){this._targets.delete(e.targetId);this.targetRemoved(e)}onTargetUpdated(e){const t=this._targets.get(e.targetId);this._targets.set(e.targetId,e);t&&this.targetRemoved(t);this.targetAdded(e)}onClearTargets(){this._targets.forEach(e=>{this.targetRemoved(e)});this._targets.clear()}async onCacheUpdated(e){this._cacheOriginCount.get(e)||this._cacheOriginCount.set(e,new Map);const t=await this._storageManager.retrieveCacheNames(e);for(const i of t){const t=this._cacheOriginCount.get(e);if(t&&!t.get(i)){const s=new P(e,i,this._storageManager);t.set(i,s);this._resourceViewController.resourceAdded(s)}}}deleteAllCachesForOrigin(e){const t=this._cacheOriginCount.get(e);t&&t.forEach((e,i)=>{this._resourceViewController.resourceRemoved(e);t.delete(i)})}targetAdded(e){if(!e||!e.origin)return;const t=e.origin,i=e.href;this._originCount.has(t)||this.addIndexedDBNodes(t);this._originCount.increment(t);this._hrefCount.increment(i);this.onCacheUpdated(t)}targetRemoved(e){if(!e||!e.origin)return;const t=e.origin,i=e.href;this._originCount.decrement(t);this._hrefCount.decrement(i);this.deleteAllCachesForOrigin(t);this._originCount.has(t)||this.removeIndexedDBTreeForOrigin(t)}addIndexedDBNodes(e){this._storageManager.getIdbDatabaseAndObjectStoreNames(e).then(t=>{this._idbNameOriginMap.has(e)||this._idbNameOriginMap.set(e,new Map);const i=this._idbNameOriginMap.get(e);for(const s of t){const t=`${s.databaseName}|${s.objectStoreName}|${s.indexName}`;if(i.has(t))continue;const r=new x.a(e,s.databaseName,s.objectStoreName,s.indexName,this._storageManager);i.set(t,r);this._resourceViewController.resourceAdded(r)}})}removeIndexedDBTreeForOrigin(e){const t=this._idbNameOriginMap.get(e);if(t&&0!==t.size)for(const[e,i]of t){this._resourceViewController.resourceRemoved(i);t.delete(e)}}}class re{constructor(){this.columns=[re.makeColumnInfo("key",Object(C.b)("WebStorageGridKeyLabel")),re.makeColumnInfo("value",Object(C.b)("WebStorageGridValueLabel"))];const e={inlineFilters:!0};this.dataView=new Slick.Data.DataView(e);this._currentSortInfo={sortColName:"key",ascending:!0};this._titleProperty=new l.a}static makeGridDataItem(e,t){return{id:""+re.NextId++,key:e,value:t}}static makeColumnInfo(e,t){return{editor:Slick.Editors.Text,field:e,id:e,name:t,sortable:!0}}get title(){return this._titleProperty}loadModel(e){if(e!==this._model){this._model=e;this.dataView.beginUpdate();this.dataView.setItems([]);this.dataView.endUpdate();this._titleProperty.invoke(this._model.displayName)}return this.refresh()}addItem(e){if(!this._model)return U.a;const t=e.key,i=e.value||"";this.dataView.addItem(re.makeGridDataItem(t,i));return this.setItem(e.key,i).then(()=>this.refresh())}editItem(e,t,i){if(!this._model)return U.a;const s=t.field,r=e[s];i.execute();const o=()=>this.setItem(e.key,e.value).then(()=>this.refresh());return"key"===s?this._model.removeItems([r]).then(()=>o()):o()}removeItems(e){if(!this._model)return U.a;const t=e.map(e=>{const t=this.dataView.getItem(e);b.a.hasValue(t,"Can't delete an item for which the dataView has no value");return t.key});return this._model.removeItems(t).then(()=>this.refresh())}refresh(){return this._model?this._model.refresh().then(e=>{this.dataView.beginUpdate();this.syncStorageAndGrid(e);this.internalSort();this.dataView.endUpdate()}):U.a}sort(e){this._currentSortInfo=e;this.internalSort()}createContextMenuItems(e){const t=[],i={accessKey:Object(C.b)("AccessKeyDel"),callback:()=>this.removeItems([e]),disabled:()=>e<0||null===e||e>=this.dataView.getLength(),id:"menuItemDeleteResourceItem",label:Object(C.b)("/Common/DeleteItem"),type:M.MenuItemType.command};t.push(i);return t}setupGridDataEvents(e){}setItem(e,t){return this._model.setItem(e,t).then(e=>{"string"==typeof e&&e.length>0&&_e.showErrorDisplay("WebStorageSetItemErrorMessage",[e])})}internalSort(){const e=this._currentSortInfo.sortColName,t=this._currentSortInfo.ascending;this.dataView.sort((t,i)=>k.a.naturalSort(t[e],i[e]),t)}syncStorageAndGrid(e){const t=this.dataView.getItems().slice();for(let i=t.length-1;i>=0;i--){const s=t[i],r=e[s.key];if(void 0!==r){if(r!==s.value){s.value=r;this.dataView.updateItem(s.id,s)}delete e[s.key]}else this.dataView.deleteItem(s.id)}const i=Object.keys(e);for(const t of i)this.dataView.addItem(re.makeGridDataItem(t,e[t]))}}re.NextId=0;class oe{get viewModel(){return this._viewModel}open(e,t,i){this.init();e.viewModel=this._viewModel;A.logExecuteCommand(L.WEBSTORAGE_OPENED,o.c.NotSpecified);return this._viewModel.loadModel(e).then(()=>{window.setImmediate(()=>this.doLayout(2===t));return this._resourceGrid})}close(e,t){}doLayout(e){this._resourceGrid.doLayout(e)}onAttach(){this._resourceGrid.init()}get wasRecentlyEditing(){return this._resourceGrid&&this._resourceGrid.wasRecentlyEditing}clearRecentlyEditingState(){this._resourceGrid&&this._resourceGrid.clearRecentlyEditingState()}init(){if(!this._initialized){this._viewModel=new re;this._resourceGrid=new H(this._viewModel);this._resourceGrid.rootElement.classList.add("resourceHandler");this.searchProvider=new q(this._viewModel);this._initialized=!0}}}var ae=i(133),ne=i(81);const le=Object(ne.b)();class de extends ae.a{constructor(e){super(de.STORAGE_SETTINGS_KEY);this._storageManager=e;this.isAttached=!1;this._storageData={resourceDisplayData:[]};this._propertyChangeRegistrations=[];this._activeResourceDataItemsMap={};this._resourceDisplayDataItems={};this.isInitialized=this.initialize();A.logPerformance({id:"Storage_Persistence_DataLoad_Start"});this._manualPersistModelNames=[]}static persistenceKeyEquals(e,t){return e.toLowerCase()===t.toLowerCase()}registerManualPersistModelName(e){this._manualPersistModelNames.push(e)}saveStorageData(e=!0){if(this.isAttached){A.logPerformance({id:"Storage_Persistence_SaveState_Start"});this.isAttached=e;le.saveSettings(de.STORAGE_DATA_KEY,this.fetchStorageData());A.logPerformance({id:"Storage_Persistence_SaveState_Stop"})}}resourceAdded(e){this._manualPersistModelNames.indexOf(e.modelName)<0&&this.persistResourceAdded(e)}persistResourceAdded(e){if(e.shouldBePersisted){this._storageData.resourceDisplayData=this._storageData.resourceDisplayData||[];for(const t of this._storageData.resourceDisplayData)de.persistenceKeyEquals(t.key,e.persistenceKey)&&(this._resourceDisplayDataItems[t.key]=t);e.persistedPropNames&&e.propertyChanged&&(this._propertyChangeRegistrations[e.id]=e.propertyChanged.addHandler(t=>{if(e.persistedPropNames&&e.persistedPropNames.indexOf(t)>=0){this.getResourceDisplayData(e.persistenceKey)[t]=e[t];this.saveStorageData()}}));if(this._storageData.openResources)for(const t of this._storageData.openResources)de.persistenceKeyEquals(e.persistenceKey,t.key)&&!this.isAlreadyOpen(e.persistenceKey)&&this.openModel(e,t)}}resourceClosed(e,t){this._manualPersistModelNames.indexOf(e.modelName)<0&&this.persistResourceClosed(e,t)}persistResourceClosed(e,t){if(e.shouldBePersisted&&this._storageData.openResources)for(let i=0;i<this._storageData.openResources.length;i++){const s=this._storageData.openResources[i];if(de.persistenceKeyEquals(e.persistenceKey,s.key)){this._activeResourceDataItemsMap.hasOwnProperty(s.key)&&delete this._activeResourceDataItemsMap[s.key];t||this._storageData.openResources.splice(i,1);this.saveStorageData();break}}}resourceOpened(e,t){this._manualPersistModelNames.indexOf(e.modelName)<0&&this.persistResourceOpened(e,t)}persistResourceOpened(e,t){if(e.shouldBePersisted){const i=this._storageData.openResources||[];let s;for(s=0;s<i.length;s++){const r=i[s];if(de.persistenceKeyEquals(e.persistenceKey,r.key)){0!==t&&(this._activeResourceDataItem=r);return}}const r={key:e.persistenceKey};i.push(r)>de.MAX_PERSISTED_RESOURCES&&i.shift();this._activeResourceDataItem=r;this._storageData.openResources=i;this.saveStorageData()}else this._activeResourceDataItem=void 0}resourceRemoved(e){this._manualPersistModelNames.indexOf(e.modelName)<0&&this.persistResourceRemoved(e)}persistResourceRemoved(e){const t=this._propertyChangeRegistrations[e.id];if(t){delete this._propertyChangeRegistrations[e.id];t.unregister()}}updateEditorPosition(e){this._activeResourceDataItem&&(this._activeResourceDataItem.offset=e)}initialize(){return this.loadStorageData(de.STORAGE_DATA_KEY).then(e=>{this._storageData=e;A.logPerformance({id:"Storage_Persistence_DataLoad_Stop"})})}loadStorageData(e){const t={};return le.getSettings(e).then(e=>this._storageData=e,()=>this._storageData=t)}openModel(e,t){A.logPerformance({id:"Storage_TabOpen_Start"});this._activeResourceDataItemsMap[t.key]=t;this._storageManager.resourceViewController.open(e,{activation:0}).then(()=>{A.logPerformance({id:"Storage_TabOpen_Stop"})})}isAlreadyOpen(e){const t=this._storageManager.resourceViewController.openModels;for(const i of t)if(i.persistenceKey){const t=i;if(de.persistenceKeyEquals(t.persistenceKey,e))return!0}return!1}fetchStorageData(){const e={};this._storageData=this._storageData||e;return this._storageData}getResourceDisplayData(e,t=!0){const i=e.toLowerCase();let s=this._resourceDisplayDataItems[i];if(!s){s={key:i};if(t){this._resourceDisplayDataItems[i]=s;this._storageData.resourceDisplayData||(this._storageData.resourceDisplayData=[]);this._storageData.resourceDisplayData.push(s);this._storageData.resourceDisplayData.length>de.MAX_PERSISTED_RESOURCES&&this._storageData.resourceDisplayData.shift()}}return s}}de.STORAGE_DATA_KEY="JavaScriptStorageData";de.STORAGE_SETTINGS_KEY="JavaScriptStorageSettings";de.MAX_PERSISTED_RESOURCES=100;class he{constructor(e){this._resources=new Set;this._resourceVC=e}removeAll(){this._removingAll=!0;this._resources.forEach(e=>{this._resourceVC.resourceRemoved(e)});this._resources=new Set;this._removingAll=!1}resourceAdded(e){this._removingAll||this._resources.add(e)}resourceRemoved(e){this._removingAll||this._resources.delete(e)}}class ce{constructor(e,t){this.initializedSelfTest=!1;this.rpcClient=Object(f.g)();this.storageShell=t;this._rpcWrapper=e;this._testEventObject=new O.a;this.persistenceManager=new de(this);this.isInitialized=this.persistenceManager.isInitialized;const i=t&&t.documentToolbar;this.resourceViewController=new u.a(document.getElementById("resourcesView"),i,!0,!1);this.targetManager=new se(this);this._resourceTable=new he(this.resourceViewController);this.rpcClient.listen("notificationFromRemote|ms:storage",e=>{const{event:t,params:i}=e;this._rpcWrapper.jsonDiagOMRpcNotificationReceive(t,i)});this.rpcClient.listen("targetsUpdatedNotification",e=>{const{event:t,params:i}=e;this.targetManager.onMessage(t,i)});this.resourceViewController.registerHandler(J.ModelName,new X);const s=new oe;this.resourceViewController.registerHandler(ie.a.LocalStorageModelName,s);this.resourceViewController.registerHandler(ie.a.SessionStorageModelName,s);this.resourceViewController.registerHandler(x.a.ModelName,new ee);this.resourceViewController.registerHandler(P.ModelName,new Y);this.resourceViewController.registerListener(this.persistenceManager);this.resourceViewController.registerListener(this._resourceTable);this.registerPluginMethodHandlers()}get isAttached(){return this._rpcWrapper.isConnected}get testEventObject(){return this._testEventObject}get isStorageToolReady(){return this._storageToolLaunched}onDetached(){this._storageToolLaunched=!1;this.persistenceManager.saveStorageData(!1);this.storageShell.tabControl.animation=!1;this._resourceTable.removeAll()}registerPluginMethodHandlers(){window.setImmediate(()=>{Object(g.A)(I.c.storage)})}onConnect(){this.initializeOnConnectionSuccess()}async retrieveCache(e,t){try{A.logPerformance({id:"Storage_LoadCache_Start"});const i=await this._rpcWrapper.retrieveCache(e,t);A.logPerformance({id:"Storage_LoadCache_Stop"});const s=Object.entries(i);for(const[e,t]of s)"OpaqueContentTypeText"===t?i[e]=Object(C.b)("OpaqueContentTypeText"):"NoContentTypeText"===t&&(i[e]=Object(C.b)("NoContentTypeText"));return i}catch(e){return{}}}async retrieveCacheNames(e){try{A.logPerformance({id:"Storage_LoadCacheNames_Start"});const t=await this._rpcWrapper.retrieveCacheNames(e);A.logPerformance({id:"Storage_LoadCacheNames_Stop"});return t}catch(e){return[]}}deleteCacheItems(e,t,i){return this._rpcWrapper.deleteCacheItems(e,t,i)}async retrieveIndexedDBKeyValuePairs(e,t,i,s){try{A.logPerformance({id:"Storage_LoadIndexedDb_Start"});const r=await this._rpcWrapper.retrieveIndexedDBKeyValuePairs(e,t,i,s);A.logPerformance({id:"Storage_LoadIndexedDb_Stop"});return r}catch(e){return[]}}async getIdbDatabaseAndObjectStoreNames(e){A.logPerformance({id:"Storage_LoadIdbDatabaseAndObjectStoreNames_Start"});const t=await this._rpcWrapper.getIdbDatabaseAndObjectStoreNames(e);A.logPerformance({id:"Storage_LoadIdbDatabaseAndObjectStoreNames_Stop"});return t}idbRemoveKeyValuePairs(e,t,i,s){return this._rpcWrapper.idbRemoveKeyValuePairs(e,t,i,s)}async retrieveCookies(e){A.logPerformance({id:"Storage_LoadCookies_Start"});const t=await this._rpcWrapper.retrieveCookies(e);A.logPerformance({id:"Storage_LoadCookies_Stop"});return t}deleteCookies(e,t){return this._rpcWrapper.deleteCookies(e,t)}deleteAllCookies(e){return this._rpcWrapper.deleteAllCookies(e)}deleteSessionCookies(e){return this._rpcWrapper.deleteSessionCookies(e)}setCookie(e,t){return this._rpcWrapper.setCookie(e,t)}setSimulateCap(e,t){return 0===e?this._rpcWrapper.localStorageSetSimulateCap(t):this._rpcWrapper.sessionStorageSetSimulateCap(t)}async retrieveWebStorage(e,t){if(0===e){A.logPerformance({id:"Storage_LoadLocalStorage_Start"});const e=await this._rpcWrapper.retrieveLocalStorage(t);A.logPerformance({id:"Storage_LoadLocalStorage_Stop"});return e}{A.logPerformance({id:"Storage_LoadSessionStorage_Start"});const e=await this._rpcWrapper.retrieveSessionStorage(t);A.logPerformance({id:"Storage_LoadSessionStorage_Stop"});return e}}webStorageSetItem(e,t,i,s){return 0===e?this._rpcWrapper.localStorageSetItem(t,i,s):this._rpcWrapper.sessionStorageSetItem(t,i,s)}webStorageDeleteItems(e,t,i){return 0===e?this._rpcWrapper.localStorageDeleteItems(t,i):this._rpcWrapper.sessionStorageDeleteItems(t,i)}async initializeSelfTest(){if(w.b()&&!this.initializedSelfTest){this.initializedSelfTest=!0;(await i.e(3).then(i.bind(null,242))).init(this.storageShell)}}onAttachFailed(){return U.a}initializeOnConnectionSuccess(){this.storageShell.tabControl.animation=!0;this._storageToolLaunched||(this.persistenceManager.isAttached=!0);this._storageToolLaunched=!0;this.testEventObject.fireEvent("storageTabLaunched")}}const ue=Object(p.a)(),me=matchMedia("(max-width: 680px) and (min-width: 1px)");class _e{constructor(){this.propertyChanged=new l.a;this._traceWriter=new _.a;window.addEventListener("load",()=>{Object(f.g)().call("ms:host","postPendingMessageToPlugin",[I.c.storage]);this._traceWriter=new _.b});this._storageContent=document.getElementById("storageContent");this._storageContentContainer=document.getElementById("storageContentContainer");n.b.addEventListener("activated",()=>{this.layoutErrorDisplay(!0)});document.getElementById("root").setAttribute("aria-label",Object(C.b)("StorageTool"));c.a.registerNavigationFrames([c.a.makeNavigationFrameFromCallback(document.body,()=>document.getElementById("resourcePickerButton"))]);c.a.registerFocusHandlers(I.c.storage);this._documentToolbar=new a.a("Common.toolbarTemplateWithoutTitle");this._documentToolbar.rootElement.classList.add(u.a.HideResourceToolbarCssClass);document.getElementById("documentToolbar").appendChild(this._documentToolbar.rootElement)}static showErrorDisplay(e,t=[],i=0,s=""){_e.LastErrorDisplayId=e;const r=Object(C.b)(e,t);ue.show(r,i,s)}static closeErrorDisplay(e){e===_e.LastErrorDisplayId&&ue.close()}get resourcePicker(){return this._resourcePicker}get tabControl(){return this._tabControl}get storageContentContainer(){return this._storageContentContainer}set storageContentContainer(e){this._storageContentContainer=e}get storageManager(){return this._storageManager}get traceWriter(){return this._traceWriter}get documentToolbar(){return this._documentToolbar}initializeUI(){const e=new W;this._storageManager=new ce(e,this);this._tabControl=new m.a(document.getElementById("tabControl"),this._storageManager.resourceViewController);this._resourcePicker=new G(document.getElementById("resourcePickerMenu"),document.getElementById("resourcePickerButton"),this);this._storageManager.resourceViewController.registerListener(this._tabControl);this._storageManager.resourceViewController.registerListener(this._resourcePicker);setTimeout(()=>{e.onStorageLoadComplete(this._storageManager)},0);window.addEventListener("resize",()=>{this.resourcePicker.hidePicker()});document.addEventListener("keydown",this.onKeyDown.bind(this));me.addListener(()=>{this._storageContent.style.msGridRows="";this._storageContent.style.msGridColumns="";this.layoutDocumentWindows()});if(g.w){this._resourcePicker.addResourceRoot(ie.a.LocalStorageModelName,Object(C.b)("LocalStorageLabel"),"localStorage");this._resourcePicker.addResourceRoot(ie.a.SessionStorageModelName,Object(C.b)("SessionStorageLabel"),"sessionStorage");this._resourcePicker.addResourceRoot(x.a.ModelName,Object(C.b)("IndexedDBLabel"),"indexedDB");this._resourcePicker.addResourceRoot(J.ModelName,Object(C.b)("CookiesLabel"),"cookies");this._resourcePicker.addResourceRoot(P.ModelName,Object(C.b)("CacheLabel"),"cache")}const t=Object(g.r)(G.STORAGE_RESOURCEPICKER_OPEN_REG_KEY);if(!t||"true"===t){this.resourcePicker.showPicker();Object(g.E)(G.STORAGE_RESOURCEPICKER_OPEN_REG_KEY,"true")}this._storageManager.resourceViewController.registerListener(this);Object(d.a)(e=>{const t=this._storageManager.resourceViewController.currentHandler;if(!t)return!1;if(t.wasRecentlyEditing&&27===e.keyCode&&Object(h.i)(e)){t.clearRecentlyEditingState();return!0}return!1});window.requestAnimationFrame(()=>{S.markToolReady(I.c.storage);y.startPreload(I.c.storage);w.b()&&this._storageManager.initializeSelfTest()})}resourceOpened(e,t){}resourceClosed(){}layoutDocumentWindows(){this._storageManager.resourceViewController.doLayout();this.tabControl.doLayout();this.layoutErrorDisplay(!1)}tryNarratorAnnounce(e){E.setAlertMessage(e)}layoutErrorDisplay(e){ue.isShown&&ue.resize(e)}onKeyDown(e){let t=!1;if(e.ctrlKey&&!e.altKey&&!e.shiftKey)if(9===e.keyCode){this._tabControl.selectNextTab(o.c.KeyboardShortcut);t=!0}else if(115===e.keyCode){A.logExecuteCommand(L.CLOSE_RESOURCE_VIEW,o.c.KeyboardShortcut);this._storageManager.resourceViewController.closeCurrent(!1);t=!0}if(e.ctrlKey&&!e.altKey&&e.shiftKey){if(9===e.keyCode){this._tabControl.selectPreviousTab(o.c.KeyboardShortcut);t=!0}const i=parseInt(e.key,10);if(!isNaN(i)&&i>=1&&i<=9){this._tabControl.trySelectTabByNumber(i,o.c.KeyboardShortcut);t=!0}}if(t){e.stopPropagation();e.stopImmediatePropagation();e.preventDefault();return!1}return!0}}Object(r.a)();document.addEventListener("DOMContentLoaded",async()=>{await Object(s.a)();const e=new _e;window.storageShellForTestContractsOnly=e;e.initializeUI()})},95:function(e,t,i){"use strict";i.d(t,"a",function(){return o});var s=i(38),r=i(12);class o{constructor(e,t,i,r,o){this.toolbarPanelTemplate="Storage.indexedDBPanel";this._origin=e;this._databaseName=t;this._objectStoreName=i;this._storageManager=o;this._indexName=r;this._id=s.a.NextModelId++}get displayOrigin(){return r.a.createShortenedUrlText(this._origin)}get displayDatabaseName(){return this._databaseName}get displayDBNameAndOrigin(){return`${this._databaseName} (${this.displayOrigin})`}get displayObjectStoreName(){return this._objectStoreName}get displayIndexName(){return this._indexName}get persistenceKey(){return`${o.ModelName}/${this._origin}/${this._databaseName}/${this._objectStoreName}`}get shouldBePersisted(){return!0}get id(){return this._id}get modelName(){return o.ModelName}get displayName(){return this._indexName?r.a.createShortenedUrlText(this._indexName):r.a.createShortenedUrlText(this._objectStoreName)}get fullDisplayName(){return this._objectStoreName}refresh(){return this._storageManager.retrieveIndexedDBKeyValuePairs(this._origin,this._databaseName,this._objectStoreName,this._indexName)}removeItems(e){return this._storageManager.idbRemoveKeyValuePairs(e,this._origin,this._databaseName,this._objectStoreName)}setItem(e,t){return Promise.resolve("key, value")}}o.ModelName="indexedDB"}});
