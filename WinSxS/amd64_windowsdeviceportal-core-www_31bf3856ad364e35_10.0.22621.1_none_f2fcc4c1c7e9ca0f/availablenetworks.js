function ShowWifiNetworkActions(n,t,i){var r=$("#selectedNetwork");r.children().remove();var u=!0;n.connected||(n.requiresSharedKeyAuth?r.append('<label for="wlanSharedKey">Key<\/label><input type="password" id="wlanSharedKey" class="inputField">'):n.requiresEnterpriseAuth&&(r.append('<span class="warning">Enterprise authentication not supported in browser! Use device to connect<\/span>'),u=!1));n.connected?$(document.createElement("button")).addClass("commonButton").text("Disconnect").click(i).appendTo(r):u&&($(document.createElement("button")).addClass("commonButton indentSection").text("Connect").click(t).appendTo(r),r.append('<input type="checkbox" checked id="connectAndCreateProfile"><label for="connectAndCreateProfile">Create profile (auto re-connect)<\/label>'))}function HideWifiNetworkActions(){$("#selectedNetwork").empty()}function WifiNetworkInterface(n){var t=this,i;t.interface=n;i=/[{}]/g;t.interface.GUID=n.GUID.replace(i,"");t.availableNetworks=[];$("#availableInterfaces").append($("<option>",{value:t.interface.GUID,text:t.interface.Description}));this.onNetworkScanComplete=function(){};this.scanForNetworks=function(){t.availableNetworks=[];var n=new WebbRest;n.getAvailableWirelessNetworks(t.interface.GUID).done(function(n){var s=n.AvailableNetworks,r={},u={},f,i,e,o;for(f in s)i=s[f],i.SSID!==""&&(i.ScanOrderIndex=f,i.ProfileName&&(u[i.SSID]=i.SSID in u?"":i.ProfileName),i.SSID in r&&!i.AlreadyConnected||(r[i.SSID]=i));for(e in r)o=r[e],o.ProfileName=u[e],t.availableNetworks.push(o);t.availableNetworks.sort(function(n,t){return n.SSID.localeCompare(t.SSID)});t.onNetworkScanComplete(t)})};WifiNetworkInterface.requiresSharedKeyAuth=function(n){return n.AuthenticationAlgorithm==="WPA2_PSK"||n.AuthenticationAlgorithm==="WPA_PSK"||n.AuthenticationAlgorithm==="WEP"||n.AuthenticationAlgorithm==="Open"&&n.CipherAlgorithm!=="None"};WifiNetworkInterface.requiresEnterpriseAuth=function(n){return n.AuthenticationAlgorithm==="WPA2"||n.AuthenticationAlgorithm==="WPA"}}function NetworksViewer(n,t){function r(){function n(n,t,i){var r=parseInt(i/25,10);return'<span class="symbol" aria-label="'+i+'%">'+["","","","",""][r]+"<\/span>"}function r(n,t,i){return i===!0?'<span class="symbol" aria-label="Connected">&#xe73e;<\/span>':'<span aria-label="Not connected"><\/span>'}function u(n,t,i){return i==="Infrastructure"?'<span class="symbol" aria-label="Infrastructure">&#xe73e;<\/span>':'<span class="symbol" aria-label="Ad-hoc">&#xe711;<\/span>'}var f=[{id:"AlreadyConnected",name:"Already Connected",field:"AlreadyConnected",width:32,cssClass:"tableCell",headerCssClass:"tableHeaderHidden",formatter:r},{id:"SSID",name:"SSID",field:"SSID",width:300,cssClass:"tableCell",headerCssClass:"tableHeader"},{id:"Profile",name:"Profile",field:"ProfileName",width:200,cssClass:"tableCell",headerCssClass:"tableHeader"},{id:"InfrastructureType",name:"Infra",field:"InfrastructureType",width:64,cssClass:"tableCell",headerCssClass:"tableHeader",formatter:u},{id:"SignalQuality",name:"Signal",field:"SignalQuality",width:64,cssClass:"tableCell",headerCssClass:"tableHeader",formatter:n},{id:"AuthenticationAlgorithm",name:"Security",field:"AuthenticationAlgorithm",width:100,cssClass:"tableCell",headerCssClass:"tableHeader"},{id:"CipherAlgorithm",name:"Encryption",field:"CipherAlgorithm",width:92,cssClass:"tableCell",headerCssClass:"tableHeader"},{id:"Channel",name:"Channel",field:"Channel",width:92,cssClass:"tableCell",headerCssClass:"tableHeader"}],o={selectedCellCssClass:"rowSelected",enableCellNavigation:!0,enableColumnReorder:!1,showHeaderRow:!0,syncColumnCellResize:!0,scaleHeightToDockContentParent:!0,rowHeight:36.5,headerRowHeight:40.45,gridLabel:t.gridLabel,rowHeaderName:t.rowHeaderName,rowHeaderId:t.rowHeaderId,rowHeaderColumn:t.rowHeaderColumn};i.dataView=new Slick.Data.DataView;i.networksGrid=new Slick.Grid("#availableWifiNetworks",i.dataView,f,o);$(window).resize(i.networksGrid.resizeCanvas.bind(i.networksGrid));i.dataView.onRowCountChanged.subscribe(function(){i.networksGrid.updateRowCount();i.networksGrid.render()});i.dataView.onRowsChanged.subscribe(function(n,t){i.networksGrid.invalidateRows(t.rows);i.networksGrid.render()});i.networksGrid.onClick.subscribe(e);i.networksGrid.setSelectionModel(new Slick.RowSelectionModel);enableSlickGridTabbing("availableWifiNetworks",!0)}function u(n){var t={connected:n.AlreadyConnected,requiresSharedKeyAuth:WifiNetworkInterface.requiresSharedKeyAuth(n),requiresEnterpriseAuth:WifiNetworkInterface.requiresEnterpriseAuth(n)};ShowWifiNetworkActions(t,function(){f(n)},i.onDisconnectClick)}function f(n){var t;WifiNetworkInterface.requiresSharedKeyAuth(n)&&(t=$("#wlanSharedKey").val());i.onConnectClick(n,t)}function e(n,t){var f=$("#availableInterfaces option:selected").val(),r=WirelessNetworksManager.lookupByGuid(i.interfaces,f);r&&u(r.availableNetworks[t.row])}var i=this;i.interfaces=n;r();this.invalidate=function(n){var t=n.availableNetworks;i.dataView.setItems([]);i.dataView.setItems(t,"ScanOrderIndex");i.networksGrid.setSelectedRows([]);HideWifiNetworkActions()};this.onDisconnectClick=function(){};this.onConnectClick=function(){}}function WirelessNetworksManager(){function t(t){n.asyncScanCount=t;var i=createSmallSpinOptions();i.top="0%";i.left="0%";i.position="relative";n.busySpin=new Spinner(i);n.busySpin.spin(document.getElementById("availableNetworksScanningBusyIndicator"))}function u(){n.busySpin.stop()}function f(){var r=$("#availableInterfaces option:selected").val(),i=WirelessNetworksManager.lookupByGuid(n.interfaces,r);i&&(t(1),i.scanForNetworks())}function e(t){var i=$("#availableInterfaces option:selected").val();t.interface.GUID===i&&n.networksViewer.invalidate(t);n.asyncScanCount--;n.asyncScanCount===0&&u()}function i(n){var i,r,t,u;if($("#availableProfiles").empty(),$("#connectToProfile").prop("disabled",!0),$("#deleteProfile").prop("disabled",!0),n.ProfilesList){for(i=n.ProfilesList,r=0;r<i.length;r++)t=i[r],u=t.Name,t.GroupPolicyProfile===!0&&(u+=" (group policy)"),u+=t.PerUserProfile?" (per user)":" (all users)",$("#availableProfiles").append($("<option>",{value:t.Name,text:u}));i.length>0&&($("#connectToProfile").prop("disabled",!1),$("#deleteProfile").prop("disabled",!1))}}function o(){var r=$("#availableInterfaces option:selected").val(),t=WirelessNetworksManager.lookupByGuid(n.interfaces,r);t&&(i(t),n.networksViewer.invalidate(t))}function s(){var u=$("#availableInterfaces option:selected").val(),i=WirelessNetworksManager.lookupByGuid(n.interfaces,u),r;i&&(r=new WebbRest,t(1),r.disconnectFromNetwork(i.interface.GUID).always(function(){i.scanForNetworks()}))}function h(i,r){var e=$("#availableInterfaces option:selected").val(),u=WirelessNetworksManager.lookupByGuid(n.interfaces,e),o=$("#connectAndCreateProfile")[0].checked,f;u&&(f=new WebbRest,t(1),f.connectToNetwork(u.interface.GUID,i.SSID,r,o).always(function(){u.scanForNetworks()}))}function c(){var i=$("#availableInterfaces option:selected").val(),u=WirelessNetworksManager.lookupByGuid(n.interfaces,i),f=$("#availableProfiles option:selected").val(),r;t(1);r=new WebbRest;r.connectToNetworkUsingProfile(i,f).always(function(){u.scanForNetworks()})}function l(){var t=$("#availableInterfaces option:selected").val(),r=WirelessNetworksManager.lookupByGuid(n.interfaces,t),u=$("#availableProfiles option:selected").val(),f=new WebbRest;f.deleteWifiProfile(t,u).done(function(){for(var t=r.interface.ProfilesList,n=0;n<t.length;n++)if(t[n].Name===u){t.splice(n,1);break}i(r.interface)})}var n=this,r=new WebbRest;r.getWirelessInterfaces().done(function(r){var c,l,u,a;for(r.Enabled===!1&&(a='<span class="warning" role="alert">WiFi is not available on this device.<\/span>',document.getElementById("adapterStatusIndicator").innerHTML=a,document.getElementById("adapterControls").hidden=!0),n.interfaces=[],u=0;u<r.Interfaces.length;u++)c=r.Interfaces[u],l=new WifiNetworkInterface(c),n.interfaces.push(l),u==0&&i(c);n.networksViewer=new NetworksViewer(n.interfaces,{gridLabel:"Available networks",rowHeaderName:"SSID"});n.networksViewer.onConnectClick=h;n.networksViewer.onDisconnectClick=s;$("#availableInterfaces").on("change",o);if($("#rescanInterface").click(f),n.interfaces.length>0)for(t(n.interfaces.length),u=0;u<n.interfaces.length;u++)n.interfaces[u].onNetworkScanComplete=e,n.interfaces[u].scanForNetworks()});WirelessNetworksManager.lookupByGuid=function(n,t){for(var i in n)if(n[i].interface.GUID===t)return n[i]};$("#connectToProfile").click(c);$("#deleteProfile").click(l)}var createSmallSpin,WebbRest;$(function(){WirelessNetworksManager()});
/*!
//@ sourceURL=tools/AvailableNetworks/AvailableNetworks.js
*/
