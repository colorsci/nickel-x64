function AvailableRadioViewer(n){function f(n,t,i){return i=="On"?"<a href='#' tabindex='0' aria-label='on' role='button'>On<\/a>":i=="Off"?"<a href='#' tabindex='0' aria-label='off' role='button'>Off<\/a>":""}function e(n,t,i,r,u){var f=u.HasUnknownUsbDevice?"Possibly: ":"",e=u.ID||"";return f+i+"<br /><span class='bluetoothRadioFullName'>"+e+"<\/span>"}function u(n,i){var r=new WebbRest,u={ID:window.btoa(n),State:i};r.httpPostExpect200("/api/bt/setradio?"+$.param(u)).done(function(){t.setFocusToHeadingNextGridInvalidate=!0;t.updater.start()}).fail(function(){alert("Failed to set radio.")})}function o(n){var i=this.availableRadioGrid,r=i.getCellFromEvent(n),t;i.getColumns()[r.cell].id=="State"&&(t=this.dataView.getItems()[r.row],t.State=="On"?u(t.ID,"Off"):t.State=="Off"&&u(t.ID,"On"))}function s(){this.availableRadioGrid.updateRowCount();this.availableRadioGrid.render()}function h(n,t){this.availableRadioGrid.invalidateRows(t.rows);this.availableRadioGrid.render()}function c(n,t){var i=function(n,i){var r=n[t.sortCol.field],u=i[t.sortCol.field];return r===u?0:r>u?1:-1};this.dataView.sort(i,t.sortAsc);this.availableRadioGrid.render()}var t=this,i,r;this.updateAvailableRadioList=function(n){this.dataView.beginUpdate();this.dataView.setItems([],"idIndex");this.dataView.setItems(n,"idIndex");this.dataView.reSort();this.dataView.endUpdate();this.availableRadioGrid.invalidate();this.setFocusToHeadingNextGridInvalidate&&($("#radioListHeading").focus(),this.setFocusToHeadingNextGridInvalidate=!1)};this.onDataSourceError=function(){this.dataView.setItems([]);this.availableRadioGrid.invalidate();this.availableRadioGrid.render()};i=[{id:"Name",name:"Radio",field:"DisplayName",sortable:!0,width:550,cssClass:"tableCell",headerCssClass:"tableHeader",formatter:e},{id:"ProblemCode",name:"Problem Code",field:"ProblemCode",sortable:!0,width:100,cssClass:"tableCell",headerCssClass:"tableHeader"},{id:"State",name:"State",field:"State",sortable:!0,width:80,cssClass:"tableCell",headerCssClass:"tableHeader",formatter:f}];r={selectedCellCssClass:"rowSelected",enableCellNavigation:!0,enableColumnReorder:!1,showHeaderRow:!1,syncColumnCellResize:!0,enableTextSelectionOnCells:!0,rowHeight:62,autoHeight:!0,scaleHeightToDockContentParent:!1,gridLabel:"Bluetooth radios"};this.dataView=new Slick.Data.DataView;this.availableRadioGrid=new Slick.Grid("#"+n,this.dataView,i,r);$(window).resize(this.availableRadioGrid.resizeCanvas.bind(this.availableRadioGrid));this.dataView.onRowCountChanged.subscribe(s.bind(this));this.dataView.onRowsChanged.subscribe(h.bind(this));this.availableRadioGrid.onSort.subscribe(c.bind(this));this.availableRadioGrid.setSortColumn("Name",!0);this.availableRadioGrid.onClick.subscribe(o.bind(this));this.updater=new AvailableRadioDataUpdater;this.updater.dataAvailable.add(t.updateAvailableRadioList.bind(t));t.updater.start()}function AvailableBluetoothViewer(n){function t(){return"<a href='#' tabindex='0' aria-label='pair' role='button'><span class='blackTextButton'>Pair<\/span><\/a>"}function r(n){var i=this.availableDevicesGrid,r=i.getCellFromEvent(n),t,u;i.getColumns()[r.cell].id=="PairDevice"&&(t=this.dataView.getItems()[r.row],window.confirm("Do you want to pair this device "+t.Name+"?")&&(u=new BluetoothPair(t.ID),u.start()))}function u(){this.availableDevicesGrid.updateRowCount();this.availableDevicesGrid.render()}function f(n,t){this.availableDevicesGrid.invalidateRows(t.rows);this.availableDevicesGrid.render()}function e(n,t){var i=function(n,i){var r=n[t.sortCol.field],u=i[t.sortCol.field];return r===u?0:r>u?1:-1};this.dataView.sort(i,t.sortAsc)}this.updateAvailableBluetoothList=function(n){this.dataView.beginUpdate();this.dataView.setItems(n,"ID");this.dataView.reSort();this.dataView.endUpdate();this.availableDevicesGrid.invalidate()};this.onDataSourceError=function(){this.dataView.setItems([],"ID");this.availableDevicesGrid.invalidate()};var i=[{id:"PairDevice",name:"Pair Device",field:"",sortable:!0,width:80,cssClass:"tableCell",headerCssClass:"tableHeaderHidden",formatter:t},{id:"Name",name:"Device Name",field:"Name",sortable:!0,width:200,cssClass:"tableCell",headerCssClass:"tableHeader"},{id:"ID",name:"ID",field:"ID",sortable:!0,width:450,cssClass:"tableCell",headerCssClass:"tableHeader"}];this.dataView=new Slick.Data.DataView;this.availableDevicesGrid=new Slick.Grid("#"+n,this.dataView,i,{selectedCellCssClass:"rowSelected",enableCellNavigation:!0,enableColumnReorder:!1,showHeaderRow:!0,syncColumnCellResize:!0,rowHeight:36.5,autoHeight:!0,gridLabel:"Available devices"});$(window).resize(this.availableDevicesGrid.resizeCanvas.bind(this.availableDevicesGrid));this.dataView.onRowCountChanged.subscribe(u.bind(this));this.dataView.onRowsChanged.subscribe(f.bind(this));this.availableDevicesGrid.onSort.subscribe(e.bind(this));this.availableDevicesGrid.setSortColumn("Name",!0);this.availableDevicesGrid.onClick.subscribe(r.bind(this))}function PairedBluetoothViewer(n){function u(){return"<a href='#' tabindex='0' aria-label='Remove' role='button'><span class='blackTextButton'>Remove<\/span><\/a>"}function f(n,t,i){return i=="Connected"?"<a href='#' tabindex='0' aria-label='Disconnect' role='button'>Disconnect<\/a>":i=="Disconnected"?"<a href='#' tabindex='0' aria-label='Connect' role='button'>Connect<\/a>":""}function e(n,t,i){return isNaN(i)?"":i.toString()+"%"}function o(n){var f=this.pairedDevicesGrid,u=f.getCellFromEvent(n),i,r;f.getColumns()[u.cell].id=="PairDevice"?(i=this.dataView.getItems()[u.row],window.confirm("Do you want to remove this device "+i.Name+"?")&&(r=new WebbRest,r.removeBluetoothDevice(i.ID))):f.getColumns()[u.cell].id=="AudioConnectionStatus"&&(i=this.dataView.getItems()[u.row],i.AudioConnectionStatus=="Connected"?(r=new WebbRest,r.disconnectBluetoothDevice(i.ID).done(function(){t.setFocusToHeadingNextGridInvalidate=!0})):i.AudioConnectionStatus=="Disconnected"&&(r=new WebbRest,r.connectBluetoothDevice(i.ID).done(function(){t.setFocusToHeadingNextGridInvalidate=!0})))}function s(){this.pairedDevicesGrid.updateRowCount();this.pairedDevicesGrid.render()}function h(n,t){this.pairedDevicesGrid.invalidateRows(t.rows);this.pairedDevicesGrid.render()}function c(n,t){var i=function(n,i){var r=n[t.sortCol.field],u=i[t.sortCol.field];return r===u?0:r>u?1:-1};this.dataView.sort(i,t.sortAsc)}var t=this,i,r;this.updatePairedBluetoothList=function(n){this.dataView.beginUpdate();this.dataView.setItems(n,"ID");this.dataView.reSort();this.dataView.endUpdate();this.pairedDevicesGrid.invalidate();this.setFocusToHeadingNextGridInvalidate&&($("#pairedDeviceHeading").focus(),this.setFocusToHeadingNextGridInvalidate=!1)};this.onDataSourceError=function(){this.dataView.setItems([],"ID");this.pairedDevicesGrid.invalidate()};i=[{id:"PairDevice",name:"Pair Device",field:"",sortable:!0,width:80,cssClass:"tableCell",headerCssClass:"tableHeaderHidden",formatter:u},{id:"Name",name:"Device Name",field:"Name",sortable:!0,width:200,cssClass:"tableCell",headerCssClass:"tableHeader"},{id:"ID",name:"ID",field:"ID",sortable:!0,width:450,cssClass:"tableCell",headerCssClass:"tableHeader"},{id:"AudioConnectionStatus",name:"Audio Connection Status",field:"AudioConnectionStatus",sortable:!0,width:150,cssClass:"tableCell",headerCssClass:"tableHeader",formatter:f},{id:"BatteryLevel",name:"Battery Level",field:"BatteryLevel",sortable:!0,width:100,cssClass:"tableCell",headerCssClass:"tableHeader",formatter:e}];r={selectedCellCssClass:"rowSelected",enableCellNavigation:!0,enableColumnReorder:!1,showHeaderRow:!0,syncColumnCellResize:!0,rowHeight:36.5,autoHeight:!0,gridLabel:"Paired devices"};this.dataView=new Slick.Data.DataView;this.pairedDevicesGrid=new Slick.Grid("#"+n,this.dataView,i,r);$(window).resize(this.pairedDevicesGrid.resizeCanvas.bind(this.pairedDevicesGrid));this.dataView.onRowCountChanged.subscribe(s.bind(this));this.dataView.onRowsChanged.subscribe(h.bind(this));this.pairedDevicesGrid.onSort.subscribe(c.bind(this));this.pairedDevicesGrid.setSortColumn("Name",!0);this.pairedDevicesGrid.onClick.subscribe(o.bind(this))}window.onbeforeunload=function(){}